const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/new-Y4Rh6vwq.js","assets/index-BA7OnkC-.js","assets/_patientId-UVqw4ljs.js","assets/new-C0aDniaU.js","assets/_appointmentId-CNj7nzSk.js"])))=>i.map(i=>d[i]);
!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const e={context:void 0,registry:void 0,effects:void 0,done:!1,getContextId(){return t(this.context.count)},getNextContextId(){return t(this.context.count++)}};function t(t){const n=String(t),s=n.length-1;return e.context.id+(s?String.fromCharCode(96+s):"")+n}function n(t){e.context=t}const s=Symbol("solid-proxy"),r="function"==typeof Proxy,i=Symbol("solid-track"),o={equals:(e,t)=>e===t};let a=null,l=K;const c=1,u=2,h={owned:null,cleanups:null,context:null,owner:null},d={};var f=null;let p=null,g=null,m=null,y=null,v=0;function b(e,t){const n=g,s=f,r=0===e.length,i=void 0===t?s:t,o=r?h:{owned:null,cleanups:null,context:i?i.context:null,owner:i},a=r?e:()=>e(()=>_(()=>H(o)));f=o,g=null;try{return U(a,!0)}finally{g=n,f=s}}function w(e,t){const n={value:e,observers:null,observerSlots:null,comparator:(t=t?Object.assign({},o,t):o).equals||void 0};return[F.bind(n),e=>("function"==typeof e&&(e=e(n.value)),q(n,e))]}function x(e,t,n){V(B(e,t,!0,c))}function S(e,t,n){V(B(e,t,!1,c))}function C(e,t,n){l=z;const s=B(e,t,!1,c),r=$&&L($);r&&(s.suspense=r),n&&n.render||(s.user=!0),y?y.push(s):V(s)}function k(e,t,n){n=n?Object.assign({},o,n):o;const s=B(e,t,!0,0);return s.observers=null,s.observerSlots=null,s.comparator=n.equals||void 0,V(s),F.bind(s)}function O(t,n,s){let r,i,o;"function"==typeof n?(r=t,i=n,o=s||{}):(r=!0,i=t,o=n||{});let a=null,l=d,c=null,u=!1,h="initialValue"in o,m="function"==typeof r&&k(r);const y=new Set,[v,b]=(o.storage||w)(o.initialValue),[S,C]=w(void 0),[O,M]=w(void 0,{equals:!1}),[P,I]=w(h?"ready":"unresolved");function A(e,t,n,s){return a===e&&(a=null,void 0!==s&&(h=!0),e!==l&&t!==l||!o.onHydrated||queueMicrotask(()=>o.onHydrated(s,{value:t})),l=d,function(e,t){U(()=>{void 0===t&&b(()=>e),I(void 0!==t?"errored":h?"ready":"unresolved"),C(t);for(const e of y.keys())e.decrement();y.clear()},!1)}(t,n)),t}function R(){const e=$&&L($),t=v(),n=S();if(void 0!==n&&!a)throw n;return g&&!g.user&&e&&x(()=>{O(),a&&(e.resolved&&p||y.has(e)||(e.increment(),y.add(e)))}),t}function E(e=!0){if(!1!==e&&u)return;u=!1;const t=m?m():r;if(null==t||!1===t)return void A(a,_(v));let n;const s=l!==d?l:_(()=>{try{return i(t,{value:v(),refetching:e})}catch(s){n=s}});var o;if(void 0===n)return(o=s)&&"object"==typeof o&&"then"in o?(a=s,"v"in s?(1===s.s?A(a,s.v,void 0,t):A(a,void 0,G(s.v),t),s):(u=!0,queueMicrotask(()=>u=!1),U(()=>{I(h?"refreshing":"pending"),M()},!1),s.then(e=>A(s,e,void 0,t),e=>A(s,void 0,G(e),t)))):(A(a,s,void 0,t),s);A(a,void 0,G(n),t)}e.context&&(c=e.getNextContextId(),"initial"===o.ssrLoadFrom?l=o.initialValue:e.load&&e.has(c)&&(l=e.load(c))),Object.defineProperties(R,{state:{get:()=>P()},error:{get:()=>S()},loading:{get(){const e=P();return"pending"===e||"refreshing"===e}},latest:{get(){if(!h)return R();const e=S();if(e&&!a)throw e;return v()}}});let T=f;return m?x(()=>(T=f,E(!1))):E(!1),[R,{refetch:e=>function(e,t){const n=f,s=g;f=e,g=null;try{return U(t,!0)}catch(r){Y(r)}finally{f=n,g=s}}(T,()=>E(e)),mutate:b}]}function M(e){return U(e,!1)}function _(e){if(null===g)return e();const t=g;g=null;try{return e()}finally{g=t}}function P(e,t,n){const s=Array.isArray(e);let r,i=n&&n.defer;return n=>{let o;if(s){o=Array(e.length);for(let t=0;t<e.length;t++)o[t]=e[t]()}else o=e();if(i)return i=!1,n;const a=_(()=>t(o,r,n));return r=o,a}}function I(e){C(()=>_(e))}function A(e){return null===f||(null===f.cleanups?f.cleanups=[e]:f.cleanups.push(e)),e}function R(){return g}const[E,T]=w(!1);function j(e,t){const n=Symbol("context");return{id:n,Provider:X(n),defaultValue:e}}function L(e){let t;return f&&f.context&&void 0!==(t=f.context[e.id])?t:e.defaultValue}function D(e){const t=k(e),n=k(()=>Z(t()));return n.toArray=()=>{const e=n();return Array.isArray(e)?e:null!=e?[e]:[]},n}let $;function F(){if(this.sources&&this.state)if(this.state===c)V(this);else{const e=m;m=null,U(()=>W(this),!1),m=e}if(g){const e=this.observers?this.observers.length:0;g.sources?(g.sources.push(this),g.sourceSlots.push(e)):(g.sources=[this],g.sourceSlots=[e]),this.observers?(this.observers.push(g),this.observerSlots.push(g.sources.length-1)):(this.observers=[g],this.observerSlots=[g.sources.length-1])}return this.value}function q(e,t,n){let s=e.value;return e.comparator&&e.comparator(s,t)||(e.value=t,e.observers&&e.observers.length&&U(()=>{for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t],s=p&&p.running;s&&p.disposed.has(n),(s?n.tState:n.state)||(n.pure?m.push(n):y.push(n),n.observers&&Q(n)),s||(n.state=c)}if(m.length>1e6)throw m=[],new Error},!1)),t}function V(e){if(!e.fn)return;H(e);const t=v;!function(e,t,n){let s;const r=f,i=g;g=f=e;try{s=e.fn(t)}catch(o){return e.pure&&(e.state=c,e.owned&&e.owned.forEach(H),e.owned=null),e.updatedAt=n+1,Y(o)}finally{g=i,f=r}(!e.updatedAt||e.updatedAt<=n)&&(null!=e.updatedAt&&"observers"in e?q(e,s):e.value=s,e.updatedAt=n)}(e,e.value,t)}function B(e,t,n,s=c,r){const i={fn:e,state:s,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:f,context:f?f.context:null,pure:n};return null===f||f!==h&&(f.owned?f.owned.push(i):f.owned=[i]),i}function N(e){if(0===e.state)return;if(e.state===u)return W(e);if(e.suspense&&_(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<v);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if((e=t[n]).state===c)V(e);else if(e.state===u){const n=m;m=null,U(()=>W(e,t[0]),!1),m=n}}function U(e,t){if(m)return e();let n=!1;t||(m=[]),y?n=!0:y=[],v++;try{const t=e();return function(e){m&&(K(m),m=null);if(e)return;const t=y;y=null,t.length&&U(()=>l(t),!1)}(n),t}catch(s){n||(y=null),m=null,Y(s)}}function K(e){for(let t=0;t<e.length;t++)N(e[t])}function z(t){let s,r=0;for(s=0;s<t.length;s++){const e=t[s];e.user?t[r++]=e:N(e)}if(e.context){if(e.count)return e.effects||(e.effects=[]),void e.effects.push(...t.slice(0,r));n()}for(!e.effects||!e.done&&e.count||(t=[...e.effects,...t],r+=e.effects.length,delete e.effects),s=0;s<r;s++)N(t[s])}function W(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const s=e.sources[n];if(s.sources){const e=s.state;e===c?s!==t&&(!s.updatedAt||s.updatedAt<v)&&N(s):e===u&&W(s,t)}}}function Q(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=u,n.pure?m.push(n):y.push(n),n.observers&&Q(n))}}function H(e){let t;if(e.sources)for(;e.sources.length;){const t=e.sources.pop(),n=e.sourceSlots.pop(),s=t.observers;if(s&&s.length){const e=s.pop(),r=t.observerSlots.pop();n<s.length&&(e.sourceSlots[r]=n,s[n]=e,t.observerSlots[n]=r)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)H(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)H(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function G(e){return e instanceof Error?e:new Error("string"==typeof e?e:"Unknown error",{cause:e})}function J(e,t,n){try{for(const n of t)n(e)}catch(s){Y(s,n&&n.owner||null)}}function Y(e,t=f){const n=a&&t&&t.context&&t.context[a],s=G(e);if(!n)throw s;y?y.push({fn(){J(s,n,t)},state:c}):J(s,n,t)}function Z(e){if("function"==typeof e&&!e.length)return Z(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const s=Z(e[n]);Array.isArray(s)?t.push.apply(t,s):t.push(s)}return t}return e}function X(e,t){return function(t){let n;return S(()=>n=_(()=>(f.context={...f.context,[e]:t.value},D(()=>t.children))),void 0),n}}const ee=Symbol("fallback");function te(e){for(let t=0;t<e.length;t++)e[t]()}function ne(e,t){return _(()=>e(t||{}))}function se(){return!0}const re={get:(e,t,n)=>t===s?n:e.get(t),has:(e,t)=>t===s||e.has(t),set:se,deleteProperty:se,getOwnPropertyDescriptor:(e,t)=>({configurable:!0,enumerable:!0,get:()=>e.get(t),set:se,deleteProperty:se}),ownKeys:e=>e.keys()};function ie(e){return(e="function"==typeof e?e():e)?e:{}}function oe(){for(let e=0,t=this.length;e<t;++e){const t=this[e]();if(void 0!==t)return t}}function ae(...e){let t=!1;for(let r=0;r<e.length;r++){const n=e[r];t=t||!!n&&s in n,e[r]="function"==typeof n?(t=!0,k(n)):n}if(r&&t)return new Proxy({get(t){for(let n=e.length-1;n>=0;n--){const s=ie(e[n])[t];if(void 0!==s)return s}},has(t){for(let n=e.length-1;n>=0;n--)if(t in ie(e[n]))return!0;return!1},keys(){const t=[];for(let n=0;n<e.length;n++)t.push(...Object.keys(ie(e[n])));return[...new Set(t)]}},re);const n={},i=Object.create(null);for(let s=e.length-1;s>=0;s--){const t=e[s];if(!t)continue;const r=Object.getOwnPropertyNames(t);for(let e=r.length-1;e>=0;e--){const s=r[e];if("__proto__"===s||"constructor"===s)continue;const o=Object.getOwnPropertyDescriptor(t,s);if(i[s]){const e=n[s];e&&(o.get?e.push(o.get.bind(t)):void 0!==o.value&&e.push(()=>o.value))}else i[s]=o.get?{enumerable:!0,configurable:!0,get:oe.bind(n[s]=[o.get.bind(t)])}:void 0!==o.value?o:void 0}}const o={},a=Object.keys(i);for(let s=a.length-1;s>=0;s--){const e=a[s],t=i[e];t&&t.get?Object.defineProperty(o,e,t):o[e]=t?t.value:void 0}return o}function le(e,...t){if(r&&s in e){const n=new Set(t.length>1?t.flat():t[0]),s=t.map(t=>new Proxy({get:n=>t.includes(n)?e[n]:void 0,has:n=>t.includes(n)&&n in e,keys:()=>t.filter(t=>t in e)},re));return s.push(new Proxy({get:t=>n.has(t)?void 0:e[t],has:t=>!n.has(t)&&t in e,keys:()=>Object.keys(e).filter(e=>!n.has(e))},re)),s}const n={},i=t.map(()=>({}));for(const s of Object.getOwnPropertyNames(e)){const r=Object.getOwnPropertyDescriptor(e,s),o=!r.get&&!r.set&&r.enumerable&&r.writable&&r.configurable;let a=!1,l=0;for(const e of t)e.includes(s)&&(a=!0,o?i[l][s]=r.value:Object.defineProperty(i[l],s,r)),++l;a||(o?n[s]=r.value:Object.defineProperty(n,s,r))}return[...i,n]}function ce(t){let s,r;const i=i=>{const o=e.context;if(o){const[i,a]=w();e.count||(e.count=0),e.count++,(r||(r=t())).then(t=>{!e.done&&n(o),e.count--,a(()=>t.default),n()}),s=i}else if(!s){const[e]=O(()=>(r||(r=t())).then(e=>e.default));s=e}let a;return k(()=>(a=s())?_(()=>{if(!o||e.done)return a(i);const t=e.context;n(o);const s=a(i);return n(t),s}):"")};return i.preload=()=>r||((r=t()).then(e=>s=()=>e.default),r),i}const ue=e=>`Stale read from <${e}>.`;function he(e){const t="fallback"in e&&{fallback:()=>e.fallback};return k(function(e,t,n={}){let s=[],r=[],o=[],a=0,l=t.length>1?[]:null;return A(()=>te(o)),()=>{let c,u,h=e()||[],d=h.length;return h[i],_(()=>{let e,t,i,p,g,m,y,v,w;if(0===d)0!==a&&(te(o),o=[],s=[],r=[],a=0,l&&(l=[])),n.fallback&&(s=[ee],r[0]=b(e=>(o[0]=e,n.fallback())),a=1);else if(0===a){for(r=new Array(d),u=0;u<d;u++)s[u]=h[u],r[u]=b(f);a=d}else{for(i=new Array(d),p=new Array(d),l&&(g=new Array(d)),m=0,y=Math.min(a,d);m<y&&s[m]===h[m];m++);for(y=a-1,v=d-1;y>=m&&v>=m&&s[y]===h[v];y--,v--)i[v]=r[y],p[v]=o[y],l&&(g[v]=l[y]);for(e=new Map,t=new Array(v+1),u=v;u>=m;u--)w=h[u],c=e.get(w),t[u]=void 0===c?-1:c,e.set(w,u);for(c=m;c<=y;c++)w=s[c],u=e.get(w),void 0!==u&&-1!==u?(i[u]=r[c],p[u]=o[c],l&&(g[u]=l[c]),u=t[u],e.set(w,u)):o[c]();for(u=m;u<d;u++)u in i?(r[u]=i[u],o[u]=p[u],l&&(l[u]=g[u],l[u](u))):r[u]=b(f);r=r.slice(0,a=d),s=h.slice(0)}return r});function f(e){if(o[u]=e,l){const[e,n]=w(u);return l[u]=n,t(h[u],e)}return t(h[u])}}}(()=>e.each,e.children,t||void 0))}function de(e){const t=e.keyed,n=k(()=>e.when,void 0,void 0),s=t?n:k(n,void 0,{equals:(e,t)=>!e==!t});return k(()=>{const r=s();if(r){const i=e.children;return"function"==typeof i&&i.length>0?_(()=>i(t?r:()=>{if(!_(s))throw ue("Show");return n()})):i}return e.fallback},void 0,void 0)}function fe(e){const t=D(()=>e.children),n=k(()=>{const e=t(),n=Array.isArray(e)?e:[e];let s=()=>{};for(let t=0;t<n.length;t++){const e=t,r=n[t],i=s,o=k(()=>i()?void 0:r.when,void 0,void 0),a=r.keyed?o:k(o,void 0,{equals:(e,t)=>!e==!t});s=()=>i()||(a()?[e,o,r]:void 0)}return s});return k(()=>{const t=n()();if(!t)return e.fallback;const[s,r,i]=t,o=i.children;return"function"==typeof o&&o.length>0?_(()=>o(i.keyed?r():()=>{if(_(n)()?.[0]!==s)throw ue("Match");return r()})):o},void 0,void 0)}function pe(e){return e}let ge;function me(t){let n;e.context&&e.load&&(n=e.load(e.getContextId()));const[s,r]=w(n,void 0);return ge||(ge=new Set),ge.add(r),A(()=>ge.delete(r)),k(()=>{let e;if(e=s()){const n=t.fallback;return"function"==typeof n&&n.length?_(()=>n(e,()=>r())):n}return function(e,t){a||(a=Symbol("error")),(f=B(void 0,void 0,!0)).context={...f.context,[a]:[t]};try{return e()}catch(n){Y(n)}finally{f=f.owner}}(()=>t.children,r)},void 0,void 0)}const ye=j();function ve(t){let s,r,i,o,a,l=0;const[c,u]=w(!1),h=$||($=j()),d={increment:()=>{1===++l&&u(!0)},decrement:()=>{0===--l&&u(!1)},inFallback:c,effects:[],resolved:!1},p=f;if(e.context&&e.load){const t=e.getContextId();let s=e.load(t);if(s&&("object"!=typeof s||1!==s.s?i=s:e.gather(t)),i&&"$$f"!==i){const[s,l]=w(void 0,{equals:!1});o=s,i.then(()=>{if(e.done)return l();e.gather(t),n(r),l(),n()},e=>{a=e,l()})}}const g=L(ye);let m;return g&&(s=g.register(d.inFallback)),A(()=>m&&m()),ne(h.Provider,{value:d,get children(){return k(()=>{if(a)throw a;if(r=e.context,o)return o(),o=void 0;r&&"$$f"===i&&n();const l=k(()=>t.children);return k(e=>{const o=d.inFallback(),{showContent:a=!0,showFallback:c=!0}=s?s():{};return(!o||i&&"$$f"!==i)&&a?(d.resolved=!0,m&&m(),m=r=i=void 0,u=d.effects,y.push.apply(y,u),u.length=0,l()):c?m?e:b(e=>(m=e,r&&(n({id:r.id+"F",count:0}),r=void 0),t.fallback),p):void 0;var u})})}})}const be=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline","adAuctionHeaders","allowFullscreen","browsingTopics","defaultChecked","defaultMuted","defaultSelected","disablePictureInPicture","disableRemotePlayback","preservesPitch","shadowRootClonable","shadowRootCustomElementRegistry","shadowRootDelegatesFocus","shadowRootSerializable","sharedStorageWritable","allowfullscreen","async","alpha","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected","adauctionheaders","browsingtopics","credentialless","defaultchecked","defaultmuted","defaultselected","defer","disablepictureinpicture","disableremoteplayback","preservespitch","shadowrootclonable","shadowrootcustomelementregistry","shadowrootdelegatesfocus","shadowrootserializable","sharedstoragewritable"]),we=new Set(["innerHTML","textContent","innerText","children"]),xe=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),Se=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1},adauctionheaders:{$:"adAuctionHeaders",IFRAME:1},allowfullscreen:{$:"allowFullscreen",IFRAME:1},browsingtopics:{$:"browsingTopics",IMG:1},defaultchecked:{$:"defaultChecked",INPUT:1},defaultmuted:{$:"defaultMuted",AUDIO:1,VIDEO:1},defaultselected:{$:"defaultSelected",OPTION:1},disablepictureinpicture:{$:"disablePictureInPicture",VIDEO:1},disableremoteplayback:{$:"disableRemotePlayback",AUDIO:1,VIDEO:1},preservespitch:{$:"preservesPitch",AUDIO:1,VIDEO:1},shadowrootclonable:{$:"shadowRootClonable",TEMPLATE:1},shadowrootdelegatesfocus:{$:"shadowRootDelegatesFocus",TEMPLATE:1},shadowrootserializable:{$:"shadowRootSerializable",TEMPLATE:1},sharedstoragewritable:{$:"sharedStorageWritable",IFRAME:1,IMG:1}});const Ce=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),ke=new Set(["altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","set","stop","svg","switch","symbol","text","textPath","tref","tspan","use","view","vkern"]),Oe={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},Me=e=>k(()=>e());const _e="_$DX_DELEGATE";function Pe(e,t,n,s){let r;const i=()=>(r||(r=(()=>{const t=document.createElement("template");return t.innerHTML=e,t.content.firstChild})())).cloneNode(!0);return i.cloneNode=i,i}function Ie(e,t=window.document){const n=t[_e]||(t[_e]=new Set);for(let s=0,r=e.length;s<r;s++){const r=e[s];n.has(r)||(n.add(r),t.addEventListener(r,Be))}}function Ae(e,t,n){Fe(e)||(null==n?e.removeAttribute(t):e.setAttribute(t,n))}function Re(e,t){Fe(e)||(null==t?e.removeAttribute("class"):e.className=t)}function Ee(e,t,n,s){if(s)Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n;else if(Array.isArray(n)){const s=n[0];e.addEventListener(t,n[0]=t=>s.call(e,n[1],t))}else e.addEventListener(t,n,"function"!=typeof n&&n)}function Te(e,t,n){null!=n?e.style.setProperty(t,n):e.style.removeProperty(t)}function je(e,t={},n,s){const r={};return S(()=>r.children=Ne(e,t.children,r.children)),S(()=>"function"==typeof t.ref&&Le(t.ref,e)),S(()=>function(e,t,n,s,r={},i=!1){t||(t={});for(const o in r)if(!(o in t)){if("children"===o)continue;r[o]=Ve(e,o,null,r[o],n,i,t)}for(const o in t){if("children"===o)continue;const s=t[o];r[o]=Ve(e,o,s,r[o],n,i,t)}}(e,t,n,0,r,!0)),r}function Le(e,t,n){return _(()=>e(t,n))}function De(e,t,n,s){if(void 0===n||s||(s=[]),"function"!=typeof t)return Ne(e,t,s,n);S(s=>Ne(e,t(),s,n),s)}function $e(t){let n,s;return Fe()&&(n=e.registry.get(s=e.getNextContextId()))?(e.completed&&e.completed.add(n),e.registry.delete(s),n):t()}function Fe(t){return!!e.context&&!e.done&&(!t||t.isConnected)}function qe(e,t,n){const s=t.trim().split(/\s+/);for(let r=0,i=s.length;r<i;r++)e.classList.toggle(s[r],n)}function Ve(e,t,n,s,r,i,o){let a,l,c,u,h;if("style"===t)return function(e,t,n){if(!t)return n?Ae(e,"style"):t;const s=e.style;if("string"==typeof t)return s.cssText=t;let r,i;for(i in"string"==typeof n&&(s.cssText=n=void 0),n||(n={}),t||(t={}),n)null==t[i]&&s.removeProperty(i),delete n[i];for(i in t)r=t[i],r!==n[i]&&(s.setProperty(i,r),n[i]=r);return n}(e,n,s);if("classList"===t)return function(e,t,n={}){const s=Object.keys(t||{}),r=Object.keys(n);let i,o;for(i=0,o=r.length;i<o;i++){const s=r[i];s&&"undefined"!==s&&!t[s]&&(qe(e,s,!1),delete n[s])}for(i=0,o=s.length;i<o;i++){const r=s[i],o=!!t[r];r&&"undefined"!==r&&n[r]!==o&&o&&(qe(e,r,!0),n[r]=o)}return n}(e,n,s);if(n===s)return s;if("ref"===t)i||n(e);else if("on:"===t.slice(0,3)){const r=t.slice(3);s&&e.removeEventListener(r,s,"function"!=typeof s&&s),n&&e.addEventListener(r,n,"function"!=typeof n&&n)}else if("oncapture:"===t.slice(0,10)){const r=t.slice(10);s&&e.removeEventListener(r,s,!0),n&&e.addEventListener(r,n,!0)}else if("on"===t.slice(0,2)){const r=t.slice(2).toLowerCase(),i=Ce.has(r);if(!i&&s){const t=Array.isArray(s)?s[0]:s;e.removeEventListener(r,t)}(i||n)&&(Ee(e,r,n,i),i&&Ie([r]))}else if("attr:"===t.slice(0,5))Ae(e,t.slice(5),n);else if("bool:"===t.slice(0,5))!function(e,t,n){Fe(e)||(n?e.setAttribute(t,""):e.removeAttribute(t))}(e,t.slice(5),n);else if((h="prop:"===t.slice(0,5))||(c=we.has(t))||!r&&((u=function(e,t){const n=Se[e];return"object"==typeof n?n[t]?n.$:void 0:n}(t,e.tagName))||(l=be.has(t)))||(a=e.nodeName.includes("-")||"is"in o)){if(h)t=t.slice(5),l=!0;else if(Fe(e))return n;"class"===t||"className"===t?Re(e,n):!a||l||c?e[u||t]=n:e[(d=t,d.toLowerCase().replace(/-([a-z])/g,(e,t)=>t.toUpperCase()))]=n}else{const s=r&&t.indexOf(":")>-1&&Oe[t.split(":")[0]];s?function(e,t,n,s){Fe(e)||(null==s?e.removeAttributeNS(t,n):e.setAttributeNS(t,n,s))}(e,s,t,n):Ae(e,xe[t]||t,n)}var d;return n}function Be(t){if(e.registry&&e.events&&e.events.find(([e,n])=>n===t))return;let n=t.target;const s=`$$${t.type}`,r=t.target,i=t.currentTarget,o=e=>Object.defineProperty(t,"target",{configurable:!0,value:e}),a=()=>{const e=n[s];if(e&&!n.disabled){const r=n[`${s}Data`];if(void 0!==r?e.call(n,r,t):e.call(n,t),t.cancelBubble)return}return n.host&&"string"!=typeof n.host&&!n.host._$host&&n.contains(t.target)&&o(n.host),!0},l=()=>{for(;a()&&(n=n._$host||n.parentNode||n.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get:()=>n||document}),e.registry&&!e.done&&(e.done=_$HY.done=!0),t.composedPath){const e=t.composedPath();o(e[0]);for(let t=0;t<e.length-2&&(n=e[t],a());t++){if(n._$host){n=n._$host,l();break}if(n.parentNode===i)break}}else l();o(r)}function Ne(e,t,n,s,r){const i=Fe(e);if(i){!n&&(n=[...e.childNodes]);let t=[];for(let e=0;e<n.length;e++){const s=n[e];8===s.nodeType&&"!$"===s.data.slice(0,2)?s.remove():t.push(s)}n=t}for(;"function"==typeof n;)n=n();if(t===n)return n;const o=typeof t,a=void 0!==s;if(e=a&&n[0]&&n[0].parentNode||e,"string"===o||"number"===o){if(i)return n;if("number"===o&&(t=t.toString())===n)return n;if(a){let r=n[0];r&&3===r.nodeType?r.data!==t&&(r.data=t):r=document.createTextNode(t),n=ze(e,n,s,r)}else n=""!==n&&"string"==typeof n?e.firstChild.data=t:e.textContent=t}else if(null==t||"boolean"===o){if(i)return n;n=ze(e,n,s)}else{if("function"===o)return S(()=>{let r=t();for(;"function"==typeof r;)r=r();n=Ne(e,r,n,s)}),()=>n;if(Array.isArray(t)){const o=[],l=n&&Array.isArray(n);if(Ue(o,t,n,r))return S(()=>n=Ne(e,o,n,s,!0)),()=>n;if(i){if(!o.length)return n;if(void 0===s)return n=[...e.childNodes];let t=o[0];if(t.parentNode!==e)return n;const r=[t];for(;(t=t.nextSibling)!==s;)r.push(t);return n=r}if(0===o.length){if(n=ze(e,n,s),a)return n}else l?0===n.length?Ke(e,o,s):function(e,t,n){let s=n.length,r=t.length,i=s,o=0,a=0,l=t[r-1].nextSibling,c=null;for(;o<r||a<i;)if(t[o]!==n[a]){for(;t[r-1]===n[i-1];)r--,i--;if(r===o){const t=i<s?a?n[a-1].nextSibling:n[i-a]:l;for(;a<i;)e.insertBefore(n[a++],t)}else if(i===a)for(;o<r;)c&&c.has(t[o])||t[o].remove(),o++;else if(t[o]===n[i-1]&&n[a]===t[r-1]){const s=t[--r].nextSibling;e.insertBefore(n[a++],t[o++].nextSibling),e.insertBefore(n[--i],s),t[r]=n[i]}else{if(!c){c=new Map;let e=a;for(;e<i;)c.set(n[e],e++)}const s=c.get(t[o]);if(null!=s)if(a<s&&s<i){let l,u=o,h=1;for(;++u<r&&u<i&&null!=(l=c.get(t[u]))&&l===s+h;)h++;if(h>s-a){const r=t[o];for(;a<s;)e.insertBefore(n[a++],r)}else e.replaceChild(n[a++],t[o++])}else o++;else t[o++].remove()}}else o++,a++}(e,n,o):(n&&ze(e),Ke(e,o));n=o}else if(t.nodeType){if(i&&t.parentNode)return n=a?[t]:t;if(Array.isArray(n)){if(a)return n=ze(e,n,s,t);ze(e,n,null,t)}else null!=n&&""!==n&&e.firstChild?e.replaceChild(t,e.firstChild):e.appendChild(t);n=t}}return n}function Ue(e,t,n,s){let r=!1;for(let i=0,o=t.length;i<o;i++){let o,a=t[i],l=n&&n[e.length];if(null==a||!0===a||!1===a);else if("object"==(o=typeof a)&&a.nodeType)e.push(a);else if(Array.isArray(a))r=Ue(e,a,l)||r;else if("function"===o)if(s){for(;"function"==typeof a;)a=a();r=Ue(e,Array.isArray(a)?a:[a],Array.isArray(l)?l:[l])||r}else e.push(a),r=!0;else{const t=String(a);l&&3===l.nodeType&&l.data===t?e.push(l):e.push(document.createTextNode(t))}}return r}function Ke(e,t,n=null){for(let s=0,r=t.length;s<r;s++)e.insertBefore(t[s],n)}function ze(e,t,n,s){if(void 0===n)return e.textContent="";const r=s||document.createTextNode("");if(t.length){let s=!1;for(let i=t.length-1;i>=0;i--){const o=t[i];if(r!==o){const t=o.parentNode===e;s||i?t&&o.remove():t?e.replaceChild(r,o):e.insertBefore(r,n)}else s=!0}}else e.insertBefore(r,n);return[r]}function We(t,n){const s=k(t);return k(()=>{const t=s();switch(typeof t){case"function":return _(()=>t(n));case"string":const s=ke.has(t),r=e.context?$e():function(e,t=!1,n){return t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e,{is:n})}(t,s,n.is);return je(r,n,s),r}})}function Qe(e){const[,t]=le(e,["component"]);return We(()=>e.component,t)}function He(e,t){if(!e)throw new Error("Invariant failed")}const Ge=new WeakMap,Je=new WeakMap,Ye={current:[]};let Ze=!1,Xe=0;const et=new Set,tt=new Map;function nt(e){const t=Array.from(e).sort((e,t)=>e instanceof lt&&e.options.deps.includes(t)?1:t instanceof lt&&t.options.deps.includes(e)?-1:0);for(const n of t){if(Ye.current.includes(n))continue;Ye.current.push(n),n.recompute();const e=Je.get(n);if(e)for(const t of e){const e=Ge.get(t);e&&nt(e)}}}function st(e){e.listeners.forEach(t=>t({prevVal:e.prevState,currentVal:e.state}))}function rt(e){e.listeners.forEach(t=>t({prevVal:e.prevState,currentVal:e.state}))}function it(e){if(Xe>0&&!tt.has(e)&&tt.set(e,e.prevState),et.add(e),!(Xe>0||Ze))try{for(Ze=!0;et.size>0;){const e=Array.from(et);et.clear();for(const t of e){const e=tt.get(t)??t.prevState;t.prevState=e,st(t)}for(const t of e){const e=Ge.get(t);e&&(Ye.current.push(t),nt(e))}for(const t of e){const e=Ge.get(t);if(e)for(const t of e)rt(t)}}}finally{Ze=!1,Ye.current=[],tt.clear()}}function ot(e){Xe++;try{e()}finally{if(Xe--,0===Xe){const e=Array.from(et)[0];e&&it(e)}}}class at{constructor(e,t){this.listeners=new Set,this.subscribe=e=>{var t,n;this.listeners.add(e);const s=null==(n=null==(t=this.options)?void 0:t.onSubscribe)?void 0:n.call(t,e,this);return()=>{this.listeners.delete(e),null==s||s()}},this.prevState=e,this.state=e,this.options=t}setState(e){var t,n,s;this.prevState=this.state,(null==(t=this.options)?void 0:t.updateFn)?this.state=this.options.updateFn(this.prevState)(e):!function(e){return"function"==typeof e}(e)?this.state=e:this.state=e(this.prevState),null==(s=null==(n=this.options)?void 0:n.onUpdate)||s.call(n),it(this)}}class lt{constructor(e){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{const e=[],t=[];for(const n of this.options.deps)e.push(n.prevState),t.push(n.state);return this.lastSeenDepValues=t,{prevDepVals:e,currDepVals:t,prevVal:this.prevState??void 0}},this.recompute=()=>{var e,t;this.prevState=this.state;const{prevDepVals:n,currDepVals:s,prevVal:r}=this.getDepVals();this.state=this.options.fn({prevDepVals:n,currDepVals:s,prevVal:r}),null==(t=(e=this.options).onUpdate)||t.call(e)},this.checkIfRecalculationNeededDeeply=()=>{for(const s of this.options.deps)s instanceof lt&&s.checkIfRecalculationNeededDeeply();let e=!1;const t=this.lastSeenDepValues,{currDepVals:n}=this.getDepVals();for(let s=0;s<n.length;s++)if(n[s]!==t[s]){e=!0;break}e&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(const e of this._subscriptions)e()}),this.subscribe=e=>{var t,n;this.listeners.add(e);const s=null==(n=(t=this.options).onSubscribe)?void 0:n.call(t,e,this);return()=>{this.listeners.delete(e),null==s||s()}},this.options=e,this.state=e.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(e=this.options.deps){for(const t of e)if(t instanceof lt)t.registerOnGraph(),this.registerOnGraph(t.options.deps);else if(t instanceof at){let e=Ge.get(t);e||(e=new Set,Ge.set(t,e)),e.add(this);let n=Je.get(this);n||(n=new Set,Je.set(this,n)),n.add(t)}}unregisterFromGraph(e=this.options.deps){for(const t of e)if(t instanceof lt)this.unregisterFromGraph(t.options.deps);else if(t instanceof at){const e=Ge.get(t);e&&e.delete(this);const n=Je.get(this);n&&n.delete(t)}}}const ct="__TSR_index",ut="popstate",ht="beforeunload";function dt(e){let t=e.getLocation();const n=new Set,s=s=>{t=e.getLocation(),n.forEach(e=>e({location:t,action:s}))},r=n=>{e.notifyOnIndexChange??1?s(n):t=e.getLocation()},i=async({task:n,navigateOpts:s,...r})=>{var i,o;if((null==s?void 0:s.ignoreBlocker)??!1)return void n();const a=(null==(i=e.getBlockers)?void 0:i.call(e))??[],l="PUSH"===r.type||"REPLACE"===r.type;if("undefined"!=typeof document&&a.length&&l)for(const c of a){const n=pt(r.path,r.state);if(await c.blockerFn({currentLocation:t,nextLocation:n,action:r.type}))return void(null==(o=e.onBlocked)||o.call(e))}n()};return{get location(){return t},get length(){return e.getLength()},subscribers:n,subscribe:e=>(n.add(e),()=>{n.delete(e)}),push:(n,r,o)=>{const a=t.state[ct];r=ft(a+1,r),i({task:()=>{e.pushState(n,r),s({type:"PUSH"})},navigateOpts:o,type:"PUSH",path:n,state:r})},replace:(n,r,o)=>{const a=t.state[ct];r=ft(a,r),i({task:()=>{e.replaceState(n,r),s({type:"REPLACE"})},navigateOpts:o,type:"REPLACE",path:n,state:r})},go:(t,n)=>{i({task:()=>{e.go(t),r({type:"GO",index:t})},navigateOpts:n,type:"GO"})},back:t=>{i({task:()=>{e.back((null==t?void 0:t.ignoreBlocker)??!1),r({type:"BACK"})},navigateOpts:t,type:"BACK"})},forward:t=>{i({task:()=>{e.forward((null==t?void 0:t.ignoreBlocker)??!1),r({type:"FORWARD"})},navigateOpts:t,type:"FORWARD"})},canGoBack:()=>0!==t.state[ct],createHref:t=>e.createHref(t),block:t=>{var n;if(!e.setBlockers)return()=>{};const s=(null==(n=e.getBlockers)?void 0:n.call(e))??[];return e.setBlockers([...s,t]),()=>{var n,s;const r=(null==(n=e.getBlockers)?void 0:n.call(e))??[];null==(s=e.setBlockers)||s.call(e,r.filter(e=>e!==t))}},flush:()=>{var t;return null==(t=e.flush)?void 0:t.call(e)},destroy:()=>{var t;return null==(t=e.destroy)?void 0:t.call(e)},notify:s}}function ft(e,t){t||(t={});const n=gt();return{...t,key:n,__TSR_key:n,[ct]:e}}function pt(e,t){const n=e.indexOf("#"),s=e.indexOf("?"),r=gt();return{href:e,pathname:e.substring(0,n>0?s>0?Math.min(n,s):n:s>0?s:e.length),hash:n>-1?e.substring(n):"",search:s>-1?e.slice(s,-1===n?void 0:n):"",state:t||{[ct]:0,key:r,__TSR_key:r}}}function gt(){return(Math.random()+1).toString(36).substring(7)}function mt(e){return e[e.length-1]}function yt(e,t){return"function"==typeof e?e(t):e}function vt(e,t){return t.reduce((t,n)=>(t[n]=e[n],t),{})}function bt(e,t){if(e===t)return e;const n=t,s=Ct(e)&&Ct(n);if(s||wt(e)&&wt(n)){const t=s?e:Object.keys(e).concat(Object.getOwnPropertySymbols(e)),r=t.length,i=s?n:Object.keys(n).concat(Object.getOwnPropertySymbols(n)),o=i.length,a=s?[]:{};let l=0;for(let c=0;c<o;c++){const r=s?c:i[c];(!s&&t.includes(r)||s)&&void 0===e[r]&&void 0===n[r]?(a[r]=void 0,l++):(a[r]=bt(e[r],n[r]),a[r]===e[r]&&void 0!==e[r]&&l++)}return r===o&&l===r?e:a}return n}function wt(e){return xt(e)&&Object.getOwnPropertyNames(e).length===Object.keys(e).length}function xt(e){if(!St(e))return!1;const t=e.constructor;if(void 0===t)return!0;const n=t.prototype;return!!St(n)&&!!n.hasOwnProperty("isPrototypeOf")}function St(e){return"[object Object]"===Object.prototype.toString.call(e)}function Ct(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function kt(e,t){let n=Object.keys(e);return t&&(n=n.filter(t=>void 0!==e[t])),n}function Ot(e,t,n){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(xt(e)&&xt(t)){const s=(null==n?void 0:n.ignoreUndefined)??!0,r=kt(e,s),i=kt(t,s);return!(!(null==n?void 0:n.partial)&&r.length!==i.length)&&i.every(s=>Ot(e[s],t[s],n))}return!(!Array.isArray(e)||!Array.isArray(t))&&(e.length===t.length&&!e.some((e,s)=>!Ot(e,t[s],n)))}function Mt(e){let t,n;const s=new Promise((e,s)=>{t=e,n=s});return s.status="pending",s.resolve=n=>{s.status="resolved",s.value=n,t(n),null==e||e(n)},s.reject=e=>{s.status="rejected",n(e)},s}function _t(e){return Pt(e.filter(e=>void 0!==e).join("/"))}function Pt(e){return e.replace(/\/{2,}/g,"/")}function It(e){return"/"===e?e:e.replace(/^\/{1,}/,"")}function At(e){return"/"===e?e:e.replace(/\/{1,}$/,"")}function Rt(e){return At(It(e))}function Et(e,t){return(null==e?void 0:e.endsWith("/"))&&"/"!==e&&e!==`${t}/`?e.slice(0,-1):e}function Tt(e){const{type:t,value:n}=e;if(0===t)return n;const{prefixSegment:s,suffixSegment:r}=e;if(1===t){const e=n.substring(1);if(s&&r)return`${s}{$${e}}${r}`;if(s)return`${s}{$${e}}`;if(r)return`{$${e}}${r}`}if(3===t){const e=n.substring(1);return s&&r?`${s}{-$${e}}${r}`:s?`${s}{-$${e}}`:r?`{-$${e}}${r}`:`{-$${e}}`}if(2===t){if(s&&r)return`${s}{$}${r}`;if(s)return`${s}{$}`;if(r)return`{$}${r}`}return n}const jt=(e,t)=>{if(!e)return[];const n=null==t?void 0:t.get(e);if(n)return n;const s=function(e){e=Pt(e);const t=[];"/"===e.slice(0,1)&&(e=e.substring(1),t.push({type:0,value:"/"}));if(!e)return t;const n=e.split("/").filter(Boolean);t.push(...n.map(e=>{const t=e.match(qt);if(t){return{type:2,value:"$",prefixSegment:t[1]||void 0,suffixSegment:t[2]||void 0}}const n=e.match($t);if(n){const e=n[1];return{type:3,value:n[2],prefixSegment:e||void 0,suffixSegment:n[3]||void 0}}const s=e.match(Dt);if(s){const e=s[1];return{type:1,value:""+s[2],prefixSegment:e||void 0,suffixSegment:s[3]||void 0}}if(Lt.test(e)){return{type:1,value:"$"+e.substring(1),prefixSegment:void 0,suffixSegment:void 0}}return Ft.test(e)?{type:2,value:"$",prefixSegment:void 0,suffixSegment:void 0}:{type:0,value:e.includes("%25")?e.split("%25").map(e=>decodeURI(e)).join("%25"):decodeURI(e)}})),"/"===e.slice(-1)&&(e=e.substring(1),t.push({type:0,value:"/"}));return t}(e);return null==t||t.set(e,s),s},Lt=/^\$.{1,}$/,Dt=/^(.*?)\{(\$[a-zA-Z_$][a-zA-Z0-9_$]*)\}(.*)$/,$t=/^(.*?)\{-(\$[a-zA-Z_$][a-zA-Z0-9_$]*)\}(.*)$/,Ft=/^\$$/,qt=/^(.*?)\{\$\}(.*)$/;function Vt({path:e,params:t,leaveWildcards:n,leaveParams:s,decodeCharMap:r,parseCache:i}){const o=jt(e,i);function a(e){const n=t[e],s="string"==typeof n;return"*"===e||"_splat"===e?s?encodeURI(n):n:s?function(e,t){let n=encodeURIComponent(e);if(t)for(const[s,r]of t)n=n.replaceAll(s,r);return n}(n,r):n}let l=!1;const c={},u=_t(o.map(e=>{if(0===e.type)return e.value;if(2===e.type){c._splat=t._splat;const s=e.prefixSegment||"",r=e.suffixSegment||"";if(!("_splat"in t))return l=!0,n?`${s}${e.value}${r}`:s||r?`${s}${r}`:void 0;const i=a("_splat");return n?`${s}${e.value}${i??""}${r}`:`${s}${i}${r}`}if(1===e.type){const n=e.value.substring(1);l||n in t||(l=!0),c[n]=t[n];const r=e.prefixSegment||"",i=e.suffixSegment||"";if(s){const t=a(e.value);return`${r}${e.value}${t??""}${i}`}return`${r}${a(n)??"undefined"}${i}`}if(3===e.type){const r=e.value.substring(1),i=e.prefixSegment||"",o=e.suffixSegment||"";if(!(r in t)||null==t[r])return n?`${i}${r}${o}`:i||o?`${i}${o}`:void 0;if(c[r]=t[r],s){const t=a(e.value);return`${i}${e.value}${t??""}${o}`}return n?`${i}${r}${a(r)??""}${o}`:`${i}${a(r)??""}${o}`}return e.value}));return{usedParams:c,interpolatedPath:u,isMissingParams:l}}function Bt(e,t,n,s){const r=function(e,t,{to:n,fuzzy:s,caseSensitive:r},i){if("/"!==e&&!t.startsWith(e))return;t=Nt(e,t,r),n=Nt(e,`${n??"$"}`,r);const o=jt(t.startsWith("/")?t:`/${t}`,i),a=jt(n.startsWith("/")?n:`/${n}`,i),l={};return function(e,t,n,s,r){var i,o,a;let l=0,c=0;for(;l<e.length||c<t.length;){const u=e[l],h=t[c];if(h){if(2===h.type){const t=e.slice(l);let s;if(h.prefixSegment||h.suffixSegment){if(!u)return!1;const n=h.prefixSegment||"",r=h.suffixSegment||"",o=u.value;if("prefixSegment"in h&&!o.startsWith(n))return!1;if("suffixSegment"in h&&!(null==(i=e[e.length-1])?void 0:i.value.endsWith(r)))return!1;let a=decodeURI(_t(t.map(e=>e.value)));n&&a.startsWith(n)&&(a=a.slice(n.length)),r&&a.endsWith(r)&&(a=a.slice(0,a.length-r.length)),s=a}else s=decodeURI(_t(t.map(e=>e.value)));return n["*"]=s,n._splat=s,!0}if(0===h.type){if("/"===h.value&&!(null==u?void 0:u.value)){c++;continue}if(u){if(r){if(h.value!==u.value)return!1}else if(h.value.toLowerCase()!==u.value.toLowerCase())return!1;l++,c++;continue}return!1}if(1===h.type){if(!u)return!1;if("/"===u.value)return!1;let e="",t=!1;if(h.prefixSegment||h.suffixSegment){const n=h.prefixSegment||"",s=h.suffixSegment||"",r=u.value;if(n&&!r.startsWith(n))return!1;if(s&&!r.endsWith(s))return!1;let i=r;n&&i.startsWith(n)&&(i=i.slice(n.length)),s&&i.endsWith(s)&&(i=i.slice(0,i.length-s.length)),e=decodeURIComponent(i),t=!0}else e=decodeURIComponent(u.value),t=!0;t&&(n[h.value.substring(1)]=e,l++),c++;continue}if(3===h.type){if(!u){c++;continue}if("/"===u.value){c++;continue}let s="",r=!1;if(h.prefixSegment||h.suffixSegment){const e=h.prefixSegment||"",t=h.suffixSegment||"",n=u.value;if((!e||n.startsWith(e))&&(!t||n.endsWith(t))){let i=n;e&&i.startsWith(e)&&(i=i.slice(e.length)),t&&i.endsWith(t)&&(i=i.slice(0,i.length-t.length)),s=decodeURIComponent(i),r=!0}}else{let n=!0;for(let s=c+1;s<t.length;s++){const r=t[s];if(0===(null==r?void 0:r.type)&&r.value===u.value){n=!1;break}if(1===(null==r?void 0:r.type)||2===(null==r?void 0:r.type)){e.length<t.length&&(n=!1);break}}n&&(s=decodeURIComponent(u.value),r=!0)}r&&(n[h.value.substring(1)]=s,l++),c++;continue}}if(l<e.length&&c>=t.length)return n["**"]=_t(e.slice(l).map(e=>e.value)),!!s&&"/"!==(null==(o=t[t.length-1])?void 0:o.value);if(c<t.length&&l>=e.length){for(let e=c;e<t.length;e++)if(3!==(null==(a=t[e])?void 0:a.type))return!1;break}break}return!0}(o,a,l,s,r)?l:void 0}(e,t,n,s);if(!n.to||r)return r??{}}function Nt(e,t,n=!1){const s=n?e:e.toLowerCase(),r=n?t:t.toLowerCase();switch(!0){case"/"===s:return t;case r===s:return"";case t.length<e.length:case"/"!==r[s.length]:return t;case r.startsWith(s):return t.slice(e.length);default:return t}}function Ut(e){return!!(null==e?void 0:e.isNotFound)}const Kt="tsr-scroll-restoration-v1_3";const zt=function(){const e=function(){try{if("undefined"!=typeof window&&"object"==typeof window.sessionStorage)return window.sessionStorage}catch{return}}();if(!e)return;const t=e.getItem(Kt);let n=t?JSON.parse(t):{};return{state:n,set:t=>(n=yt(t,n)||n,e.setItem(Kt,JSON.stringify(n)))}}(),Wt=e=>e.state.__TSR_key||e.href;let Qt=!1;function Ht({storageKey:e,key:t,behavior:n,shouldScrollRestoration:s,scrollToTopSelectors:r,location:i}){var o;let a;try{a=JSON.parse(sessionStorage.getItem(e)||"{}")}catch(c){return}const l=a[t||(null==(o=window.history.state)?void 0:o.key)];Qt=!0,(()=>{if(s&&l&&Object.keys(l).length>0){for(const e in l){const t=l[e];if("window"===e)window.scrollTo({top:t.scrollY,left:t.scrollX,behavior:n});else if(e){const n=document.querySelector(e);n&&(n.scrollLeft=t.scrollX,n.scrollTop=t.scrollY)}}return}const e=(i??window.location).hash.split("#")[1];if(e){const t=(window.history.state||{}).__hashScrollIntoViewOptions??!0;if(t){const n=document.getElementById(e);n&&n.scrollIntoView(t)}return}["window",...(null==r?void 0:r.filter(e=>"window"!==e))??[]].forEach(e=>{const t="window"===e?window:"function"==typeof e?e():document.querySelector(e);t&&t.scrollTo({top:0,left:0,behavior:n})})})(),Qt=!1}function Gt(e,t){if(void 0===zt)return;if((e.options.scrollRestoration??!1)&&(e.isScrollRestoring=!0),"undefined"==typeof document||e.isScrollRestorationSetup)return;e.isScrollRestorationSetup=!0,Qt=!1;const n=e.options.getScrollRestorationKey||Wt;window.history.scrollRestoration="manual";const s=t=>{if(Qt||!e.isScrollRestoring)return;let s="";if(t.target===document||t.target===window)s="window";else{const e=t.target.getAttribute("data-scroll-restoration-id");s=e?`[data-scroll-restoration-id="${e}"]`:function(e){const t=[];let n;for(;n=e.parentNode;)t.unshift(`${e.tagName}:nth-child(${[].indexOf.call(n.children,e)+1})`),e=n;return`${t.join(" > ")}`.toLowerCase()}(t.target)}const r=n(e.state.location);zt.set(e=>{const t=e[r]=e[r]||{},n=t[s]=t[s]||{};if("window"===s)n.scrollX=window.scrollX||0,n.scrollY=window.scrollY||0;else if(s){const e=document.querySelector(s);e&&(n.scrollX=e.scrollLeft||0,n.scrollY=e.scrollTop||0)}return e})};"undefined"!=typeof document&&document.addEventListener("scroll",((e,t)=>{let n;return(...s)=>{n||(n=setTimeout(()=>{e(...s),n=null},t))}})(s,100),!0),e.subscribe("onRendered",t=>{const s=n(t.toLocation);e.resetNextScroll?(Ht({storageKey:Kt,key:s,behavior:e.options.scrollRestorationBehavior,shouldScrollRestoration:e.isScrollRestoring,scrollToTopSelectors:e.options.scrollToTopSelectors,location:e.history.location}),e.isScrollRestoring&&zt.set(e=>(e[s]=e[s]||{},e))):e.resetNextScroll=!0})}function Jt(e){return e?"false"!==e&&("true"===e||(0*+e==0&&+e+""===e?+e:e)):""}const Yt=(Zt=JSON.parse,e=>{"?"===e.substring(0,1)&&(e=e.substring(1));const t=[...new URLSearchParams(e).entries()].reduce((e,[t,n])=>{const s=e[t];return e[t]=null==s?Jt(n):Array.isArray(s)?[...s,Jt(n)]:[s,Jt(n)],e},{});for(const s in t){const e=t[s];if("string"==typeof e)try{t[s]=Zt(e)}catch(n){}}return t});var Zt;const Xt=function(e,t){return n=>{n={...n},Object.keys(n).forEach(s=>{const r=n[s];void 0===r||void 0===r?delete n[s]:n[s]=function(n){if("object"==typeof n&&null!==n)try{return e(n)}catch(s){}else if("string"==typeof n&&"function"==typeof t)try{return t(n),e(n)}catch(s){}return n}(r)});const s=function(e){const t=Object.entries(e).flatMap(([e,t])=>Array.isArray(t)?t.map(t=>[e,String(t)]):[[e,String(t)]]);return""+new URLSearchParams(t).toString()}(n).toString();return s?`?${s}`:""}}(JSON.stringify,JSON.parse);const en="__root__";function tn(e){if(e.statusCode=e.statusCode||e.code||307,!e.reloadDocument)try{new URL(`${e.href}`),e.reloadDocument=!0}catch{}const t=new Headers(e.headers||{});e.href&&null===t.get("Location")&&t.set("Location",e.href);const n=new Response(null,{status:e.statusCode,headers:t});if(n.options=e,e.throw)throw n;return n}function nn(e){return e instanceof Response&&!!e.options}function sn(e){const t=e.resolvedLocation,n=e.location;return{fromLocation:t,toLocation:n,pathChanged:(null==t?void 0:t.pathname)!==n.pathname,hrefChanged:(null==t?void 0:t.href)!==n.href,hashChanged:(null==t?void 0:t.hash)!==n.hash}}class rn{constructor(e){this.tempLocationKey=`${Math.round(1e7*Math.random())}`,this.resetNextScroll=!0,this.shouldViewTransition=void 0,this.isViewTransitionTypesSupported=void 0,this.subscribers=new Set,this.isScrollRestoring=!1,this.isScrollRestorationSetup=!1,this.startTransition=e=>e(),this.update=e=>{var t;e.notFoundRoute;const n=this.options;this.options={...this.options,...e},this.isServer=this.options.isServer??"undefined"==typeof document,this.pathParamsDecodeCharMap=this.options.pathParamsAllowedCharacters?new Map(this.options.pathParamsAllowedCharacters.map(e=>[encodeURIComponent(e),e])):void 0,(!this.basepath||e.basepath&&e.basepath!==n.basepath)&&(void 0===e.basepath||""===e.basepath||"/"===e.basepath?this.basepath="/":this.basepath=`/${Rt(e.basepath)}`),(!this.history||this.options.history&&this.options.history!==this.history)&&(this.history=this.options.history??(this.isServer?function(e={initialEntries:["/"]}){const t=e.initialEntries;let n=e.initialIndex?Math.min(Math.max(e.initialIndex,0),t.length-1):t.length-1;const s=t.map((e,t)=>ft(t,void 0));return dt({getLocation:()=>pt(t[n],s[n]),getLength:()=>t.length,pushState:(e,r)=>{n<t.length-1&&(t.splice(n+1),s.splice(n+1)),s.push(r),t.push(e),n=Math.max(t.length-1,0)},replaceState:(e,r)=>{s[n]=r,t[n]=e},back:()=>{n=Math.max(n-1,0)},forward:()=>{n=Math.min(n+1,t.length-1)},go:e=>{n=Math.min(Math.max(n+e,0),t.length-1)},createHref:e=>e})}({initialEntries:[this.basepath||"/"]}):function(){var e,t;const n="undefined"!=typeof document?window:void 0,s=n.history.pushState,r=n.history.replaceState;let i=[];const o=()=>i,a=()=>pt(`${n.location.pathname}${n.location.search}${n.location.hash}`,n.history.state);if(!(null==(e=n.history.state)?void 0:e.__TSR_key)&&!(null==(t=n.history.state)?void 0:t.key)){const e=gt();n.history.replaceState({[ct]:0,key:e,__TSR_key:e},"")}let l,c,u,h=a(),d=!1,f=!1,p=!1,g=!1;const m=()=>{c&&(x._ignoreSubscribers=!0,(c.isPush?n.history.pushState:n.history.replaceState)(c.state,"",c.href),x._ignoreSubscribers=!1,c=void 0,u=void 0,l=void 0)},y=(e,t,n)=>{const s=t;u||(l=h),h=pt(t,n),c={href:s,state:n,isPush:(null==c?void 0:c.isPush)||"push"===e},u||(u=Promise.resolve().then(()=>m()))},v=e=>{h=a(),x.notify({type:e})},b=async()=>{if(f)return void(f=!1);const e=a(),t=e.state[ct]-h.state[ct],s=-1===t,r=!(1===t)&&!s||d;d=!1;const i=r?"GO":s?"BACK":"FORWARD",l=r?{type:"GO",index:t}:{type:s?"BACK":"FORWARD"};if(p)p=!1;else{const t=o();if("undefined"!=typeof document&&t.length)for(const s of t)if(await s.blockerFn({currentLocation:h,nextLocation:e,action:i}))return f=!0,n.history.go(1),void x.notify(l)}h=a(),x.notify(l)},w=e=>{if(g)return void(g=!1);let t=!1;const n=o();if("undefined"!=typeof document&&n.length)for(const s of n){const e=s.enableBeforeUnload??!0;if(!0===e){t=!0;break}if("function"==typeof e&&!0===e()){t=!0;break}}return t?(e.preventDefault(),e.returnValue=""):void 0},x=dt({getLocation:()=>h,getLength:()=>n.history.length,pushState:(e,t)=>y("push",e,t),replaceState:(e,t)=>y("replace",e,t),back:e=>(e&&(p=!0),g=!0,n.history.back()),forward:e=>{e&&(p=!0),g=!0,n.history.forward()},go:e=>{d=!0,n.history.go(e)},createHref:e=>e,flush:m,destroy:()=>{n.history.pushState=s,n.history.replaceState=r,n.removeEventListener(ht,w,{capture:!0}),n.removeEventListener(ut,b)},onBlocked:()=>{l&&h!==l&&(h=l)},getBlockers:o,setBlockers:e=>i=e,notifyOnIndexChange:!1});return n.addEventListener(ht,w,{capture:!0}),n.addEventListener(ut,b),n.history.pushState=function(...e){const t=s.apply(n.history,e);return x._ignoreSubscribers||v("PUSH"),t},n.history.replaceState=function(...e){const t=r.apply(n.history,e);return x._ignoreSubscribers||v("REPLACE"),t},x}()),this.updateLatestLocation()),this.options.routeTree!==this.routeTree&&(this.routeTree=this.options.routeTree,this.buildRouteTree()),this.__store||(this.__store=new at({loadedAt:0,isLoading:!1,isTransitioning:!1,status:"idle",resolvedLocation:void 0,location:this.latestLocation,matches:[],pendingMatches:[],cachedMatches:[],statusCode:200},{onUpdate:()=>{this.__store.state={...this.state,cachedMatches:this.state.cachedMatches.filter(e=>!["redirected"].includes(e.status))}}}),Gt(this)),"undefined"!=typeof window&&"CSS"in window&&"function"==typeof(null==(t=window.CSS)?void 0:t.supports)&&(this.isViewTransitionTypesSupported=window.CSS.supports("selector(:active-view-transition-type(a)"))},this.updateLatestLocation=()=>{this.latestLocation=this.parseLocation(this.history.location,this.latestLocation)},this.buildRouteTree=()=>{const{routesById:e,routesByPath:t,flatRoutes:n}=function({routeTree:e,initRoute:t}){const n={},s={},r=e=>{e.forEach((e,i)=>{null==t||t(e,i);if(He(!n[e.id],String(e.id)),n[e.id]=e,!e.isRoot&&e.path){const t=At(e.fullPath);s[t]&&!e.fullPath.endsWith("/")||(s[t]=e)}const o=e.children;(null==o?void 0:o.length)&&r(o)})};r([e]);const i=[],o=Object.values(n);o.forEach((e,t)=>{var n;if(e.isRoot||!e.path)return;const s=It(e.fullPath);let r=jt(s),o=0;for(;r.length>o+1&&"/"===(null==(n=r[o])?void 0:n.value);)o++;o>0&&(r=r.slice(o));let a=0,l=!1;const c=r.map((e,t)=>{if("/"===e.value)return.75;let n;if(1===e.type?n=fn:3===e.type?(n=pn,a++):2===e.type&&(n=gn),n){for(let s=t+1;s<r.length;s++){const t=r[s];if(0===t.type&&"/"!==t.value)return l=!0,xn(e,n+.2)}return xn(e,n)}return 1});i.push({child:e,trimmed:s,parsed:r,index:t,scores:c,optionalParamCount:a,hasStaticAfter:l})});const a=i.sort((e,t)=>{const n=Math.min(e.scores.length,t.scores.length);for(let s=0;s<n;s++)if(e.scores[s]!==t.scores[s])return t.scores[s]-e.scores[s];if(e.scores.length!==t.scores.length){if(e.optionalParamCount!==t.optionalParamCount){if(e.hasStaticAfter===t.hasStaticAfter)return e.optionalParamCount-t.optionalParamCount;if(e.hasStaticAfter&&!t.hasStaticAfter)return-1;if(!e.hasStaticAfter&&t.hasStaticAfter)return 1}return t.scores.length-e.scores.length}for(let s=0;s<n;s++)if(e.parsed[s].value!==t.parsed[s].value)return e.parsed[s].value>t.parsed[s].value?1:-1;return e.index-t.index}).map((e,t)=>(e.child.rank=t,e.child));return{routesById:n,routesByPath:s,flatRoutes:a}}({routeTree:this.routeTree,initRoute:(e,t)=>{e.init({originalIndex:t})}});this.routesById=e,this.routesByPath=t,this.flatRoutes=n;const s=this.options.notFoundRoute;s&&(s.init({originalIndex:99999999999}),this.routesById[s.id]=s)},this.subscribe=(e,t)=>{const n={eventType:e,fn:t};return this.subscribers.add(n),()=>{this.subscribers.delete(n)}},this.emit=e=>{this.subscribers.forEach(t=>{t.eventType===e.type&&t.fn(e)})},this.parseLocation=(e,t)=>{const n=({pathname:e,search:n,hash:s,state:r})=>{const i=this.options.parseSearch(n),o=this.options.stringifySearch(i);return{pathname:e,searchStr:o,search:bt(null==t?void 0:t.search,i),hash:s.split("#").reverse()[0]??"",href:`${e}${o}${s}`,state:bt(null==t?void 0:t.state,r)}},s=n(e),{__tempLocation:r,__tempKey:i}=s.state;if(r&&(!i||i===this.tempLocationKey)){const e=n(r);return e.state.key=s.state.key,e.state.__TSR_key=s.state.__TSR_key,delete e.state.__tempLocation,{...e,maskedLocation:s}}return s},this.resolvePathWithBase=(e,t)=>function({basepath:e,base:t,to:n,trailingSlash:s="never",caseSensitive:r,parseCache:i}){var o;t=Nt(e,t,r),n=Nt(e,n,r);let a=jt(t,i).slice();const l=jt(n,i);a.length>1&&"/"===(null==(o=mt(a))?void 0:o.value)&&a.pop();for(let c=0,u=l.length;c<u;c++){const e=l[c],t=e.value;"/"===t?c?c===u-1&&a.push(e):a=[e]:".."===t?a.pop():"."===t||a.push(e)}return a.length>1&&("/"===mt(a).value?"never"===s&&a.pop():"always"===s&&a.push({type:0,value:"/"})),_t([e,...a.map(Tt)])}({basepath:this.basepath,base:e,to:Pt(t),trailingSlash:this.options.trailingSlash,caseSensitive:this.options.caseSensitive,parseCache:this.parsePathnameCache}),this.matchRoutes=(e,t,n)=>"string"==typeof e?this.matchRoutesInternal({pathname:e,search:t},n):this.matchRoutesInternal(e,t),this.parsePathnameCache=function(e){const t=new Map;let n,s;const r=e=>{e.next&&(e.prev?(e.prev.next=e.next,e.next.prev=e.prev,e.next=void 0,s&&(s.next=e,e.prev=s)):(e.next.prev=void 0,n=e.next,e.next=void 0,s&&(e.prev=s,s.next=e)),s=e)};return{get(e){const n=t.get(e);if(n)return r(n),n.value},set(i,o){if(t.size>=e&&n){const e=n;t.delete(e.key),e.next&&(n=e.next,e.next.prev=void 0),e===s&&(s=void 0)}const a=t.get(i);if(a)a.value=o,r(a);else{const e={key:i,value:o,prev:s};s&&(s.next=e),s=e,n||(n=e),t.set(i,e)}}}}(1e3),this.getMatchedRoutes=(e,t)=>function({pathname:e,routePathname:t,basepath:n,caseSensitive:s,routesByPath:r,routesById:i,flatRoutes:o,parseCache:a}){let l={};const c=At(e),u=e=>{var t;return Bt(n,c,{to:e.fullPath,caseSensitive:(null==(t=e.options)?void 0:t.caseSensitive)??s,fuzzy:!0},a)};let h=void 0!==t?r[t]:void 0;if(h)l=u(h);else{let e;for(const t of o){const n=u(t);if(n){if("/"===t.path||!n["**"]){h=t,l=n;break}e||(e={foundRoute:t,routeParams:n})}}!h&&e&&(h=e.foundRoute,l=e.routeParams)}let d=h||i[en];const f=[d];for(;d.parentRoute;)d=d.parentRoute,f.push(d);return f.reverse(),{matchedRoutes:f,routeParams:l,foundRoute:h}}({pathname:e,routePathname:t,basepath:this.basepath,caseSensitive:this.options.caseSensitive,routesByPath:this.routesByPath,routesById:this.routesById,flatRoutes:this.flatRoutes,parseCache:this.parsePathnameCache}),this.cancelMatch=e=>{const t=this.getMatch(e);t&&(t.abortController.abort(),this.updateMatch(e,e=>(clearTimeout(e.pendingTimeout),{...e,pendingTimeout:void 0})))},this.cancelMatches=()=>{var e;null==(e=this.state.pendingMatches)||e.forEach(e=>{this.cancelMatch(e.id)})},this.buildLocation=e=>{const t=(t={})=>{var n;const s=t._fromLocation||this.latestLocation,r=mt(this.matchRoutes(s,{_buildLocation:!0}));let i=r.fullPath;const o=t.to?this.resolvePathWithBase(i,`${t.to}`):this.resolvePathWithBase(i,"."),a=!!t.to&&!cn(t.to.toString(),i)&&!cn(o,i);"path"===t.unsafeRelative?i=s.pathname:a&&t.from&&(i=t.from);const l=r.search,c={...r.params},u=t.to?this.resolvePathWithBase(i,`${t.to}`):this.resolvePathWithBase(i,".");let h=!1===t.params||null===t.params?{}:!0===(t.params??!0)?c:{...c,...yt(t.params,c)};const d=Vt({path:u,params:h??{},parseCache:this.parsePathnameCache}).interpolatedPath,f=this.matchRoutes(d,{},{_buildLocation:!0}).map(e=>this.looseRoutesById[e.routeId]);Object.keys(h).length>0&&f.map(e=>{var t;return(null==(t=e.options.params)?void 0:t.stringify)??e.options.stringifyParams}).filter(Boolean).forEach(e=>{h={...h,...e(h)}});const p=Vt({path:u,params:h??{},leaveWildcards:!1,leaveParams:e.leaveParams,decodeCharMap:this.pathParamsDecodeCharMap,parseCache:this.parsePathnameCache}).interpolatedPath;let g=l;if(e._includeValidateSearch&&(null==(n=this.options.search)?void 0:n.strict)){let e={};f.forEach(t=>{try{t.options.validateSearch&&(e={...e,...un(t.options.validateSearch,{...e,...g})??{}})}catch{}}),g=e}g=function({search:e,dest:t,destRoutes:n,_includeValidateSearch:s}){const r=n.reduce((e,t)=>{var n;const r=[];if("search"in t.options)(null==(n=t.options.search)?void 0:n.middlewares)&&r.push(...t.options.search.middlewares);else if(t.options.preSearchFilters||t.options.postSearchFilters){const e=({search:e,next:n})=>{let s=e;"preSearchFilters"in t.options&&t.options.preSearchFilters&&(s=t.options.preSearchFilters.reduce((e,t)=>t(e),e));const r=n(s);return"postSearchFilters"in t.options&&t.options.postSearchFilters?t.options.postSearchFilters.reduce((e,t)=>t(e),r):r};r.push(e)}if(s&&t.options.validateSearch){const e=({search:e,next:n})=>{const s=n(e);try{return{...s,...un(t.options.validateSearch,s)??{}}}catch{return s}};r.push(e)}return e.concat(r)},[])??[],i=({search:e})=>t.search?!0===t.search?e:yt(t.search,e):{};r.push(i);const o=(e,t)=>{if(e>=r.length)return t;return(0,r[e])({search:t,next:t=>o(e+1,t)})};return o(0,e)}({search:g,dest:t,destRoutes:f,_includeValidateSearch:e._includeValidateSearch}),g=bt(l,g);const m=this.options.stringifySearch(g),y=!0===t.hash?s.hash:t.hash?yt(t.hash,s.hash):void 0,v=y?`#${y}`:"";let b=!0===t.state?s.state:t.state?yt(t.state,s.state):{};return b=bt(s.state,b),{pathname:p,search:g,searchStr:m,state:b,hash:y??"",href:`${p}${m}${v}`,unmaskOnReload:t.unmaskOnReload}},n=(n={},s)=>{var r;const i=t(n);let o=s?t(s):void 0;if(!o){let n={};const a=null==(r=this.options.routeMasks)?void 0:r.find(e=>{const t=Bt(this.basepath,i.pathname,{to:e.from,caseSensitive:!1,fuzzy:!1},this.parsePathnameCache);return!!t&&(n=t,!0)});if(a){const{from:r,...i}=a;s={...vt(e,["from"]),...i,params:n},o=t(s)}}if(o){const e=t(s);i.maskedLocation=e}return i};return e.mask?n(e,{...vt(e,["from"]),...e.mask}):n(e)},this.commitLocation=({viewTransition:e,ignoreBlocker:t,...n})=>{const s=this.latestLocation.href===n.href,r=this.commitLocationPromise;if(this.commitLocationPromise=Mt(()=>{null==r||r.resolve()}),s&&(()=>{const e=["key","__TSR_key","__TSR_index","__hashScrollIntoViewOptions"];e.forEach(e=>{n.state[e]=this.latestLocation.state[e]});const t=Ot(n.state,this.latestLocation.state);return e.forEach(e=>{delete n.state[e]}),t})())this.load();else{let{maskedLocation:s,hashScrollIntoView:r,...i}=n;s&&(i={...s,state:{...s.state,__tempKey:void 0,__tempLocation:{...i,search:i.searchStr,state:{...i.state,__tempKey:void 0,__tempLocation:void 0,__TSR_key:void 0,key:void 0}}}},(i.unmaskOnReload??this.options.unmaskOnReload)&&(i.state.__tempKey=this.tempLocationKey)),i.state.__hashScrollIntoViewOptions=r??this.options.defaultHashScrollIntoView??!0,this.shouldViewTransition=e,this.history[n.replace?"replace":"push"](i.href,i.state,{ignoreBlocker:t})}return this.resetNextScroll=n.resetScroll??!0,this.history.subscribers.size||this.load(),this.commitLocationPromise},this.buildAndCommitLocation=({replace:e,resetScroll:t,hashScrollIntoView:n,viewTransition:s,ignoreBlocker:r,href:i,...o}={})=>{if(i){const t=this.history.location.state.__TSR_index,n=pt(i,{__TSR_index:e?t:t+1});o.to=n.pathname,o.search=this.options.parseSearch(n.search),o.hash=n.hash.slice(1)}const a=this.buildLocation({...o,_includeValidateSearch:!0});return this.commitLocation({...a,viewTransition:s,replace:e,resetScroll:t,hashScrollIntoView:n,ignoreBlocker:r})},this.navigate=({to:e,reloadDocument:t,href:n,...s})=>{if(!t&&n)try{new URL(`${n}`),t=!0}catch{}if(t){if(!n){const t=this.buildLocation({to:e,...s});n=this.history.createHref(t.href)}return s.replace?window.location.replace(n):window.location.href=n,Promise.resolve()}return this.buildAndCommitLocation({...s,href:n,to:e,_isNavigate:!0})},this.beforeLoad=()=>{if(this.cancelMatches(),this.updateLatestLocation(),this.isServer){const e=this.buildLocation({to:this.latestLocation.pathname,search:!0,params:!0,hash:!0,state:!0,_includeValidateSearch:!0}),t=e=>{try{return encodeURI(decodeURI(e))}catch{return e}};if(Rt(t(this.latestLocation.href))!==Rt(t(e.href)))throw tn({href:e.href})}const e=this.matchRoutes(this.latestLocation);this.__store.setState(t=>({...t,status:"pending",statusCode:200,isLoading:!0,location:this.latestLocation,pendingMatches:e,cachedMatches:t.cachedMatches.filter(t=>!e.some(e=>e.id===t.id))}))},this.load=async e=>{let t,n,s;for(s=new Promise(r=>{this.startTransition(async()=>{var i;try{this.beforeLoad();const t=this.latestLocation,n=this.state.resolvedLocation;this.state.redirect||this.emit({type:"onBeforeNavigate",...sn({resolvedLocation:n,location:t})}),this.emit({type:"onBeforeLoad",...sn({resolvedLocation:n,location:t})}),await this.loadMatches({sync:null==e?void 0:e.sync,matches:this.state.pendingMatches,location:t,onReady:async()=>{this.startViewTransition(async()=>{let e,t,n;ot(()=>{this.__store.setState(s=>{const r=s.matches,i=s.pendingMatches||s.matches;return e=r.filter(e=>!i.some(t=>t.id===e.id)),t=i.filter(e=>!r.some(t=>t.id===e.id)),n=r.filter(e=>i.some(t=>t.id===e.id)),{...s,isLoading:!1,loadedAt:Date.now(),matches:i,pendingMatches:void 0,cachedMatches:[...s.cachedMatches,...e.filter(e=>"error"!==e.status)]}}),this.clearExpiredCache()}),[[e,"onLeave"],[t,"onEnter"],[n,"onStay"]].forEach(([e,t])=>{e.forEach(e=>{var n,s;null==(s=(n=this.looseRoutesById[e.routeId].options)[t])||s.call(n,e)})})})}})}catch(o){nn(o)?(t=o,this.isServer||this.navigate({...t.options,replace:!0,ignoreBlocker:!0})):Ut(o)&&(n=o),this.__store.setState(e=>({...e,statusCode:t?t.status:n?404:e.matches.some(e=>"error"===e.status)?500:200,redirect:t}))}this.latestLoadPromise===s&&(null==(i=this.commitLocationPromise)||i.resolve(),this.latestLoadPromise=void 0,this.commitLocationPromise=void 0),r()})}),this.latestLoadPromise=s,await s;this.latestLoadPromise&&s!==this.latestLoadPromise;)await this.latestLoadPromise;this.hasNotFoundMatch()&&this.__store.setState(e=>({...e,statusCode:404}))},this.startViewTransition=e=>{const t=this.shouldViewTransition??this.options.defaultViewTransition;if(delete this.shouldViewTransition,t&&"undefined"!=typeof document&&"startViewTransition"in document&&"function"==typeof document.startViewTransition){let n;if("object"==typeof t&&this.isViewTransitionTypesSupported){const s=this.latestLocation,r=this.state.resolvedLocation;n={update:e,types:"function"==typeof t.types?t.types(sn({resolvedLocation:r,location:s})):t.types}}else n=e;document.startViewTransition(n)}else e()},this.updateMatch=(e,t)=>{var n;const s=(null==(n=this.state.pendingMatches)?void 0:n.some(t=>t.id===e))?"pendingMatches":this.state.matches.some(t=>t.id===e)?"matches":this.state.cachedMatches.some(t=>t.id===e)?"cachedMatches":"";s&&this.__store.setState(n=>{var r;return{...n,[s]:null==(r=n[s])?void 0:r.map(n=>n.id===e?t(n):n)}})},this.getMatch=e=>{var t;const n=t=>t.id===e;return this.state.cachedMatches.find(n)??(null==(t=this.state.pendingMatches)?void 0:t.find(n))??this.state.matches.find(n)},this.loadMatches=async({location:e,matches:t,preload:n,onReady:s,updateMatch:r=this.updateMatch,sync:i})=>{let o,a=!1;const l=async()=>{a||(a=!0,await(null==s?void 0:s()))},c=e=>!(!n||this.state.matches.some(t=>t.id===e));!this.isServer&&this.state.matches.some(e=>e._forcePending)&&l();const u=(n,s)=>{var i,o,l;if(nn(s)||Ut(s)){if(nn(s)&&s.redirectHandled&&!s.options.reloadDocument)throw s;if(null==(i=n.beforeLoadPromise)||i.resolve(),null==(o=n.loaderPromise)||o.resolve(),r(n.id,e=>({...e,status:nn(s)?"redirected":Ut(s)?"notFound":"error",isFetching:!1,error:s,beforeLoadPromise:void 0,loaderPromise:void 0})),s.routeId||(s.routeId=n.routeId),null==(l=n.loadPromise)||l.resolve(),nn(s))throw a=!0,s.options._fromLocation=e,s.redirectHandled=!0,s=this.resolveRedirect(s);if(Ut(s))throw this._handleNotFound(t,s,{updateMatch:r}),s}},h=e=>{const t=this.getMatch(e);return!(this.isServer||!t._dehydrated)||!(!this.isServer||!1!==t.ssr)};try{await new Promise((n,a)=>{(async()=>{var d,f,p,g;try{const a=(e,n,s)=>{var i,a;const{id:l,routeId:c}=t[e],h=this.looseRoutesById[c];if(n instanceof Promise)throw n;n.routerCode=s,o=o??e,u(this.getMatch(l),n);try{null==(a=(i=h.options).onError)||a.call(i,n)}catch(d){n=d,u(this.getMatch(l),n)}r(l,e=>{var t,s;return null==(t=e.beforeLoadPromise)||t.resolve(),null==(s=e.loadPromise)||s.resolve(),{...e,error:n,status:"error",isFetching:!1,updatedAt:Date.now(),abortController:new AbortController,beforeLoadPromise:void 0}})};for(const[n,{id:i,routeId:o}]of t.entries()){const y=this.getMatch(i),v=null==(d=t[n-1])?void 0:d.id,b=v?this.getMatch(v):void 0,w=this.looseRoutesById[o],x=w.options.pendingMs??this.options.defaultPendingMs;if(this.isServer){let n;if(this.isShell())n=i===en;else{const s=this.options.defaultSsr??!0;if(!1===(null==b?void 0:b.ssr))n=!1;else{let r;if(void 0===w.options.ssr)r=s;else if("function"==typeof w.options.ssr){let n=function(e,t){return t?{status:"error",error:t}:{status:"success",value:e}};const{search:o,params:a}=this.getMatch(i),l={search:n(o,y.searchError),params:n(a,y.paramsError),location:e,matches:t.map(e=>({index:e.index,pathname:e.pathname,fullPath:e.fullPath,staticData:e.staticData,id:e.id,routeId:e.routeId,search:n(e.search,e.searchError),params:n(e.params,e.paramsError),ssr:e.ssr}))};r=await w.options.ssr(l)??s}else r=w.options.ssr;n=!0===r&&"data-only"===(null==b?void 0:b.ssr)?"data-only":r}}r(i,e=>({...e,ssr:n}))}if(h(i))continue;const S=!(!s||this.isServer||c(i)||!(w.options.loader||w.options.beforeLoad||dn(w))||"number"!=typeof x||x===1/0||!(w.options.pendingComponent??(null==(f=this.options)?void 0:f.defaultPendingComponent)));let C=!0;const k=()=>{if(S&&void 0===this.getMatch(i).pendingTimeout){const e=setTimeout(()=>{try{l()}catch{}},x);r(i,t=>({...t,pendingTimeout:e}))}};if(y.beforeLoadPromise||y.loaderPromise){k(),await y.beforeLoadPromise;const e=this.getMatch(i);"error"===e.status?C=!0:!e.preload||"redirected"!==e.status&&"notFound"!==e.status||u(e,e.error)}if(C){try{r(i,e=>{const t=e.loadPromise;return{...e,loadPromise:Mt(()=>{null==t||t.resolve()}),beforeLoadPromise:Mt()}});const{paramsError:s,searchError:o}=this.getMatch(i);s&&a(n,s,"PARSE_PARAMS"),o&&a(n,o,"VALIDATE_SEARCH"),k();const l=new AbortController,u=(null==b?void 0:b.context)??this.options.context??{};r(i,e=>({...e,isFetching:"beforeLoad",fetchCount:e.fetchCount+1,abortController:l,context:{...u,...e.__routeContext}}));const{search:h,params:d,context:f,cause:m}=this.getMatch(i),y=c(i),v={search:h,abortController:l,params:d,preload:y,context:f,location:e,navigate:t=>this.navigate({...t,_fromLocation:e}),buildLocation:this.buildLocation,cause:y?"preload":m,matches:t},x=await(null==(g=(p=w.options).beforeLoad)?void 0:g.call(p,v));(nn(x)||Ut(x))&&a(n,x,"BEFORE_LOAD"),r(i,e=>({...e,__beforeLoadContext:x,context:{...u,...e.__routeContext,...x},abortController:l}))}catch(m){a(n,m,"BEFORE_LOAD")}r(i,e=>{var t;return null==(t=e.beforeLoadPromise)||t.resolve(),{...e,beforeLoadPromise:void 0,isFetching:!1}})}}const y=t.slice(0,o),v=[];y.forEach(({id:n,routeId:s},o)=>{v.push((async()=>{let a=!1,l=!1;const d=this.looseRoutesById[s],f=async()=>{var e,s,r,i,o,a;const l=this.getMatch(n);if(!l)return;const c={matches:t,match:l,params:l.params,loaderData:l.loaderData},u=await(null==(s=(e=d.options).head)?void 0:s.call(e,c)),h=null==u?void 0:u.meta,f=null==u?void 0:u.links,p=null==u?void 0:u.scripts,g=null==u?void 0:u.styles,m=await(null==(i=(r=d.options).scripts)?void 0:i.call(r,c));return{meta:h,links:f,headScripts:p,headers:await(null==(a=(o=d.options).headers)?void 0:a.call(o,c)),scripts:m,styles:g}},p=async()=>{const e=this.getMatch(n);e.minPendingPromise&&await e.minPendingPromise},g=this.getMatch(n);if(h(n)){if(this.isServer){const e=await f();return r(n,t=>({...t,...e})),this.getMatch(n)}}else if(g.loaderPromise){if("success"===g.status&&!i&&!g.preload)return this.getMatch(n);await g.loaderPromise;const e=this.getMatch(n);e.error&&u(e,e.error)}else{const t=v[o-1],s=()=>{const{params:s,loaderDeps:r,abortController:i,context:o,cause:a}=this.getMatch(n),l=c(n);return{params:s,deps:r,preload:!!l,parentMatchPromise:t,abortController:i,context:o,location:e,navigate:t=>this.navigate({...t,_fromLocation:e}),cause:l?"preload":a,route:d}},h=Date.now()-this.getMatch(n).updatedAt,g=c(n),y=g?d.options.preloadStaleTime??this.options.defaultPreloadStaleTime??3e4:d.options.staleTime??this.options.defaultStaleTime??0,b=d.options.shouldReload,w="function"==typeof b?b(s()):b;r(n,e=>({...e,loaderPromise:Mt(),preload:!!g&&!this.state.matches.some(e=>e.id===n)}));const x=async()=>{var e,t,i,o;try{try{(!this.isServer||this.isServer&&!0===this.getMatch(n).ssr)&&this.loadRouteChunk(d),r(n,e=>({...e,isFetching:"loader"}));const i=await(null==(t=(e=d.options).loader)?void 0:t.call(e,s()));u(this.getMatch(n),i),r(n,e=>({...e,loaderData:i})),await d._lazyPromise;const o=await f();await p(),await d._componentsPromise,r(n,e=>({...e,error:void 0,status:"success",isFetching:!1,updatedAt:Date.now(),...o}))}catch(a){let e=a;await p(),u(this.getMatch(n),a);try{null==(o=(i=d.options).onError)||o.call(i,a)}catch(l){e=l,u(this.getMatch(n),l)}const t=await f();r(n,n=>({...n,error:e,status:"error",isFetching:!1,...t}))}}catch(m){const t=await f();r(n,e=>({...e,loaderPromise:void 0,...t})),u(this.getMatch(n),m)}},{status:S,invalid:C}=this.getMatch(n);if(a="success"===S&&(C||(w??h>y)),g&&!1===d.options.preload);else if(a&&!i)l=!0,(async()=>{try{await x();const{loaderPromise:e,loadPromise:t}=this.getMatch(n);null==e||e.resolve(),null==t||t.resolve(),r(n,e=>({...e,loaderPromise:void 0}))}catch(m){nn(m)&&await this.navigate(m.options)}})();else if("success"!==S||a&&i)await x();else{const e=await f();r(n,t=>({...t,...e}))}}if(!l){const{loaderPromise:e,loadPromise:t}=this.getMatch(n);null==e||e.resolve(),null==t||t.resolve()}return r(n,e=>(clearTimeout(e.pendingTimeout),{...e,isFetching:!!l&&e.isFetching,loaderPromise:l?e.loaderPromise:void 0,invalid:!1,pendingTimeout:void 0,_dehydrated:void 0})),this.getMatch(n)})())}),await Promise.all(v),n()}catch(m){a(m)}})()}),await l()}catch(d){if(nn(d)||Ut(d))throw Ut(d)&&!n&&await l(),d}return t},this.invalidate=e=>{const t=t=>{var n;return(null==(n=null==e?void 0:e.filter)?void 0:n.call(e,t))??1?{...t,invalid:!0,...(null==e?void 0:e.forcePending)||"error"===t.status?{status:"pending",error:void 0}:{}}:t};return this.__store.setState(e=>{var n;return{...e,matches:e.matches.map(t),cachedMatches:e.cachedMatches.map(t),pendingMatches:null==(n=e.pendingMatches)?void 0:n.map(t)}}),this.shouldViewTransition=!1,this.load({sync:null==e?void 0:e.sync})},this.resolveRedirect=e=>(e.options.href||(e.options.href=this.buildLocation(e.options).href,e.headers.set("Location",e.options.href)),e.headers.get("Location")||e.headers.set("Location",e.options.href),e),this.clearCache=e=>{const t=null==e?void 0:e.filter;void 0!==t?this.__store.setState(e=>({...e,cachedMatches:e.cachedMatches.filter(e=>!t(e))})):this.__store.setState(e=>({...e,cachedMatches:[]}))},this.clearExpiredCache=()=>{this.clearCache({filter:e=>{const t=this.looseRoutesById[e.routeId];if(!t.options.loader)return!0;const n=(e.preload?t.options.preloadGcTime??this.options.defaultPreloadGcTime:t.options.gcTime??this.options.defaultGcTime)??3e5;if("error"===e.status)return!0;return Date.now()-e.updatedAt>=n}})},this.loadRouteChunk=e=>(void 0===e._lazyPromise&&(e.lazyFn?e._lazyPromise=e.lazyFn().then(t=>{const{id:n,...s}=t.options;Object.assign(e.options,s)}):e._lazyPromise=Promise.resolve()),void 0===e._componentsPromise&&(e._componentsPromise=e._lazyPromise.then(()=>Promise.all(hn.map(async t=>{const n=e.options[t];(null==n?void 0:n.preload)&&await n.preload()})))),e._componentsPromise),this.preloadRoute=async e=>{const t=this.buildLocation(e);let n=this.matchRoutes(t,{throwOnError:!0,preload:!0,dest:e});const s=new Set([...this.state.matches,...this.state.pendingMatches??[]].map(e=>e.id)),r=new Set([...s,...this.state.cachedMatches.map(e=>e.id)]);ot(()=>{n.forEach(e=>{r.has(e.id)||this.__store.setState(t=>({...t,cachedMatches:[...t.cachedMatches,e]}))})});try{return n=await this.loadMatches({matches:n,location:t,preload:!0,updateMatch:(e,t)=>{s.has(e)?n=n.map(n=>n.id===e?t(n):n):this.updateMatch(e,t)}}),n}catch(i){if(nn(i)){if(i.options.reloadDocument)return;return await this.preloadRoute({...i.options,_fromLocation:t})}return void Ut(i)}},this.matchRoute=(e,t)=>{const n={...e,to:e.to?this.resolvePathWithBase(e.from||"",e.to):void 0,params:e.params||{},leaveParams:!0},s=this.buildLocation(n);if((null==t?void 0:t.pending)&&"pending"!==this.state.status)return!1;const r=(void 0===(null==t?void 0:t.pending)?!this.state.isLoading:t.pending)?this.latestLocation:this.state.resolvedLocation||this.state.location,i=Bt(this.basepath,r.pathname,{...t,to:s.pathname},this.parsePathnameCache);return!!i&&(!(e.params&&!Ot(i,e.params,{partial:!0}))&&(i&&((null==t?void 0:t.includeSearch)??1)?!!Ot(r.search,s.search,{partial:!0})&&i:i))},this._handleNotFound=(e,t,{updateMatch:n=this.updateMatch}={})=>{var s;const r=this.routesById[t.routeId??""]??this.routeTree,i={};for(const a of e)i[a.routeId]=a;!r.options.notFoundComponent&&(null==(s=this.options)?void 0:s.defaultNotFoundComponent)&&(r.options.notFoundComponent=this.options.defaultNotFoundComponent),He(r.options.notFoundComponent);const o=i[r.id];He(o,r.id),n(o.id,e=>({...e,status:"notFound",error:t,isFetching:!1})),"BEFORE_LOAD"===t.routerCode&&r.parentRoute&&(t.routeId=r.parentRoute.id,this._handleNotFound(e,t,{updateMatch:n}))},this.hasNotFoundMatch=()=>this.__store.state.matches.some(e=>"notFound"===e.status||e.globalNotFound),this.update({defaultPreloadDelay:50,defaultPendingMs:1e3,defaultPendingMinMs:500,context:void 0,...e,caseSensitive:e.caseSensitive??!1,notFoundMode:e.notFoundMode??"fuzzy",stringifySearch:e.stringifySearch??Xt,parseSearch:e.parseSearch??Yt}),"undefined"!=typeof document&&(self.__TSR_ROUTER__=this)}isShell(){return!!this.options.isShell}isPrerendering(){return!!this.options.isPrerendering}get state(){return this.__store.state}get looseRoutesById(){return this.routesById}matchRoutesInternal(e,t){var n;const{foundRoute:s,matchedRoutes:r,routeParams:i}=this.getMatchedRoutes(e.pathname,null==(n=null==t?void 0:t.dest)?void 0:n.to);let o=!1;(s?"/"!==s.path&&i["**"]:At(e.pathname))&&(this.options.notFoundRoute?r.push(this.options.notFoundRoute):o=!0);const a=(()=>{if(o){if("root"!==this.options.notFoundMode)for(let e=r.length-1;e>=0;e--){const t=r[e];if(t.children)return t.id}return en}})(),l=r.map(e=>{var n;let s;const r=(null==(n=e.options.params)?void 0:n.parse)??e.options.parseParams;if(r)try{const e=r(i);Object.assign(i,e)}catch(o){if(s=new an(o.message,{cause:o}),null==t?void 0:t.throwOnError)throw s;return s}}),c=[],u=e=>(null==e?void 0:e.id)?e.context??this.options.context??{}:this.options.context??{};return r.forEach((n,s)=>{var r,o;const h=c[s-1],[d,f,p]=(()=>{const s=(null==h?void 0:h.search)??e.search,r=(null==h?void 0:h._strictSearch)??{};try{const e=un(n.options.validateSearch,{...s})??{};return[{...s,...e},{...r,...e},void 0]}catch(i){let e=i;if(i instanceof on||(e=new on(i.message,{cause:i})),null==t?void 0:t.throwOnError)throw e;return[s,{},e]}})(),g=(null==(o=(r=n.options).loaderDeps)?void 0:o.call(r,{search:d}))??"",m=g?JSON.stringify(g):"",{usedParams:y,interpolatedPath:v}=Vt({path:n.fullPath,params:i,decodeCharMap:this.pathParamsDecodeCharMap}),b=Vt({path:n.id,params:i,leaveWildcards:!0,decodeCharMap:this.pathParamsDecodeCharMap,parseCache:this.parsePathnameCache}).interpolatedPath+m,w=this.getMatch(b),x=this.state.matches.find(e=>e.routeId===n.id),S=x?"stay":"enter";let C;if(w)C={...w,cause:S,params:x?bt(x.params,i):i,_strictParams:y,search:bt(x?x.search:w.search,d),_strictSearch:f};else{const e=n.options.loader||n.options.beforeLoad||n.lazyFn||dn(n)?"pending":"success";C={id:b,index:s,routeId:n.id,params:x?bt(x.params,i):i,_strictParams:y,pathname:_t([this.basepath,v]),updatedAt:Date.now(),search:x?bt(x.search,d):d,_strictSearch:f,searchError:void 0,status:e,isFetching:!1,error:void 0,paramsError:l[s],__routeContext:{},__beforeLoadContext:void 0,context:{},abortController:new AbortController,fetchCount:0,cause:S,loaderDeps:x?bt(x.loaderDeps,g):g,invalid:!1,preload:!1,links:void 0,scripts:void 0,headScripts:void 0,meta:void 0,staticData:n.options.staticData||{},loadPromise:Mt(),fullPath:n.fullPath}}(null==t?void 0:t.preload)||(C.globalNotFound=a===n.id),C.searchError=p;const k=u(h);C.context={...k,...C.__routeContext,...C.__beforeLoadContext},c.push(C)}),c.forEach((n,s)=>{var r,i;const o=this.looseRoutesById[n.routeId];if(!this.getMatch(n.id)&&!0!==(null==t?void 0:t._buildLocation)){const t=c[s-1],a=u(t),l={deps:n.loaderDeps,params:n.params,context:a,location:e,navigate:t=>this.navigate({...t,_fromLocation:e}),buildLocation:this.buildLocation,cause:n.cause,abortController:n.abortController,preload:!!n.preload,matches:c};n.__routeContext=(null==(i=(r=o.options).context)?void 0:i.call(r,l))??{},n.context={...a,...n.__routeContext,...n.__beforeLoadContext}}}),c}}class on extends Error{}class an extends Error{}const ln=e=>e.endsWith("/")&&e.length>1?e.slice(0,-1):e;function cn(e,t){return ln(e)===ln(t)}function un(e,t){if(null==e)return{};if("~standard"in e){const n=e["~standard"].validate(t);if(n instanceof Promise)throw new on("Async validation not supported");if(n.issues)throw new on(JSON.stringify(n.issues,void 0,2),{cause:n});return n.value}return"parse"in e?e.parse(t):"function"==typeof e?e(t):{}}const hn=["component","errorComponent","pendingComponent","notFoundComponent"];function dn(e){var t;for(const n of hn)if(null==(t=e.options[n])?void 0:t.preload)return!0;return!1}const fn=.5,pn=.4,gn=.25,mn=.05,yn=.02,vn=.01,bn=2e-4,wn=1e-4;function xn(e,t){return e.prefixSegment&&e.suffixSegment?t+mn+bn*e.prefixSegment.length+wn*e.suffixSegment.length:e.prefixSegment?t+yn+bn*e.prefixSegment.length:e.suffixSegment?t+vn+wn*e.suffixSegment.length:t}class Sn{constructor(e){if(this.init=e=>{var t,n;this.originalIndex=e.originalIndex;const s=this.options,r=!(null==s?void 0:s.path)&&!(null==s?void 0:s.id);this.parentRoute=null==(n=(t=this.options).getParentRoute)?void 0:n.call(t),r?this._path=en:this.parentRoute||He(!1);let i=r?en:null==s?void 0:s.path;i&&"/"!==i&&(i=It(i));const o=(null==s?void 0:s.id)||i;let a=r?en:_t([this.parentRoute.id===en?"":this.parentRoute.id,o]);i===en&&(i="/"),a!==en&&(a=_t(["/",a]));const l=a===en?"/":_t([this.parentRoute.fullPath,i]);this._path=i,this._id=a,this._fullPath=l,this._to=l},this.clone=e=>{this._path=e._path,this._id=e._id,this._fullPath=e._fullPath,this._to=e._to,this.options.getParentRoute=e.options.getParentRoute,this.children=e.children},this.addChildren=e=>this._addFileChildren(e),this._addFileChildren=e=>(Array.isArray(e)&&(this.children=e),"object"==typeof e&&null!==e&&(this.children=Object.values(e)),this),this._addFileTypes=()=>this,this.updateLoader=e=>(Object.assign(this.options,e),this),this.update=e=>(Object.assign(this.options,e),this),this.lazy=e=>(this.lazyFn=e,this),this.options=e||{},this.isRoot=!(null==e?void 0:e.getParentRoute),(null==e?void 0:e.id)&&(null==e?void 0:e.path))throw new Error("Route cannot have both an 'id' and a 'path' option.")}get to(){return this._to}get id(){return this._id}get path(){return this._path}get fullPath(){return this._fullPath}}class Cn extends Sn{constructor(e){super(e)}}var kn=Pe("<div style=max-width:100%><div style=align-items:center><strong style=font-size:1rem>Something went wrong!</strong><button style=font-size:.6em;font-weight:bold;border-radius:.25rem></button></div><div>"),On=Pe("<div><pre style=font-size:.7em;border-radius:.25rem>"),Mn=Pe("<code>");function _n(e){return ne(me,{fallback:(t,n)=>(e.onCatch?.(t),C(P([e.getResetKey],()=>n(),{defer:!0})),ne(Qe,{get component(){return e.errorComponent??Pn},error:t,reset:n})),get children(){return e.children}})}function Pn({error:e}){const[t,n]=w(!1);return r=kn(),i=r.firstChild,o=i.firstChild.nextSibling,a=i.nextSibling,Te(r,"padding",".5rem"),Te(i,"display","flex"),Te(i,"gap",".5rem"),o.$$click=()=>n(e=>!e),Te(o,"appearance","none"),Te(o,"border","1px solid currentColor"),Te(o,"padding",".1rem .2rem"),De(o,()=>t()?"Hide Error":"Show Error"),Te(a,"height",".25rem"),De(r,(s=Me(()=>!!t()),()=>{return s()?(n=On(),Te(r=n.firstChild,"border","1px solid red"),Te(r,"padding",".3rem"),Te(r,"color","red"),Te(r,"overflow","auto"),De(r,(t=Me(()=>!!e.message),()=>{return t()?(De(n=Mn(),()=>e.message),n):null;var n})),n):null;var t,n,r}),null),r;var s,r,i,o,a}function In(...e){return t=e,(...e)=>{for(const n of t)n&&n(...e)};var t}Ie(["click"]);const An=Symbol("store-raw"),Rn=Symbol("store-node"),En=Symbol("store-has"),Tn=Symbol("store-self");function jn(e){let t=e[s];if(!t&&(Object.defineProperty(e,s,{value:t=new Proxy(e,Vn)}),!Array.isArray(e))){const n=Object.keys(e),s=Object.getOwnPropertyDescriptors(e);for(let r=0,i=n.length;r<i;r++){const i=n[r];s[i].get&&Object.defineProperty(e,i,{enumerable:s[i].enumerable,get:s[i].get.bind(t)})}}return t}function Ln(e){let t;return null!=e&&"object"==typeof e&&(e[s]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function Dn(e,t=new Set){let n,s,r,i;if(n=null!=e&&e[An])return n;if(!Ln(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let n=0,i=e.length;n<i;n++)r=e[n],(s=Dn(r,t))!==r&&(e[n]=s)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const n=Object.keys(e),o=Object.getOwnPropertyDescriptors(e);for(let a=0,l=n.length;a<l;a++)i=n[a],o[i].get||(r=e[i],(s=Dn(r,t))!==r&&(e[i]=s))}return e}function $n(e,t){let n=e[t];return n||Object.defineProperty(e,t,{value:n=Object.create(null)}),n}function Fn(e,t,n){if(e[t])return e[t];const[s,r]=w(n,{equals:!1,internal:!0});return s.$=r,e[t]=s}function qn(e){R()&&Fn($n(e,Rn),Tn)()}const Vn={get(e,t,n){if(t===An)return e;if(t===s)return n;if(t===i)return qn(e),n;const r=$n(e,Rn),o=r[t];let a=o?o():e[t];if(t===Rn||t===En||"__proto__"===t)return a;if(!o){const n=Object.getOwnPropertyDescriptor(e,t);!R()||"function"==typeof a&&!e.hasOwnProperty(t)||n&&n.get||(a=Fn(r,t,a)())}return Ln(a)?jn(a):a},has:(e,t)=>t===An||t===s||t===i||t===Rn||t===En||"__proto__"===t||(R()&&Fn($n(e,En),t)(),t in e),set:()=>!0,deleteProperty:()=>!0,ownKeys:function(e){return qn(e),Reflect.ownKeys(e)},getOwnPropertyDescriptor:function(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return n&&!n.get&&n.configurable&&t!==s&&t!==Rn?(delete n.value,delete n.writable,n.get=()=>e[s][t],n):n}};function Bn(e,t,n,s=!1){if(!s&&e[t]===n)return;const r=e[t],i=e.length;void 0===n?(delete e[t],e[En]&&e[En][t]&&void 0!==r&&e[En][t].$()):(e[t]=n,e[En]&&e[En][t]&&void 0===r&&e[En][t].$());let o,a=$n(e,Rn);if((o=Fn(a,t,r))&&o.$(()=>n),Array.isArray(e)&&e.length!==i){for(let t=e.length;t<i;t++)(o=a[t])&&o.$();(o=Fn(a,"length",i))&&o.$(e.length)}(o=a[Tn])&&o.$()}function Nn(e,t){const n=Object.keys(t);for(let s=0;s<n.length;s+=1){const r=n[s];Bn(e,r,t[r])}}function Un(e,t,n=[]){let s,r=e;if(t.length>1){s=t.shift();const i=typeof s,o=Array.isArray(e);if(Array.isArray(s)){for(let r=0;r<s.length;r++)Un(e,[s[r]].concat(t),n);return}if(o&&"function"===i){for(let r=0;r<e.length;r++)s(e[r],r)&&Un(e,[r].concat(t),n);return}if(o&&"object"===i){const{from:r=0,to:i=e.length-1,by:o=1}=s;for(let s=r;s<=i;s+=o)Un(e,[s].concat(t),n);return}if(t.length>1)return void Un(e[s],t,[s].concat(n));r=e[s],n=[s].concat(n)}let i=t[0];"function"==typeof i&&(i=i(r,n),i===r)||void 0===s&&null==i||(i=Dn(i),void 0===s||Ln(r)&&Ln(i)&&!Array.isArray(i)?Nn(r,i):Bn(e,s,i))}function Kn(...[e,t]){const n=Dn(e||{}),s=Array.isArray(n);return[jn(n),function(...e){M(()=>{s&&1===e.length?function(e,t){if("function"==typeof t&&(t=t(e)),t=Dn(t),Array.isArray(t)){if(e===t)return;let n=0,s=t.length;for(;n<s;n++){const s=t[n];e[n]!==s&&Bn(e,n,s)}Bn(e,"length",s)}else Nn(e,t)}(n,e[0]):Un(n,e)})}]}const zn=Symbol("store-root");function Wn(e,t,n,s,r){const i=t[n];if(e===i)return;const o=Array.isArray(e);if(n!==zn&&(!Ln(e)||!Ln(i)||o!==Array.isArray(i)||r&&e[r]!==i[r]))return void Bn(t,n,e);if(o){if(e.length&&i.length&&(!s||r&&e[0]&&null!=e[0][r])){let t,n,o,a,l,c,u,h;for(o=0,a=Math.min(i.length,e.length);o<a&&(i[o]===e[o]||r&&i[o]&&e[o]&&i[o][r]&&i[o][r]===e[o][r]);o++)Wn(e[o],i,o,s,r);const d=new Array(e.length),f=new Map;for(a=i.length-1,l=e.length-1;a>=o&&l>=o&&(i[a]===e[l]||r&&i[a]&&e[l]&&i[a][r]&&i[a][r]===e[l][r]);a--,l--)d[l]=i[a];if(o>l||o>a){for(n=o;n<=l;n++)Bn(i,n,e[n]);for(;n<e.length;n++)Bn(i,n,d[n]),Wn(e[n],i,n,s,r);return void(i.length>e.length&&Bn(i,"length",e.length))}for(u=new Array(l+1),n=l;n>=o;n--)c=e[n],h=r&&c?c[r]:c,t=f.get(h),u[n]=void 0===t?-1:t,f.set(h,n);for(t=o;t<=a;t++)c=i[t],h=r&&c?c[r]:c,n=f.get(h),void 0!==n&&-1!==n&&(d[n]=i[t],n=u[n],f.set(h,n));for(n=o;n<e.length;n++)n in d?(Bn(i,n,d[n]),Wn(e[n],i,n,s,r)):Bn(i,n,e[n])}else for(let t=0,n=e.length;t<n;t++)Wn(e[t],i,t,s,r);return void(i.length>e.length&&Bn(i,"length",e.length))}const a=Object.keys(e);for(let c=0,u=a.length;c<u;c++)Wn(e[a[c]],i,a[c],s,r);const l=Object.keys(i);for(let c=0,u=l.length;c<u;c++)void 0===e[l[c]]&&Bn(i,l[c],void 0)}function Qn(e,t={}){const{merge:n,key:s="id"}=t,r=Dn(e);return e=>{if(!Ln(e)||!Ln(r))return r;const t=Wn(r,{[zn]:e},zn,n,s);return void 0===t?e:t}}const Hn=j(null);function Gn(){return"undefined"==typeof document?Hn:window.__TSR_ROUTER_CONTEXT__?window.__TSR_ROUTER_CONTEXT__:(window.__TSR_ROUTER_CONTEXT__=Hn,Hn)}function Jn(e){const t=L(Gn());return t}function Yn(e){const t=Jn();return function(e,t=e=>e){const[n,s]=Kn({value:t(e.state)}),r=e.subscribe(()=>{const n=t(e.state);s("value",Qn(n))});return A(()=>{r()}),()=>n.value}((e?.router||t).__store,t=>e?.select?e.select(t):t)}const Zn=e=>k((t={current:null,previous:null})=>{const n=e();return t.current!==n&&(t.previous=t.current,t.current=n),t});const Xn=j(()=>{}),es=j(()=>{});function ts(e){const t=L(e.from?es:Xn);return Yn({select:n=>{const s=n.matches.find(n=>e.from?e.from===n.routeId:n.id===t());if(He(!((e.shouldThrow??1)&&!s),e.from&&e.from),void 0!==s)return e.select?e.select(s):s}})}function ns(e){const t=Jn(),[n,s]=w(!1);let r=!1;const[i,o]=le(ae({activeProps:()=>({class:"active"}),inactiveProps:()=>({})},e),["activeProps","inactiveProps","activeOptions","to","preload","preloadDelay","hashScrollIntoView","replace","startTransition","resetScroll","viewTransition","target","disabled","style","class","onClick","onFocus","onMouseEnter","onMouseLeave","onMouseOver","onMouseOut","onTouchStart","ignoreBlocker"]),[a,l]=le(o,["params","search","hash","state","mask","reloadDocument","unsafeRelative"]),c=()=>{try{return new URL(`${i.to}`),"external"}catch{}return"internal"},u=Yn({select:e=>e.location.searchStr}),h=ts({strict:!1,select:t=>e.from??t.fullPath}),d=()=>({...e,from:h()}),f=k(()=>(u(),t.buildLocation(d()))),p=k(()=>!d().reloadDocument&&(i.preload??t.options.defaultPreload)),g=Yn({select:e=>{if(i.activeOptions?.exact){if(!(n=e.location.pathname,s=f().pathname,r=t.basepath,Et(n,r)===Et(s,r)))return!1}else{const n=Et(e.location.pathname,t.basepath).split("/"),s=Et(f()?.pathname,t.basepath)?.split("/"),r=s?.every((e,t)=>e===n[t]);if(!r)return!1}var n,s,r;if(i.activeOptions?.includeSearch??1){if(!Ot(e.location.search,f().search,{partial:!i.activeOptions?.exact,ignoreUndefined:!i.activeOptions?.explicitUndefined}))return!1}return!i.activeOptions?.includeHash||e.location.hash===f().hash}}),m=()=>t.preloadRoute(d()).catch(e=>{}),[y,v]=w(null);if(function(e,t,n={},s={}){const r="function"==typeof IntersectionObserver;let i=null;C(()=>{const o=e();o&&r&&!s.disabled&&(i=new IntersectionObserver(([e])=>{t(e)},n),i.observe(o),A(()=>{i?.disconnect()}))})}(y,e=>{e?.isIntersecting&&m()},{rootMargin:"100px"},{disabled:!(!i.disabled&&"viewport"===p())}),C(()=>{r||i.disabled||"render"!==p()||(m(),r=!0)}),"external"===c())return ae(l,{ref:y,get type(){return c()},get href(){return i.to}},le(i,["target","disabled","style","class","onClick","onFocus","onMouseEnter","onMouseLeave","onMouseOut","onMouseOver","onTouchStart"])[0]);const b=e=>{if(!(i.disabled||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)||e.defaultPrevented||i.target&&"_self"!==i.target||0!==e.button)){e.preventDefault(),s(!0);const n=t.subscribe("onResolved",()=>{n(),s(!1)});t.navigate({...d(),replace:i.replace,resetScroll:i.resetScroll,hashScrollIntoView:i.hashScrollIntoView,startTransition:i.startTransition,viewTransition:i.viewTransition,ignoreBlocker:i.ignoreBlocker})}},x=e=>{i.disabled||p()&&m()},S=x,O=e=>{if(i.disabled)return;const n=e.target||{};if(p()){if(n.preloadTimeout)return;n.preloadTimeout=setTimeout(()=>{n.preloadTimeout=null,m()},i.preloadDelay??t.options.defaultPreloadDelay??0)}},M=e=>{if(i.disabled)return;const t=e.target||{};t.preloadTimeout&&(clearTimeout(t.preloadTimeout),t.preloadTimeout=null)};function _(e,t){return t&&("function"==typeof t?t(e):t[0](t[1],e)),e.defaultPrevented}function P(e){return t=>{for(const n of e)_(t,n)}}const I=()=>g()?yt(i.activeProps,{})??{}:{},R=()=>g()?{}:yt(i.inactiveProps,{}),E=()=>[i.class,I().class,R().class].filter(Boolean).join(" "),T=()=>({...i.style,...I().style,...R().style}),j=k(()=>{const e=f(),n=e?.maskedLocation;return d().disabled?void 0:n?t.history.createHref(n.href):t.history.createHref(e?.href)});return ae(l,I,R,()=>({href:j(),ref:In(v,d().ref),onClick:P([i.onClick,b]),onFocus:P([i.onFocus,x]),onMouseEnter:P([i.onMouseEnter,O]),onMouseOver:P([i.onMouseOver,O]),onMouseLeave:P([i.onMouseLeave,M]),onMouseOut:P([i.onMouseOut,M]),onTouchStart:P([i.onTouchStart,S]),disabled:!!i.disabled,target:i.target,...Object.keys(T).length&&{style:T},...E()&&{class:E()},...i.disabled&&{role:"link","aria-disabled":!0},...g()&&{"data-status":"active","aria-current":"page"},...n()&&{"data-transitioning":"transitioning"}}))}const ss=e=>{const[t,n]=le(e,["_asChild","children"]),[s,r]=le(ns(n),["type"]),i=k(()=>{const e=t.children;return"function"==typeof e?e({get isActive(){return"active"===r["data-status"]},isTransitioning:!1}):e});return ne(Qe,ae({get component(){return Me(()=>!!t._asChild)()?t._asChild:"a"}},r,{get children(){return i()}}))};function rs(e){return ts({from:e.from,strict:e.strict,select:t=>e.select?e.select(t.loaderData):t.loaderData})}function is(e){const{select:t,...n}=e;return ts({...n,select:e=>t?t(e.loaderDeps):e.loaderDeps})}function os(e){return ts({from:e.from,strict:e.strict,shouldThrow:e.shouldThrow,select:t=>e.select?e.select(t.params):t.params})}function as(e){return ts({from:e.from,strict:e.strict,shouldThrow:e.shouldThrow,select:t=>e.select?e.select(t.search):t.search})}function ls(e){const{navigate:t,state:n}=Jn(),s=ts({strict:!1,select:e=>e.index});return r=>t({...r,from:r.from??e?.from??n.matches[s()].fullPath})}let cs=class extends Sn{constructor(e){super(e),this.useMatch=e=>ts({select:e?.select,from:this.id}),this.useRouteContext=e=>ts({...e,from:this.id,select:t=>e?.select?e.select(t.context):t.context}),this.useSearch=e=>as({select:e?.select,from:this.id}),this.useParams=e=>os({select:e?.select,from:this.id}),this.useLoaderDeps=e=>is({...e,from:this.id}),this.useLoaderData=e=>rs({...e,from:this.id}),this.useNavigate=()=>ls({from:this.fullPath}),this.Link=e=>{const t=this;return ne(ss,ae({get from(){return t.fullPath}},e))}}};class us extends Cn{constructor(e){super(e),this.useMatch=e=>ts({select:e?.select,from:this.id}),this.useRouteContext=e=>ts({...e,from:this.id,select:t=>e?.select?e.select(t.context):t.context}),this.useSearch=e=>as({select:e?.select,from:this.id}),this.useParams=e=>os({select:e?.select,from:this.id}),this.useLoaderDeps=e=>is({...e,from:this.id}),this.useLoaderData=e=>rs({...e,from:this.id}),this.useNavigate=()=>ls({from:this.fullPath}),this.Link=e=>{const t=this;return ne(ss,ae({get from(){return t.fullPath}},e))}}}function hs(e){return"object"==typeof e?new ds(e,{silent:!0}).createRoute(e):new ds(e,{silent:!0}).createRoute}class ds{constructor(e,t){this.path=e,this.createRoute=e=>{this.silent;const t=function(e){return new cs(e)}(e);return t.isRoot=!1,t},this.silent=t?.silent}}class fs{constructor(e){this.useMatch=e=>ts({select:e?.select,from:this.options.id}),this.useRouteContext=e=>ts({from:this.options.id,select:t=>e?.select?e.select(t.context):t.context}),this.useSearch=e=>as({select:e?.select,from:this.options.id}),this.useParams=e=>os({select:e?.select,from:this.options.id}),this.useLoaderDeps=e=>is({...e,from:this.options.id}),this.useLoaderData=e=>rs({...e,from:this.options.id}),this.useNavigate=()=>ls({from:Jn().routesById[this.options.id].fullPath}),this.options=e}}function ps(e){return"object"==typeof e?new fs(e):t=>new fs({id:e,...t})}function gs(e,t){let n,s,r;const i=()=>(n||(n=e().then(e=>(n=void 0,s=e[t],s)).catch(e=>{r=e})),n),o=function(e){if(r){if(function(e){return"string"==typeof(null==e?void 0:e.message)&&(e.message.startsWith("Failed to fetch dynamically imported module")||e.message.startsWith("error loading dynamically imported module")||e.message.startsWith("Importing a module script failed"))}(r)&&r instanceof Error&&"undefined"!=typeof window&&"undefined"!=typeof sessionStorage){const e=`tanstack_router_reload:${r.message}`;if(!sessionStorage.getItem(e))return sessionStorage.setItem(e,"1"),window.location.reload(),{default:()=>null}}throw r}if(!s){const[e]=O(i,{initialValue:s,ssrLoadFrom:"initial"});return Me(e)}return ne(Qe,ae({component:s},e))};return o.preload=i,o}function ms(){const e=Jn();let t={router:e,mounted:!1};const n=Yn({select:({isLoading:e})=>e}),[s,r]=w(!1),i=Yn({select:e=>e.matches.some(e=>"pending"===e.status)}),o=Zn(n),a=()=>n()||s()||i(),l=Zn(a),c=()=>n()||i(),u=Zn(c);return e.startTransition=async e=>{r(!0),await e(),r(!1)},I(()=>{const t=e.history.subscribe(e.load),n=e.buildLocation({to:e.latestLocation.pathname,search:!0,params:!0,hash:!0,state:!0,_includeValidateSearch:!0});At(e.latestLocation.href)!==At(n.href)&&e.commitLocation({...n,replace:!0}),A(()=>{t()})}),S(()=>{_(()=>{if("undefined"!=typeof window&&e.ssr||t.router===e&&t.mounted)return;t={router:e,mounted:!0};(async()=>{try{await e.load()}catch(t){}})()})}),S(P([o,n],([t,n])=>{t.previous&&!n&&e.emit({type:"onLoad",...sn(e.state)})})),S(P([c,u],([t,n])=>{n.previous&&!t&&e.emit({type:"onBeforeRouteMount",...sn(e.state)})})),S(P([a,l],([t,n])=>{n.previous&&!t&&(e.emit({type:"onResolved",...sn(e.state)}),e.__store.setState(e=>({...e,status:"idle",resolvedLocation:e.location})),function(e){if("undefined"!=typeof document&&document.querySelector){const t=e.state.location.state.__hashScrollIntoViewOptions??!0;if(t&&""!==e.state.location.hash){const n=document.getElementById(e.state.location.hash);n&&n.scrollIntoView(t)}}}(e))})),null}var ys=Pe("<p>Not Found");function vs(e){const t=Yn({select:e=>`not-found-${e.location.pathname}-${e.status}`});return ne(_n,{getResetKey:()=>t(),onCatch:t=>{if(!Ut(t))throw t;e.onCatch?.(t)},errorComponent:({error:t})=>{if(Ut(t))return e.fallback?.(t);throw t},get children(){return e.children}})}function bs(){return ys()}function ws(e){return Me(()=>e.children)}function xs(e,t,n){return t.options.notFoundComponent?ne(t.options.notFoundComponent,{data:n}):e.options.defaultNotFoundComponent?ne(e.options.defaultNotFoundComponent,{data:n}):ne(bs,{})}var Ss=Pe("<script class=tsr-once>");function Cs({children:e}){return"undefined"!=typeof document?null:(t=Ss(),S(()=>t.innerHTML=[e].filter(Boolean).join("\n")),t);var t}function ks(){const e=Jn(),t=(e.options.getScrollRestorationKey||Wt)(e.latestLocation),n=t!==Wt(e.latestLocation)?t:void 0;if(!e.isScrollRestoring||!e.isServer)return null;const s={storageKey:Kt,shouldScrollRestoration:!0};return n&&(s.key=n),ne(Cs,{get children(){return`(${Ht.toString()})(${JSON.stringify(s)})`}})}const Os=e=>{const t=Jn(),n=Yn({select:t=>{const n=t.matches.find(t=>t.id===e.matchId);return He(n,e.matchId),vt(n,["routeId","ssr","_displayPending"])}}),s=()=>t.routesById[n().routeId],r=()=>s().options.pendingComponent??t.options.defaultPendingComponent,i=()=>s().options.errorComponent??t.options.defaultErrorComponent,o=()=>s().isRoot?s().options.notFoundComponent??t.options.notFoundRoute?.options.component:s().options.notFoundComponent,a=!1===n().ssr||"data-only"===n().ssr,l=Yn({select:e=>e.loadedAt}),c=Yn({select:t=>{const n=t.matches.findIndex(t=>t.id===e.matchId);return t.matches[n-1]?.routeId}});return ne(s().isRoot?s().options.shellComponent??ws:ws,{get children(){return[ne(Xn.Provider,{value:()=>e.matchId,get children(){return ne(Qe,{get component(){return(!s().isRoot||s().options.wrapInSuspense||a||n()._displayPending)&&(s().options.wrapInSuspense??r()??(s().options.errorComponent?.preload||a))?ve:ws},get fallback(){return ne(Qe,{get component(){return r()}})},get children(){return ne(Qe,{get component(){return i()?_n:ws},getResetKey:()=>l(),get errorComponent(){return i()||Pn},onCatch:n=>{if(Ut(n))throw n;e.matchId,(s().options.onCatch??t.options.defaultOnCatch)?.(n)},get children(){return ne(Qe,{get component(){return o()?vs:ws},fallback:e=>{if(!o()||e.routeId&&e.routeId!==n().routeId||!e.routeId&&!s().isRoot)throw e;return ne(Qe,ae({get component(){return o()}},e))},get children(){return ne(fe,{get children(){return[ne(pe,{when:a,get children(){return ne(de,{get when(){return!t.isServer},get fallback(){return ne(Qe,{get component(){return r()}})},get children(){return ne(_s,{get matchId(){return e.matchId}})}})}}),ne(pe,{when:!a,get children(){return ne(_s,{get matchId(){return e.matchId}})}})]}})}})}})}})}}),Me(()=>Me(()=>c()===en)()?[ne(Ms,{}),ne(ks,{})]:null)]}})};function Ms(){const e=Jn();return C(P([Yn({select:e=>e.resolvedLocation?.state.__TSR_key})],()=>{e.emit({type:"onRendered",...sn(e.state)})})),null}const _s=e=>{const t=Jn(),n=Yn({select:n=>{const s=n.matches.findIndex(t=>t.id===e.matchId),r=n.matches[s],i=r.routeId,o=t.routesById[i].options.remountDeps??t.options.defaultRemountDeps,a=o?.({routeId:i,loaderDeps:r.loaderDeps,params:r._strictParams,search:r._strictSearch});return{key:a?JSON.stringify(a):void 0,routeId:i,match:vt(r,["id","status","error","_forcePending","_displayPending"])}}}),s=()=>t.routesById[n().routeId],r=()=>n().match;return ne(fe,{get children(){return[ne(pe,{get when(){return r()._displayPending},children:e=>{const[n]=O(()=>t.getMatch(r().id)?.displayPendingPromise);return Me(n)}}),ne(pe,{get when(){return r()._forcePending},children:e=>{const[n]=O(()=>t.getMatch(r().id)?.minPendingPromise);return Me(n)}}),ne(pe,{get when(){return"pending"===r().status},children:e=>{const n=s().options.pendingMinMs??t.options.defaultPendingMinMs;if(n&&!t.getMatch(r().id)?.minPendingPromise&&!t.isServer){const e=Mt();Promise.resolve().then(()=>{t.updateMatch(r().id,t=>({...t,minPendingPromise:e}))}),setTimeout(()=>{e.resolve(),t.updateMatch(r().id,e=>({...e,minPendingPromise:void 0}))},n)}const[i]=O(async()=>(await new Promise(e=>setTimeout(e,0)),t.getMatch(r().id)?.loadPromise));return Me(i)}}),ne(pe,{get when(){return"notFound"===r().status},children:e=>(He(Ut(r().error)),xs(t,s(),r().error))}),ne(pe,{get when(){return"redirected"===r().status},children:e=>{He(nn(r().error));const[n]=O(async()=>(await new Promise(e=>setTimeout(e,0)),t.getMatch(r().id)?.loadPromise));return Me(n)}}),ne(pe,{get when(){return"error"===r().status},children:e=>{if(t.isServer){return ne((s().options.errorComponent??t.options.defaultErrorComponent)||Pn,{get error(){return r().error},info:{componentStack:""}})}throw r().error}}),ne(pe,{get when(){return"success"===r().status},get children(){return(()=>{const e=s().options.component??t.options.defaultComponent;return e?ne(de,{get when(){return n().match.id},keyed:!0,get children(){return ne(e,{})}}):ne(Ps,{})})()}})]}})},Ps=()=>{const e=Jn(),t=L(Xn),n=Yn({select:e=>e.matches.find(e=>e.id===t())?.routeId}),s=Yn({select:e=>{const n=e.matches.find(e=>e.id===t());return He(n,t()),n.globalNotFound}}),r=Yn({select:e=>{const n=e.matches,s=n.findIndex(e=>e.id===t()),r=n[s+1]?.id;return r}});return ne(fe,{get children(){return[ne(pe,{get when(){return s()},get children(){return xs(e,e.routesById[n()],void 0)}}),ne(pe,{get when(){return r()},children:t=>ne(de,{get when(){return t()===en},get fallback(){return ne(Os,{get matchId(){return t()}})},get children(){return ne(ve,{get fallback(){return ne(Qe,{get component(){return e.options.defaultPendingComponent}})},get children(){return ne(Os,{get matchId(){return t()}})}})}})})]}})};function Is(){const e=Jn(),t=e.options.defaultPendingComponent?ne(e.options.defaultPendingComponent,{}):null,n=ne(e.isServer||"undefined"!=typeof document&&e.ssr?ws:ve,{fallback:t,get children(){return[Me(()=>Me(()=>!e.isServer)()&&ne(ms,{})),ne(As,{})]}});return e.options.InnerWrap?ne(e.options.InnerWrap,{children:n}):n}function As(){const e=Jn(),t=Yn({select:e=>e.matches[0]?.id}),n=Yn({select:e=>e.loadedAt}),s=()=>t()?ne(Os,{get matchId(){return t()}}):null;return ne(Xn.Provider,{value:t,get children(){return Me(()=>!!e.options.disableGlobalCatchBoundary)()?s():ne(_n,{getResetKey:()=>n(),errorComponent:Pn,onCatch:e=>{e.message||e.toString()},get children(){return s()}})}})}class Rs extends rn{constructor(e){super(e)}}function Es({router:e,children:t,...n}){e.update({...e.options,...n,context:{...e.options.context,...n.context}});const s=ne(Gn().Provider,{value:e,get children(){return t()}});return e.options.Wrap?ne(e.options.Wrap,{children:s}):s}function Ts({router:e,...t}){return ne(Es,ae({router:e},t,{children:()=>ne(Is,{})}))}"undefined"!=typeof globalThis?(globalThis.createFileRoute=hs,globalThis.createLazyFileRoute=ps):"undefined"!=typeof window&&(window.createFileRoute=hs,window.createFileRoute=ps);var js=Pe("<div><div role=status aria-label=Loading><span class=sr-only>Loading...");const Ls=e=>{const t={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"};return n=js(),s=n.firstChild,S(r=>{var i=`flex items-center justify-center ${e.class||""}`,o=`${t[e.size||"md"]} animate-spin rounded-full border-2 border-gray-300 border-t-blue-600`;return i!==r.e&&Re(n,r.e=i),o!==r.t&&Re(s,r.t=o),r},{e:void 0,t:void 0}),n;var n,s};var Ds=Pe('<div class="flex items-center justify-center min-h-[400px] w-full"><div class=text-center><p class="text-gray-400 text-sm">Loading...');const $s=()=>{return e=Ds(),t=e.firstChild,n=t.firstChild,De(t,ne(Ls,{size:"lg",class:"mb-4"}),n),e;var e,t,n},Fs={},qs=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),r=n?.nonce||n?.getAttribute("nonce");s=e(t.map(e=>{if((e=function(e){return"/"+e}(e))in Fs)return;Fs[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const s=document.createElement("link");return s.rel=t?"stylesheet":"modulepreload",t||(s.as="script"),s.crossOrigin="",s.href=e,r&&s.setAttribute("nonce",r),document.head.appendChild(s),t?new Promise((t,n)=>{s.addEventListener("load",t),s.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function r(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return s.then(t=>{for(const e of t||[])"rejected"===e.status&&r(e.reason);return e().catch(r)})},Vs=function(){return null};var Bs=Pe('<svg class="h-5 w-5 text-gray-400"fill=none viewBox="0 0 24 24"stroke=currentColor stroke-width=2><path stroke-linecap=round stroke-linejoin=round d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z">'),Ns=Pe('<svg class="h-6 w-6"fill=none viewBox="0 0 24 24"stroke=currentColor stroke-width=2><path stroke-linecap=round stroke-linejoin=round d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z">'),Us=Pe("<kbd>"),Ks=Pe('<div class="absolute inset-y-0 right-16 animate-pulse p-2 text-xs text-gray-400">...'),zs=Pe('<div class="p-4 text-center text-red-400">'),Ws=Pe('<div class="p-6 text-center text-gray-400">Loading search...'),Qs=Pe('<div class="p-6 text-center text-gray-400">Searching...'),Hs=Pe('<div class="px-2 pt-2 pb-1 text-xs text-gray-500"> result'),Gs=Pe('<ul class="divide-y divide-gray-700">'),Js=Pe('<div class="p-6 text-center text-gray-400">Please enter at least 2 characters.'),Ys=Pe('<div class="p-6 text-center text-gray-500">Start typing to search your content.'),Zs=Pe('<div class="fixed inset-0 z-50 overflow-y-auto bg-rich-black-900/90 p-4 backdrop-blur-sm"><div class="mx-auto mt-4 max-w-2xl overflow-hidden rounded-lg bg-rich-black-800 shadow-xl md:mt-16"><div class="relative flex items-center border-b border-gray-700"><div class="pointer-events-none absolute inset-y-0 left-4 flex items-center text-gray-400"></div><input type=search class="w-full appearance-none border-none bg-transparent py-3 pr-24 pl-12 text-white placeholder-gray-400 focus:ring-0 focus:outline-none"placeholder="Search content..."autocomplete=off aria-label="Search input"><button class="absolute right-4 text-sm font-medium text-indigo-400 hover:text-indigo-300">Cancel</button></div><div class="hidden flex-wrap items-center gap-x-3 gap-y-1 px-4 pt-3 pb-2 text-xs text-gray-400 lg:flex"aria-hidden=true><span>Navigate:</span><span class="flex items-center gap-1"> </span><span>Select:</span> <span>Close:</span> </div><div class="max-h-[60vh] overflow-y-auto md:max-h-[70vh]">'),Xs=Pe('<div class="p-6 text-center text-gray-400">No results found for "<!>".'),er=Pe('<li><a class="block p-4 hover:bg-rich-black-700"><div class="flex items-start gap-3 text-white"><div class="mt-1 shrink-0 text-gray-500"></div><div class="flex-1 overflow-hidden"><span class="mb-1 block truncate font-medium"></span><div class="search-excerpt line-clamp-2 text-sm text-gray-400">');const tr=()=>Bs(),nr=()=>Ns(),sr=e=>{return De(t=Us(),()=>e.children),S(()=>Re(t,`inline-flex items-center justify-center rounded border border-gray-600 bg-rich-black-700 px-1.5 py-0.5 text-xs font-semibold text-gray-300 ${e.class??""}`)),t;var t};const rr=async()=>{try{const e=await import("/pagefind/pagefind.js"),t=e.default||e;if(t&&"function"==typeof t.search)return t;throw new Error("Pagefind module loaded, but API not found or invalid.")}catch(e){throw new Error("Failed to load search functionality.")}};function ir(e){const[t,n]=w(""),[s,r]=w(-1),[i,o]=w([]),[a,l]=w(!1),[c]=O(()=>!!e.isOpen,rr,{initialValue:null});let u;C(()=>{e.isOpen?(u?.focus(),r(i().length>0?0:-1)):(n(""),o([]),r(-1),l(!1))}),C(()=>{if(e.isOpen){const e=s();if(e>=0){const t=document.querySelector(`[data-result-index="${e}"]`);t?.scrollIntoView({block:"nearest",behavior:"smooth"})}}}),C(()=>{const e=t().trim();e.length>=2?h(e):(o([]),r(-1),l(!1))});const h=function(e,t){let n;return(...s)=>{clearTimeout(n),n=window.setTimeout(()=>{e(...s)},t)}}(async e=>{const t=c();if(t){if(e.length<2)return o([]),r(-1),void l(!1);l(!0),r(-1);try{const n=await t.search(e);if(0===n.results.length)o([]);else{const e=await Promise.all(n.results.map(e=>e.data()));o(e),r(0)}}catch(n){o([])}finally{l(!1)}}},300);I(()=>{document.addEventListener("keydown",d)}),A(()=>{document.removeEventListener("keydown",d)});const d=t=>{if("Escape"===t.key&&e.isOpen)return t.preventDefault(),void e.onClose();if(!e.isOpen)return;const n=i();if(0!==n.length)switch(t.key){case"ArrowDown":t.preventDefault(),r(e=>(e+1)%n.length);break;case"ArrowUp":t.preventDefault(),r(e=>{const t=e-1;return t<0?n.length-1:t});break;case"Enter":t.preventDefault();const i=s();if(i>-1){const t=n[i];t?.url&&(window.location.href=t.url,e.onClose())}}};return ne(de,{get when(){return e.isOpen},get children(){var o=Zs(),l=o.firstChild.firstChild,h=l.firstChild,d=h.nextSibling,f=d.nextSibling,p=l.nextSibling,g=p.firstChild.nextSibling,m=g.firstChild,y=g.nextSibling.nextSibling.nextSibling;y.nextSibling;var v=p.nextSibling;o.$$click=t=>{t.target===t.currentTarget&&e.onClose()},De(h,ne(nr,{}));return"function"==typeof u?Le(u,d):u=d,d.$$input=e=>n(e.currentTarget.value),De(l,ne(de,{get when(){return a()},get children(){return Ks()}}),f),Ee(f,"click",e.onClose,!0),De(g,ne(sr,{children:"↑"}),m),De(g,ne(sr,{children:"↓"}),null),De(p,ne(sr,{children:"↵"}),y),De(p,ne(sr,{children:"Esc"}),null),De(v,ne(de,{get when(){return c.error},get children(){var e=zs();return De(e,()=>c.error?.message||"Failed to load search functionality"),e}}),null),De(v,ne(de,{get when(){return c.loading},get children(){return Ws()}}),null),De(v,ne(de,{get when(){return Me(()=>!(!a()||c.error))()&&!c.loading},get children(){return Qs()}}),null),De(v,ne(de,{get when(){return Me(()=>!(a()||c.error||c.loading))()&&t().trim().length>=2},get children(){return ne(de,{get when(){return i().length>0},get fallback(){return e=Xs(),(n=e.firstChild.nextSibling).nextSibling,De(e,t,n),e;var e,n},get children(){return[(t=Hs(),De(t,()=>i().length,t.firstChild),De(t,()=>1===i().length?"":"s",null),t),(e=Gs(),De(e,ne(he,{get each(){return i()},children:(e,t)=>{return n=er(),i=n.firstChild,o=i.firstChild.firstChild,a=o.nextSibling.firstChild,l=a.nextSibling,n.addEventListener("mouseenter",()=>r(t())),De(o,ne(tr,{})),De(a,()=>e.meta.title||"Untitled Page"),S(r=>{var o=t(),a="transition-colors duration-100 "+(t()===s()?"bg-rich-black-700/50":""),c=e.url,u=e.excerpt;return o!==r.e&&Ae(n,"data-result-index",r.e=o),a!==r.t&&Re(n,r.t=a),c!==r.a&&Ae(i,"href",r.a=c),u!==r.o&&(l.innerHTML=r.o=u),r},{e:void 0,t:void 0,a:void 0,o:void 0}),n;var n,i,o,a,l}})),e)];var e,t}})}}),null),De(v,ne(de,{get when(){return Me(()=>!(a()||c.error||c.loading||!(t().trim().length>0)))()&&t().trim().length<2},get children(){return Js()}}),null),De(v,ne(de,{get when(){return Me(()=>!(c.error||c.loading))()&&0===t().trim().length},get children(){return Ys()}}),null),S(()=>d.value=t()),o}})}Ie(["click","input"]);var or=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},ar="undefined"==typeof window||"Deno"in globalThis;function lr(){}function cr(e){return"number"==typeof e&&e>=0&&e!==1/0}function ur(e,t){return Math.max(e+(t||0)-Date.now(),0)}function hr(e,t){return"function"==typeof e?e(t):e}function dr(e,t){return"function"==typeof e?e(t):e}function fr(e,t){const{type:n="all",exact:s,fetchStatus:r,predicate:i,queryKey:o,stale:a}=e;if(o)if(s){if(t.queryHash!==gr(o,t.options))return!1}else if(!yr(t.queryKey,o))return!1;if("all"!==n){const e=t.isActive();if("active"===n&&!e)return!1;if("inactive"===n&&e)return!1}return("boolean"!=typeof a||t.isStale()===a)&&((!r||r===t.state.fetchStatus)&&!(i&&!i(t)))}function pr(e,t){const{exact:n,status:s,predicate:r,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(mr(t.options.mutationKey)!==mr(i))return!1}else if(!yr(t.options.mutationKey,i))return!1}return(!s||t.state.status===s)&&!(r&&!r(t))}function gr(e,t){return(t?.queryKeyHashFn||mr)(e)}function mr(e){return JSON.stringify(e,(e,t)=>xr(t)?Object.keys(t).sort().reduce((e,n)=>(e[n]=t[n],e),{}):t)}function yr(e,t){return e===t||typeof e==typeof t&&(!(!e||!t||"object"!=typeof e||"object"!=typeof t)&&Object.keys(t).every(n=>yr(e[n],t[n])))}function vr(e,t){if(e===t)return e;const n=wr(e)&&wr(t);if(n||xr(e)&&xr(t)){const s=n?e:Object.keys(e),r=s.length,i=n?t:Object.keys(t),o=i.length,a=n?[]:{},l=new Set(s);let c=0;for(let u=0;u<o;u++){const s=n?u:i[u];(!n&&l.has(s)||n)&&void 0===e[s]&&void 0===t[s]?(a[s]=void 0,c++):(a[s]=vr(e[s],t[s]),a[s]===e[s]&&void 0!==e[s]&&c++)}return r===o&&c===r?e:a}return t}function br(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function wr(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function xr(e){if(!Sr(e))return!1;const t=e.constructor;if(void 0===t)return!0;const n=t.prototype;return!!Sr(n)&&(!!n.hasOwnProperty("isPrototypeOf")&&Object.getPrototypeOf(e)===Object.prototype)}function Sr(e){return"[object Object]"===Object.prototype.toString.call(e)}function Cr(e,t,n){return"function"==typeof n.structuralSharing?n.structuralSharing(e,t):!1!==n.structuralSharing?vr(e,t):t}function kr(e,t,n=0){const s=[...e,t];return n&&s.length>n?s.slice(1):s}function Or(e,t,n=0){const s=[t,...e];return n&&s.length>n?s.slice(0,-1):s}var Mr=Symbol();function _r(e,t){return!e.queryFn&&t?.initialPromise?()=>t.initialPromise:e.queryFn&&e.queryFn!==Mr?e.queryFn:()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`))}function Pr(e,t){return"function"==typeof e?e(...t):!!e}var Ir=new class extends or{#e;#t;#n;constructor(){super(),this.#n=e=>{if(!ar&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#n=e,this.#t?.(),this.#t=e(e=>{"boolean"==typeof e?this.setFocused(e):this.onFocus()})}setFocused(e){this.#e!==e&&(this.#e=e,this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){return"boolean"==typeof this.#e?this.#e:"hidden"!==globalThis.document?.visibilityState}},Ar=new class extends or{#s=!0;#t;#n;constructor(){super(),this.#n=e=>{if(!ar&&window.addEventListener){const t=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#n=e,this.#t?.(),this.#t=e(this.setOnline.bind(this))}setOnline(e){this.#s!==e&&(this.#s=e,this.listeners.forEach(t=>{t(e)}))}isOnline(){return this.#s}};function Rr(){let e,t;const n=new Promise((n,s)=>{e=n,t=s});function s(e){Object.assign(n,e),delete n.resolve,delete n.reject}return n.status="pending",n.catch(()=>{}),n.resolve=t=>{s({status:"fulfilled",value:t}),e(t)},n.reject=e=>{s({status:"rejected",reason:e}),t(e)},n}function Er(e){return Math.min(1e3*2**e,3e4)}function Tr(e){return"online"!==(e??"online")||Ar.isOnline()}var jr=class extends Error{constructor(e){super("CancelledError"),this.revert=e?.revert,this.silent=e?.silent}};function Lr(e){return e instanceof jr}function Dr(e){let t,n=!1,s=0,r=!1;const i=Rr(),o=()=>Ir.isFocused()&&("always"===e.networkMode||Ar.isOnline())&&e.canRun(),a=()=>Tr(e.networkMode)&&e.canRun(),l=n=>{r||(r=!0,e.onSuccess?.(n),t?.(),i.resolve(n))},c=n=>{r||(r=!0,e.onError?.(n),t?.(),i.reject(n))},u=()=>new Promise(n=>{t=e=>{(r||o())&&n(e)},e.onPause?.()}).then(()=>{t=void 0,r||e.onContinue?.()}),h=()=>{if(r)return;let t;const i=0===s?e.initialPromise:void 0;try{t=i??e.fn()}catch(a){t=Promise.reject(a)}Promise.resolve(t).then(l).catch(t=>{if(r)return;const i=e.retry??(ar?0:3),a=e.retryDelay??Er,l="function"==typeof a?a(s,t):a,d=!0===i||"number"==typeof i&&s<i||"function"==typeof i&&i(s,t);var f;!n&&d?(s++,e.onFail?.(s,t),(f=l,new Promise(e=>{setTimeout(e,f)})).then(()=>o()?void 0:u()).then(()=>{n?c(t):h()})):c(t)})};return{promise:i,cancel:t=>{r||(c(new jr(t)),e.abort?.())},continue:()=>(t?.(),i),cancelRetry:()=>{n=!0},continueRetry:()=>{n=!1},canStart:a,start:()=>(a()?h():u().then(h),i)}}var $r=e=>setTimeout(e,0);var Fr=function(){let e=[],t=0,n=e=>{e()},s=e=>{e()},r=$r;const i=s=>{t?e.push(s):r(()=>{n(s)})};return{batch:i=>{let o;t++;try{o=i()}finally{t--,t||(()=>{const t=e;e=[],t.length&&r(()=>{s(()=>{t.forEach(e=>{n(e)})})})})()}return o},batchCalls:e=>(...t)=>{i(()=>{e(...t)})},schedule:i,setNotifyFunction:e=>{n=e},setBatchNotifyFunction:e=>{s=e},setScheduler:e=>{r=e}}}(),qr=class{#r;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),cr(this.gcTime)&&(this.#r=setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(ar?1/0:3e5))}clearGcTimeout(){this.#r&&(clearTimeout(this.#r),this.#r=void 0)}},Vr=class extends qr{#i;#o;#a;#l;#c;#u;#h;constructor(e){super(),this.#h=!1,this.#u=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#l=e.client,this.#a=this.#l.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#i=function(e){const t="function"==typeof e.initialData?e.initialData():e.initialData,n=void 0!==t,s=n?"function"==typeof e.initialDataUpdatedAt?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}(this.options),this.state=e.state??this.#i,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#c?.promise}setOptions(e){this.options={...this.#u,...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){this.observers.length||"idle"!==this.state.fetchStatus||this.#a.remove(this)}setData(e,t){const n=Cr(this.state.data,e,this.options);return this.#d({data:n,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),n}setState(e,t){this.#d({type:"setState",state:e,setStateOptions:t})}cancel(e){const t=this.#c?.promise;return this.#c?.cancel(e),t?t.then(lr).catch(lr):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#i)}isActive(){return this.observers.some(e=>!1!==dr(e.options.enabled,this))}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Mr||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0&&this.observers.some(e=>"static"===hr(e.options.staleTime,this))}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):void 0===this.state.data||this.state.isInvalidated}isStaleByTime(e=0){return void 0===this.state.data||"static"!==e&&(!!this.state.isInvalidated||!ur(this.state.dataUpdatedAt,e))}onFocus(){const e=this.observers.find(e=>e.shouldFetchOnWindowFocus());e?.refetch({cancelRefetch:!1}),this.#c?.continue()}onOnline(){const e=this.observers.find(e=>e.shouldFetchOnReconnect());e?.refetch({cancelRefetch:!1}),this.#c?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#a.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(this.#c&&(this.#h?this.#c.cancel({revert:!0}):this.#c.cancelRetry()),this.scheduleGc()),this.#a.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#d({type:"invalidate"})}fetch(e,t){if("idle"!==this.state.fetchStatus)if(void 0!==this.state.data&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#c)return this.#c.continueRetry(),this.#c.promise;if(e&&this.setOptions(e),!this.options.queryFn){const e=this.observers.find(e=>e.options.queryFn);e&&this.setOptions(e.options)}const n=new AbortController,s=e=>{Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(this.#h=!0,n.signal)})},r=()=>{const e=_r(this.options,t),n=(()=>{const e={client:this.#l,queryKey:this.queryKey,meta:this.meta};return s(e),e})();return this.#h=!1,this.options.persister?this.options.persister(e,n,this):e(n)},i=(()=>{const e={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#l,state:this.state,fetchFn:r};return s(e),e})();this.options.behavior?.onFetch(i,this),this.#o=this.state,"idle"!==this.state.fetchStatus&&this.state.fetchMeta===i.fetchOptions?.meta||this.#d({type:"fetch",meta:i.fetchOptions?.meta});const o=e=>{Lr(e)&&e.silent||this.#d({type:"error",error:e}),Lr(e)||(this.#a.config.onError?.(e,this),this.#a.config.onSettled?.(this.state.data,e,this)),this.scheduleGc()};return this.#c=Dr({initialPromise:t?.initialPromise,fn:i.fetchFn,abort:n.abort.bind(n),onSuccess:e=>{if(void 0!==e){try{this.setData(e)}catch(t){return void o(t)}this.#a.config.onSuccess?.(e,this),this.#a.config.onSettled?.(e,this.state.error,this),this.scheduleGc()}else o(new Error(`${this.queryHash} data is undefined`))},onError:o,onFail:(e,t)=>{this.#d({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#d({type:"pause"})},onContinue:()=>{this.#d({type:"continue"})},retry:i.options.retry,retryDelay:i.options.retryDelay,networkMode:i.options.networkMode,canRun:()=>!0}),this.#c.start()}#d(e){this.state=(t=>{switch(e.type){case"failed":return{...t,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...t,fetchStatus:"paused"};case"continue":return{...t,fetchStatus:"fetching"};case"fetch":return{...t,...Br(t.data,this.options),fetchMeta:e.meta??null};case"success":return this.#o=void 0,{...t,data:e.data,dataUpdateCount:t.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const n=e.error;return Lr(n)&&n.revert&&this.#o?{...this.#o,fetchStatus:"idle"}:{...t,error:n,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error"};case"invalidate":return{...t,isInvalidated:!0};case"setState":return{...t,...e.state}}})(this.state),Fr.batch(()=>{this.observers.forEach(e=>{e.onQueryUpdate()}),this.#a.notify({query:this,type:"updated",action:e})})}};function Br(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Tr(t.networkMode)?"fetching":"paused",...void 0===e&&{error:null,status:"pending"}}}var Nr=class extends or{constructor(e={}){super(),this.config=e,this.#f=new Map}#f;build(e,t,n){const s=t.queryKey,r=t.queryHash??gr(s,t);let i=this.get(r);return i||(i=new Vr({client:e,queryKey:s,queryHash:r,options:e.defaultQueryOptions(t),state:n,defaultOptions:e.getQueryDefaults(s)}),this.add(i)),i}add(e){this.#f.has(e.queryHash)||(this.#f.set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=this.#f.get(e.queryHash);t&&(e.destroy(),t===e&&this.#f.delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Fr.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return this.#f.get(e)}getAll(){return[...this.#f.values()]}find(e){const t={exact:!0,...e};return this.getAll().find(e=>fr(t,e))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(t=>fr(e,t)):t}notify(e){Fr.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){Fr.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Fr.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Ur=class extends qr{#p;#g;#c;constructor(e){super(),this.mutationId=e.mutationId,this.#g=e.mutationCache,this.#p=[],this.state=e.state||{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0},this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#p.includes(e)||(this.#p.push(e),this.clearGcTimeout(),this.#g.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#p=this.#p.filter(t=>t!==e),this.scheduleGc(),this.#g.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#p.length||("pending"===this.state.status?this.scheduleGc():this.#g.remove(this))}continue(){return this.#c?.continue()??this.execute(this.state.variables)}async execute(e){const t=()=>{this.#d({type:"continue"})};this.#c=Dr({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(e,t)=>{this.#d({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#d({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#g.canRun(this)});const n="pending"===this.state.status,s=!this.#c.canStart();try{if(n)t();else{this.#d({type:"pending",variables:e,isPaused:s}),await(this.#g.config.onMutate?.(e,this));const t=await(this.options.onMutate?.(e));t!==this.state.context&&this.#d({type:"pending",context:t,variables:e,isPaused:s})}const r=await this.#c.start();return await(this.#g.config.onSuccess?.(r,e,this.state.context,this)),await(this.options.onSuccess?.(r,e,this.state.context)),await(this.#g.config.onSettled?.(r,null,this.state.variables,this.state.context,this)),await(this.options.onSettled?.(r,null,e,this.state.context)),this.#d({type:"success",data:r}),r}catch(r){try{throw await(this.#g.config.onError?.(r,e,this.state.context,this)),await(this.options.onError?.(r,e,this.state.context)),await(this.#g.config.onSettled?.(void 0,r,this.state.variables,this.state.context,this)),await(this.options.onSettled?.(void 0,r,e,this.state.context)),r}finally{this.#d({type:"error",error:r})}}finally{this.#g.runNext(this)}}#d(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),Fr.batch(()=>{this.#p.forEach(t=>{t.onMutationUpdate(e)}),this.#g.notify({mutation:this,type:"updated",action:e})})}};var Kr=class extends or{constructor(e={}){super(),this.config=e,this.#m=new Set,this.#y=new Map,this.#v=0}#m;#y;#v;build(e,t,n){const s=new Ur({mutationCache:this,mutationId:++this.#v,options:e.defaultMutationOptions(t),state:n});return this.add(s),s}add(e){this.#m.add(e);const t=zr(e);if("string"==typeof t){const n=this.#y.get(t);n?n.push(e):this.#y.set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(this.#m.delete(e)){const t=zr(e);if("string"==typeof t){const n=this.#y.get(t);if(n)if(n.length>1){const t=n.indexOf(e);-1!==t&&n.splice(t,1)}else n[0]===e&&this.#y.delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=zr(e);if("string"==typeof t){const n=this.#y.get(t),s=n?.find(e=>"pending"===e.state.status);return!s||s===e}return!0}runNext(e){const t=zr(e);if("string"==typeof t){const n=this.#y.get(t)?.find(t=>t!==e&&t.state.isPaused);return n?.continue()??Promise.resolve()}return Promise.resolve()}clear(){Fr.batch(()=>{this.#m.forEach(e=>{this.notify({type:"removed",mutation:e})}),this.#m.clear(),this.#y.clear()})}getAll(){return Array.from(this.#m)}find(e){const t={exact:!0,...e};return this.getAll().find(e=>pr(t,e))}findAll(e={}){return this.getAll().filter(t=>pr(e,t))}notify(e){Fr.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(e=>e.state.isPaused);return Fr.batch(()=>Promise.all(e.map(e=>e.continue().catch(lr))))}};function zr(e){return e.options.scope?.id}function Wr(e){return{onFetch:(t,n)=>{const s=t.options,r=t.fetchOptions?.meta?.fetchMore?.direction,i=t.state.data?.pages||[],o=t.state.data?.pageParams||[];let a={pages:[],pageParams:[]},l=0;const c=async()=>{let n=!1;const c=_r(t.options,t.fetchOptions),u=async(e,s,r)=>{if(n)return Promise.reject();if(null==s&&e.pages.length)return Promise.resolve(e);const i=(()=>{const e={client:t.client,queryKey:t.queryKey,pageParam:s,direction:r?"backward":"forward",meta:t.options.meta};var i;return i=e,Object.defineProperty(i,"signal",{enumerable:!0,get:()=>(t.signal.aborted?n=!0:t.signal.addEventListener("abort",()=>{n=!0}),t.signal)}),e})(),o=await c(i),{maxPages:a}=t.options,l=r?Or:kr;return{pages:l(e.pages,o,a),pageParams:l(e.pageParams,s,a)}};if(r&&i.length){const e="backward"===r,t={pages:i,pageParams:o},n=(e?Hr:Qr)(s,t);a=await u(t,n,e)}else{const t=e??i.length;do{const e=0===l?o[0]??s.initialPageParam:Qr(s,a);if(l>0&&null==e)break;a=await u(a,e),l++}while(l<t)}return a};t.options.persister?t.fetchFn=()=>t.options.persister?.(c,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n):t.fetchFn=c}}}function Qr(e,{pages:t,pageParams:n}){const s=t.length-1;return t.length>0?e.getNextPageParam(t[s],t,n[s],n):void 0}function Hr(e,{pages:t,pageParams:n}){return t.length>0?e.getPreviousPageParam?.(t[0],t,n[0],n):void 0}var Gr=class{#b;#g;#u;#w;#x;#S;#C;#k;constructor(e={}){this.#b=e.queryCache||new Nr,this.#g=e.mutationCache||new Kr,this.#u=e.defaultOptions||{},this.#w=new Map,this.#x=new Map,this.#S=0}mount(){this.#S++,1===this.#S&&(this.#C=Ir.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#b.onFocus())}),this.#k=Ar.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#b.onOnline())}))}unmount(){this.#S--,0===this.#S&&(this.#C?.(),this.#C=void 0,this.#k?.(),this.#k=void 0)}isFetching(e){return this.#b.findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return this.#g.findAll({...e,status:"pending"}).length}getQueryData(e){const t=this.defaultQueryOptions({queryKey:e});return this.#b.get(t.queryHash)?.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=this.#b.build(this,t),s=n.state.data;return void 0===s?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(hr(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(s))}getQueriesData(e){return this.#b.findAll(e).map(({queryKey:e,state:t})=>[e,t.data])}setQueryData(e,t,n){const s=this.defaultQueryOptions({queryKey:e}),r=this.#b.get(s.queryHash),i=r?.state.data,o=function(e,t){return"function"==typeof e?e(t):e}(t,i);if(void 0!==o)return this.#b.build(this,s).setData(o,{...n,manual:!0})}setQueriesData(e,t,n){return Fr.batch(()=>this.#b.findAll(e).map(({queryKey:e})=>[e,this.setQueryData(e,t,n)]))}getQueryState(e){const t=this.defaultQueryOptions({queryKey:e});return this.#b.get(t.queryHash)?.state}removeQueries(e){const t=this.#b;Fr.batch(()=>{t.findAll(e).forEach(e=>{t.remove(e)})})}resetQueries(e,t){const n=this.#b;return Fr.batch(()=>(n.findAll(e).forEach(e=>{e.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},s=Fr.batch(()=>this.#b.findAll(e).map(e=>e.cancel(n)));return Promise.all(s).then(lr).catch(lr)}invalidateQueries(e,t={}){return Fr.batch(()=>(this.#b.findAll(e).forEach(e=>{e.invalidate()}),"none"===e?.refetchType?Promise.resolve():this.refetchQueries({...e,type:e?.refetchType??e?.type??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},s=Fr.batch(()=>this.#b.findAll(e).filter(e=>!e.isDisabled()&&!e.isStatic()).map(e=>{let t=e.fetch(void 0,n);return n.throwOnError||(t=t.catch(lr)),"paused"===e.state.fetchStatus?Promise.resolve():t}));return Promise.all(s).then(lr)}fetchQuery(e){const t=this.defaultQueryOptions(e);void 0===t.retry&&(t.retry=!1);const n=this.#b.build(this,t);return n.isStaleByTime(hr(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(lr).catch(lr)}fetchInfiniteQuery(e){return e.behavior=Wr(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(lr).catch(lr)}ensureInfiniteQueryData(e){return e.behavior=Wr(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Ar.isOnline()?this.#g.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#b}getMutationCache(){return this.#g}getDefaultOptions(){return this.#u}setDefaultOptions(e){this.#u=e}setQueryDefaults(e,t){this.#w.set(mr(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...this.#w.values()],n={};return t.forEach(t=>{yr(e,t.queryKey)&&Object.assign(n,t.defaultOptions)}),n}setMutationDefaults(e,t){this.#x.set(mr(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...this.#x.values()],n={};return t.forEach(t=>{yr(e,t.mutationKey)&&Object.assign(n,t.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...this.#u.queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=gr(t.queryKey,t)),void 0===t.refetchOnReconnect&&(t.refetchOnReconnect="always"!==t.networkMode),void 0===t.throwOnError&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Mr&&(t.enabled=!1),t}defaultMutationOptions(e){return e?._defaulted?e:{...this.#u.mutations,...e?.mutationKey&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){this.#b.clear(),this.#g.clear()}},Jr=class extends or{constructor(e,t){super(),this.options=t,this.#l=e,this.#O=null,this.#M=Rr(),this.options.experimental_prefetchInRender||this.#M.reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(t)}#l;#_=void 0;#P=void 0;#I=void 0;#A;#R;#M;#O;#E;#T;#j;#L;#D;#$;#F=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#_.addObserver(this),Yr(this.#_,this.options)?this.#q():this.updateResult(),this.#V())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Zr(this.#_,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Zr(this.#_,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#B(),this.#N(),this.#_.removeObserver(this)}setOptions(e){const t=this.options,n=this.#_;if(this.options=this.#l.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof dr(this.options.enabled,this.#_))throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#U(),this.#_.setOptions(this.options),t._defaulted&&!br(this.options,t)&&this.#l.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#_,observer:this});const s=this.hasListeners();s&&Xr(this.#_,n,this.options,t)&&this.#q(),this.updateResult(),!s||this.#_===n&&dr(this.options.enabled,this.#_)===dr(t.enabled,this.#_)&&hr(this.options.staleTime,this.#_)===hr(t.staleTime,this.#_)||this.#K();const r=this.#z();!s||this.#_===n&&dr(this.options.enabled,this.#_)===dr(t.enabled,this.#_)&&r===this.#$||this.#W(r)}getOptimisticResult(e){const t=this.#l.getQueryCache().build(this.#l,e),n=this.createResult(t,e);return function(e,t){if(!br(e.getCurrentResult(),t))return!0;return!1}(this,n)&&(this.#I=n,this.#R=this.options,this.#A=this.#_.state),n}getCurrentResult(){return this.#I}trackResult(e,t){return new Proxy(e,{get:(e,n)=>(this.trackProp(n),t?.(n),Reflect.get(e,n))})}trackProp(e){this.#F.add(e)}getCurrentQuery(){return this.#_}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=this.#l.defaultQueryOptions(e),n=this.#l.getQueryCache().build(this.#l,t);return n.fetch().then(()=>this.createResult(n,t))}fetch(e){return this.#q({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#I))}#q(e){this.#U();let t=this.#_.fetch(this.options,e);return e?.throwOnError||(t=t.catch(lr)),t}#K(){this.#B();const e=hr(this.options.staleTime,this.#_);if(ar||this.#I.isStale||!cr(e))return;const t=ur(this.#I.dataUpdatedAt,e)+1;this.#L=setTimeout(()=>{this.#I.isStale||this.updateResult()},t)}#z(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#_):this.options.refetchInterval)??!1}#W(e){this.#N(),this.#$=e,!ar&&!1!==dr(this.options.enabled,this.#_)&&cr(this.#$)&&0!==this.#$&&(this.#D=setInterval(()=>{(this.options.refetchIntervalInBackground||Ir.isFocused())&&this.#q()},this.#$))}#V(){this.#K(),this.#W(this.#z())}#B(){this.#L&&(clearTimeout(this.#L),this.#L=void 0)}#N(){this.#D&&(clearInterval(this.#D),this.#D=void 0)}createResult(e,t){const n=this.#_,s=this.options,r=this.#I,i=this.#A,o=this.#R,a=e!==n?e.state:this.#P,{state:l}=e;let c,u={...l},h=!1;if(t._optimisticResults){const r=this.hasListeners(),i=!r&&Yr(e,t),o=r&&Xr(e,n,t,s);(i||o)&&(u={...u,...Br(l.data,e.options)}),"isRestoring"===t._optimisticResults&&(u.fetchStatus="idle")}let{error:d,errorUpdatedAt:f,status:p}=u;c=u.data;let g=!1;if(void 0!==t.placeholderData&&void 0===c&&"pending"===p){let e;r?.isPlaceholderData&&t.placeholderData===o?.placeholderData?(e=r.data,g=!0):e="function"==typeof t.placeholderData?t.placeholderData(this.#j?.state.data,this.#j):t.placeholderData,void 0!==e&&(p="success",c=Cr(r?.data,e,t),h=!0)}if(t.select&&void 0!==c&&!g)if(r&&c===i?.data&&t.select===this.#E)c=this.#T;else try{this.#E=t.select,c=t.select(c),c=Cr(r?.data,c,t),this.#T=c,this.#O=null}catch(S){this.#O=S}this.#O&&(d=this.#O,c=this.#T,f=Date.now(),p="error");const m="fetching"===u.fetchStatus,y="pending"===p,v="error"===p,b=y&&m,w=void 0!==c,x={status:p,fetchStatus:u.fetchStatus,isPending:y,isSuccess:"success"===p,isError:v,isInitialLoading:b,isLoading:b,data:c,dataUpdatedAt:u.dataUpdatedAt,error:d,errorUpdatedAt:f,failureCount:u.fetchFailureCount,failureReason:u.fetchFailureReason,errorUpdateCount:u.errorUpdateCount,isFetched:u.dataUpdateCount>0||u.errorUpdateCount>0,isFetchedAfterMount:u.dataUpdateCount>a.dataUpdateCount||u.errorUpdateCount>a.errorUpdateCount,isFetching:m,isRefetching:m&&!y,isLoadingError:v&&!w,isPaused:"paused"===u.fetchStatus,isPlaceholderData:h,isRefetchError:v&&w,isStale:ei(e,t),refetch:this.refetch,promise:this.#M,isEnabled:!1!==dr(t.enabled,e)};if(this.options.experimental_prefetchInRender){const t=e=>{"error"===x.status?e.reject(x.error):void 0!==x.data&&e.resolve(x.data)},s=()=>{const e=this.#M=x.promise=Rr();t(e)},r=this.#M;switch(r.status){case"pending":e.queryHash===n.queryHash&&t(r);break;case"fulfilled":"error"!==x.status&&x.data===r.value||s();break;case"rejected":"error"===x.status&&x.error===r.reason||s()}}return x}updateResult(){const e=this.#I,t=this.createResult(this.#_,this.options);if(this.#A=this.#_.state,this.#R=this.options,void 0!==this.#A.data&&(this.#j=this.#_),br(t,e))return;this.#I=t;this.#Q({listeners:(()=>{if(!e)return!0;const{notifyOnChangeProps:t}=this.options,n="function"==typeof t?t():t;if("all"===n||!n&&!this.#F.size)return!0;const s=new Set(n??this.#F);return this.options.throwOnError&&s.add("error"),Object.keys(this.#I).some(t=>{const n=t;return this.#I[n]!==e[n]&&s.has(n)})})()})}#U(){const e=this.#l.getQueryCache().build(this.#l,this.options);if(e===this.#_)return;const t=this.#_;this.#_=e,this.#P=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#V()}#Q(e){Fr.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e(this.#I)}),this.#l.getQueryCache().notify({query:this.#_,type:"observerResultsUpdated"})})}};function Yr(e,t){return function(e,t){return!1!==dr(t.enabled,e)&&void 0===e.state.data&&!("error"===e.state.status&&!1===t.retryOnMount)}(e,t)||void 0!==e.state.data&&Zr(e,t,t.refetchOnMount)}function Zr(e,t,n){if(!1!==dr(t.enabled,e)&&"static"!==hr(t.staleTime,e)){const s="function"==typeof n?n(e):n;return"always"===s||!1!==s&&ei(e,t)}return!1}function Xr(e,t,n,s){return(e!==t||!1===dr(s.enabled,e))&&(!n.suspense||"error"!==e.state.status)&&ei(e,n)}function ei(e,t){return!1!==dr(t.enabled,e)&&e.isStaleByTime(hr(t.staleTime,e))}var ti=class extends or{#l;#I=void 0;#H;#G;constructor(e,t){super(),this.#l=e,this.setOptions(t),this.bindMethods(),this.#J()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const t=this.options;this.options=this.#l.defaultMutationOptions(e),br(this.options,t)||this.#l.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#H,observer:this}),t?.mutationKey&&this.options.mutationKey&&mr(t.mutationKey)!==mr(this.options.mutationKey)?this.reset():"pending"===this.#H?.state.status&&this.#H.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#H?.removeObserver(this)}onMutationUpdate(e){this.#J(),this.#Q(e)}getCurrentResult(){return this.#I}reset(){this.#H?.removeObserver(this),this.#H=void 0,this.#J(),this.#Q()}mutate(e,t){return this.#G=t,this.#H?.removeObserver(this),this.#H=this.#l.getMutationCache().build(this.#l,this.options),this.#H.addObserver(this),this.#H.execute(e)}#J(){const e=this.#H?.state??{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0};this.#I={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#Q(e){Fr.batch(()=>{if(this.#G&&this.hasListeners()){const t=this.#I.variables,n=this.#I.context;"success"===e?.type?(this.#G.onSuccess?.(e.data,t,n),this.#G.onSettled?.(e.data,null,t,n)):"error"===e?.type&&(this.#G.onError?.(e.error,t,n),this.#G.onSettled?.(void 0,e.error,t,n))}this.listeners.forEach(e=>{e(this.#I)})})}};function ni(e){return e}function si(e,t,n){if("object"!=typeof t||null===t)return;const s=e.getMutationCache(),r=e.getQueryCache(),i=e.getDefaultOptions().hydrate?.deserializeData??ni,o=t.mutations||[],a=t.queries||[];o.forEach(({state:t,...r})=>{s.build(e,{...e.getDefaultOptions().hydrate?.mutations,...n?.defaultOptions?.mutations,...r},t)}),a.forEach(({queryKey:t,state:s,queryHash:o,meta:a,promise:l,dehydratedAt:c})=>{const u=l?function(e){let t;if(e.then(e=>(t=e,e),lr)?.catch(lr),void 0!==t)return{data:t}}(l):void 0,h=void 0===s.data?u?.data:s.data,d=void 0===h?h:i(h);let f=r.get(o);const p="pending"===f?.state.status,g="fetching"===f?.state.fetchStatus;if(f){const e=u&&void 0!==c&&c>f.state.dataUpdatedAt;if(s.dataUpdatedAt>f.state.dataUpdatedAt||e){const{fetchStatus:e,...t}=s;f.setState({...t,data:d})}}else f=r.build(e,{...e.getDefaultOptions().hydrate?.queries,...n?.defaultOptions?.queries,queryKey:t,queryHash:o,meta:a},{...s,data:d,fetchStatus:"idle",status:void 0!==d?"success":s.status});l&&!p&&!g&&(void 0===c||c>f.state.dataUpdatedAt)&&f.fetch(void 0,{initialPromise:Promise.resolve(l).then(i)})})}var ri=j(void 0),ii=e=>{if(e)return e;const t=L(ri);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t()},oi=e=>(S(t=>(t?.(),e.client.mount(),e.client.unmount.bind(e.client))),A(()=>e.client.unmount()),ne(ri.Provider,{value:()=>e.client,get children(){return e.children}})),ai=j(()=>!1);ai.Provider;function li(e,t,n){const s=k(()=>ii(n?.())),r=L(ai),i=k(()=>{const t=s().defaultQueryOptions(e());return t._optimisticResults=r()?"isRestoring":"optimistic",t.structuralSharing=!1,t}),o=i(),[a,l]=w(new t(s(),i()));let c=a().getOptimisticResult(i());const[u,h]=Kn(c),d=()=>a().subscribe(e=>{c=e,queueMicrotask(()=>{p&&y()})});function f(e){const t=a().options,n=t.reconcile;h(s=>function(e,t,n){if(!1===n)return t;if("function"==typeof n){const s=n(e.data,t.data);return{...t,data:s}}let s=t.data;if(void 0===e.data)try{s=structuredClone(s)}catch(i){}const r=Qn(s,{key:n})(e.data);return{...t,data:r}}(s,e,void 0!==n&&n,t.queryHash))}let p=null,g=null;const[m,{refetch:y}]=O(()=>{const e=a();return new Promise((t,n)=>(g=t,p||r()||(p=d()),e.updateResult(),c.isError&&!c.isFetching&&!r()&&Pr(e.options.throwOnError,[c.error,e.getCurrentQuery()])?(f(c),n(c.error)):c.isLoading?void f(c):(g=null,t((e.getCurrentQuery(),c)))))},{storage:function(){return[()=>u,e=>{const t=Dn(u);if("function"==typeof e&&(e=e(t)),e?.hydrationData){const{hydrationData:t,...n}=e;e=n}f(e)}]},get deferStream(){return e().deferStream},onHydrated(e,t){if(t.value&&"hydrationData"in t.value&&si(s(),{queries:[{...t.value.hydrationData}]}),p)return;const n={...o};!o.staleTime&&o.initialData||!t.value||(n.refetchOnMount=!1),a().setOptions(n),f(a().getOptimisticResult(n)),p=d()}});x(P(s,e=>{p&&p();const n=new t(e,i());p=d(),l(n)},{defer:!0})),x(P(r,e=>{e||y()},{defer:!0})),A(()=>{p&&(p(),p=null),g&&(g(c),g=null)}),x(P([a,i],([e,t])=>{e.setOptions(t),f(e.getOptimisticResult(t)),y()},{defer:!0}));return new Proxy(u,{get:(e,t)=>"data"===t?void 0!==u.data?m.latest?.data:m()?.data:Reflect.get(e,t)})}function ci(e,t){return li(k(()=>e()),Jr,t)}function ui(e,t){const n=k(()=>ii(t?.())),s=new ti(n(),e()),r=(e,t)=>{s.mutate(e,t).catch(lr)},[i,o]=Kn({...s.getCurrentResult(),mutate:r,mutateAsync:s.getCurrentResult().mutate});x(()=>{s.setOptions(e())}),x(P(()=>i.status,()=>{if(i.isError&&Pr(s.options.throwOnError,[i.error]))throw i.error}));return A(s.subscribe(e=>{o({...e,mutate:r,mutateAsync:e.mutate})})),i}class hi extends Error{constructor(e){super("ClientResponseError"),this.url="",this.status=0,this.response={},this.isAbort=!1,this.originalError=null,Object.setPrototypeOf(this,hi.prototype),null!==e&&"object"==typeof e&&(this.url="string"==typeof e.url?e.url:"",this.status="number"==typeof e.status?e.status:0,this.isAbort=!!e.isAbort,this.originalError=e.originalError,null!==e.response&&"object"==typeof e.response?this.response=e.response:null!==e.data&&"object"==typeof e.data?this.response=e.data:this.response={}),this.originalError||e instanceof hi||(this.originalError=e),"undefined"!=typeof DOMException&&e instanceof DOMException&&(this.isAbort=!0),this.name="ClientResponseError "+this.status,this.message=this.response?.message,this.message||(this.isAbort?this.message="The request was autocancelled. You can find more info in https://github.com/pocketbase/js-sdk#auto-cancellation.":this.originalError?.cause?.message?.includes("ECONNREFUSED ::1")?this.message="Failed to connect to the PocketBase server. Try changing the SDK URL from localhost to 127.0.0.1 (https://github.com/pocketbase/js-sdk/issues/21).":this.message="Something went wrong."),this.cause=this.originalError}get data(){return this.response}toJSON(){return{...this}}}const di=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function fi(e,t,n){const s=Object.assign({},n||{}),r=s.encode||gi;if(!di.test(e))throw new TypeError("argument name is invalid");const i=r(t);if(i&&!di.test(i))throw new TypeError("argument val is invalid");let o=e+"="+i;if(null!=s.maxAge){const e=s.maxAge-0;if(isNaN(e)||!isFinite(e))throw new TypeError("option maxAge is invalid");o+="; Max-Age="+Math.floor(e)}if(s.domain){if(!di.test(s.domain))throw new TypeError("option domain is invalid");o+="; Domain="+s.domain}if(s.path){if(!di.test(s.path))throw new TypeError("option path is invalid");o+="; Path="+s.path}if(s.expires){if(a=s.expires,!("[object Date]"===Object.prototype.toString.call(a)||a instanceof Date)||isNaN(s.expires.valueOf()))throw new TypeError("option expires is invalid");o+="; Expires="+s.expires.toUTCString()}var a;if(s.httpOnly&&(o+="; HttpOnly"),s.secure&&(o+="; Secure"),s.priority)switch("string"==typeof s.priority?s.priority.toLowerCase():s.priority){case"low":o+="; Priority=Low";break;case"medium":o+="; Priority=Medium";break;case"high":o+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(s.sameSite)switch("string"==typeof s.sameSite?s.sameSite.toLowerCase():s.sameSite){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return o}function pi(e){return-1!==e.indexOf("%")?decodeURIComponent(e):e}function gi(e){return encodeURIComponent(e)}const mi="undefined"!=typeof navigator&&"ReactNative"===navigator.product||"undefined"!=typeof global&&global.HermesInternal;let yi;function vi(e){if(e)try{const t=decodeURIComponent(yi(e.split(".")[1]).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(t)||{}}catch(t){}return{}}function bi(e,t=0){let n=vi(e);return!(Object.keys(n).length>0&&(!n.exp||n.exp-t>Date.now()/1e3))}yi="function"!=typeof atob||mi?e=>{let t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,s,r=0,i=0,o="";s=t.charAt(i++);~s&&(n=r%4?64*n+s:s,r++%4)?o+=String.fromCharCode(255&n>>(-2*r&6)):0)s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(s);return o}:atob;const wi="pb_auth";class xi{constructor(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}get token(){return this.baseToken}get record(){return this.baseModel}get model(){return this.baseModel}get isValid(){return!bi(this.token)}get isSuperuser(){let e=vi(this.token);return"auth"==e.type&&("_superusers"==this.record?.collectionName||!this.record?.collectionName&&"pbc_3142635823"==e.collectionId)}get isAdmin(){return this.isSuperuser}get isAuthRecord(){return"auth"==vi(this.token).type&&!this.isSuperuser}save(e,t){this.baseToken=e||"",this.baseModel=t||null,this.triggerChange()}clear(){this.baseToken="",this.baseModel=null,this.triggerChange()}loadFromCookie(e,t=wi){const n=function(e){const t={};if("string"!=typeof e)return t;const n=Object.assign({},{}).decode||pi;let s=0;for(;s<e.length;){const i=e.indexOf("=",s);if(-1===i)break;let o=e.indexOf(";",s);if(-1===o)o=e.length;else if(o<i){s=e.lastIndexOf(";",i-1)+1;continue}const a=e.slice(s,i).trim();if(void 0===t[a]){let s=e.slice(i+1,o).trim();34===s.charCodeAt(0)&&(s=s.slice(1,-1));try{t[a]=n(s)}catch(r){t[a]=s}}s=o+1}return t}(e||"")[t]||"";let s={};try{s=JSON.parse(n),(null===typeof s||"object"!=typeof s||Array.isArray(s))&&(s={})}catch(r){}this.save(s.token||"",s.record||s.model||null)}exportToCookie(e,t=wi){const n={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},s=vi(this.token);n.expires=s?.exp?new Date(1e3*s.exp):new Date("1970-01-01"),e=Object.assign({},n,e);const r={token:this.token,record:this.record?JSON.parse(JSON.stringify(this.record)):null};let i=fi(t,JSON.stringify(r),e);const o="undefined"!=typeof Blob?new Blob([i]).size:i.length;if(r.record&&o>4096){r.record={id:r.record?.id,email:r.record?.email};const n=["collectionId","collectionName","verified"];for(const e in this.record)n.includes(e)&&(r.record[e]=this.record[e]);i=fi(t,JSON.stringify(r),e)}return i}onChange(e,t=!1){return this._onChangeCallbacks.push(e),t&&e(this.token,this.record),()=>{for(let t=this._onChangeCallbacks.length-1;t>=0;t--)if(this._onChangeCallbacks[t]==e)return delete this._onChangeCallbacks[t],void this._onChangeCallbacks.splice(t,1)}}triggerChange(){for(const e of this._onChangeCallbacks)e&&e(this.token,this.record)}}class Si extends xi{constructor(e="pocketbase_auth"){super(),this.storageFallback={},this.storageKey=e,this._bindStorageEvent()}get token(){return(this._storageGet(this.storageKey)||{}).token||""}get record(){const e=this._storageGet(this.storageKey)||{};return e.record||e.model||null}get model(){return this.record}save(e,t){this._storageSet(this.storageKey,{token:e,record:t}),super.save(e,t)}clear(){this._storageRemove(this.storageKey),super.clear()}_storageGet(e){if("undefined"!=typeof window&&window?.localStorage){const n=window.localStorage.getItem(e)||"";try{return JSON.parse(n)}catch(t){return n}}return this.storageFallback[e]}_storageSet(e,t){if("undefined"!=typeof window&&window?.localStorage){let n=t;"string"!=typeof t&&(n=JSON.stringify(t)),window.localStorage.setItem(e,n)}else this.storageFallback[e]=t}_storageRemove(e){"undefined"!=typeof window&&window?.localStorage&&window.localStorage?.removeItem(e),delete this.storageFallback[e]}_bindStorageEvent(){"undefined"!=typeof window&&window?.localStorage&&window.addEventListener&&window.addEventListener("storage",e=>{if(e.key!=this.storageKey)return;const t=this._storageGet(this.storageKey)||{};super.save(t.token||"",t.record||t.model||null)})}}class Ci{constructor(e){this.client=e}}class ki extends Ci{async getAll(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/settings",e)}async update(e,t){return t=Object.assign({method:"PATCH",body:e},t),this.client.send("/api/settings",t)}async testS3(e="storage",t){return t=Object.assign({method:"POST",body:{filesystem:e}},t),this.client.send("/api/settings/test/s3",t).then(()=>!0)}async testEmail(e,t,n,s){return s=Object.assign({method:"POST",body:{email:t,template:n,collection:e}},s),this.client.send("/api/settings/test/email",s).then(()=>!0)}async generateAppleClientSecret(e,t,n,s,r,i){return i=Object.assign({method:"POST",body:{clientId:e,teamId:t,keyId:n,privateKey:s,duration:r}},i),this.client.send("/api/settings/apple/generate-client-secret",i)}}const Oi=["requestKey","$cancelKey","$autoCancel","fetch","headers","body","query","params","cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window"];function Mi(e){if(e){e.query=e.query||{};for(let t in e)Oi.includes(t)||(e.query[t]=e[t],delete e[t])}}function _i(e){const t=[];for(const n in e){const s=encodeURIComponent(n),r=Array.isArray(e[n])?e[n]:[e[n]];for(let e of r)e=Pi(e),null!==e&&t.push(s+"="+e)}return t.join("&")}function Pi(e){return null==e?null:e instanceof Date?encodeURIComponent(e.toISOString().replace("T"," ")):"object"==typeof e?encodeURIComponent(JSON.stringify(e)):encodeURIComponent(e)}class Ii extends Ci{constructor(){super(...arguments),this.clientId="",this.eventSource=null,this.subscriptions={},this.lastSentSubscriptions=[],this.maxConnectTimeout=15e3,this.reconnectAttempts=0,this.maxReconnectAttempts=1/0,this.predefinedReconnectIntervals=[200,300,500,1e3,1200,1500,2e3],this.pendingConnects=[]}get isConnected(){return!!this.eventSource&&!!this.clientId&&!this.pendingConnects.length}async subscribe(e,t,n){if(!e)throw new Error("topic must be set.");let s=e;if(n){Mi(n=Object.assign({},n));const e="options="+encodeURIComponent(JSON.stringify({query:n.query,headers:n.headers}));s+=(s.includes("?")?"&":"?")+e}const r=function(e){const n=e;let s;try{s=JSON.parse(n?.data)}catch{}t(s||{})};return this.subscriptions[s]||(this.subscriptions[s]=[]),this.subscriptions[s].push(r),this.isConnected?1===this.subscriptions[s].length?await this.submitSubscriptions():this.eventSource?.addEventListener(s,r):await this.connect(),async()=>this.unsubscribeByTopicAndListener(e,r)}async unsubscribe(e){let t=!1;if(e){const n=this.getSubscriptionsByTopic(e);for(let e in n)if(this.hasSubscriptionListeners(e)){for(let t of this.subscriptions[e])this.eventSource?.removeEventListener(e,t);delete this.subscriptions[e],t||(t=!0)}}else this.subscriptions={};this.hasSubscriptionListeners()?t&&await this.submitSubscriptions():this.disconnect()}async unsubscribeByPrefix(e){let t=!1;for(let n in this.subscriptions)if((n+"?").startsWith(e)){t=!0;for(let e of this.subscriptions[n])this.eventSource?.removeEventListener(n,e);delete this.subscriptions[n]}t&&(this.hasSubscriptionListeners()?await this.submitSubscriptions():this.disconnect())}async unsubscribeByTopicAndListener(e,t){let n=!1;const s=this.getSubscriptionsByTopic(e);for(let r in s){if(!Array.isArray(this.subscriptions[r])||!this.subscriptions[r].length)continue;let e=!1;for(let n=this.subscriptions[r].length-1;n>=0;n--)this.subscriptions[r][n]===t&&(e=!0,delete this.subscriptions[r][n],this.subscriptions[r].splice(n,1),this.eventSource?.removeEventListener(r,t));e&&(this.subscriptions[r].length||delete this.subscriptions[r],n||this.hasSubscriptionListeners(r)||(n=!0))}this.hasSubscriptionListeners()?n&&await this.submitSubscriptions():this.disconnect()}hasSubscriptionListeners(e){if(this.subscriptions=this.subscriptions||{},e)return!!this.subscriptions[e]?.length;for(let t in this.subscriptions)if(this.subscriptions[t]?.length)return!0;return!1}async submitSubscriptions(){if(this.clientId)return this.addAllSubscriptionListeners(),this.lastSentSubscriptions=this.getNonEmptySubscriptionKeys(),this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:this.lastSentSubscriptions},requestKey:this.getSubscriptionsCancelKey()}).catch(e=>{if(!e?.isAbort)throw e})}getSubscriptionsCancelKey(){return"realtime_"+this.clientId}getSubscriptionsByTopic(e){const t={};e=e.includes("?")?e:e+"?";for(let n in this.subscriptions)(n+"?").startsWith(e)&&(t[n]=this.subscriptions[n]);return t}getNonEmptySubscriptionKeys(){const e=[];for(let t in this.subscriptions)this.subscriptions[t].length&&e.push(t);return e}addAllSubscriptionListeners(){if(this.eventSource){this.removeAllSubscriptionListeners();for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.addEventListener(e,t)}}removeAllSubscriptionListeners(){if(this.eventSource)for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.removeEventListener(e,t)}async connect(){if(!(this.reconnectAttempts>0))return new Promise((e,t)=>{this.pendingConnects.push({resolve:e,reject:t}),this.pendingConnects.length>1||this.initConnect()})}initConnect(){this.disconnect(!0),clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(()=>{this.connectErrorHandler(new Error("EventSource connect took too long."))},this.maxConnectTimeout),this.eventSource=new EventSource(this.client.buildURL("/api/realtime")),this.eventSource.onerror=e=>{this.connectErrorHandler(new Error("Failed to establish realtime connection."))},this.eventSource.addEventListener("PB_CONNECT",e=>{const t=e;this.clientId=t?.lastEventId,this.submitSubscriptions().then(async()=>{let e=3;for(;this.hasUnsentSubscriptions()&&e>0;)e--,await this.submitSubscriptions()}).then(()=>{for(let e of this.pendingConnects)e.resolve();this.pendingConnects=[],this.reconnectAttempts=0,clearTimeout(this.reconnectTimeoutId),clearTimeout(this.connectTimeoutId);const t=this.getSubscriptionsByTopic("PB_CONNECT");for(let n in t)for(let s of t[n])s(e)}).catch(e=>{this.clientId="",this.connectErrorHandler(e)})})}hasUnsentSubscriptions(){const e=this.getNonEmptySubscriptionKeys();if(e.length!=this.lastSentSubscriptions.length)return!0;for(const t of e)if(!this.lastSentSubscriptions.includes(t))return!0;return!1}connectErrorHandler(e){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),!this.clientId&&!this.reconnectAttempts||this.reconnectAttempts>this.maxReconnectAttempts){for(let t of this.pendingConnects)t.reject(new hi(e));return this.pendingConnects=[],void this.disconnect()}this.disconnect(!0);const t=this.predefinedReconnectIntervals[this.reconnectAttempts]||this.predefinedReconnectIntervals[this.predefinedReconnectIntervals.length-1];this.reconnectAttempts++,this.reconnectTimeoutId=setTimeout(()=>{this.initConnect()},t)}disconnect(e=!1){if(this.clientId&&this.onDisconnect&&this.onDisconnect(Object.keys(this.subscriptions)),clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),this.removeAllSubscriptionListeners(),this.client.cancelRequest(this.getSubscriptionsCancelKey()),this.eventSource?.close(),this.eventSource=null,this.clientId="",!e){this.reconnectAttempts=0;for(let e of this.pendingConnects)e.resolve();this.pendingConnects=[]}}}class Ai extends Ci{decode(e){return e}async getFullList(e,t){if("number"==typeof e)return this._getFullList(e,t);let n=500;return(t=Object.assign({},e,t)).batch&&(n=t.batch,delete t.batch),this._getFullList(n,t)}async getList(e=1,t=30,n){return(n=Object.assign({method:"GET"},n)).query=Object.assign({page:e,perPage:t},n.query),this.client.send(this.baseCrudPath,n).then(e=>(e.items=e.items?.map(e=>this.decode(e))||[],e))}async getFirstListItem(e,t){return(t=Object.assign({requestKey:"one_by_filter_"+this.baseCrudPath+"_"+e},t)).query=Object.assign({filter:e,skipTotal:1},t.query),this.getList(1,1,t).then(e=>{if(!e?.items?.length)throw new hi({status:404,response:{code:404,message:"The requested resource wasn't found.",data:{}}});return e.items[0]})}async getOne(e,t){if(!e)throw new hi({url:this.client.buildURL(this.baseCrudPath+"/"),status:404,response:{code:404,message:"Missing required record id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(e=>this.decode(e))}async create(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send(this.baseCrudPath,t).then(e=>this.decode(e))}async update(e,t,n){return n=Object.assign({method:"PATCH",body:t},n),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),n).then(e=>this.decode(e))}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(()=>!0)}_getFullList(e=500,t){(t=t||{}).query=Object.assign({skipTotal:1},t.query);let n=[],s=async r=>this.getList(r,e||500,t).then(e=>{const t=e.items;return n=n.concat(t),t.length==e.perPage?s(r+1):n});return s(1)}}function Ri(e,t,n,s){const r=void 0!==s;return r||void 0!==n?r?(t.body=Object.assign({},t.body,n),t.query=Object.assign({},t.query,s),t):Object.assign(t,n):t}function Ei(e){e._resetAutoRefresh?.()}class Ti extends Ai{constructor(e,t){super(e),this.collectionIdOrName=t}get baseCrudPath(){return this.baseCollectionPath+"/records"}get baseCollectionPath(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)}get isSuperusers(){return"_superusers"==this.collectionIdOrName||"_pbc_2773867675"==this.collectionIdOrName}async subscribe(e,t,n){if(!e)throw new Error("Missing topic.");if(!t)throw new Error("Missing subscription callback.");return this.client.realtime.subscribe(this.collectionIdOrName+"/"+e,t,n)}async unsubscribe(e){return e?this.client.realtime.unsubscribe(this.collectionIdOrName+"/"+e):this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)}async getFullList(e,t){if("number"==typeof e)return super.getFullList(e,t);const n=Object.assign({},e,t);return super.getFullList(n)}async getList(e=1,t=30,n){return super.getList(e,t,n)}async getFirstListItem(e,t){return super.getFirstListItem(e,t)}async getOne(e,t){return super.getOne(e,t)}async create(e,t){return super.create(e,t)}async update(e,t,n){return super.update(e,t,n).then(e=>{if(this.client.authStore.record?.id===e?.id&&(this.client.authStore.record?.collectionId===this.collectionIdOrName||this.client.authStore.record?.collectionName===this.collectionIdOrName)){let t=Object.assign({},this.client.authStore.record.expand),n=Object.assign({},this.client.authStore.record,e);t&&(n.expand=Object.assign(t,e.expand)),this.client.authStore.save(this.client.authStore.token,n)}return e})}async delete(e,t){return super.delete(e,t).then(t=>(!t||this.client.authStore.record?.id!==e||this.client.authStore.record?.collectionId!==this.collectionIdOrName&&this.client.authStore.record?.collectionName!==this.collectionIdOrName||this.client.authStore.clear(),t))}authResponse(e){const t=this.decode(e?.record||{});return this.client.authStore.save(e?.token,t),Object.assign({},e,{token:e?.token||"",record:t})}async listAuthMethods(e){return e=Object.assign({method:"GET",fields:"mfa,otp,password,oauth2"},e),this.client.send(this.baseCollectionPath+"/auth-methods",e)}async authWithPassword(e,t,n){let s;n=Object.assign({method:"POST",body:{identity:e,password:t}},n),this.isSuperusers&&(s=n.autoRefreshThreshold,delete n.autoRefreshThreshold,n.autoRefresh||Ei(this.client));let r=await this.client.send(this.baseCollectionPath+"/auth-with-password",n);return r=this.authResponse(r),s&&this.isSuperusers&&function(e,t,n,s){Ei(e);const r=e.beforeSend,i=e.authStore.record,o=e.authStore.onChange((t,n)=>{(!t||n?.id!=i?.id||(n?.collectionId||i?.collectionId)&&n?.collectionId!=i?.collectionId)&&Ei(e)});e._resetAutoRefresh=function(){o(),e.beforeSend=r,delete e._resetAutoRefresh},e.beforeSend=async(i,o)=>{const a=e.authStore.token;if(o.query?.autoRefresh)return r?r(i,o):{url:i,sendOptions:o};let l=e.authStore.isValid;if(l&&bi(e.authStore.token,t))try{await n()}catch(u){l=!1}l||await s();const c=o.headers||{};for(let t in c)if("authorization"==t.toLowerCase()&&a==c[t]&&e.authStore.token){c[t]=e.authStore.token;break}return o.headers=c,r?r(i,o):{url:i,sendOptions:o}}}(this.client,s,()=>this.authRefresh({autoRefresh:!0}),()=>this.authWithPassword(e,t,Object.assign({autoRefresh:!0},n))),r}async authWithOAuth2Code(e,t,n,s,r,i,o){let a={method:"POST",body:{provider:e,code:t,codeVerifier:n,redirectURL:s,createData:r}};return a=Ri(0,a,i,o),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",a).then(e=>this.authResponse(e))}authWithOAuth2(...e){if(e.length>1||"string"==typeof e?.[0])return this.authWithOAuth2Code(e?.[0]||"",e?.[1]||"",e?.[2]||"",e?.[3]||"",e?.[4]||{},e?.[5]||{},e?.[6]||{});const t=e?.[0]||{};let n=null;t.urlCallback||(n=ji(void 0));const s=new Ii(this.client);function r(){n?.close(),s.unsubscribe()}const i={},o=t.requestKey;return o&&(i.requestKey=o),this.listAuthMethods(i).then(e=>{const i=e.oauth2.providers.find(e=>e.name===t.provider);if(!i)throw new hi(new Error(`Missing or invalid provider "${t.provider}".`));const a=this.client.buildURL("/api/oauth2-redirect"),l=o?this.client.cancelControllers?.[o]:void 0;return l&&(l.signal.onabort=()=>{r()}),new Promise(async(e,o)=>{try{await s.subscribe("@oauth2",async n=>{const c=s.clientId;try{if(!n.state||c!==n.state)throw new Error("State parameters don't match.");if(n.error||!n.code)throw new Error("OAuth2 redirect error or missing code: "+n.error);const s=Object.assign({},t);delete s.provider,delete s.scopes,delete s.createData,delete s.urlCallback,l?.signal?.onabort&&(l.signal.onabort=null);const r=await this.authWithOAuth2Code(i.name,n.code,i.codeVerifier,a,t.createData,s);e(r)}catch(u){o(new hi(u))}r()});const c={state:s.clientId};t.scopes?.length&&(c.scope=t.scopes.join(" "));const u=this._replaceQueryParams(i.authURL+a,c);let h=t.urlCallback||function(e){n?n.location.href=e:n=ji(e)};await h(u)}catch(c){r(),o(new hi(c))}})}).catch(e=>{throw r(),e})}async authRefresh(e,t){let n={method:"POST"};return n=Ri(0,n,e,t),this.client.send(this.baseCollectionPath+"/auth-refresh",n).then(e=>this.authResponse(e))}async requestPasswordReset(e,t,n){let s={method:"POST",body:{email:e}};return s=Ri(0,s,t,n),this.client.send(this.baseCollectionPath+"/request-password-reset",s).then(()=>!0)}async confirmPasswordReset(e,t,n,s,r){let i={method:"POST",body:{token:e,password:t,passwordConfirm:n}};return i=Ri(0,i,s,r),this.client.send(this.baseCollectionPath+"/confirm-password-reset",i).then(()=>!0)}async requestVerification(e,t,n){let s={method:"POST",body:{email:e}};return s=Ri(0,s,t,n),this.client.send(this.baseCollectionPath+"/request-verification",s).then(()=>!0)}async confirmVerification(e,t,n){let s={method:"POST",body:{token:e}};return s=Ri(0,s,t,n),this.client.send(this.baseCollectionPath+"/confirm-verification",s).then(()=>{const t=vi(e),n=this.client.authStore.record;return n&&!n.verified&&n.id===t.id&&n.collectionId===t.collectionId&&(n.verified=!0,this.client.authStore.save(this.client.authStore.token,n)),!0})}async requestEmailChange(e,t,n){let s={method:"POST",body:{newEmail:e}};return s=Ri(0,s,t,n),this.client.send(this.baseCollectionPath+"/request-email-change",s).then(()=>!0)}async confirmEmailChange(e,t,n,s){let r={method:"POST",body:{token:e,password:t}};return r=Ri(0,r,n,s),this.client.send(this.baseCollectionPath+"/confirm-email-change",r).then(()=>{const t=vi(e),n=this.client.authStore.record;return n&&n.id===t.id&&n.collectionId===t.collectionId&&this.client.authStore.clear(),!0})}async listExternalAuths(e,t){return this.client.collection("_externalAuths").getFullList(Object.assign({},t,{filter:this.client.filter("recordRef = {:id}",{id:e})}))}async unlinkExternalAuth(e,t,n){const s=await this.client.collection("_externalAuths").getFirstListItem(this.client.filter("recordRef = {:recordId} && provider = {:provider}",{recordId:e,provider:t}));return this.client.collection("_externalAuths").delete(s.id,n).then(()=>!0)}async requestOTP(e,t){return t=Object.assign({method:"POST",body:{email:e}},t),this.client.send(this.baseCollectionPath+"/request-otp",t)}async authWithOTP(e,t,n){return n=Object.assign({method:"POST",body:{otpId:e,password:t}},n),this.client.send(this.baseCollectionPath+"/auth-with-otp",n).then(e=>this.authResponse(e))}async impersonate(e,t,n){(n=Object.assign({method:"POST",body:{duration:t}},n)).headers=n.headers||{},n.headers.Authorization||(n.headers.Authorization=this.client.authStore.token);const s=new Hi(this.client.baseURL,new xi,this.client.lang),r=await s.send(this.baseCollectionPath+"/impersonate/"+encodeURIComponent(e),n);return s.authStore.save(r?.token,this.decode(r?.record||{})),s}_replaceQueryParams(e,t={}){let n=e,s="";e.indexOf("?")>=0&&(n=e.substring(0,e.indexOf("?")),s=e.substring(e.indexOf("?")+1));const r={},i=s.split("&");for(const o of i){if(""==o)continue;const e=o.split("=");r[decodeURIComponent(e[0].replace(/\+/g," "))]=decodeURIComponent((e[1]||"").replace(/\+/g," "))}for(let o in t)t.hasOwnProperty(o)&&(null==t[o]?delete r[o]:r[o]=t[o]);s="";for(let o in r)r.hasOwnProperty(o)&&(""!=s&&(s+="&"),s+=encodeURIComponent(o.replace(/%20/g,"+"))+"="+encodeURIComponent(r[o].replace(/%20/g,"+")));return""!=s?n+"?"+s:n}}function ji(e){if("undefined"==typeof window||!window?.open)throw new hi(new Error("Not in a browser context - please pass a custom urlCallback function."));let t=1024,n=768,s=window.innerWidth,r=window.innerHeight;t=t>s?s:t,n=n>r?r:n;let i=s/2-t/2,o=r/2-n/2;return window.open(e,"popup_window","width="+t+",height="+n+",top="+o+",left="+i+",resizable,menubar=no")}class Li extends Ai{get baseCrudPath(){return"/api/collections"}async import(e,t=!1,n){return n=Object.assign({method:"PUT",body:{collections:e,deleteMissing:t}},n),this.client.send(this.baseCrudPath+"/import",n).then(()=>!0)}async getScaffolds(e){return e=Object.assign({method:"GET"},e),this.client.send(this.baseCrudPath+"/meta/scaffolds",e)}async truncate(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/truncate",t).then(()=>!0)}}class Di extends Ci{async getList(e=1,t=30,n){return(n=Object.assign({method:"GET"},n)).query=Object.assign({page:e,perPage:t},n.query),this.client.send("/api/logs",n)}async getOne(e,t){if(!e)throw new hi({url:this.client.buildURL("/api/logs/"),status:404,response:{code:404,message:"Missing required log id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send("/api/logs/"+encodeURIComponent(e),t)}async getStats(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/logs/stats",e)}}class $i extends Ci{async check(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/health",e)}}class Fi extends Ci{getUrl(e,t,n={}){return this.getURL(e,t,n)}getURL(e,t,n={}){if(!t||!e?.id||!e?.collectionId&&!e?.collectionName)return"";const s=[];s.push("api"),s.push("files"),s.push(encodeURIComponent(e.collectionId||e.collectionName)),s.push(encodeURIComponent(e.id)),s.push(encodeURIComponent(t));let r=this.client.buildURL(s.join("/"));if(Object.keys(n).length){!1===n.download&&delete n.download;const e=new URLSearchParams(n);r+=(r.includes("?")?"&":"?")+e}return r}async getToken(e){return e=Object.assign({method:"POST"},e),this.client.send("/api/files/token",e).then(e=>e?.token||"")}}class qi extends Ci{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/backups",e)}async create(e,t){return t=Object.assign({method:"POST",body:{name:e}},t),this.client.send("/api/backups",t).then(()=>!0)}async upload(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send("/api/backups/upload",t).then(()=>!0)}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}`,t).then(()=>!0)}async restore(e,t){return t=Object.assign({method:"POST"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}/restore`,t).then(()=>!0)}getDownloadUrl(e,t){return this.getDownloadURL(e,t)}getDownloadURL(e,t){return this.client.buildURL(`/api/backups/${encodeURIComponent(t)}?token=${encodeURIComponent(e)}`)}}class Vi extends Ci{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/crons",e)}async run(e,t){return t=Object.assign({method:"POST"},t),this.client.send(`/api/crons/${encodeURIComponent(e)}`,t).then(()=>!0)}}function Bi(e){return"undefined"!=typeof Blob&&e instanceof Blob||"undefined"!=typeof File&&e instanceof File||null!==e&&"object"==typeof e&&e.uri&&("undefined"!=typeof navigator&&"ReactNative"===navigator.product||"undefined"!=typeof global&&global.HermesInternal)}function Ni(e){return e&&("FormData"===e.constructor?.name||"undefined"!=typeof FormData&&e instanceof FormData)}function Ui(e){for(const t in e){const n=Array.isArray(e[t])?e[t]:[e[t]];for(const e of n)if(Bi(e))return!0}return!1}const Ki=/^[\-\.\d]+$/;function zi(e){if("string"!=typeof e)return e;if("true"==e)return!0;if("false"==e)return!1;if(("-"===e[0]||e[0]>="0"&&e[0]<="9")&&Ki.test(e)){let t=+e;if(""+t===e)return t}return e}class Wi extends Ci{constructor(){super(...arguments),this.requests=[],this.subs={}}collection(e){return this.subs[e]||(this.subs[e]=new Qi(this.requests,e)),this.subs[e]}async send(e){const t=new FormData,n=[];for(let s=0;s<this.requests.length;s++){const e=this.requests[s];if(n.push({method:e.method,url:e.url,headers:e.headers,body:e.json}),e.files)for(let n in e.files){const r=e.files[n]||[];for(let e of r)t.append("requests."+s+"."+n,e)}}return t.append("@jsonPayload",JSON.stringify({requests:n})),e=Object.assign({method:"POST",body:t},e),this.client.send("/api/batch",e)}}class Qi{constructor(e,t){this.requests=[],this.requests=e,this.collectionIdOrName=t}upsert(e,t){t=Object.assign({body:e||{}},t);const n={method:"PUT",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records"};this.prepareRequest(n,t),this.requests.push(n)}create(e,t){t=Object.assign({body:e||{}},t);const n={method:"POST",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records"};this.prepareRequest(n,t),this.requests.push(n)}update(e,t,n){n=Object.assign({body:t||{}},n);const s={method:"PATCH",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records/"+encodeURIComponent(e)};this.prepareRequest(s,n),this.requests.push(s)}delete(e,t){t=Object.assign({},t);const n={method:"DELETE",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records/"+encodeURIComponent(e)};this.prepareRequest(n,t),this.requests.push(n)}prepareRequest(e,t){if(Mi(t),e.headers=t.headers,e.json={},e.files={},void 0!==t.query){const n=_i(t.query);n&&(e.url+=(e.url.includes("?")?"&":"?")+n)}let n=t.body;Ni(n)&&(n=function(e){let t={};return e.forEach((e,n)=>{if("@jsonPayload"===n&&"string"==typeof e)try{let n=JSON.parse(e);Object.assign(t,n)}catch(s){}else void 0!==t[n]?(Array.isArray(t[n])||(t[n]=[t[n]]),t[n].push(zi(e))):t[n]=zi(e)}),t}(n));for(const s in n){const t=n[s];if(Bi(t))e.files[s]=e.files[s]||[],e.files[s].push(t);else if(Array.isArray(t)){const n=[],r=[];for(const e of t)Bi(e)?n.push(e):r.push(e);if(n.length>0&&n.length==t.length){e.files[s]=e.files[s]||[];for(let t of n)e.files[s].push(t)}else if(e.json[s]=r,n.length>0){let t=s;s.startsWith("+")||s.endsWith("+")||(t+="+"),e.files[t]=e.files[t]||[];for(let s of n)e.files[t].push(s)}}else e.json[s]=t}}}class Hi{get baseUrl(){return this.baseURL}set baseUrl(e){this.baseURL=e}constructor(e="/",t,n="en-US"){this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseURL=e,this.lang=n,t?this.authStore=t:"undefined"!=typeof window&&window.Deno?this.authStore=new xi:this.authStore=new Si,this.collections=new Li(this),this.files=new Fi(this),this.logs=new Di(this),this.settings=new ki(this),this.realtime=new Ii(this),this.health=new $i(this),this.backups=new qi(this),this.crons=new Vi(this)}get admins(){return this.collection("_superusers")}createBatch(){return new Wi(this)}collection(e){return this.recordServices[e]||(this.recordServices[e]=new Ti(this,e)),this.recordServices[e]}autoCancellation(e){return this.enableAutoCancellation=!!e,this}cancelRequest(e){return this.cancelControllers[e]&&(this.cancelControllers[e].abort(),delete this.cancelControllers[e]),this}cancelAllRequests(){for(let e in this.cancelControllers)this.cancelControllers[e].abort();return this.cancelControllers={},this}filter(e,t){if(!t)return e;for(let n in t){let s=t[n];switch(typeof s){case"boolean":case"number":s=""+s;break;case"string":s="'"+s.replace(/'/g,"\\'")+"'";break;default:s=null===s?"null":s instanceof Date?"'"+s.toISOString().replace("T"," ")+"'":"'"+JSON.stringify(s).replace(/'/g,"\\'")+"'"}e=e.replaceAll("{:"+n+"}",s)}return e}getFileUrl(e,t,n={}){return this.files.getURL(e,t,n)}buildUrl(e){return this.buildURL(e)}buildURL(e){let t=this.baseURL;return"undefined"==typeof window||!window.location||t.startsWith("https://")||t.startsWith("http://")||(t=window.location.origin?.endsWith("/")?window.location.origin.substring(0,window.location.origin.length-1):window.location.origin||"",this.baseURL.startsWith("/")||(t+=window.location.pathname||"/",t+=t.endsWith("/")?"":"/"),t+=this.baseURL),e&&(t+=t.endsWith("/")?"":"/",t+=e.startsWith("/")?e.substring(1):e),t}async send(e,t){t=this.initSendOptions(e,t);let n=this.buildURL(e);if(this.beforeSend){const e=Object.assign({},await this.beforeSend(n,t));void 0!==e.url||void 0!==e.options?(n=e.url||n,t=e.options||t):Object.keys(e).length&&(t=e,console)}if(void 0!==t.query){const e=_i(t.query);e&&(n+=(n.includes("?")?"&":"?")+e),delete t.query}return"application/json"==this.getHeader(t.headers,"Content-Type")&&t.body&&"string"!=typeof t.body&&(t.body=JSON.stringify(t.body)),(t.fetch||fetch)(n,t).then(async e=>{let n={};try{n=await e.json()}catch(s){}if(this.afterSend&&(n=await this.afterSend(e,n,t)),e.status>=400)throw new hi({url:e.url,status:e.status,data:n});return n}).catch(e=>{throw new hi(e)})}initSendOptions(e,t){if((t=Object.assign({method:"GET"},t)).body=function(e){if("undefined"==typeof FormData||void 0===e||"object"!=typeof e||null===e||Ni(e)||!Ui(e))return e;const t=new FormData;for(const n in e){const s=e[n];if(void 0!==s)if("object"!=typeof s||Ui({data:s})){const e=Array.isArray(s)?s:[s];for(let s of e)t.append(n,s)}else{let e={};e[n]=s,t.append("@jsonPayload",JSON.stringify(e))}}return t}(t.body),Mi(t),t.query=Object.assign({},t.params,t.query),void 0===t.requestKey&&(!1===t.$autoCancel||!1===t.query.$autoCancel?t.requestKey=null:(t.$cancelKey||t.query.$cancelKey)&&(t.requestKey=t.$cancelKey||t.query.$cancelKey)),delete t.$autoCancel,delete t.query.$autoCancel,delete t.$cancelKey,delete t.query.$cancelKey,null!==this.getHeader(t.headers,"Content-Type")||Ni(t.body)||(t.headers=Object.assign({},t.headers,{"Content-Type":"application/json"})),null===this.getHeader(t.headers,"Accept-Language")&&(t.headers=Object.assign({},t.headers,{"Accept-Language":this.lang})),this.authStore.token&&null===this.getHeader(t.headers,"Authorization")&&(t.headers=Object.assign({},t.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&null!==t.requestKey){const n=t.requestKey||(t.method||"GET")+e;delete t.requestKey,this.cancelRequest(n);const s=new AbortController;this.cancelControllers[n]=s,t.signal=s.signal}return t}getHeader(e,t){e=e||{},t=t.toLowerCase();for(let n in e)if(n.toLowerCase()==t)return e[n];return null}}const Gi=new Hi("http://127.0.0.1:8090"),Ji=j(),Yi=()=>{const e=L(Ji);if(!e)throw new Error("usePocketBase must be used within a PocketBaseProvider");return e};var Zi=(e=>(e.Authorigins="_authOrigins",e.Externalauths="_externalAuths",e.Mfas="_mfas",e.Otps="_otps",e.Superusers="_superusers",e.Appointments="appointments",e.DentalCharts="dental_charts",e.Clinics="clinics",e.Organizations="organizations",e.PatientTransfers="patient_transfers",e.Patients="patients",e.StaffMembers="staff_members",e.TreatmentRecords="treatment_records",e.TreatmentsCatalog="treatments_catalog",e.Users="users",e))(Zi||{}),Xi=(e=>(e.org_admin="org_admin",e.clinic_manager="clinic_manager",e.dentist="dentist",e.receptionist="receptionist",e))(Xi||{});let eo=null;async function to(){const e=Gi.authStore.record;if(e&&e.collectionName===Zi.Users)try{const t=Gi,n=await t.collection("staff_members").getFirstListItem(`user="${e.id}"`);eo=n}catch(t){eo=null}else eo=null}const no=Object.freeze(Object.defineProperty({__proto__:null,ensureStaffLoaded:async function(){const e=Gi.authStore.record;e&&e.collectionName===Zi.Users&&(eo||await to())},getSnapshot:function(){const e=Gi.authStore.isValid,t=Gi.authStore.record;if(!e||!t)return{user:null,role:null,staffMember:null};const n={id:t.id,email:t.email,name:t.name,avatar:t.avatar,verified:!!t.verified,created:t.created,updated:t.updated};return t.collectionName===Zi.Superusers?{user:n,role:"admin",staffMember:null}:{user:n,role:eo?function(e){switch(e){case Xi.receptionist:return"receptionist";case Xi.dentist:return"dentist";case Xi.clinic_manager:return"manager";case Xi.org_admin:return"admin"}}(eo.role):"user",staffMember:eo}},login:async function(e,t){await Gi.collection("users").authWithPassword(e,t),await to()},loginAsAdmin:async function(e,t){await Gi.collection("_superusers").authWithPassword(e,t),eo=null},logout:async function(){Gi.authStore.clear(),eo=null},refreshAuth:async function(){Gi.authStore.isValid&&Gi.authStore.token&&(await Gi.collection("users").authRefresh(),await to())},register:async function(e,t,n){await Gi.collection("users").create({email:e,password:t,passwordConfirm:t,name:n}),await Gi.collection("users").authWithPassword(e,t),await to()},subscribe:function(e){return Gi.authStore.onChange(async()=>{await to(),e()})}},Symbol.toStringTag,{value:"Module"}));const so=function(){const[e,t]=Kn({user:null,isAuthenticated:!1,isLoading:!1,error:null,role:null,staffMember:null}),n=async()=>{try{t("isLoading",!0),"function"==typeof no.ensureStaffLoaded&&await no.ensureStaffLoaded();const{user:e,role:n,staffMember:s}=no.getSnapshot();t({user:e,isAuthenticated:!!e,isLoading:!1,error:null,role:n,staffMember:s??null})}catch(e){t({user:null,isAuthenticated:!1,isLoading:!1,error:"Failed to initialize authentication",role:null,staffMember:null})}};return no.subscribe(async()=>{n()}),n(),{authState:e,setLoading:e=>{t("isLoading",e)},setError:e=>{t("error",e)},clearError:()=>{t("error",null)},initializeAuth:n}}(),ro=j(),io=e=>{const t=ii(),{authState:n,setLoading:s,setError:r,clearError:i}=so,o=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),a=async()=>{try{s(!0),await no.logout(),t.clear()}catch(e){}finally{s(!1)}},l=async()=>{try{s(!0),await no.refreshAuth()}catch(e){await a()}finally{s(!1)}};I(()=>(()=>{const e=setInterval(()=>{n.isAuthenticated&&l().catch(console.error)},864e5);return()=>clearInterval(e)})());const c={authState:()=>n,login:async e=>{try{if(i(),s(!0),!o(e.email))throw new Error("Please enter a valid email address");if(!e.password)throw new Error("Password is required");await no.login(e.email.toLowerCase().trim(),e.password),t.invalidateQueries()}catch(n){const e=n instanceof Error?n.message:"Login failed. Please check your credentials.";throw r(e),new Error(e)}finally{s(!1)}},loginAsAdmin:async(e,n)=>{try{if(i(),s(!0),!o(e))throw new Error("Please enter a valid email address");if(!n)throw new Error("Password is required");await no.loginAsAdmin(e.toLowerCase().trim(),n),t.invalidateQueries()}catch(a){const e=a instanceof Error?a.message:"Admin login failed. Please check your credentials.";throw r(e),new Error(e)}finally{s(!1)}},register:async e=>{try{if(i(),s(!0),!o(e.email))throw new Error("Please enter a valid email address");const n=(e=>{const t=[];return e.length<8&&t.push("Password must be at least 8 characters long"),/(?=.*[a-z])/.test(e)||t.push("Password must contain at least one lowercase letter"),/(?=.*[A-Z])/.test(e)||t.push("Password must contain at least one uppercase letter"),/(?=.*\d)/.test(e)||t.push("Password must contain at least one number"),t})(e.password);if(n.length>0)throw new Error(n.join(". "));if(e.password!==e.passwordConfirm)throw new Error("Passwords do not match");if(e.name&&e.name.trim().length<2)throw new Error("Name must be at least 2 characters long");const r={email:e.email.toLowerCase().trim(),password:e.password,passwordConfirm:e.passwordConfirm,name:e.name?.trim()||""};await no.register(r.email,r.password,r.name),t.invalidateQueries()}catch(n){const e=n instanceof Error?n.message:"Registration failed. Please try again.";throw r(e),new Error(e)}finally{s(!1)}},logout:a,clearError:i,refreshAuth:l};return ne(ro.Provider,{value:c,get children(){return e.children}})},oo=()=>{const e=L(ro);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e};var ao=Pe('<svg class="h-5 w-5"fill=none viewBox="0 0 24 24"stroke=currentColor stroke-width=2><path stroke-linecap=round stroke-linejoin=round d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z">'),lo=Pe('<svg class="h-5 w-5"fill=none viewBox="0 0 24 24"stroke=currentColor stroke-width=2><path stroke-linecap=round stroke-linejoin=round d="M4 6h16M4 12h16M4 18h16">'),co=Pe('<svg class="h-4 w-4"fill=none viewBox="0 0 24 24"stroke=currentColor stroke-width=2><path stroke-linecap=round stroke-linejoin=round d="M6 18L18 6M6 6l12 12">'),uo=Pe('<svg class="h-4 w-4"fill=none viewBox="0 0 24 24"stroke=currentColor stroke-width=2><path stroke-linecap=round stroke-linejoin=round d="M15 19l-7-7 7-7">'),ho=Pe('<svg class="h-4 w-4"fill=none viewBox="0 0 24 24"stroke=currentColor stroke-width=2><path stroke-linecap=round stroke-linejoin=round d="M9 5l7 7-7 7">'),fo=Pe('<svg class="h-6 w-6"fill=none viewBox="0 0 24 24"stroke=currentColor stroke-width=2><path stroke-linecap=round stroke-linejoin=round d="M4.26 10.147a60.436 60.436 0 00-.491 6.347A48.627 48.627 0 0112 20.904a48.627 48.627 0 018.232-4.41 60.46 60.46 0 00-.491-6.347m-15.482 0a50.57 50.57 0 00-2.658-.813A59.905 59.905 0 0112 3.493a59.902 59.902 0 0110.399 5.84c-.896.248-1.783.52-2.658.814m-15.482 0A50.697 50.697 0 0112 13.489a50.702 50.702 0 017.74-3.342M6.75 15a.75.75 0 100-1.5.75.75 0 000 1.5zm0 0v-3.675A55.378 55.378 0 0112 8.443m-7.007 11.55A5.981 5.981 0 006.75 15.75v-1.5">'),po=Pe('<svg class="h-4 w-4"fill=none viewBox="0 0 24 24"stroke=currentColor stroke-width=2><path stroke-linecap=round stroke-linejoin=round d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1">'),go=Pe('<svg class="h-4 w-4"fill=none viewBox="0 0 24 24"stroke=currentColor stroke-width=2><path stroke-linecap=round stroke-linejoin=round d="M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 011.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.107 1.204.165.397.505.71.93.78l.893.15c.543.09.94.56.94 1.109v1.094c0 .55-.397 1.02-.94 1.11l-.893.149c-.425.07-.765.383-.93.78-.165.398-.143.854.107 1.204l.527.738c.32.447.269 1.06-.12 1.45l-.774.773a1.125 1.125 0 01-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.397.165-.71.505-.781.929l-.149.894c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.894c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527c-.447.32-1.06.269-1.45-.12l-.773-.774a1.125 1.125 0 01-.12-1.45l.527-.737c.25-.35.273-.806.108-1.204-.165-.397-.505-.71-.93-.78l-.894-.15c-.542-.09-.94-.56-.94-1.109v-1.094c0-.55.398-1.02.94-1.11l.894-.149c.424-.07.765-.383.93-.78.165-.398.143-.854-.107-1.204l-.527-.738a1.125 1.125 0 01.12-1.45l.773-.773a1.125 1.125 0 011.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.929l.15-.894z"></path><circle cx=12 cy=12 r=3>'),mo=Pe('<svg class="h-4 w-4"fill=none viewBox="0 0 24 24"stroke=currentColor stroke-width=2><path stroke-linecap=round stroke-linejoin=round d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z">'),yo=Pe('<svg class="h-4 w-4"fill=none viewBox="0 0 24 24"stroke=currentColor stroke-width=2><path stroke-linecap=round stroke-linejoin=round d="M15 17h5l-5 5v-5zM4.83 2.83A4 4 0 016.34 2h11.32a4 4 0 013.51 2.83L22 8H2l1.83-5.17z">'),vo=Pe('<svg class="h-4 w-4"fill=none viewBox="0 0 24 24"stroke=currentColor stroke-width=2><path stroke-linecap=round stroke-linejoin=round d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z">'),bo=Pe('<svg class="h-4 w-4"fill=none viewBox="0 0 24 24"stroke=currentColor stroke-width=2><path stroke-linecap=round stroke-linejoin=round d="M19 9l-7 7-7-7">'),wo=Pe("<kbd>"),xo=Pe('<img class="w-10 h-10 rounded-full object-cover">'),So=Pe('<button class="w-full flex items-center gap-3 p-3 rounded-lg hover:bg-slate-800/30 transition-colors group"><div class=relative><div class="absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-emerald-400 border-2 border-slate-900 rounded-full"></div></div><div class="flex-1 min-w-0 text-left"><p class="font-medium text-white truncate"></p><p class="text-sm text-slate-400 truncate"></p></div><div>'),Co=Pe('<div class="absolute bottom-full left-0 right-0 mb-2 bg-slate-800/95 backdrop-blur-xl border border-slate-700/50 rounded-lg shadow-xl overflow-hidden"><div class="p-2 space-y-1"><button class="w-full flex items-center gap-3 px-3 py-2.5 text-sm text-slate-300 hover:bg-slate-700/50 hover:text-white rounded-md transition-colors"><span>Profile</span></button><button class="w-full flex items-center gap-3 px-3 py-2.5 text-sm text-slate-300 hover:bg-slate-700/50 hover:text-white rounded-md transition-colors"><span>Settings</span></button><button class="w-full flex items-center gap-3 px-3 py-2.5 text-sm text-slate-300 hover:bg-slate-700/50 hover:text-white rounded-md transition-colors"><span>Notifications</span></button><button class="w-full flex items-center gap-3 px-3 py-2.5 text-sm text-slate-300 hover:bg-slate-700/50 hover:text-white rounded-md transition-colors"><span>Help & Support</span></button><div class="border-t border-slate-700/50 my-1"></div><button class="w-full flex items-center gap-3 px-3 py-2.5 text-sm text-red-400 hover:bg-red-500/10 hover:text-red-300 rounded-md transition-colors"><span>Log Out'),ko=Pe('<div class="flex justify-center"><div class=relative><div class="absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-emerald-400 border-2 border-slate-900 rounded-full">'),Oo=Pe("<div class=relative>"),Mo=Pe('<div class="w-10 h-10 bg-gradient-to-br from-teal-400 to-cyan-500 rounded-full flex items-center justify-center"><span class="text-sm font-semibold text-white">'),_o=Pe("<span>"),Po=Pe('<div class="px-3 py-2"><h3 class="text-xs font-semibold text-slate-500 uppercase tracking-wider">'),Io=Pe("<div class=space-y-1>"),Ao=Pe('<span class="flex-1 truncate">'),Ro=Pe("<div>"),Eo=Pe('<div class="flex items-center gap-2">'),To=Pe('<div class="absolute -top-1 -right-1">'),jo=Pe('<div class="ml-6 space-y-1 border-l border-slate-700/50 pl-4">'),Lo=Pe("<div class=text-teal-400>"),Do=Pe('<span class="text-xl font-bold bg-gradient-to-r from-teal-400 to-cyan-400 bg-clip-text text-transparent">Zahrawi'),$o=Pe('<header class="fixed top-0 right-0 left-0 z-50 flex items-center justify-between border-b border-slate-800/80 bg-slate-900/95 backdrop-blur-xl p-4 lg:hidden"><div class="flex items-center gap-2"><button class="rounded-lg p-2.5 text-slate-300 hover:bg-slate-800/50 hover:text-white transition-colors"aria-label="Open Search"></button><button class="rounded-lg p-2.5 text-slate-300 hover:bg-slate-800/50 hover:text-white transition-colors"aria-label="Toggle Menu">'),Fo=Pe('<div class="fixed inset-0 z-20 bg-black/50 backdrop-blur-sm lg:hidden"aria-hidden=true>'),qo=Pe('<div class="flex flex-col pt-16 lg:flex-row lg:pt-0"><aside><div><div><button class="rounded-lg p-2 text-slate-400 hover:bg-slate-800/50 hover:text-white transition-colors"aria-label=Search></button></div><button class="hidden lg:flex rounded-lg p-1.5 text-slate-400 hover:bg-slate-800/50 hover:text-white transition-colors"></button></div><nav><div class=space-y-6>'),Vo=Pe('<svg viewBox="0 0 24 24"aria-hidden><path fill=currentColor d="M3 3h8v8H3zM13 3h8v5h-8zM13 10h8v11h-8zM3 13h8v8H3z">'),Bo=Pe('<svg viewBox="0 0 24 24"aria-hidden><path fill=currentColor d="M16 11a4 4 0 10-8 0 4 4 0 008 0zm-6 5a6 6 0 00-6 6h2a4 4 0 014-4h4a4 4 0 014 4h2a6 6 0 00-6-6H10z">'),No=Pe('<svg viewBox="0 0 24 24"aria-hidden><path fill=currentColor d="M7 12a4 4 0 110-8 4 4 0 010 8zm10 0a4 4 0 110-8 4 4 0 010 8zM2 20a5 5 0 015-5h2a5 5 0 015 5H2zm10 0a5 5 0 015-5h2a5 5 0 015 5h-12z">'),Uo=Pe('<svg viewBox="0 0 24 24"aria-hidden><path fill=currentColor d="M7 2h2v2h6V2h2v2h3a2 2 0 012 2v14a2 2 0 01-2 2H4a2 2 0 01-2-2V6a2 2 0 012-2h3V2zm13 8H4v10h16V10z">'),Ko=Pe('<svg viewBox="0 0 24 24"aria-hidden><path fill=currentColor d="M3 21V9l9-6 9 6v12h-6v-6H9v6H3z">');const zo=()=>ao(),Wo=()=>lo(),Qo=()=>co(),Ho=()=>uo(),Go=()=>ho(),Jo=()=>fo(),Yo=()=>po(),Zo=()=>go(),Xo=()=>mo(),ea=()=>yo(),ta=()=>vo(),na=()=>bo(),sa=e=>{return De(t=wo(),()=>e.children),S(()=>Re(t,`inline-flex items-center justify-center rounded border border-slate-600/50 bg-slate-900/80 px-1.5 py-0.5 text-xs font-medium text-slate-300 backdrop-blur-sm ${e.class??""}`)),t;var t},ra=e=>{const[t,n]=w(!1),{logout:s}=oo(),r=ls(),i=async()=>{await s(),r({to:"/login"})},o=()=>{n(!1)},a=()=>{n(!1)},l=()=>{n(!1)},c=()=>{n(!1)};return De(u=Oo(),ne(de,{get when(){return!e.collapsed},get children(){return[(s=So(),r=s.firstChild,u=r.firstChild,h=r.nextSibling,d=h.firstChild,f=d.nextSibling,p=h.nextSibling,s.$$click=()=>n(!t()),De(r,ne(de,{get when(){return e.userProfile.avatar},get fallback(){return De((t=Mo()).firstChild,()=>e.userProfile.name.charAt(0).toUpperCase()),t;var t},get children(){var t=xo();return S(n=>{var s=`http://127.0.0.1:8090/api/files/users/${e.userProfile.id}/${e.userProfile.avatar}`,r=e.userProfile.name;return s!==n.e&&Ae(t,"src",n.e=s),r!==n.t&&Ae(t,"alt",n.t=r),n},{e:void 0,t:void 0}),t}}),u),De(d,()=>e.userProfile.name),De(f,()=>e.userProfile.role),De(p,ne(na,{})),S(()=>Re(p,"transition-transform duration-200 "+(t()?"rotate-180":""))),s),ne(de,{get when(){return t()},get children(){var e=Co(),t=e.firstChild.firstChild,n=t.firstChild,s=t.nextSibling,r=s.firstChild,u=s.nextSibling,h=u.firstChild,d=u.nextSibling,f=d.firstChild,p=d.nextSibling.nextSibling,g=p.firstChild;return t.$$click=a,De(t,ne(Xo,{}),n),s.$$click=o,De(s,ne(Zo,{}),r),u.$$click=l,De(u,ne(ea,{}),h),d.$$click=c,De(d,ne(ta,{}),f),p.$$click=i,De(p,ne(Yo,{}),g),e}})];var s,r,u,h,d,f,p}}),null),De(u,ne(de,{get when(){return e.collapsed},get children(){var t=ko(),n=t.firstChild,s=n.firstChild;return De(n,ne(de,{get when(){return e.userProfile.avatar},get fallback(){return De((t=Mo()).firstChild,()=>e.userProfile.name.charAt(0).toUpperCase()),t;var t},get children(){var t=xo();return S(n=>{var s=e.userProfile.avatar,r=e.userProfile.name;return s!==n.e&&Ae(t,"src",n.e=s),r!==n.t&&Ae(t,"alt",n.t=r),n},{e:void 0,t:void 0}),t}}),s),t}}),null),u;var u},ia=e=>{return De(t=_o(),()=>e.children),S(()=>Re(t,"inline-flex items-center justify-center min-w-[18px] h-[18px] px-1.5 text-xs font-medium rounded-full "+("success"===e.variant?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":"warning"===e.variant?"bg-amber-500/20 text-amber-400 border border-amber-500/30":"error"===e.variant?"bg-red-500/20 text-red-400 border border-red-500/30":"bg-slate-600/30 text-slate-300 border border-slate-600/50"))),t;var t},oa=e=>{return De(t=Io(),ne(de,{get when(){return Me(()=>!!e.title)()&&!e.collapsed},get children(){var t=Po();return De(t.firstChild,()=>e.title),t}}),null),De(t,()=>e.children,null),t;var t},aa=e=>{const[t,n]=w(!1),s=()=>e.item.children&&e.item.children.length>0;return De(r=Io(),ne(ss,{get to(){return e.item.to},get class(){return`group relative flex items-center gap-3 rounded-lg px-3 py-2.5 text-sm font-medium transition-all duration-200 ${e.isActive?"bg-gradient-to-r from-teal-500/20 to-cyan-500/20 text-teal-300 shadow-lg shadow-teal-500/10 border border-teal-500/30":"text-slate-300 hover:bg-slate-800/50 hover:text-white"} ${e.collapsed?"justify-center":""}`},onClick:r=>{(e=>{s()&&(e.preventDefault(),n(!t()))})(r),e.onClick?.()},get children(){return[ne(de,{get when(){return e.item.icon},get children(){return ne(e.item.icon,{get class(){return"h-5 w-5 shrink-0 transition-colors duration-200 "+(e.isActive?"text-teal-300":"text-slate-400 group-hover:text-white")}})}}),ne(de,{get when(){return!e.collapsed},get children(){return[(r=Ao(),De(r,()=>e.item.label),r),(n=Eo(),De(n,ne(de,{get when(){return e.item.badge},get children(){return ne(ia,{get children(){return e.item.badge}})}}),null),De(n,ne(de,{get when(){return s()},get children(){var e=Ro();return De(e,ne(Go,{})),S(()=>Re(e,"transition-transform duration-200 "+(t()?"rotate-90":""))),e}}),null),n)];var n,r}}),ne(de,{get when(){return Me(()=>!!e.collapsed)()&&e.item.badge},get children(){var t=To();return De(t,ne(ia,{get children(){return e.item.badge}})),t}})]}}),null),De(r,ne(de,{get when(){return Me(()=>!(!s()||!t()))()&&!e.collapsed},get children(){var t=jo();return De(t,ne(he,{get each(){return e.item.children},children:t=>ne(aa,{item:t,isActive:!1,collapsed:!1,get onClick(){return e.onClick}})})),t}}),null),r;var r};function la(e){ls();const t=Yn({select:e=>e.location}),[n,s]=w(!1),[r,i]=w(!1),[o,a]=w(e.defaultCollapsed??!1),l=k(()=>{const t={};return e.items.forEach(e=>{if(e.hidden)return;const n=e.section||"main";t[n]||(t[n]=[]),t[n].push(e)}),t}),c=k(()=>e=>{const n=t().pathname;return n===e||"/"!==e&&n.startsWith(e)});I(()=>{document.addEventListener("keydown",u)}),A(()=>{document.removeEventListener("keydown",u),document.body.style.overflow=""});const u=e=>"/"!==e.key||n()||["INPUT","TEXTAREA","SELECT"].includes(document.activeElement?.tagName||"")?"Escape"===e.key&&r()?(e.preventDefault(),void i(!1)):void 0:(e.preventDefault(),void s(!0)),h=()=>s(e=>!e),d=()=>{const e=!r();i(e),document.body.style.overflow=e?"hidden":""},f=()=>{const t=!o();a(t),e.onCollapse?.(t)},p=()=>{r()&&i(!1)};return[(M=$o(),_=M.firstChild,P=_.firstChild,R=P.nextSibling,De(M,ne(ss,{to:"/",class:"flex items-center gap-3",get children(){return[(e=Lo(),De(e,ne(Jo,{})),e),Do()];var e}}),_),P.$$click=h,De(P,ne(zo,{})),R.$$click=d,De(R,ne(fe,{get children(){return[ne(pe,{get when(){return r()},get children(){return ne(Qo,{})}}),ne(pe,{get when(){return!r()},get children(){return ne(Wo,{})}})]}})),M),ne(ir,{get isOpen(){return n()},onClose:()=>s(!1)}),(g=qo(),m=g.firstChild,y=m.firstChild,v=y.firstChild,b=v.firstChild,x=v.nextSibling,C=y.nextSibling,O=C.firstChild,De(y,ne(de,{get when(){return!o()},get children(){return ne(ss,{to:"/",class:"flex items-center gap-3",get children(){return[(e=Lo(),De(e,ne(Jo,{})),e),Do()];var e}})}}),v),De(y,ne(de,{get when(){return o()},get children(){return ne(ss,{to:"/",class:"text-teal-400 mx-auto",get children(){return ne(Jo,{})}})}}),v),b.$$click=h,De(b,ne(zo,{})),De(v,ne(sa,{"aria-hidden":"true",children:"/"}),null),x.$$click=f,De(x,ne(fe,{get children(){return[ne(pe,{get when(){return o()},get children(){return ne(Go,{})}}),ne(pe,{get when(){return!o()},get children(){return ne(Ho,{})}})]}})),De(O,ne(he,{get each(){return Object.entries(l())},children:([e,t])=>ne(oa,{title:"main"!==e?e:void 0,get collapsed(){return o()},get children(){var e=Io();return De(e,ne(he,{each:t,children:e=>ne(aa,{item:e,get isActive(){return c()(e.to)},get collapsed(){return o()},onClick:p})})),e}})})),De(m,ne(de,{get when(){return e.userProfile},get children(){var t=Ro();return De(t,ne(ra,{get userProfile(){return e.userProfile},get collapsed(){return o()}})),S(()=>Re(t,"shrink-0 border-t border-slate-800/50 "+(o()?"p-2":"p-4"))),t}}),null),De(g,ne(de,{get when(){return r()},get children(){var e=Fo();return e.$$click=d,e}}),null),S(e=>{var t=`fixed inset-y-0 left-0 z-30 bg-slate-900/95 backdrop-blur-xl border-r border-slate-800/80 text-slate-300 transition-all duration-300 ease-in-out lg:sticky lg:translate-x-0 flex h-screen flex-col lg:h-auto lg:max-h-screen ${r()?"translate-x-0":"-translate-x-full"} ${r(),"mt-16 lg:mt-0"} ${o()?"w-16":"w-64"}`,n="hidden shrink-0 items-center justify-between border-b border-slate-800/50 p-4 lg:flex "+(o()?"px-3":""),s="flex items-center gap-2 "+(o()?"hidden":""),i=o()?"Expand sidebar":"Collapse sidebar",a="flex-1 overflow-y-auto overflow-x-hidden scrollbar-thin scrollbar-track-transparent scrollbar-thumb-slate-700/50 "+(o()?"p-2":"p-4");return t!==e.e&&Re(m,e.e=t),n!==e.t&&Re(y,e.t=n),s!==e.a&&Re(v,e.a=s),i!==e.o&&Ae(x,"aria-label",e.o=i),a!==e.i&&Re(C,e.i=a),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),g)];var g,m,y,v,b,x,C,O,M,_,P,R}const ca=[{to:"/",label:"Dashboard",icon:e=>{return t=Vo(),S(()=>Ae(t,"class",e.class||"h-5 w-5")),t;var t},badge:"2"},{to:"/patients",label:"Patients",icon:e=>{return t=Bo(),S(()=>Ae(t,"class",e.class||"h-5 w-5")),t;var t},badge:"12"},{to:"/appointments",label:"Appointments",icon:e=>{return t=Uo(),S(()=>Ae(t,"class",e.class||"h-5 w-5")),t;var t},badge:"3"},{to:"/admin/users",label:"Users",section:"Administration",icon:e=>{return t=No(),S(()=>Ae(t,"class",e.class||"h-5 w-5")),t;var t}},{to:"/admin/clinics",label:"Clinics",section:"Administration",icon:e=>{return t=Ko(),S(()=>Ae(t,"class",e.class||"h-5 w-5")),t;var t}}];Ie(["click"]);const ua=new class extends Gr{constructor(e={}){super(e)}}({defaultOptions:{queries:{staleTime:3e5,refetchOnWindowFocus:!1,gcTime:18e5,retry:3,retryDelay:e=>Math.min(1e3*2**e,3e4)},mutations:{retry:1,networkMode:"always"}}});var ha=Pe('<div class="flex items-center justify-center p-6"><div class="max-w-md w-full border border-gray-200 rounded-lg p-6 text-center"><div class="text-6xl font-extrabold text-gray-100">404</div><h1 class="mt-2 text-xl font-semibold text-gray-200">Page not found</h1><p class="mt-1 text-sm text-gray-300">The page you are looking for doesn’t exist or has moved.</p><div class="mt-4 flex items-center justify-center gap-3"><button class="px-4 py-2 rounded border hover:bg-gray-50">Go to Dashboard</button><button class="px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700">Home');const da=()=>{const e=ls();return t=ha(),n=t.firstChild.firstChild.nextSibling.nextSibling.nextSibling.firstChild,s=n.nextSibling,n.$$click=()=>e({to:"/"}),s.$$click=()=>e({to:"/"}),t;var t,n,s};Ie(["click"]);var fa=Pe('<div class="bg-slate-900 flex min-h-screen flex-col text-white"><div class="flex flex-grow flex-col lg:flex-row"><main class="px-4 py-6 pt-16 lg:flex-1 lg:px-8">');const pa=new us({beforeLoad:async({location:e})=>{const t=Gi.authStore.isValid&&Gi.authStore.model;if(["/login","/signup","/admin-login"].includes(e.pathname)){if(t)throw tn({to:"/"})}else{if(!t)throw tn({to:"/login"});await so.initializeAuth()}},notFoundComponent:()=>da,component:()=>{const{authState:e}=so,t=k(()=>{if(!e.user)return;const t=e.user;return{id:t.id,name:t.name||t.email,email:t.email,avatar:t.avatar,role:e.role}});return[ne(Ji.Provider,{value:Gi,get children(){return ne(oi,{client:ua,get children(){return ne(io,{get children(){var n,s=fa(),r=s.firstChild,i=r.firstChild;return De(r,(n=Me(()=>!(!e.isAuthenticated||!e.user)),()=>n()?ne(la,{items:ca,get userProfile(){return t()}}):null),i),De(i,ne(ve,{get fallback(){return ne($s,{})},get children(){return ne(Ps,{})}})),s}})}})}}),ne(Vs,{})]}});const ga={equals:!1};class ma{#Y;constructor(e=Map){this.#Y=new e}dirty(e){this.#Y.get(e)?.$$()}dirtyAll(){for(const e of this.#Y.values())e.$$()}track(e){if(!R())return;let t=this.#Y.get(e);if(t)t.n++;else{const[n,s]=w(void 0,ga);this.#Y.set(e,t={$:n,$$:s,n:1})}A(()=>{0===--t.n&&queueMicrotask(()=>0===t.n&&this.#Y.delete(e))}),t.$()}}const ya=Symbol("track-object");class va extends Map{#Z=new ma;#X=new ma;[Symbol.iterator](){return this.entries()}constructor(e){if(super(),e)for(const t of e)super.set(...t)}get size(){return this.#Z.track(ya),super.size}*keys(){this.#Z.track(ya);for(const e of super.keys())yield e}*values(){this.#X.track(ya);for(const e of super.values())yield e}*entries(){this.#Z.track(ya),this.#X.track(ya);for(const e of super.entries())yield e}forEach(e,t){this.#Z.track(ya),this.#X.track(ya),super.forEach(e,t)}has(e){return this.#Z.track(e),super.has(e)}get(e){return this.#X.track(e),super.get(e)}set(e,t){const n=!super.has(e),s=super.get(e)!==t,r=super.set(e,t);return(s||n)&&M(()=>{n&&(this.#Z.dirty(ya),this.#Z.dirty(e)),s&&(this.#X.dirty(ya),this.#X.dirty(e))}),r}delete(e){const t=void 0!==super.get(e),n=super.delete(e);return n&&M(()=>{this.#Z.dirty(ya),this.#X.dirty(ya),this.#Z.dirty(e),t&&this.#X.dirty(e)}),n}clear(){0!==super.size&&M(()=>{this.#Z.dirty(ya),this.#X.dirty(ya);for(const e of super.keys())this.#Z.dirty(e),this.#X.dirty(e);super.clear()})}}function ba(...e){const t="undefined"!=typeof window&&"undefined"!=typeof localStorage;t&&localStorage.getItem("DEBUG")}function wa(e,t=new WeakMap){if(null==e)return e;if("object"!=typeof e)return e;if(t.has(e))return t.get(e);if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return new RegExp(e.source,e.flags);if(Array.isArray(e)){const n=[];return t.set(e,n),e.forEach((e,s)=>{n[s]=wa(e,t)}),n}if(ArrayBuffer.isView(e)&&!(e instanceof DataView)){const n=new(0,Object.getPrototypeOf(e).constructor)(e.length);t.set(e,n);for(let t=0;t<e.length;t++)n[t]=e[t];return n}if(e instanceof Map){const n=new Map;return t.set(e,n),e.forEach((e,s)=>{n.set(s,wa(e,t))}),n}if(e instanceof Set){const n=new Set;return t.set(e,n),e.forEach(e=>{n.add(wa(e,t))}),n}const n={};t.set(e,n);for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=wa(e[r],t));const s=Object.getOwnPropertySymbols(e);for(const r of s)n[r]=wa(e[r],t);return n}function xa(e,t){if(e===t)return!0;if(null===e||null===t||"object"!=typeof e||"object"!=typeof t)return!1;if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if(e instanceof RegExp&&t instanceof RegExp)return e.source===t.source&&e.flags===t.flags;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;const n=Array.from(e.entries());for(const[e,s]of n)if(!t.has(e)||!xa(s,t.get(e)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;const n=Array.from(e),s=Array.from(t);return n.every(e=>"object"!=typeof e)?n.every(e=>t.has(e)):n.length===s.length}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!xa(e[n],t[n]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)&&!(e instanceof DataView)&&!(t instanceof DataView)){const n=e,s=t;if(n.length!==s.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==s[e])return!1;return!0}const n=Object.keys(e),s=Object.keys(t);return n.length===s.length&&n.every(n=>Object.prototype.hasOwnProperty.call(t,n)&&xa(e[n],t[n]))}let Sa=0;function Ca(e,t){const n=new Map;function s(e,t){if(ba(e.constructor.name),n.has(e))return n.get(e);{const s=Ca(e,t);return n.set(e,s),s}}const r=new Map,i={copy_:wa(e),originalObject:wa(e),proxyCount:(Sa+=1,Sa),modified:!1,assigned_:{},parent:t,target:e};function o(e){e.modified||(e.modified=!0),e.parent&&(ba(),"updateMap"in e.parent?e.parent.updateMap(e.copy_):"updateSet"in e.parent?e.parent.updateSet(e.copy_):(e.parent.tracker.copy_[e.parent.prop]=e.copy_,e.parent.tracker.assigned_[e.parent.prop]=!0),o(e.parent.tracker))}function a(e){if(ba(Object.keys(e.assigned_)),0===Object.keys(e.assigned_).length&&0===Object.getOwnPropertySymbols(e.assigned_).length)return ba(),!0;for(const n in e.assigned_)if(!0===e.assigned_[n]){const t=e.copy_[n],s=e.originalObject[n];if(ba(String(n)),!xa(t,s))return ba(String(n)),!1}else if(!1===e.assigned_[n])return ba(String(n)),!1;const t=Object.getOwnPropertySymbols(e.assigned_);for(const n of t)if(!0===e.assigned_[n]){if(!xa(e.copy_[n],e.originalObject[n]))return ba(),!1}else if(!1===e.assigned_[n])return ba(),!1;return ba(),!0}function l(e,t){ba();const n=a(e);ba(),n&&(ba(),e.modified=!1,e.assigned_={},e.parent&&(ba(),l(e.parent.tracker,e.parent.prop)))}ba(i.proxyCount);return{proxy:function(e){if(ba(),r.has(e))return ba(),r.get(e);const n=new Proxy(e,{get(e,t){ba();const n=i.copy_[t]??i.originalObject[t],a=i.originalObject[t];ba();const l=Object.getOwnPropertyDescriptor(e,t);if(null==l?void 0:l.get)return n;if("function"==typeof n){if(Array.isArray(e)){const e=t.toString();if(new Set(["pop","push","shift","unshift","splice","sort","reverse","fill","copyWithin"]).has(e))return function(...e){const t=n.apply(i.copy_,e);return o(i),t}}if(e instanceof Map||e instanceof Set){const r=t.toString();if(new Set(["set","delete","clear","add","pop","push","shift","unshift","splice","sort","reverse"]).has(r))return function(...e){const t=n.apply(i.copy_,e);return o(i),t};if(new Set(["entries","keys","values","forEach",Symbol.iterator]).has(r)||t===Symbol.iterator)return function(...a){const l=n.apply(i.copy_,a);if("forEach"===r){const t=a[0];if("function"==typeof t){const s=function(e,n,s){const r=t.call(this,e,n,s);return o(i),r};return n.apply(e,[s,...a.slice(1)])}}if("entries"===r||"values"===r||r===Symbol.iterator.toString()||t===Symbol.iterator){const n=l,o=new Map;if("values"===r&&e instanceof Map)for(const[e,t]of i.copy_.entries())o.set(t,e);const a=new Map;if(e instanceof Set)for(const e of i.copy_.values())a.set(e,e);return{next(){const l=n.next();if(!l.done&&l.value&&"object"==typeof l.value)if("entries"===r&&Array.isArray(l.value)&&2===l.value.length){if(l.value[1]&&"object"==typeof l.value[1]){const e=l.value[0],t={tracker:i,prop:e,updateMap:t=>{i.copy_ instanceof Map&&i.copy_.set(e,t)}},{proxy:n}=s(l.value[1],t);l.value[1]=n}}else if(("values"===r||r===Symbol.iterator.toString()||t===Symbol.iterator)&&"object"==typeof l.value&&null!==l.value)if("values"===r&&e instanceof Map){const e=o.get(l.value);if(void 0!==e){const t={tracker:i,prop:e,updateMap:t=>{i.copy_ instanceof Map&&i.copy_.set(e,t)}},{proxy:n}=s(l.value,t);l.value=n}}else if(e instanceof Set){const e=l.value,t={tracker:i,prop:e,updateSet:t=>{i.copy_ instanceof Set&&(i.copy_.delete(e),i.copy_.add(t),a.set(e,t))}},{proxy:n}=s(l.value,t);l.value=n}else{const e=Symbol("iterator-value"),{proxy:t}=s(l.value,{tracker:i,prop:e});l.value=t}return l},[Symbol.iterator](){return this}}}return l}}return n.bind(e)}if(n&&"object"==typeof n&&!(n instanceof Date)&&!(n instanceof RegExp)){const e={tracker:i,prop:String(t)},{proxy:o}=s(a,e);return r.set(n,o),o}return n},set(e,n,s){const r=i.copy_[n];if(ba(String(n)),xa(r,s))ba();else{const e=i.originalObject[n],r=xa(s,e);if(ba(),r){ba(String(n)),delete i.assigned_[n.toString()],ba(String(n)),i.copy_[n]=wa(e),ba();const s=a(i);ba(),s?(ba(),i.modified=!1,i.assigned_={},t&&(ba(t.prop),l(t.tracker,t.prop))):(ba(),i.modified=!0)}else ba(String(n)),i.copy_[n]=s,i.assigned_[n.toString()]=!0,ba(),o(i)}return!0},defineProperty:(e,t,n)=>("value"in n&&(i.copy_[t]=wa(n.value),i.assigned_[t.toString()]=!0,o(i)),!0),deleteProperty(e,t){ba();const n="symbol"==typeof t?t.toString():t;if(n in e){const e=n in i.originalObject;delete i.copy_[t],e?(i.assigned_[n]=!1,i.copy_[n]=void 0,o(i)):(delete i.copy_[n],delete i.assigned_[n],0===Object.keys(i.assigned_).length&&0===Object.getOwnPropertySymbols(i.assigned_).length?i.modified=!1:i.modified=!0)}return!0}});return r.set(e,n),n}(e),getChanges:()=>{if(ba(i.modified),ba(),!i.modified)return ba(),{};if("object"!=typeof i.copy_||Array.isArray(i.copy_))return i.copy_;if(0===Object.keys(i.assigned_).length)return i.copy_;const e={};for(const t in i.copy_)!0===i.assigned_[t]&&t in i.copy_&&(e[t]=i.copy_[t]);return ba(),e}}}function ka(e,t){const{proxies:n,getChanges:s}=function(e){const t=e.map(e=>Ca(e));return{proxies:t.map(e=>e.proxy),getChanges:()=>t.map(e=>e.getChanges())}}(e);return t(n),s()}class Oa{constructor(e){this.map=new Map,this.sortedKeys=[],this.comparator=e||this.defaultComparator}defaultComparator(e,t){return e<t?-1:e>t?1:0}indexOf(e){let t=0,n=this.sortedKeys.length;for(;t<n;){const s=Math.floor((t+n)/2),r=this.sortedKeys[s],i=this.map.get(r),o=this.comparator(e,i);if(o<0)n=s;else{if(!(o>0))return s;t=s+1}}return t}set(e,t){if(this.map.has(e)){const t=this.map.get(e),n=this.indexOf(t);this.sortedKeys.splice(n,1)}const n=this.indexOf(t);return this.sortedKeys.splice(n,0,e),this.map.set(e,t),this}get(e){return this.map.get(e)}delete(e){if(this.map.has(e)){const t=this.map.get(e),n=this.indexOf(t);return this.sortedKeys.splice(n,1),this.map.delete(e)}return!1}has(e){return this.map.has(e)}clear(){this.map.clear(),this.sortedKeys=[]}get size(){return this.map.size}*[Symbol.iterator](){for(const e of this.sortedKeys)yield[e,this.map.get(e)]}entries(){return this[Symbol.iterator]()}keys(){return this.sortedKeys[Symbol.iterator]()}values(){return function*(){for(const e of this.sortedKeys)yield this.map.get(e)}.call(this)}forEach(e){for(const t of this.sortedKeys)e(this.map.get(t),t,this.map)}}class Ma{}class _a extends Ma{constructor(e,t){super(),this.collection=e,this.alias=t,this.type="collectionRef"}}class Pa extends Ma{constructor(e,t){super(),this.query=e,this.alias=t,this.type="queryRef"}}class Ia extends Ma{constructor(e){super(),this.path=e,this.type="ref"}}class Aa extends Ma{constructor(e){super(),this.value=e,this.type="val"}}class Ra extends Ma{constructor(e,t){super(),this.name=e,this.args=t,this.type="func"}}function Ea(){const e=new Map;return function t(n){const s=n.join(".");if(e.has(s))return e.get(s);const r=new Proxy({},{get(e,s,r){if("__refProxy"===s)return!0;if("__path"===s)return n;if("__type"===s)return;if("symbol"==typeof s)return Reflect.get(e,s,r);return t([...n,String(s)])},has:(e,t)=>"__refProxy"===t||"__path"===t||"__type"===t||Reflect.has(e,t),ownKeys:e=>Reflect.ownKeys(e),getOwnPropertyDescriptor:(e,t)=>"__refProxy"===t||"__path"===t||"__type"===t?{enumerable:!1,configurable:!0}:Reflect.getOwnPropertyDescriptor(e,t)});return e.set(s,r),r}([])}function Ta(e){const t=new Map,n=new Set;function s(e){const r=e.join(".");if(t.has(r))return t.get(r);const i=new Proxy({},{get(t,n,r){if("__refProxy"===n)return!0;if("__path"===n)return e;if("__type"===n)return;if("symbol"==typeof n)return Reflect.get(t,n,r);return s([...e,String(n)])},has:(e,t)=>"__refProxy"===t||"__path"===t||"__type"===t||Reflect.has(e,t),ownKeys(t){if(1===e.length){const t=e[0];n.add(t)}return Reflect.ownKeys(t)},getOwnPropertyDescriptor:(e,t)=>"__refProxy"===t||"__path"===t||"__type"===t?{enumerable:!1,configurable:!0}:Reflect.getOwnPropertyDescriptor(e,t)});return t.set(r,i),i}return new Proxy({},{get(t,r,i){if("__refProxy"===r)return!0;if("__path"===r)return[];if("__type"===r)return;if("__spreadSentinels"===r)return n;if("symbol"==typeof r)return Reflect.get(t,r,i);const o=String(r);return e.includes(o)?s([o]):void 0},has:(t,n)=>"__refProxy"===n||"__path"===n||"__type"===n||"__spreadSentinels"===n||(!("string"!=typeof n||!e.includes(n))||Reflect.has(t,n)),ownKeys:t=>[...e,"__refProxy","__path","__type","__spreadSentinels"],getOwnPropertyDescriptor:(t,n)=>"__refProxy"===n||"__path"===n||"__type"===n||"__spreadSentinels"===n?{enumerable:!1,configurable:!0}:"string"==typeof n&&e.includes(n)?{enumerable:!0,configurable:!0}:void 0})}function ja(e){return La(e)?new Ia(e.__path):e&&"object"==typeof e&&"type"in e&&("func"===e.type||"ref"===e.type||"val"===e.type||"agg"===e.type)?e:new Aa(e)}function La(e){return e&&"object"==typeof e&&!0===e.__refProxy}class Da{constructor(e,t,n){this._root=Na,this._size=0,this._maxNodeSize=n>=4?Math.min(n,256):32,this._compare=e,t&&this.setPairs(t)}get size(){return this._size}get length(){return this._size}get isEmpty(){return 0===this._size}clear(){this._root=Na,this._size=0}get(e,t){return this._root.get(e,t,this)}set(e,t,n){this._root.isShared&&(this._root=this._root.clone());const s=this._root.set(e,t,n,this);return!0===s||!1===s?s:(this._root=new Fa([this._root,s]),!0)}has(e){return 0!==this.forRange(e,e,!0,void 0)}delete(e){return 0!==this.editRange(e,e,!0,Ba)}get maxNodeSize(){return this._maxNodeSize}minKey(){return this._root.minKey()}maxKey(){return this._root.maxKey()}keysArray(){const e=[];return this._root.forRange(this.minKey(),this.maxKey(),!0,!1,this,0,(t,n)=>{e.push(t)}),e}nextHigherPair(e,t){return t=t||[],void 0===e?this._root.minPair(t):this._root.getPairOrNextHigher(e,this._compare,!1,t)}nextHigherKey(e){const t=this.nextHigherPair(e,Ua);return t&&t[0]}nextLowerPair(e,t){return t=t||[],void 0===e?this._root.maxPair(t):this._root.getPairOrNextLower(e,this._compare,!1,t)}nextLowerKey(e){const t=this.nextLowerPair(e,Ua);return t&&t[0]}setPairs(e,t){let n=0;for(const s of e)this.set(s[0],s[1],t)&&n++;return n}forRange(e,t,n,s,r){const i=this._root.forRange(e,t,n,!1,this,r||0,s);return"number"==typeof i?i:i.break}editRange(e,t,n,s,r){let i=this._root;i.isShared&&(this._root=i=i.clone());try{const o=i.forRange(e,t,n,!0,this,r||0,s);return"number"==typeof o?o:o.break}finally{let e;for(;i.keys.length<=1&&!i.isLeaf;)e||(e=i.isShared),this._root=i=0===i.keys.length?Na:i.children[0];e&&(i.isShared=!0)}}}class $a{get isLeaf(){return void 0===this.children}constructor(e=[],t){this.keys=e,this.values=t||qa,this.isShared=void 0}maxKey(){return this.keys[this.keys.length-1]}indexOf(e,t,n){const s=this.keys;let r=0,i=s.length,o=i>>1;for(;r<i;){const t=n(s[o],e);if(t<0)r=o+1;else{if(!(t>0)){if(0===t)return o;if(e==e)return s.length;throw new Error("BTree: NaN was used as a key")}i=o}o=r+i>>1}return o^t}minKey(){return this.keys[0]}minPair(e){if(0!==this.keys.length)return e[0]=this.keys[0],e[1]=this.values[0],e}maxPair(e){if(0===this.keys.length)return;const t=this.keys.length-1;return e[0]=this.keys[t],e[1]=this.values[t],e}clone(){const e=this.values;return new $a(this.keys.slice(0),e===qa?e:e.slice(0))}get(e,t,n){const s=this.indexOf(e,-1,n._compare);return s<0?t:this.values[s]}getPairOrNextLower(e,t,n,s){const r=this.indexOf(e,-1,t),i=r<0?~r-1:n?r:r-1;if(i>=0)return s[0]=this.keys[i],s[1]=this.values[i],s}getPairOrNextHigher(e,t,n,s){const r=this.indexOf(e,-1,t),i=r<0?~r:n?r:r+1,o=this.keys;if(i<o.length)return s[0]=o[i],s[1]=this.values[i],s}set(e,t,n,s){let r=this.indexOf(e,-1,s._compare);if(r<0){if(r=~r,s._size++,this.keys.length<s._maxNodeSize)return this.insertInLeaf(r,e,t,s);{const n=this.splitOffRightSide();let i=this;return r>this.keys.length&&(r-=this.keys.length,i=n),i.insertInLeaf(r,e,t,s),n}}return!1!==n&&(void 0!==t&&this.reifyValues(),this.keys[r]=e,this.values[r]=t),!1}reifyValues(){return this.values===qa?this.values=this.values.slice(0,this.keys.length):this.values}insertInLeaf(e,t,n,s){if(this.keys.splice(e,0,t),this.values===qa){for(;qa.length<s._maxNodeSize;)qa.push(void 0);if(void 0===n)return!0;this.values=qa.slice(0,this.keys.length-1)}return this.values.splice(e,0,n),!0}takeFromRight(e){let t=this.values;e.values===qa?t!==qa&&t.push(void 0):(t=this.reifyValues(),t.push(e.values.shift())),this.keys.push(e.keys.shift())}takeFromLeft(e){let t=this.values;e.values===qa?t!==qa&&t.unshift(void 0):(t=this.reifyValues(),t.unshift(e.values.pop())),this.keys.unshift(e.keys.pop())}splitOffRightSide(){const e=this.keys.length>>1,t=this.keys.splice(e),n=this.values===qa?qa:this.values.splice(e);return new $a(t,n)}forRange(e,t,n,s,r,i,o){const a=r._compare;let l,c;if(t===e){if(!n)return i;if(c=(l=this.indexOf(e,-1,a))+1,l<0)return i}else l=this.indexOf(e,0,a),c=this.indexOf(t,-1,a),c<0?c=~c:!0===n&&c++;const u=this.keys,h=this.values;if(void 0!==o)for(let d=l;d<c;d++){const e=u[d],t=o(e,h[d],i++);if(void 0!==t){if(!0===s){if(e!==u[d]||!0===this.isShared)throw new Error("BTree illegally changed or cloned in editRange");t.delete?(this.keys.splice(d,1),this.values!==qa&&this.values.splice(d,1),r._size--,d--,c--):t.hasOwnProperty("value")&&(h[d]=t.value)}if(void 0!==t.break)return t}}else i+=c-l;return i}mergeSibling(e,t){if(this.keys.push.apply(this.keys,e.keys),this.values===qa){if(e.values===qa)return;this.values=this.values.slice(0,this.keys.length)}this.values.push.apply(this.values,e.reifyValues())}}class Fa extends $a{constructor(e,t){if(!t){t=[];for(let n=0;n<e.length;n++)t[n]=e[n].maxKey()}super(t),this.children=e}minKey(){return this.children[0].minKey()}minPair(e){return this.children[0].minPair(e)}maxPair(e){return this.children[this.children.length-1].maxPair(e)}get(e,t,n){const s=this.indexOf(e,0,n._compare),r=this.children;return s<r.length?r[s].get(e,t,n):void 0}getPairOrNextLower(e,t,n,s){const r=this.indexOf(e,0,t),i=this.children;if(r>=i.length)return this.maxPair(s);const o=i[r].getPairOrNextLower(e,t,n,s);return void 0===o&&r>0?i[r-1].maxPair(s):o}getPairOrNextHigher(e,t,n,s){const r=this.indexOf(e,0,t),i=this.children,o=i.length;if(r>=o)return;const a=i[r].getPairOrNextHigher(e,t,n,s);return void 0===a&&r<o-1?i[r+1].minPair(s):a}set(e,t,n,s){const r=this.children,i=s._maxNodeSize,o=s._compare;let a=Math.min(this.indexOf(e,0,o),r.length-1),l=r[a];if(l.isShared&&(r[a]=l=l.clone()),l.keys.length>=i){let t;a>0&&(t=r[a-1]).keys.length<i&&o(l.keys[0],e)<0?(t.isShared&&(r[a-1]=t=t.clone()),t.takeFromRight(l),this.keys[a-1]=t.maxKey()):void 0!==(t=r[a+1])&&t.keys.length<i&&o(l.maxKey(),e)<0&&(t.isShared&&(r[a+1]=t=t.clone()),t.takeFromLeft(l),this.keys[a]=r[a].maxKey())}const c=l.set(e,t,n,s);if(!1===c)return!1;if(this.keys[a]=l.maxKey(),!0===c)return!0;if(this.keys.length<i)return this.insert(a+1,c),!0;{const e=this.splitOffRightSide();let t=this;return o(c.maxKey(),this.maxKey())>0&&(t=e,a-=this.keys.length),t.insert(a+1,c),e}}insert(e,t){this.children.splice(e,0,t),this.keys.splice(e,0,t.maxKey())}splitOffRightSide(){const e=this.children.length>>1;return new Fa(this.children.splice(e),this.keys.splice(e))}takeFromRight(e){this.keys.push(e.keys.shift()),this.children.push(e.children.shift())}takeFromLeft(e){this.keys.unshift(e.keys.pop()),this.children.unshift(e.children.pop())}forRange(e,t,n,s,r,i,o){const a=r._compare,l=this.keys,c=this.children;let u=this.indexOf(e,0,a),h=u;const d=Math.min(t===e?u:this.indexOf(t,0,a),l.length-1);if(s){if(h<=d)try{for(;h<=d;h++){c[h].isShared&&(c[h]=c[h].clone());const a=c[h].forRange(e,t,n,s,r,i,o);if(l[h]=c[h].maxKey(),"number"!=typeof a)return a;i=a}}finally{const e=r._maxNodeSize>>1;for(u>0&&u--,h=d;h>=u;h--)c[h].keys.length<=e&&(0!==c[h].keys.length?this.tryMerge(h,r._maxNodeSize):(l.splice(h,1),c.splice(h,1)));0!==c.length&&0===c[0].keys.length&&function(e,...t){throw t.unshift("B+ tree"),new Error(t.join(" "))}(0,"emptiness bug")}}else for(;h<=d;h++){const a=c[h].forRange(e,t,n,s,r,i,o);if("number"!=typeof a)return a;i=a}return i}tryMerge(e,t){const n=this.children;return e>=0&&e+1<n.length&&n[e].keys.length+n[e+1].keys.length<=t&&(n[e].isShared&&(n[e]=n[e].clone()),n[e].mergeSibling(n[e+1],t),n.splice(e+1,1),this.keys.splice(e+1,1),this.keys[e]=n[e].maxKey(),!0)}mergeSibling(e,t){const n=this.keys.length;this.keys.push.apply(this.keys,e.keys);const s=e.children;if(this.children.push.apply(this.children,s),e.isShared&&!this.isShared)for(const r of s)r.isShared=!0;this.tryMerge(n-1,t)}}const qa=[],Va={delete:!0},Ba=()=>Va,Na=function(){const e=new $a;return e.isShared=!0,e}(),Ua=[];const Ka=new WeakMap;let za=1;function Wa(e){if(Ka.has(e))return Ka.get(e);const t=za++;return Ka.set(e,t),t}const Qa=(e,t,n)=>{const{nulls:s}=n;if(null==e&&null==t)return 0;if(null==e)return"first"===s?-1:1;if(null==t)return"first"===s?1:-1;if("string"==typeof e&&"string"==typeof t&&"locale"===n.stringSort)return e.localeCompare(t,n.locale,n.localeOptions);if(Array.isArray(e)&&Array.isArray(t)){for(let s=0;s<Math.min(e.length,t.length);s++){const r=Qa(e[s],t[s],n);if(0!==r)return r}return e.length-t.length}if(e instanceof Date&&t instanceof Date)return e.getTime()-t.getTime();const r="object"==typeof e,i="object"==typeof t;if(r||i){if(r&&i){return Wa(e)-Wa(t)}if(r)return 1;if(i)return-1}return e<t?-1:e>t?1:0};function Ha(e){return(t,n)=>"asc"===e.direction?Qa(t,n,e):((e,t,n)=>Qa(t,e,{...n,nulls:"first"===n.nulls?"last":"first"}))(t,n,e)}const Ga=Ha({direction:"asc",nulls:"first",stringSort:"locale"});class Ja extends Error{constructor(e){super(e),this.name="TanStackDBError"}}class Ya extends Ja{constructor(e,t,n){const s=`${"insert"===e?"Insert":"Update"} validation failed: ${t.map(e=>`\n- ${e.message} - path: ${e.path}`).join("")}`;super(n||s),this.name="SchemaValidationError",this.type=e,this.issues=t}}class Za extends Ja{constructor(e){super(e),this.name="CollectionConfigurationError"}}class Xa extends Za{constructor(){super("Collection requires a config")}}class el extends Za{constructor(){super("Collection requires a sync config")}}class tl extends Za{constructor(){super("Schema must implement the standard-schema interface")}}class nl extends Za{constructor(){super("Schema validation must be synchronous")}}class sl extends Ja{constructor(e){super(e),this.name="CollectionStateError"}}class rl extends sl{constructor(e,t){super(`Cannot perform ${e} on collection "${t}" - collection is in error state. Try calling cleanup() and restarting the collection.`)}}class il extends sl{constructor(e,t,n){super(`Invalid collection status transition from "${e}" to "${t}" for collection "${n}"`)}}class ol extends sl{constructor(){super("Collection is in error state")}}class al extends sl{constructor(){super("Active subscribers count is negative - this should never happen")}}class ll extends Ja{constructor(e){super(e),this.name="CollectionOperationError"}}class cl extends ll{constructor(e){super(`An object was created without a defined key: ${JSON.stringify(e)}`)}}class ul extends ll{constructor(e){super(`Cannot insert document with ID "${e}" because it already exists in the collection`)}}class hl extends ll{constructor(e,t){super(`Cannot insert document with key "${e}" from sync because it already exists in the collection "${t}"`)}}class dl extends ll{constructor(){super("The first argument to update is missing")}}class fl extends ll{constructor(){super("No keys were passed to update")}}class pl extends ll{constructor(e){super(`The key "${e}" was passed to update but an object for this key was not found in the collection`)}}class gl extends ll{constructor(e,t){super(`Updating the key of an item is not allowed. Original key: "${e}", Attempted new key: "${t}". Please delete the old item and create a new one if a key change is necessary.`)}}class ml extends ll{constructor(){super("No keys were passed to delete")}}class yl extends ll{constructor(e){super(`Collection.delete was called with key '${e}' but there is no item in the collection with this key`)}}class vl extends Ja{constructor(e){super(e),this.name="MissingHandlerError"}}class bl extends vl{constructor(){super("Collection.insert called directly (not within an explicit transaction) but no 'onInsert' handler is configured.")}}class wl extends vl{constructor(){super("Collection.update called directly (not within an explicit transaction) but no 'onUpdate' handler is configured.")}}class xl extends vl{constructor(){super("Collection.delete called directly (not within an explicit transaction) but no 'onDelete' handler is configured.")}}class Sl extends Ja{constructor(e){super(e),this.name="TransactionError"}}class Cl extends Sl{constructor(){super("mutationFn is required when creating a transaction")}}class kl extends Sl{constructor(){super("You can no longer call .mutate() as the transaction is no longer pending")}}class Ol extends Sl{constructor(){super("You can no longer call .rollback() as the transaction is already completed")}}class Ml extends Sl{constructor(){super("You can no longer call .commit() as the transaction is no longer pending")}}class _l extends Sl{constructor(){super("No pending sync transaction to write to")}}class Pl extends Sl{constructor(){super("The pending sync transaction is already committed, you can't still write to it.")}}class Il extends Sl{constructor(){super("No pending sync transaction to commit")}}class Al extends Sl{constructor(){super("The pending sync transaction is already committed, you can't commit it again.")}}class Rl extends Ja{constructor(e){super(e),this.name="QueryBuilderError"}}class El extends Rl{constructor(e){super(`Only one source is allowed in the ${e}`)}}class Tl extends Rl{constructor(e){super(`A sub query passed to a ${e} must have a from clause itself`)}}class jl extends Rl{constructor(){super("Invalid source")}}class Ll extends Rl{constructor(){super("Join condition must be an equality expression")}}class Dl extends Rl{constructor(){super("Query must have a from clause")}}class $l extends Ja{constructor(e){super(e),this.name="QueryCompilationError"}}class Fl extends $l{constructor(){super("DISTINCT requires a SELECT clause.")}}class ql extends $l{constructor(){super("HAVING clause requires GROUP BY clause")}}class Vl extends $l{constructor(){super("LIMIT and OFFSET require an ORDER BY clause to ensure deterministic results")}}class Bl extends $l{constructor(e){super(`Input for collection "${e}" not found in inputs map`)}}class Nl extends $l{constructor(e){super(`Unsupported FROM type: ${e}`)}}class Ul extends $l{constructor(e){super(`Unknown expression type: ${e}`)}}class Kl extends $l{constructor(){super("Reference path cannot be empty")}}class zl extends $l{constructor(e){super(`Unknown function: ${e}`)}}class Wl extends $l{constructor(e){super(`Collection "${e}" not found during compilation of join`)}}class Ql extends Ja{constructor(e){super(e),this.name="JoinError"}}class Hl extends Ql{constructor(e){super(`Unsupported join type: ${e}`)}}class Gl extends Ql{constructor(e){super(`Invalid join condition: both expressions refer to the same table "${e}"`)}}class Jl extends Ql{constructor(e,t){super(`Invalid join condition: expressions must reference table aliases "${e}" and "${t}"`)}}class Yl extends Ql{constructor(e,t,n,s){super(`Invalid join condition: expressions reference tables "${e}" and "${t}" but join is between "${n}" and "${s}"`)}}class Zl extends Ql{constructor(e){super(`Unsupported join source type: ${e}`)}}class Xl extends Ja{constructor(e){super(e),this.name="GroupByError"}}class ec extends Xl{constructor(e){super(`Non-aggregate expression '${e}' in SELECT must also appear in GROUP BY clause`)}}class tc extends Xl{constructor(e){super(`Unsupported aggregate function: ${e}`)}}class nc extends Xl{constructor(e){super(`Aggregate function in HAVING clause must also be in SELECT clause: ${e}`)}}class sc extends Xl{constructor(e){super(`Unknown expression type in HAVING clause: ${e}`)}}class rc extends Ja{constructor(e,t){super(`Collection "${e}" sync cleanup function threw an error: ${t instanceof Error?t.message:String(t)}`),this.name="SyncCleanupError"}}class ic extends Ja{constructor(e){super(e),this.name="QueryOptimizerError"}}class oc extends ic{constructor(){super("Cannot combine empty expression list")}}function ac(e,t=!1){return cc(e,t)}function lc(e){return cc(e,!0)}function cc(e,t){switch(e.type){case"val":{const t=e.value;return()=>t}case"ref":return t?function(e){const t=e.path;return e=>{let n=e;for(const s of t){if(null==n)return n;n=n[s]}return n}}(e):function(e){const[t,...n]=e.path;if(!t)throw new Kl;if(0===n.length)return e=>e[t];if(1===n.length){const e=n[0];return n=>{const s=n[t];return null==s?void 0:s[e]}}return e=>{const s=e[t];if(void 0===s)return;let r=s;for(const t of n){if(null==r)return r;r=r[t]}return r}}(e);case"func":return function(e,t){const n=e.args.map(e=>cc(e,t));switch(e.name){case"eq":{const e=n[0],t=n[1];return n=>e(n)===t(n)}case"gt":{const e=n[0],t=n[1];return n=>e(n)>t(n)}case"gte":{const e=n[0],t=n[1];return n=>e(n)>=t(n)}case"lt":{const e=n[0],t=n[1];return n=>e(n)<t(n)}case"lte":{const e=n[0],t=n[1];return n=>e(n)<=t(n)}case"and":return e=>{for(const t of n)if(!t(e))return!1;return!0};case"or":return e=>{for(const t of n)if(t(e))return!0;return!1};case"not":{const e=n[0];return t=>!e(t)}case"in":{const e=n[0],t=n[1];return n=>{const s=e(n),r=t(n);return!!Array.isArray(r)&&r.includes(s)}}case"like":{const e=n[0],t=n[1];return n=>uc(e(n),t(n),!1)}case"ilike":{const e=n[0],t=n[1];return n=>uc(e(n),t(n),!0)}case"upper":{const e=n[0];return t=>{const n=e(t);return"string"==typeof n?n.toUpperCase():n}}case"lower":{const e=n[0];return t=>{const n=e(t);return"string"==typeof n?n.toLowerCase():n}}case"length":{const e=n[0];return t=>{const n=e(t);return"string"==typeof n||Array.isArray(n)?n.length:0}}case"concat":return e=>n.map(t=>{const n=t(e);try{return String(n??"")}catch{try{return JSON.stringify(n)||""}catch{return"[object]"}}}).join("");case"coalesce":return e=>{for(const t of n){const n=t(e);if(null!=n)return n}return null};case"add":{const e=n[0],t=n[1];return n=>(e(n)??0)+(t(n)??0)}case"subtract":{const e=n[0],t=n[1];return n=>(e(n)??0)-(t(n)??0)}case"multiply":{const e=n[0],t=n[1];return n=>(e(n)??0)*(t(n)??0)}case"divide":{const e=n[0],t=n[1];return n=>{const s=e(n),r=t(n)??0;return 0!==r?(s??0)/r:null}}default:throw new zl(e.name)}}(e,t);default:throw new Ul(e.type)}}function uc(e,t,n){if("string"!=typeof e||"string"!=typeof t)return!1;const s=n?e.toLowerCase():e;let r=(n?t.toLowerCase():t).replace(/[.*+?^${}()|[\]\\]/g,"\\$&");r=r.replace(/%/g,".*"),r=r.replace(/_/g,".");return new RegExp(`^${r}$`).test(s)}class hc{constructor(e,t,n,s){this.lookupCount=0,this.totalLookupTime=0,this.lastUpdated=new Date,this.id=e,this.expression=t,this.name=n,this.initialize(s)}supports(e){return this.supportedOperations.has(e)}matchesField(e){return"ref"===this.expression.type&&this.expression.path.length===e.length&&this.expression.path.every((t,n)=>t===e[n])}getStats(){return{entryCount:this.keyCount,lookupCount:this.lookupCount,averageLookupTime:this.lookupCount>0?this.totalLookupTime/this.lookupCount:0,lastUpdated:this.lastUpdated}}evaluateIndexExpression(e){return lc(this.expression)(e)}trackLookup(e){const t=performance.now()-e;this.lookupCount++,this.totalLookupTime+=t}updateTimestamp(){this.lastUpdated=new Date}}class dc extends hc{constructor(e,t,n,s){super(e,t,n,s),this.supportedOperations=new Set(["eq","gt","gte","lt","lte","in"]),this.valueMap=new Map,this.indexedKeys=new Set,this.compareFn=Ga,this.compareFn=(null==s?void 0:s.compareFn)??Ga,this.orderedEntries=new Da(this.compareFn)}initialize(e){}add(e,t){let n;try{n=this.evaluateIndexExpression(t)}catch(s){throw new Error(`Failed to evaluate index expression for key ${e}: ${s}`)}if(this.valueMap.has(n))this.valueMap.get(n).add(e);else{const t=new Set([e]);this.valueMap.set(n,t),this.orderedEntries.set(n,void 0)}this.indexedKeys.add(e),this.updateTimestamp()}remove(e,t){let n;try{n=this.evaluateIndexExpression(t)}catch(s){return}if(this.valueMap.has(n)){const t=this.valueMap.get(n);t.delete(e),0===t.size&&(this.valueMap.delete(n),this.orderedEntries.delete(n))}this.indexedKeys.delete(e),this.updateTimestamp()}update(e,t,n){this.remove(e,t),this.add(e,n)}build(e){this.clear();for(const[t,n]of e)this.add(t,n)}clear(){this.orderedEntries.clear(),this.valueMap.clear(),this.indexedKeys.clear(),this.updateTimestamp()}lookup(e,t){const n=performance.now();let s;switch(e){case"eq":s=this.equalityLookup(t);break;case"gt":s=this.rangeQuery({from:t,fromInclusive:!1});break;case"gte":s=this.rangeQuery({from:t,fromInclusive:!0});break;case"lt":s=this.rangeQuery({to:t,toInclusive:!1});break;case"lte":s=this.rangeQuery({to:t,toInclusive:!0});break;case"in":s=this.inArrayLookup(t);break;default:throw new Error(`Operation ${e} not supported by BTreeIndex`)}return this.trackLookup(n),s}get keyCount(){return this.indexedKeys.size}equalityLookup(e){return new Set(this.valueMap.get(e)??[])}rangeQuery(e={}){const{from:t,to:n,fromInclusive:s=!0,toInclusive:r=!0}=e,i=new Set,o=t??this.orderedEntries.minKey(),a=n??this.orderedEntries.maxKey();return this.orderedEntries.forRange(o,a,r,(e,n)=>{if(!s&&0===this.compareFn(e,t))return;const r=this.valueMap.get(e);r&&r.forEach(e=>i.add(e))}),i}take(e,t){const n=new Set,s=[],r=e=>this.orderedEntries.nextHigherKey(e);let i=t;for(;(i=r(i))&&s.length<e;){const t=this.valueMap.get(i);if(t){const r=t.values();let i;for(;s.length<e&&(i=r.next().value);)n.has(i)||(s.push(i),n.add(i))}}return s}inArrayLookup(e){const t=new Set;for(const n of e){const e=this.valueMap.get(n);e&&e.forEach(e=>t.add(e))}return t}get indexedKeysSet(){return this.indexedKeys}get orderedEntriesArray(){return this.orderedEntries.keysArray().map(e=>[e,this.valueMap.get(e)??new Set])}get valueMapData(){return this.valueMap}}function fc(e){return"function"==typeof e&&void 0!==e.prototype&&e.prototype.constructor===e}class pc{constructor(e,t,n,s,r,i){this.id=e,this.expression=t,this.name=n,this.resolver=s,this.options=r,this.collectionEntries=i,this.indexPromise=null,this.resolvedIndex=null,fc(this.resolver)&&(this.resolvedIndex=new this.resolver(this.id,this.expression,this.name,this.options),this.collectionEntries&&this.resolvedIndex.build(this.collectionEntries))}async resolve(){return this.resolvedIndex||(this.indexPromise||(this.indexPromise=this.createIndex()),this.resolvedIndex=await this.indexPromise),this.resolvedIndex}isResolved(){return null!==this.resolvedIndex}getResolved(){if(!this.resolvedIndex)throw new Error(`Index ${this.id} has not been resolved yet. Ensure collection is synced.`);return this.resolvedIndex}getId(){return this.id}getName(){return this.name}getExpression(){return this.expression}async createIndex(){return new(await async function(e){return fc(e)?e:await e()}(this.resolver))(this.id,this.expression,this.name,this.options)}}class gc{constructor(e,t){this.indexId=e,this.lazyIndex=t}get index(){return this.lazyIndex.getResolved()}get isReady(){return this.lazyIndex.isResolved()}async whenReady(){return await this.lazyIndex.resolve()}get id(){return this.indexId}get name(){return this.isReady?this.index.name:this.lazyIndex.getName()}get expression(){return this.lazyIndex.getExpression()}supports(e){return this.index.supports(e)}getStats(){return this.index.getStats()}matchesField(e){const t=this.expression;return"ref"===t.type&&t.path.length===e.length&&t.path.every((t,n)=>t===e[n])}get keyCount(){return this.index.keyCount}get indexedKeysSet(){return this.index.indexedKeysSet}get orderedEntriesArray(){return this.index.orderedEntriesArray}get valueMapData(){return this.index.valueMapData}equalityLookup(e){var t;const n=this.index;return(null==(t=n.equalityLookup)?void 0:t.call(n,e))??new Set}rangeQuery(e){var t;const n=this.index;return(null==(t=n.rangeQuery)?void 0:t.call(n,e))??new Set}inArrayLookup(e){var t;const n=this.index;return(null==(t=n.inArrayLookup)?void 0:t.call(n,e))??new Set}_getLazyWrapper(){return this.lazyIndex}}function mc(e){return"eager"===e.config.autoIndex&&("loading"!==e.status&&"initialCommit"!==e.status)}function yc(e,t,n,s){if(!mc(n))return;if(!Array.from(n.indexes.values()).find(e=>e.matchesField(t)))try{n.createIndex(t=>t[e],{name:`auto_${e}`,indexType:dc,options:s?{compareFn:s}:{}})}catch(r){}}const vc=[];let bc=[],wc=0;function xc(e){const t=new Cc(e);return vc.push(t),t}function Sc(){return bc.length>0?bc.slice(-1)[0]:void 0}class Cc{constructor(e){if(void 0===e.mutationFn)throw new Cl;this.id=e.id??crypto.randomUUID(),this.mutationFn=e.mutationFn,this.state="pending",this.mutations=[],this.isPersisted=function(){let e,t,n=!0;return{promise:new Promise((s,r)=>{e=e=>{n=!1,s(e)},t=e=>{n=!1,r(e)}}),resolve:e,reject:t,isPending:()=>n}}(),this.autoCommit=e.autoCommit??!0,this.createdAt=new Date,this.sequenceNumber=wc++,this.metadata=e.metadata??{}}setState(e){this.state=e,"completed"!==e&&"failed"!==e||function(e){const t=vc.findIndex(t=>t.id===e.id);-1!==t&&vc.splice(t,1)}(this)}mutate(e){if("pending"!==this.state)throw new kl;var t;t=this,bc.push(t);try{e()}finally{!function(e){bc=bc.filter(t=>t.id!==e.id)}(this)}return this.autoCommit&&this.commit(),this}applyMutations(e){for(const t of e){const e=this.mutations.findIndex(e=>e.globalKey===t.globalKey);e>=0?this.mutations[e]=t:this.mutations.push(t)}}rollback(e){var t;const n=(null==e?void 0:e.isSecondaryRollback)??!1;if("completed"===this.state)throw new Ol;if(this.setState("failed"),!n){const e=new Set;this.mutations.forEach(t=>e.add(t.globalKey));for(const t of vc)"pending"===t.state&&t.mutations.some(t=>e.has(t.globalKey))&&t.rollback({isSecondaryRollback:!0})}return this.isPersisted.reject(null==(t=this.error)?void 0:t.error),this.touchCollection(),this}touchCollection(){const e=new Set;for(const t of this.mutations)e.has(t.collection.id)||(t.collection.onTransactionStateChange(),t.collection.pendingSyncedTransactions.length>0&&t.collection.commitPendingTransactions(),e.add(t.collection.id))}async commit(){if("pending"!==this.state)throw new Ml;if(this.setState("persisting"),0===this.mutations.length)return this.setState("completed"),this.isPersisted.resolve(this),this;try{await this.mutationFn({transaction:this}),this.setState("completed"),this.touchCollection(),this.isPersisted.resolve(this)}catch(e){return this.error={message:e instanceof Error?e.message:String(e),error:e instanceof Error?e:new Error(String(e))},this.rollback()}return this}compareCreatedAt(e){const t=this.createdAt.getTime()-e.createdAt.getTime();return 0!==t?t:this.sequenceNumber-e.sequenceNumber}}function kc(e,t){for(const n of e.values())if(n.matchesField(t))return n}function Oc(e,t){if("func"===e.type)switch(e.name){case"eq":case"gt":case"gte":case"lt":case"lte":return function(e,t){if("func"!==e.type||2!==e.args.length)return{canOptimize:!1,matchingKeys:new Set};const n=e.args[0],s=e.args[1];let r=null,i=null,o=e.name;if("ref"===n.type&&"val"===s.type)r=n,i=s;else if("val"===n.type&&"ref"===s.type)switch(r=s,i=n,o){case"gt":o="lt";break;case"gte":o="lte";break;case"lt":o="gt";break;case"lte":o="gte"}if(r&&i){const e=kc(t,r.path);if(e){const t=i.value,n=o;if(!e.supports(n))return{canOptimize:!1,matchingKeys:new Set};return{canOptimize:!0,matchingKeys:e.lookup(n,t)}}}return{canOptimize:!1,matchingKeys:new Set}}(e,t);case"and":return function(e,t){if("func"!==e.type||e.args.length<2)return{canOptimize:!1,matchingKeys:new Set};const n=function(e,t){if("func"!==e.type||e.args.length<2)return{canOptimize:!1,matchingKeys:new Set};const n=new Map;for(const s of e.args)if("func"===s.type&&["gt","gte","lt","lte"].includes(s.name)){const e=s;if(2===e.args.length){const t=e.args[0],s=e.args[1];let r=null,i=null,o=e.name;if("ref"===t.type&&"val"===s.type)r=t,i=s;else if("val"===t.type&&"ref"===s.type)switch(r=s,i=t,o){case"gt":o="lt";break;case"gte":o="lte";break;case"lt":o="gt";break;case"lte":o="gte"}if(r&&i){const e=r.path.join("."),t=i.value;n.has(e)||n.set(e,[]),n.get(e).push({operation:o,value:t})}}}for(const[s,r]of n)if(r.length>=2){const e=kc(t,s.split("."));if(e&&e.supports("gt")&&e.supports("lt")){let t,n,s=!0,i=!0;for(const{operation:e,value:o}of r)switch(e){case"gt":(void 0===t||o>t)&&(t=o,s=!1);break;case"gte":(void 0===t||o>t)&&(t=o,s=!0);break;case"lt":(void 0===n||o<n)&&(n=o,i=!1);break;case"lte":(void 0===n||o<n)&&(n=o,i=!0)}return{canOptimize:!0,matchingKeys:e.rangeQuery({from:t,to:n,fromInclusive:s,toInclusive:i})}}}return{canOptimize:!1,matchingKeys:new Set}}(e,t);if(n.canOptimize)return n;const s=[];for(const r of e.args){const e=Oc(r,t);e.canOptimize&&s.push(e)}if(s.length>0){return{canOptimize:!0,matchingKeys:function(e){if(0===e.length)return new Set;if(1===e.length)return new Set(e[0]);let t=new Set(e[0]);for(let n=1;n<e.length;n++){const s=new Set;for(const r of t)e[n].has(r)&&s.add(r);t=s}return t}(s.map(e=>e.matchingKeys))}}return{canOptimize:!1,matchingKeys:new Set}}(e,t);case"or":return function(e,t){if("func"!==e.type||e.args.length<2)return{canOptimize:!1,matchingKeys:new Set};const n=[];for(const s of e.args){const e=Oc(s,t);e.canOptimize&&n.push(e)}if(n.length>0){return{canOptimize:!0,matchingKeys:function(e){const t=new Set;for(const n of e)for(const e of n)t.add(e);return t}(n.map(e=>e.matchingKeys))}}return{canOptimize:!1,matchingKeys:new Set}}(e,t);case"in":return function(e,t){if("func"!==e.type||2!==e.args.length)return{canOptimize:!1,matchingKeys:new Set};const n=e.args[0],s=e.args[1];if("ref"===n.type&&"val"===s.type&&Array.isArray(s.value)){const e=n.path,r=s.value,i=kc(t,e);if(i){if(i.supports("in")){return{canOptimize:!0,matchingKeys:i.lookup("in",r)}}if(i.supports("eq")){const e=new Set;for(const t of r){const n=i.lookup("eq",t);for(const t of n)e.add(t)}return{canOptimize:!0,matchingKeys:e}}}}return{canOptimize:!1,matchingKeys:new Set}}(e,t)}return{canOptimize:!1,matchingKeys:new Set}}function Mc(e,t={}){const n=t=>{const n=[];for(const[s,r]of e.entries())((null==t?void 0:t(r))??1)&&n.push({type:"insert",key:s,value:r});return n};if(!t.where&&!t.whereExpression)return n();try{let s;if(t.whereExpression)s=t.whereExpression;else{if(!t.where)return[];{const e=Ea();s=ja(t.where(e))}}const r=function(e,t){return Oc(e,t)}(s,e.indexes);if(r.canOptimize){const t=[];for(const n of r.matchingKeys){const s=e.get(n);void 0!==s&&t.push({type:"insert",key:n,value:s})}return t}return n(t.where?_c(t.where):Pc(s))}catch(s){return n(t.where?_c(t.where):Pc(t.whereExpression))}}function _c(e){return t=>{try{const n=Ea(),s=e(n),r=lc(ja(s));return r(t)}catch{try{const n=new Proxy(t,{get:(e,t)=>e[t]});return e(n)}catch{return!1}}}}function Pc(e){return t=>{try{const n=lc(e)(t);return Boolean(n)}catch{return!1}}}function Ic(e){const t=new Ac(e);return e.utils?t.utils={...e.utils}:t.utils={},t}class Ac{constructor(e){if(this.pendingSyncedTransactions=[],this.syncedMetadata=new Map,this.optimisticUpserts=new Map,this.optimisticDeletes=new Set,this._size=0,this.lazyIndexes=new Map,this.resolvedIndexes=new Map,this.isIndexesResolved=!1,this.indexCounter=0,this.changeListeners=new Set,this.changeKeyListeners=new Map,this.utils={},this.syncedKeys=new Set,this.preSyncVisibleState=new Map,this.recentlySyncedKeys=new Set,this.hasReceivedFirstCommit=!1,this.isCommittingSyncTransactions=!1,this.onFirstReadyCallbacks=[],this.hasBeenReady=!1,this.batchedEvents=[],this.shouldBatchEvents=!1,this._status="idle",this.activeSubscribersCount=0,this.gcTimeoutId=null,this.preloadPromise=null,this.syncCleanupFn=null,this.id="",this.commitPendingTransactions=()=>{let e=!1;for(const n of this.transactions.values())if("persisting"===n.state){e=!0;break}const t=this.pendingSyncedTransactions.some(e=>!0===e.truncate);if(!e||t){this.isCommittingSyncTransactions=!0;const e=new Set;for(const i of this.pendingSyncedTransactions)for(const t of i.operations)e.add(t.key);let t=this.preSyncVisibleState;if(0===t.size){t=new Map;for(const n of e){const e=this.get(n);void 0!==e&&t.set(n,e)}}const n=[],s=this.config.sync.rowUpdateMode||"partial";for(const i of this.pendingSyncedTransactions){if(i.truncate){for(const e of this.syncedData.keys()){if(this.optimisticDeletes.has(e))continue;const t=this.optimisticUpserts.get(e)||this.syncedData.get(e);void 0!==t&&n.push({type:"delete",key:e,value:t})}this.syncedData.clear(),this.syncedMetadata.clear(),this.syncedKeys.clear()}for(const e of i.operations){const t=e.key;switch(this.syncedKeys.add(t),e.type){case"insert":this.syncedMetadata.set(t,e.metadata);break;case"update":this.syncedMetadata.set(t,Object.assign({},this.syncedMetadata.get(t),e.metadata));break;case"delete":this.syncedMetadata.delete(t)}switch(e.type){case"insert":this.syncedData.set(t,e.value);break;case"update":if("partial"===s){const n=Object.assign({},this.syncedData.get(t),e.value);this.syncedData.set(t,n)}else this.syncedData.set(t,e.value);break;case"delete":this.syncedData.delete(t)}}}if(this.pendingSyncedTransactions.some(e=>!0===e.truncate)){const e=new Set;for(const n of this.pendingSyncedTransactions)for(const t of n.operations)"insert"!==t.type&&"update"!==t.type||e.add(t.key);const t=new Map,s=new Set;for(const n of this.transactions.values())if(!["completed","failed"].includes(n.state))for(const e of n.mutations){if(e.collection!==this||!e.optimistic)continue;const n=e.key;switch(e.type){case"insert":t.set(n,e.modified),s.delete(n);break;case"update":{const r=this.syncedData.get(n),i=r?Object.assign({},r,e.changes):e.modified;t.set(n,i),s.delete(n);break}case"delete":t.delete(n),s.add(n)}}for(const[r,i]of t)if(!s.has(r))if(e.has(r)){let e=!1;for(let t=n.length-1;t>=0;t--){const s=n[t];if(s.key===r&&"insert"===s.type){s.value=i,e=!0;break}}e||n.push({type:"insert",key:r,value:i})}else n.push({type:"insert",key:r,value:i});if(n.length>0&&s.size>0){const e=[];for(const t of n)"insert"===t.type&&s.has(t.key)||e.push(t);n.length=0,n.push(...e)}this.isReady()||this.setStatus("ready")}this.optimisticUpserts.clear(),this.optimisticDeletes.clear(),this.isCommittingSyncTransactions=!1;for(const i of this.transactions.values())if(!["completed","failed"].includes(i.state))for(const e of i.mutations)if(e.collection===this&&e.optimistic)switch(e.type){case"insert":case"update":this.optimisticUpserts.set(e.key,e.modified),this.optimisticDeletes.delete(e.key);break;case"delete":this.optimisticUpserts.delete(e.key),this.optimisticDeletes.add(e.key)}const r=new Map;for(const i of this.transactions.values())if("completed"===i.state)for(const t of i.mutations)t.collection===this&&e.has(t.key)&&r.set(t.key,{type:t.type,value:t.modified});for(const i of e){const e=t.get(i),s=this.get(i),o=r.get(i);o&&void 0!==s&&this.deepEqual(o.value,s)||(void 0===e&&void 0!==s?n.push({type:"insert",key:i,value:s}):void 0!==e&&void 0===s?n.push({type:"delete",key:i,value:e}):void 0===e||void 0===s||this.deepEqual(e,s)||n.push({type:"update",key:i,value:s,previousValue:e}))}if(this._size=this.calculateSize(),n.length>0&&this.updateIndexes(n),this.emitEvents(n,!0),this.pendingSyncedTransactions=[],this.preSyncVisibleState.clear(),Promise.resolve().then(()=>{this.recentlySyncedKeys.clear()}),!this.hasReceivedFirstCommit){this.hasReceivedFirstCommit=!0;const e=[...this.onFirstReadyCallbacks];this.onFirstReadyCallbacks=[],e.forEach(e=>e())}}},this.insert=(e,t)=>{this.validateCollectionUsable("insert");const n=Sc();if(!n&&!this.config.onInsert)throw new bl;const s=Array.isArray(e)?e:[e],r=[];if(s.forEach(e=>{var n,s;const i=this.validateData(e,"insert"),o=this.getKeyFromItem(i);if(this.has(o))throw new ul(o);const a=this.generateGlobalKey(o,e),l={mutationId:crypto.randomUUID(),original:{},modified:i,changes:Object.fromEntries(Object.keys(e).map(e=>[e,i[e]])),globalKey:a,key:o,metadata:null==t?void 0:t.metadata,syncMetadata:(null==(s=(n=this.config.sync).getSyncMetadata)?void 0:s.call(n))||{},optimistic:(null==t?void 0:t.optimistic)??!0,type:"insert",createdAt:new Date,updatedAt:new Date,collection:this};r.push(l)}),n)return n.applyMutations(r),this.transactions.set(n.id,n),this.scheduleTransactionCleanup(n),this.recomputeOptimisticState(!0),n;{const e=xc({mutationFn:async e=>await this.config.onInsert({transaction:e.transaction,collection:this})});return e.applyMutations(r),e.commit(),this.transactions.set(e.id,e),this.scheduleTransactionCleanup(e),this.recomputeOptimisticState(!0),e}},this.delete=(e,t)=>{this.validateCollectionUsable("delete");const n=Sc();if(!n&&!this.config.onDelete)throw new xl;if(Array.isArray(e)&&0===e.length)throw new ml;const s=Array.isArray(e)?e:[e],r=[];for(const o of s){if(!this.has(o))throw new yl(o);const e=this.generateGlobalKey(o,this.get(o)),n={mutationId:crypto.randomUUID(),original:this.get(o),modified:this.get(o),changes:this.get(o),globalKey:e,key:o,metadata:null==t?void 0:t.metadata,syncMetadata:this.syncedMetadata.get(o)||{},optimistic:(null==t?void 0:t.optimistic)??!0,type:"delete",createdAt:new Date,updatedAt:new Date,collection:this};r.push(n)}if(n)return n.applyMutations(r),this.transactions.set(n.id,n),this.scheduleTransactionCleanup(n),this.recomputeOptimisticState(!0),n;const i=xc({autoCommit:!0,mutationFn:async e=>this.config.onDelete({transaction:e.transaction,collection:this})});return i.applyMutations(r),i.commit(),this.transactions.set(i.id,i),this.scheduleTransactionCleanup(i),this.recomputeOptimisticState(!0),i},!e)throw new Xa;if(e.id?this.id=e.id:this.id=crypto.randomUUID(),!e.sync)throw new el;this.transactions=new Oa((e,t)=>e.compareCreatedAt(t)),this.config={...e,autoIndex:e.autoIndex??"eager"},this.config.compare?this.syncedData=new Oa(this.config.compare):this.syncedData=new Map,!0===e.startSync&&this.startSync()}onFirstReady(e){this.hasBeenReady?e():this.onFirstReadyCallbacks.push(e)}isReady(){return"ready"===this._status}markReady(){if(("loading"===this._status||"initialCommit"===this._status)&&(this.setStatus("ready"),!this.hasBeenReady)){this.hasBeenReady=!0,this.hasReceivedFirstCommit||(this.hasReceivedFirstCommit=!0);const e=[...this.onFirstReadyCallbacks];this.onFirstReadyCallbacks=[],e.forEach(e=>e()),this.changeListeners.size>0&&this.emitEmptyReadyEvent()}}get status(){return this._status}validateCollectionUsable(e){switch(this._status){case"error":throw new rl(e,this.id);case"cleaned-up":this.startSync()}}validateStatusTransition(e,t){if(e===t)return;if(!{idle:["loading","error","cleaned-up"],loading:["initialCommit","ready","error","cleaned-up"],initialCommit:["ready","error","cleaned-up"],ready:["cleaned-up","error"],error:["cleaned-up","idle"],"cleaned-up":["loading","error"]}[e].includes(t))throw new il(e,t,this.id)}setStatus(e){this.validateStatusTransition(this._status,e),this._status=e,"ready"!==e||this.isIndexesResolved||this.resolveAllIndexes().catch(e=>{})}startSyncImmediate(){this.startSync()}startSync(){if("idle"===this._status||"cleaned-up"===this._status){this.setStatus("loading");try{const e=this.config.sync.sync({collection:this,begin:()=>{this.pendingSyncedTransactions.push({committed:!1,operations:[]})},write:e=>{const t=this.pendingSyncedTransactions[this.pendingSyncedTransactions.length-1];if(!t)throw new _l;if(t.committed)throw new Pl;const n=this.getKeyFromItem(e.value);if("insert"===e.type){const e=this.syncedData.has(n),s=t.operations.some(e=>e.key===n&&"delete"===e.type),r=!0===t.truncate;if(e&&!s&&!r)throw new hl(n,this.id)}const s={...e,key:n};t.operations.push(s)},commit:()=>{const e=this.pendingSyncedTransactions[this.pendingSyncedTransactions.length-1];if(!e)throw new Il;if(e.committed)throw new Al;e.committed=!0,"loading"===this._status&&this.setStatus("initialCommit"),this.commitPendingTransactions()},markReady:()=>{this.markReady()},truncate:()=>{const e=this.pendingSyncedTransactions[this.pendingSyncedTransactions.length-1];if(!e)throw new _l;if(e.committed)throw new Pl;e.operations=[],e.truncate=!0}});this.syncCleanupFn="function"==typeof e?e:null}catch(e){throw this.setStatus("error"),e}}}preload(){return this.preloadPromise||(this.preloadPromise=new Promise((e,t)=>{if("ready"!==this._status)if("error"!==this._status){if(this.onFirstReady(()=>{e()}),"idle"===this._status||"cleaned-up"===this._status)try{this.startSync()}catch(n){return void t(n)}}else t(new ol);else e()})),this.preloadPromise}async cleanup(){this.gcTimeoutId&&(clearTimeout(this.gcTimeoutId),this.gcTimeoutId=null);try{this.syncCleanupFn&&(this.syncCleanupFn(),this.syncCleanupFn=null)}catch(e){queueMicrotask(()=>{if(e instanceof Error){const t=new rc(this.id,e);throw t.cause=e,t.stack=e.stack,t}throw new rc(this.id,e)})}return this.syncedData.clear(),this.syncedMetadata.clear(),this.optimisticUpserts.clear(),this.optimisticDeletes.clear(),this._size=0,this.pendingSyncedTransactions=[],this.syncedKeys.clear(),this.hasReceivedFirstCommit=!1,this.hasBeenReady=!1,this.onFirstReadyCallbacks=[],this.preloadPromise=null,this.batchedEvents=[],this.shouldBatchEvents=!1,this.setStatus("cleaned-up"),Promise.resolve()}startGCTimer(){this.gcTimeoutId&&clearTimeout(this.gcTimeoutId);const e=this.config.gcTime??3e5;this.gcTimeoutId=setTimeout(()=>{0===this.activeSubscribersCount&&this.cleanup()},e)}cancelGCTimer(){this.gcTimeoutId&&(clearTimeout(this.gcTimeoutId),this.gcTimeoutId=null)}addSubscriber(){this.activeSubscribersCount++,this.cancelGCTimer(),"cleaned-up"!==this._status&&"idle"!==this._status||this.startSync()}removeSubscriber(){if(this.activeSubscribersCount--,0===this.activeSubscribersCount)this.activeSubscribersCount=0,this.startGCTimer();else if(this.activeSubscribersCount<0)throw new al}recomputeOptimisticState(e=!1){if(this.isCommittingSyncTransactions)return;const t=new Map(this.optimisticUpserts),n=new Set(this.optimisticDeletes);this.optimisticUpserts.clear(),this.optimisticDeletes.clear();const s=[];for(const o of this.transactions.values())["completed","failed"].includes(o.state)||s.push(o);for(const o of s)for(const e of o.mutations)if(e.collection===this&&e.optimistic)switch(e.type){case"insert":case"update":this.optimisticUpserts.set(e.key,e.modified),this.optimisticDeletes.delete(e.key);break;case"delete":this.optimisticUpserts.delete(e.key),this.optimisticDeletes.add(e.key)}this._size=this.calculateSize();const r=[];this.collectOptimisticChanges(t,n,r);const i=r.filter(t=>!this.recentlySyncedKeys.has(t.key)||!!e);if(this.pendingSyncedTransactions.length>0&&!e){const t=new Set;for(const e of this.pendingSyncedTransactions)for(const n of e.operations)t.add(n.key);const n=i.filter(e=>{if("delete"===e.type&&t.has(e.key)){if(!s.some(t=>t.mutations.some(t=>t.collection===this&&t.key===e.key)))return!1}return!0});n.length>0&&this.updateIndexes(n),this.emitEvents(n,e)}else i.length>0&&this.updateIndexes(i),this.emitEvents(i,e)}calculateSize(){return this.syncedData.size-Array.from(this.optimisticDeletes).filter(e=>this.syncedData.has(e)&&!this.optimisticUpserts.has(e)).length+Array.from(this.optimisticUpserts.keys()).filter(e=>!this.syncedData.has(e)).length}collectOptimisticChanges(e,t,n){const s=new Set([...e.keys(),...this.optimisticUpserts.keys(),...t,...this.optimisticDeletes]);for(const r of s){const s=this.get(r),i=this.getPreviousValue(r,e,t);void 0!==i&&void 0===s?n.push({type:"delete",key:r,value:i}):void 0===i&&void 0!==s?n.push({type:"insert",key:r,value:s}):void 0!==i&&void 0!==s&&i!==s&&n.push({type:"update",key:r,value:s,previousValue:i})}}getPreviousValue(e,t,n){if(!n.has(e))return t.has(e)?t.get(e):this.syncedData.get(e)}emitEmptyReadyEvent(){for(const e of this.changeListeners)e([]);for(const[e,t]of this.changeKeyListeners)for(const n of t)n([])}emitEvents(e,t=!1){if(this.shouldBatchEvents&&!t)return void this.batchedEvents.push(...e);let n=e;if(this.batchedEvents.length>0&&t&&(n=[...this.batchedEvents,...e],this.batchedEvents=[],this.shouldBatchEvents=!1),0!==n.length){for(const e of this.changeListeners)e(n);if(this.changeKeyListeners.size>0){const e=new Map;for(const t of n)this.changeKeyListeners.has(t.key)&&(e.has(t.key)||e.set(t.key,[]),e.get(t.key).push(t));for(const[t,n]of e){const e=this.changeKeyListeners.get(t);for(const t of e)t(n)}}}}get(e){if(!this.optimisticDeletes.has(e))return this.optimisticUpserts.has(e)?this.optimisticUpserts.get(e):this.syncedData.get(e)}has(e){return!this.optimisticDeletes.has(e)&&(!!this.optimisticUpserts.has(e)||this.syncedData.has(e))}get size(){return this._size}*keys(){for(const e of this.syncedData.keys())this.optimisticDeletes.has(e)||(yield e);for(const e of this.optimisticUpserts.keys())this.syncedData.has(e)||this.optimisticDeletes.has(e)||(yield e)}*values(){for(const e of this.keys()){const t=this.get(e);void 0!==t&&(yield t)}}*entries(){for(const e of this.keys()){const t=this.get(e);void 0!==t&&(yield[e,t])}}*[Symbol.iterator](){for(const[e,t]of this.entries())yield[e,t]}forEach(e){let t=0;for(const[n,s]of this.entries())e(s,n,t++)}map(e){const t=[];let n=0;for(const[s,r]of this.entries())t.push(e(r,s,n++));return t}scheduleTransactionCleanup(e){"completed"!==e.state?e.isPersisted.promise.then(()=>{this.transactions.delete(e.id)}).catch(()=>{}):this.transactions.delete(e.id)}ensureStandardSchema(e){if(e&&"~standard"in e)return e;throw new tl}getKeyFromItem(e){return this.config.getKey(e)}generateGlobalKey(e,t){if(void 0===e)throw new cl(t);return`KEY::${this.id}/${e}`}createIndex(e,t={}){this.validateCollectionUsable("createIndex");const n=++this.indexCounter,s=ja(e(Ea())),r=t.indexType??dc,i=new pc(n,s,t.name,r,t.options,this.entries());if(this.lazyIndexes.set(n,i),r===dc)try{const e=i.getResolved();this.resolvedIndexes.set(n,e)}catch(o){}else if("function"==typeof r&&r.prototype)try{const e=i.getResolved();this.resolvedIndexes.set(n,e)}catch{this.resolveSingleIndex(n,i).catch(e=>{})}else this.isIndexesResolved&&this.resolveSingleIndex(n,i).catch(e=>{});return new gc(n,i)}async resolveAllIndexes(){if(this.isIndexesResolved)return;const e=Array.from(this.lazyIndexes.entries()).map(async([e,t])=>{const n=await t.resolve();return n.build(this.entries()),this.resolvedIndexes.set(e,n),{indexId:e,resolvedIndex:n}});await Promise.all(e),this.isIndexesResolved=!0}async resolveSingleIndex(e,t){const n=await t.resolve();return n.build(this.entries()),this.resolvedIndexes.set(e,n),n}get indexes(){return this.resolvedIndexes}updateIndexes(e){for(const t of this.resolvedIndexes.values())for(const n of e)switch(n.type){case"insert":t.add(n.key,n.value);break;case"update":n.previousValue?t.update(n.key,n.previousValue,n.value):t.add(n.key,n.value);break;case"delete":t.remove(n.key,n.value)}}deepEqual(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(typeof e!=typeof t)return!1;if("object"==typeof e){if(Array.isArray(e)!==Array.isArray(t))return!1;const n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;const r=new Set(s);for(const i of n){if(!r.has(i))return!1;if(!this.deepEqual(e[i],t[i]))return!1}return!0}return!1}validateData(e,t,n){if(!this.config.schema)return e;const s=this.ensureStandardSchema(this.config.schema);if("update"===t&&n){const r=this.get(n);if(r&&e&&"object"==typeof e&&"object"==typeof r){const n=Object.assign({},r,e),i=s["~standard"].validate(n);if(i instanceof Promise)throw new nl;if("issues"in i&&i.issues){const e=i.issues.map(e=>{var t;return{message:e.message,path:null==(t=e.path)?void 0:t.map(e=>String(e))}});throw new Ya(t,e)}return e}}const r=s["~standard"].validate(e);if(r instanceof Promise)throw new nl;if("issues"in r&&r.issues){const e=r.issues.map(e=>{var t;return{message:e.message,path:null==(t=e.path)?void 0:t.map(e=>String(e))}});throw new Ya(t,e)}return r.value}update(e,t,n){if(void 0===e)throw new dl;this.validateCollectionUsable("update");const s=Sc();if(!s&&!this.config.onUpdate)throw new wl;const r=Array.isArray(e),i=r?e:[e];if(r&&0===i.length)throw new fl;const o="function"==typeof t?t:n,a="function"==typeof t?{}:t,l=i.map(e=>{const t=this.get(e);if(!t)throw new pl(e);return t});let c;if(r)c=ka(l,o);else{const e=function(e,t){const{proxy:n,getChanges:s}=Ca(e);return t(n),s()}(l[0],o);c=[e]}const u=i.map((e,t)=>{const n=c[t];if(!n||0===Object.keys(n).length)return null;const s=l[t],r=this.validateData(n,"update",e),i=Object.assign({},s,r),o=this.getKeyFromItem(s),u=this.getKeyFromItem(i);if(o!==u)throw new gl(o,u);const h=this.generateGlobalKey(u,i);return{mutationId:crypto.randomUUID(),original:s,modified:i,changes:r,globalKey:h,key:e,metadata:a.metadata,syncMetadata:this.syncedMetadata.get(e)||{},optimistic:a.optimistic??!0,type:"update",createdAt:new Date,updatedAt:new Date,collection:this}}).filter(Boolean);if(0===u.length){const e=xc({mutationFn:async()=>{}});return e.commit(),this.scheduleTransactionCleanup(e),e}if(s)return s.applyMutations(u),this.transactions.set(s.id,s),this.scheduleTransactionCleanup(s),this.recomputeOptimisticState(!0),s;const h=xc({mutationFn:async e=>this.config.onUpdate({transaction:e.transaction,collection:this})});return h.applyMutations(u),h.commit(),this.transactions.set(h.id,h),this.scheduleTransactionCleanup(h),this.recomputeOptimisticState(!0),h}get state(){const e=new Map;for(const[t,n]of this.entries())e.set(t,n);return e}stateWhenReady(){return this.size>0||this.isReady()?Promise.resolve(this.state):new Promise(e=>{this.onFirstReady(()=>{e(this.state)})})}get toArray(){return Array.from(this.values())}toArrayWhenReady(){return this.size>0||this.isReady()?Promise.resolve(this.toArray):new Promise(e=>{this.onFirstReady(()=>{e(this.toArray)})})}currentStateAsChanges(e={}){return Mc(this,e)}subscribeChanges(e,t={}){this.addSubscriber(),t.whereExpression&&function(e,t){if(!mc(t))return;const n=function(e){const t=[];function n(e){if("func"!==e.type)return;const s=e;if("and"===s.name){for(const e of s.args)n(e);return}if(!["eq","gt","gte","lt","lte","in"].includes(s.name))return;if(s.args.length<1||"ref"!==s.args[0].type)return;const r=s.args[0].path;if(1!==r.length)return;const i=r[0];t.push({fieldName:i,fieldPath:r})}return n(e),t}(e);for(const{fieldName:s,fieldPath:r}of n)yc(s,r,t)}(t.whereExpression,this);const n=t.where||t.whereExpression?function(e,t){const n=t.whereExpression?Pc(t.whereExpression):_c(t.where);return t=>{const s=[];for(const e of t)if("insert"===e.type)n(e.value)&&s.push(e);else if("update"===e.type){const t=n(e.value),r=!!e.previousValue&&n(e.previousValue);t&&r?s.push(e):t&&!r?s.push({...e,type:"insert"}):!t&&r&&s.push({...e,type:"delete",value:e.previousValue})}else n(e.value)&&s.push(e);(s.length>0||0===t.length)&&e(s)}}(e,t):e;if(t.includeInitialState){const e=this.currentStateAsChanges({where:t.where,whereExpression:t.whereExpression});n(e)}return this.changeListeners.add(n),()=>{this.changeListeners.delete(n),this.removeSubscriber()}}subscribeChangesKey(e,t,{includeInitialState:n=!1}={}){return this.addSubscriber(),this.changeKeyListeners.has(e)||this.changeKeyListeners.set(e,new Set),n&&t([{type:"insert",key:e,value:this.get(e)}]),this.changeKeyListeners.get(e).add(t),()=>{const n=this.changeKeyListeners.get(e);n&&(n.delete(t),0===n.size&&this.changeKeyListeners.delete(e)),this.removeSubscriber()}}capturePreSyncVisibleState(){if(0===this.pendingSyncedTransactions.length)return;this.preSyncVisibleState.clear();const e=new Set;for(const t of this.pendingSyncedTransactions)for(const n of t.operations)e.add(n.key);for(const t of e)this.recentlySyncedKeys.add(t);for(const t of e){const e=this.get(t);void 0!==e&&this.preSyncVisibleState.set(t,e)}}onTransactionStateChange(){this.shouldBatchEvents=this.pendingSyncedTransactions.length>0,this.capturePreSyncVisibleState(),this.recomputeOptimisticState(!1)}}class Rc{constructor(e={}){this.query={},this.query={...e}}_createRefForSource(e,t){if(1!==Object.keys(e).length)throw new El(t);const n=Object.keys(e)[0],s=e[n];let r;if(s instanceof Ac)r=new _a(s,n);else{if(!(s instanceof Rc))throw new jl;{const e=s._getQuery();if(!e.from)throw new Tl(t);r=new Pa(e,n)}}return[n,r]}from(e){const[,t]=this._createRefForSource(e,"from clause");return new Rc({...this.query,from:t})}join(e,t,n="left"){const[s,r]=this._createRefForSource(e,"join clause"),i=t(Ta([...this._getCurrentAliases(),s]));let o,a;if("func"!==i.type||"eq"!==i.name||2!==i.args.length)throw new Ll;o=i.args[0],a=i.args[1];const l={from:r,type:n,left:o,right:a},c=this.query.join||[];return new Rc({...this.query,join:[...c,l]})}leftJoin(e,t){return this.join(e,t,"left")}rightJoin(e,t){return this.join(e,t,"right")}innerJoin(e,t){return this.join(e,t,"inner")}fullJoin(e,t){return this.join(e,t,"full")}where(e){const t=e(Ta(this._getCurrentAliases())),n=this.query.where||[];return new Rc({...this.query,where:[...n,t]})}having(e){const t=e(Ta(this._getCurrentAliases())),n=this.query.having||[];return new Rc({...this.query,having:[...n,t]})}select(e){const t=Ta(this._getCurrentAliases()),n=e(t),s=t.__spreadSentinels,r={};for(const i of s){r[`__SPREAD_SENTINEL__${i}`]=ja(i)}for(const[i,o]of Object.entries(n))La(o)||"object"!=typeof o||!("type"in o)||"agg"!==o.type&&"func"!==o.type?r[i]=ja(o):r[i]=o;return new Rc({...this.query,select:r,fnSelect:void 0})}orderBy(e,t="asc"){const n=e(Ta(this._getCurrentAliases())),s="string"==typeof t?{direction:t,nulls:"first",stringSort:"locale"}:{direction:t.direction??"asc",nulls:t.nulls??"first",stringSort:t.stringSort??"locale",locale:"locale"===t.stringSort?t.locale:void 0,localeOptions:"locale"===t.stringSort?t.localeOptions:void 0},r={expression:ja(n),compareOptions:s},i=this.query.orderBy||[];return new Rc({...this.query,orderBy:[...i,r]})}groupBy(e){const t=e(Ta(this._getCurrentAliases())),n=Array.isArray(t)?t.map(e=>ja(e)):[ja(t)];return new Rc({...this.query,groupBy:n})}limit(e){return new Rc({...this.query,limit:e})}offset(e){return new Rc({...this.query,offset:e})}distinct(){return new Rc({...this.query,distinct:!0})}_getCurrentAliases(){const e=[];if(this.query.from&&e.push(this.query.from.alias),this.query.join)for(const t of this.query.join)e.push(t.from.alias);return e}get fn(){const e=this;return{select:t=>new Rc({...e.query,select:void 0,fnSelect:t}),where:t=>new Rc({...e.query,fnWhere:[...e.query.fnWhere||[],t]}),having:t=>new Rc({...e.query,fnHaving:[...e.query.fnHaving||[],t]})}}_getQuery(){if(!this.query.from)throw new Dl;return this.query}}function Ec(e){return e._getQuery()}function Tc(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var jc,Lc={exports:{}},Dc={exports:{}};var $c,Fc,qc={exports:{}};const Vc=Tc(function(){if(Fc)return Lc.exports;Fc=1;var e=jc?Dc.exports:(jc=1,Dc.exports=function(e,t){var n,s,r,i,o,a,l,c;for(n=3&e.length,s=e.length-n,r=t,o=3432918353,a=461845907,c=0;c<s;)l=255&e.charCodeAt(c)|(255&e.charCodeAt(++c))<<8|(255&e.charCodeAt(++c))<<16|(255&e.charCodeAt(++c))<<24,++c,r=27492+(65535&(i=5*(65535&(r=(r^=l=(65535&(l=(l=(65535&l)*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<13|r>>>19))+((5*(r>>>16)&65535)<<16)&4294967295))+(((i>>>16)+58964&65535)<<16);switch(l=0,n){case 3:l^=(255&e.charCodeAt(c+2))<<16;case 2:l^=(255&e.charCodeAt(c+1))<<8;case 1:r^=l=(65535&(l=(l=(65535&(l^=255&e.charCodeAt(c)))*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*a+(((l>>>16)*a&65535)<<16)&4294967295}return r^=e.length,r=2246822507*(65535&(r^=r>>>16))+((2246822507*(r>>>16)&65535)<<16)&4294967295,r=3266489909*(65535&(r^=r>>>13))+((3266489909*(r>>>16)&65535)<<16)&4294967295,(r^=r>>>16)>>>0}),t=$c?qc.exports:($c=1,qc.exports=function(e,t){for(var n,s=e.length,r=t^s,i=0;s>=4;)n=1540483477*(65535&(n=255&e.charCodeAt(i)|(255&e.charCodeAt(++i))<<8|(255&e.charCodeAt(++i))<<16|(255&e.charCodeAt(++i))<<24))+((1540483477*(n>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),s-=4,++i;switch(s){case 3:r^=(255&e.charCodeAt(i+2))<<16;case 2:r^=(255&e.charCodeAt(i+1))<<8;case 1:r=1540483477*(65535&(r^=255&e.charCodeAt(i)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0});return Lc.exports=e,Lc.exports.murmur3=e,Lc.exports.murmur2=t,Lc.exports}());class Bc extends Map{constructor(e,t){super(t),this.defaultValue=e}get(e){return this.has(e)||this.set(e,this.defaultValue()),super.get(e)}update(e,t){const n=t(this.get(e));return this.set(e,n),n}}const Nc=3e4;function Uc(e,t){if(t.length<=Nc)e.push(...t);else for(let n=0;n<t.length;n+=Nc){const s=t.slice(n,n+Nc);e.push(...s)}}const Kc=new WeakMap;function zc(e,t){return"bigint"==typeof t||"symbol"==typeof t||"function"==typeof t?String(t):void 0===t?"undefined":t instanceof Map?`Map(${JSON.stringify(Array.from(t.entries()),zc)})`:t instanceof Set?`Set(${JSON.stringify(Array.from(t.values()),zc)})`:t}function Wc(e){if(null==e||"object"!=typeof e&&"function"!=typeof e){const t=JSON.stringify(e,zc);return Vc.murmur3(t).toString(16)}if(Kc.has(e))return Kc.get(e);const t=JSON.stringify(e,zc),n=Vc.murmur3(t).toString(16);return Kc.set(e,n),n}const Qc=new class{constructor(){this.objectIds=new WeakMap,this.nextId=0}getId(e){if("object"!=typeof e||null===e){const t=String(e);let n=0;for(let e=0;e<t.length;e++){n=(n<<5)-n+t.charCodeAt(e),n&=n}return n}return this.objectIds.has(e)||this.objectIds.set(e,this.nextId++),this.objectIds.get(e)}getStringId(e){return null===e?"null":void 0===e?"undefined":"object"!=typeof e?`str_${String(e)}`:`obj_${this.getId(e)}`}};var Hc,Gc,Jc,Yc,Zc=e=>{throw TypeError(e)},Xc=(e,t,n)=>t.has(e)||Zc("Cannot "+n),eu=(e,t,n)=>(Xc(e,t,"read from private field"),n?n.call(e):t.get(e)),tu=(e,t,n)=>t.has(e)?Zc("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),nu=(e,t,n)=>(Xc(e,t,"access private method"),n);const su=class e{constructor(e=[]){var t,n,s;tu(this,Gc),tu(this,Hc),s=e,Xc(t=this,n=Hc,"write to private field"),n.set(t,s)}toString(e=!1){return`MultiSet(${JSON.stringify(eu(this,Hc),null,e?2:void 0)})`}toJSON(){return JSON.stringify(Array.from(this.getInner()))}static fromJSON(t){return new e(JSON.parse(t))}map(t){return new e(eu(this,Hc).map(([e,n])=>[t(e),n]))}filter(t){return new e(eu(this,Hc).filter(([e,n])=>t(e)))}negate(){return new e(eu(this,Hc).map(([e,t])=>[e,-t]))}concat(t){const n=[];return Uc(n,eu(this,Hc)),Uc(n,t.getInner()),new e(n)}consolidate(){var e;if(eu(this,Hc).length>0){const t=null==(e=eu(this,Hc)[0])?void 0:e[0];if(Array.isArray(t)&&2===t.length)return nu(this,Gc,Jc).call(this)}return nu(this,Gc,Yc).call(this)}extend(t){const n=t instanceof e?t.getInner():t;Uc(eu(this,Hc),n)}getInner(){return eu(this,Hc)}};Hc=new WeakMap,Gc=new WeakSet,Jc=function(){const e=new Map,t=new Map,n=e=>{if(2!==e.length)throw new Error("Expected tuple of length 2");const[t,n]=e;return`${Qc.getStringId(t)}|${Qc.getStringId(n)}`};for(const[r,i]of eu(this,Hc)){if(!Array.isArray(r)||2!==r.length)return nu(this,Gc,Yc).call(this);const[s,o]=r;if("string"!=typeof s&&"number"!=typeof s)return nu(this,Gc,Yc).call(this);let a;a=Array.isArray(o)&&2===o.length?n(o):Qc.getStringId(o);const l=s+"|"+a;e.set(l,(e.get(l)||0)+i),t.has(l)||t.set(l,r)}const s=[];for(const[r,i]of e)0!==i&&s.push([t.get(r),i]);return new su(s)},Yc=function(){const e=new Bc(()=>0),t=new Map;let n=!1,s=!1,r=!1;for(const[a,l]of eu(this,Hc))if("string"==typeof a)n=!0;else{if("number"!=typeof a){r=!0;break}s=!0}const i=r||n&&s;for(const[a,l]of eu(this,Hc)){const n=i?Wc(a):a;i&&!t.has(n)&&t.set(n,a),e.update(n,e=>e+l)}const o=[];for(const[a,l]of e.entries())if(0!==l){const e=i?t.get(a):a;o.push([e,l])}return new su(o)};let ru=su;var iu,ou,au=e=>{throw TypeError(e)},lu=(e,t,n)=>t.has(e)||au("Cannot "+n),cu=(e,t,n)=>(lu(e,t,"read from private field"),n?n.call(e):t.get(e)),uu=(e,t,n)=>t.has(e)?au("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n);class hu{constructor(e){var t,n,s;uu(this,iu),s=e,lu(t=this,n=iu,"write to private field"),n.set(t,s)}drain(){const e=[...cu(this,iu)].reverse();return cu(this,iu).length=0,e}isEmpty(){return 0===cu(this,iu).length}}iu=new WeakMap;class du{constructor(){uu(this,ou,[])}sendData(e){e instanceof ru||(e=new ru(e));for(const t of cu(this,ou))t.unshift(e)}newReader(){const e=[];return cu(this,ou).push(e),new hu(e)}}ou=new WeakMap;class fu{constructor(e,t,n){this.id=e,this.inputs=t,this.output=n}hasPendingWork(){return this.inputs.some(e=>!e.isEmpty())}}class pu extends fu{constructor(e,t,n){super(e,[t],n),this.id=e}inputMessages(){return this.inputs[0].drain()}}class gu extends fu{constructor(e,t,n,s){super(e,[t,n],s),this.id=e}inputAMessages(){return this.inputs[0].drain()}inputBMessages(){return this.inputs[1].drain()}}class mu extends pu{run(){for(const e of this.inputMessages())this.output.sendData(this.inner(e))}}var yu,vu,bu,wu,xu,Su,Cu,ku,Ou=e=>{throw TypeError(e)},Mu=(e,t,n)=>t.has(e)||Ou("Cannot "+n),_u=(e,t,n)=>(Mu(e,t,"read from private field"),n?n.call(e):t.get(e)),Pu=(e,t,n)=>t.has(e)?Ou("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Iu=(e,t,n,s)=>(Mu(e,t,"write to private field"),t.set(e,n),n),Au=(e,t,n)=>(Mu(e,t,"access private method"),n);class Ru{constructor(){Pu(this,xu),Pu(this,yu,[]),Pu(this,vu,[]),Pu(this,bu,0),Pu(this,wu,!1)}getNextOperatorId(){return Au(this,xu,Su).call(this),(e=this,t=bu,{set _(n){Iu(e,t,n)},get _(){return _u(e,t,n)}})._++;var e,t,n}newInput(){Au(this,xu,Su).call(this);const e=new du,t=new Tu(this,e);return _u(this,yu).push(t.connectReader()),t}addOperator(e){Au(this,xu,Su).call(this),_u(this,vu).push(e)}addStream(e){Au(this,xu,Su).call(this),_u(this,yu).push(e)}finalize(){Au(this,xu,Su).call(this),Iu(this,wu,!0)}step(){if(!_u(this,wu))throw new Error("Graph not finalized");for(const e of _u(this,vu))e.run()}pendingWork(){return _u(this,vu).some(e=>e.hasPendingWork())}run(){for(;this.pendingWork();)this.step()}}yu=new WeakMap,vu=new WeakMap,bu=new WeakMap,wu=new WeakMap,xu=new WeakSet,Su=function(){if(_u(this,wu))throw new Error("Graph already finalized")};class Eu{constructor(e,t){Pu(this,Cu),Pu(this,ku),Iu(this,Cu,e),Iu(this,ku,t)}connectReader(){return _u(this,ku).newReader()}get writer(){return _u(this,ku)}get graph(){return _u(this,Cu)}pipe(...e){return e.reduce((e,t)=>t(e),this)}}Cu=new WeakMap,ku=new WeakMap;class Tu extends Eu{sendData(e){this.writer.sendData(e)}}var ju,Lu=e=>{throw TypeError(e)},Du=(e,t,n)=>t.has(e)||Lu("Cannot "+n);class $u extends mu{constructor(e,t,n,s){var r,i,o;super(e,t,n),r=this,(i=ju).has(r)?Lu("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(r):i.set(r,o),((e,t,n)=>{Du(e,t,"write to private field"),t.set(e,n)})(this,ju,s)}inner(e){return e.map((Du(t=this,n=ju,"read from private field"),s?s.call(t):n.get(t)));var t,n,s}}function Fu(e){return t=>{const n=new Eu(t.graph,new du),s=new $u(t.graph.getNextOperatorId(),t.connectReader(),n.writer,e);return t.graph.addOperator(s),t.graph.addStream(n.connectReader()),n}}ju=new WeakMap;var qu,Vu=e=>{throw TypeError(e)},Bu=(e,t,n)=>t.has(e)||Vu("Cannot "+n),Nu=(e,t,n)=>(Bu(e,t,"read from private field"),n?n.call(e):t.get(e));class Uu{constructor(){var e,t,n;e=this,(t=qu).has(e)?Vu("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),((e,t,n)=>{Bu(e,t,"write to private field"),t.set(e,n)})(this,qu,new Bc(()=>new Map))}toString(e=!1){return`Index(${JSON.stringify([...Nu(this,qu)].map(([e,t])=>[e,[...t]]),void 0,e?"  ":void 0)})`}get(e){return[...Nu(this,qu).get(e).entries()]}getMultiplicity(e,t){return Nu(this,qu).get(e).get(t)??0}entries(){return Nu(this,qu).entries()}keys(){return Nu(this,qu).keys()}has(e){return Nu(this,qu).has(e)}get size(){return Nu(this,qu).size}addValue(e,t){const[n,s]=t,r=Nu(this,qu).get(e),i=(r.get(n)??0)+s;0!==s&&(0===i?r.delete(n):r.set(n,i))}append(e){for(const[t,n]of e.entries()){const e=Nu(this,qu).get(t);for(const[t,s]of n.entries()){const n=(e.get(t)??0)+s;0===n?e.delete(t):e.set(t,n)}}}join(e){const t=[];if(this.size<=e.size)for(const[n,s]of this.entries()){if(!e.has(n))continue;const r=e.get(n);for(const[e,i]of s.entries())for(const[s,o]of r)0!==i&&0!==o&&t.push([[n,[e,s]],i*o])}else for(const[n,s]of e.entries()){if(!this.has(n))continue;const e=this.get(n);for(const[r,i]of s.entries())for(const[s,o]of e)0!==o&&0!==i&&t.push([[n,[s,r]],o*i])}return new ru(t)}}qu=new WeakMap;var Ku,zu,Wu,Qu=e=>{throw TypeError(e)},Hu=(e,t,n)=>t.has(e)||Qu("Cannot "+n),Gu=(e,t,n)=>(Hu(e,t,"read from private field"),n?n.call(e):t.get(e)),Ju=(e,t,n)=>t.has(e)?Qu("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n);class Yu extends pu{constructor(e,t,n,s){var r,i,o;super(e,t,n),Ju(this,Ku,new Uu),Ju(this,zu,new Uu),Ju(this,Wu),o=s,Hu(r=this,i=Wu,"write to private field"),i.set(r,o)}run(){const e=new Set;for(const n of this.inputMessages())for(const[t,s]of n.getInner()){const[n,r]=t;Gu(this,Ku).addValue(n,[r,s]),e.add(n)}const t=[];for(const n of e){const e=Gu(this,Ku).get(n),s=Gu(this,zu).get(n),r=Gu(this,Wu).call(this,e),i=new Map,o=new Map;for(const[t,n]of r){const e=i.get(t)??0;i.set(t,e+n)}for(const[t,n]of s){const e=o.get(t)??0;o.set(t,e+n)}for(const[a,l]of o)i.has(a)||(t.push([[n,a],-l]),Gu(this,zu).addValue(n,[a,-l]));for(const[a,l]of i)o.has(a)||0!==l&&(t.push([[n,a],l]),Gu(this,zu).addValue(n,[a,l]));for(const[a,l]of i){const e=o.get(a);if(void 0!==e){const s=l-e;0!==s&&(t.push([[n,a],s]),Gu(this,zu).addValue(n,[a,s]))}}}t.length>0&&this.output.sendData(new ru(t))}}function Zu(e){return"pipe"in e}function Xu(e,t={}){const n=Object.fromEntries(Object.entries(t).filter(([e,t])=>!Zu(t)));return Object.fromEntries(Object.entries(t).filter(([e,t])=>Zu(t))),t=>{const s="__original_key__",r=t.pipe(Fu(t=>{const r=e(t),i=JSON.stringify(r),o={};o[s]=r;for(const[e,s]of Object.entries(n))o[e]=s.preMap(t);return[i,o]})).pipe((i=e=>{var t,r;let i=0;for(const[n,s]of e)i+=s;if(i<=0)return[];const o={},a=null==(r=null==(t=e[0])?void 0:t[0])?void 0:r[s];o[s]=a;for(const[s,l]of Object.entries(n)){const t=e.map(([e,t])=>[e[s],t]);o[s]=l.reduce(t)}return[[o,1]]},e=>{const t=new Eu(e.graph,new du),n=new Yu(e.graph.getNextOperatorId(),e.connectReader(),t.writer,i);return e.graph.addOperator(n),e.graph.addStream(t.connectReader()),t}));var i;return r.pipe(Fu(([e,t])=>{const r=t[s],i={};Object.assign(i,r);for(const[s,o]of Object.entries(n))o.postMap?i[s]=o.postMap(t[s]):i[s]=t[s];return[e,i]}))}}Ku=new WeakMap,zu=new WeakMap,Wu=new WeakMap;const eh={sum:function(e=e=>e){return{preMap:t=>e(t),reduce:e=>{let t=0;for(const[n,s]of e)t+=n*s;return t}}},count:function(){return{preMap:()=>1,reduce:e=>{let t=0;for(const[n,s]of e)t+=s;return t}}},avg:function(e=e=>e){return{preMap:t=>({sum:e(t),count:0}),reduce:e=>{let t=0,n=0;for(const[s,r]of e)t+=s.sum*r,n+=r;return{sum:t,count:n}},postMap:e=>e.sum/e.count}},min:function(e=e=>e){return{preMap:t=>e(t),reduce:e=>{let t=Number.POSITIVE_INFINITY;for(const[n,s]of e)n<t&&(t=n);return t===Number.POSITIVE_INFINITY?0:t}}},max:function(e=e=>e){return{preMap:t=>e(t),reduce:e=>{let t=Number.NEGATIVE_INFINITY;for(const[n,s]of e)n>t&&(t=n);return t===Number.NEGATIVE_INFINITY?0:t}}}};var th,nh=e=>{throw TypeError(e)},sh=(e,t,n)=>t.has(e)||nh("Cannot "+n);class rh extends mu{constructor(e,t,n,s){var r,i,o;super(e,t,n),r=this,(i=th).has(r)?nh("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(r):i.set(r,o),((e,t,n)=>{sh(e,t,"write to private field"),t.set(e,n)})(this,th,s)}inner(e){return e.map(e=>{var t,n,s;return(t=this,n=th,sh(t,n,"read from private field"),s?s.call(t):n.get(t)).call(this,e),e})}}th=new WeakMap;var ih,oh=e=>{throw TypeError(e)},ah=(e,t,n)=>t.has(e)||oh("Cannot "+n);class lh extends mu{constructor(e,t,n,s){var r,i,o;super(e,t,n),r=this,(i=ih).has(r)?oh("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(r):i.set(r,o),((e,t,n)=>{ah(e,t,"write to private field"),t.set(e,n)})(this,ih,s)}inner(e){return e.filter((ah(t=this,n=ih,"read from private field"),s?s.call(t):n.get(t)));var t,n,s}}function ch(e){return t=>{const n=new Eu(t.graph,new du),s=new lh(t.graph.getNextOperatorId(),t.connectReader(),n.writer,e);return t.graph.addOperator(s),t.graph.addStream(n.connectReader()),n}}ih=new WeakMap;class uh extends mu{inner(e){return e.negate()}}class hh extends gu{run(){for(const e of this.inputAMessages())this.output.sendData(e);for(const e of this.inputBMessages())this.output.sendData(e)}}function dh(e){return t=>{if(t.graph!==e.graph)throw new Error("Cannot concat streams from different graphs");const n=new Eu(t.graph,new du),s=new hh(t.graph.getNextOperatorId(),t.connectReader(),e.connectReader(),n.writer);return t.graph.addOperator(s),t.graph.addStream(n.connectReader()),n}}var fh,ph=e=>{throw TypeError(e)},gh=(e,t,n)=>t.has(e)||ph("Cannot "+n),mh=(e,t,n)=>(gh(e,t,"read from private field"),n?n.call(e):t.get(e));class yh extends pu{constructor(e,t,n,s){var r,i,o;super(e,t,n),r=this,(i=fh).has(r)?ph("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(r):i.set(r,o),((e,t,n)=>{gh(e,t,"write to private field"),t.set(e,n)})(this,fh,s)}run(){for(const e of this.inputMessages())mh(this,fh).call(this,e),this.output.sendData(e)}}fh=new WeakMap;class vh extends pu{run(){const e=this.inputMessages();if(0===e.length)return;const t=new ru;for(const s of e)t.extend(s);const n=t.consolidate();n.getInner().length>0&&this.output.sendData(n)}}function bh(){return e=>{const t=new Eu(e.graph,new du),n=new vh(e.graph.getNextOperatorId(),e.connectReader(),t.writer);return e.graph.addOperator(n),e.graph.addStream(t.connectReader()),t}}var wh,xh,Sh=e=>{throw TypeError(e)},Ch=(e,t,n)=>(((e,t,n)=>{t.has(e)||Sh("Cannot "+n)})(e,t,"read from private field"),n?n.call(e):t.get(e)),kh=(e,t,n)=>t.has(e)?Sh("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n);class Oh extends gu{constructor(e,t,n,s){super(e,t,n,s),kh(this,wh,new Uu),kh(this,xh,new Uu)}run(){const e=new Uu,t=new Uu,n=this.inputAMessages();for(const i of n){const t=i;for(const[n,s]of t.getInner()){const[t,r]=n;e.addValue(t,[r,s])}}const s=this.inputBMessages();for(const i of s){const e=i;for(const[n,s]of e.getInner()){const[e,r]=n;t.addValue(e,[r,s])}}const r=new ru;r.extend(e.join(Ch(this,xh))),Ch(this,wh).append(e),r.extend(Ch(this,wh).join(t)),r.getInner().length>0&&this.output.sendData(r),Ch(this,xh).append(t)}}function Mh(e,t="inner"){switch(t){case"inner":return _h(e);case"anti":return Ph(e);case"left":return function(e){return t=>{const n=t,s=e,r=n.pipe(_h(s)),i=n.pipe(Ph(s));return r.pipe(dh(i))}}(e);case"right":return function(e){return t=>{const n=t,s=e,r=n.pipe(_h(s)),i=s.pipe(Ph(n),Fu(([e,[t,n]])=>[e,[n,t]]));return r.pipe(dh(i))}}(e);case"full":return function(e){return t=>{const n=t,s=e,r=n.pipe(_h(s)),i=n.pipe(Ph(s)),o=s.pipe(Ph(n),Fu(([e,[t,n]])=>[e,[n,t]]));return r.pipe(dh(i),dh(o))}}(e);default:throw new Error(`Join type ${t} is invalid`)}}function _h(e){return t=>{if(t.graph!==e.graph)throw new Error("Cannot join streams from different graphs");const n=new Eu(t.graph,new du),s=new Oh(t.graph.getNextOperatorId(),t.connectReader(),e.connectReader(),n.writer);return t.graph.addOperator(s),t.graph.addStream(n.connectReader()),n}}function Ph(e){return t=>{const n=t.pipe(_h(e),Fu(([e,[t,n]])=>[e,t])),s=t.pipe(dh(n.pipe(e=>{const t=new Eu(e.graph,new du),n=new uh(e.graph.getNextOperatorId(),e.connectReader(),t.writer);return e.graph.addOperator(n),e.graph.addStream(t.connectReader()),t})),Fu(([e,t])=>[e,[t,null]]));return s}}wh=new WeakMap,xh=new WeakMap;var Ih,Ah,Rh=e=>{throw TypeError(e)},Eh=(e,t,n)=>t.has(e)||Rh("Cannot "+n),Th=(e,t,n)=>(Eh(e,t,"read from private field"),n?n.call(e):t.get(e)),jh=(e,t,n)=>t.has(e)?Rh("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Lh=(e,t,n,s)=>(Eh(e,t,"write to private field"),t.set(e,n),n);class Dh extends pu{constructor(e,t,n,s=e=>e){super(e,t,n),jh(this,Ih),jh(this,Ah),Lh(this,Ih,s),Lh(this,Ah,new Map)}run(){var e;const t=new Map;for(const s of this.inputMessages())for(const[n,r]of s.getInner()){const s=Wc(Th(this,Ih).call(this,n)),i=((null==(e=t.get(s))?void 0:e[0])??Th(this,Ah).get(s)??0)+r;t.set(s,[i,n])}const n=[];for(const[s,[r,i]]of t.entries()){const e=Th(this,Ah).get(s)??0;0===r?Th(this,Ah).delete(s):Th(this,Ah).set(s,r),e<=0&&r>0?n.push([i,1]):e>0&&r<=0&&n.push([i,-1])}n.length>0&&this.output.sendData(new ru(n))}}Ih=new WeakMap,Ah=new WeakMap;function $h(e,t,n){const s=n[0];if(null!=t&&e>=t)throw new Error(e+" >= "+t);if(e.slice(-1)===s||t&&t.slice(-1)===s)throw new Error("trailing zero");if(t){let r=0;for(;(e[r]||s)===t[r];)r++;if(r>0)return t.slice(0,r)+$h(e.slice(r),t.slice(r),n)}const r=e?n.indexOf(e[0]):0,i=null!=t?n.indexOf(t[0]):n.length;if(i-r>1){return n[Math.round(.5*(r+i))]}return t&&t.length>1?t.slice(0,1):n[r]+$h(e.slice(1),null,n)}function Fh(e){if(e.length!==qh(e[0]))throw new Error("invalid integer part of order key: "+e)}function qh(e){if(e>="a"&&e<="z")return e.charCodeAt(0)-"a".charCodeAt(0)+2;if(e>="A"&&e<="Z")return"Z".charCodeAt(0)-e.charCodeAt(0)+2;throw new Error("invalid order key head: "+e)}function Vh(e){const t=qh(e[0]);if(t>e.length)throw new Error("invalid order key: "+e);return e.slice(0,t)}function Bh(e,t){if(e==="A"+t[0].repeat(26))throw new Error("invalid order key: "+e);const n=Vh(e);if(e.slice(n.length).slice(-1)===t[0])throw new Error("invalid order key: "+e)}function Nh(e,t){Fh(e);const[n,...s]=e.split("");let r=!0;for(let i=s.length-1;r&&i>=0;i--){const e=t.indexOf(s[i])+1;e===t.length?s[i]=t[0]:(s[i]=t[e],r=!1)}if(r){if("Z"===n)return"a"+t[0];if("z"===n)return null;const e=String.fromCharCode(n.charCodeAt(0)+1);return e>"a"?s.push(t[0]):s.pop(),e+s.join("")}return n+s.join("")}function Uh(e,t,n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"){if(null!=e&&Bh(e,n),null!=t&&Bh(t,n),null!=e&&null!=t&&e>=t)throw new Error(e+" >= "+t);if(null==e){if(null==t)return"a"+n[0];const e=Vh(t),s=t.slice(e.length);if(e==="A"+n[0].repeat(26))return e+$h("",s,n);if(e<t)return e;const r=function(e,t){Fh(e);const[n,...s]=e.split("");let r=!0;for(let i=s.length-1;r&&i>=0;i--){const e=t.indexOf(s[i])-1;-1===e?s[i]=t.slice(-1):(s[i]=t[e],r=!1)}if(r){if("a"===n)return"Z"+t.slice(-1);if("A"===n)return null;const e=String.fromCharCode(n.charCodeAt(0)-1);return e<"Z"?s.push(t.slice(-1)):s.pop(),e+s.join("")}return n+s.join("")}(e,n);if(null==r)throw new Error("cannot decrement any more");return r}if(null==t){const t=Vh(e),s=e.slice(t.length),r=Nh(t,n);return null==r?t+$h(s,null,n):r}const s=Vh(e),r=e.slice(s.length),i=Vh(t),o=t.slice(i.length);if(s===i)return s+$h(r,o,n);const a=Nh(s,n);if(null==a)throw new Error("cannot increment any more");return a<t?a:s+$h(r,null,n)}var Kh,zh,Wh,Qh,Hh,Gh,Jh,Yh,Zh,Xh=e=>{throw TypeError(e)},ed=(e,t,n)=>t.has(e)||Xh("Cannot "+n),td=(e,t,n)=>(ed(e,t,"read from private field"),n?n.call(e):t.get(e)),nd=(e,t,n)=>t.has(e)?Xh("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),sd=(e,t,n,s)=>(ed(e,t,"write to private field"),t.set(e,n),n),rd=(e,t,n)=>(ed(e,t,"access private method"),n);class id{constructor(e,t,n){nd(this,Hh),nd(this,Kh,[]),nd(this,zh),nd(this,Wh),nd(this,Qh),sd(this,Wh,e),sd(this,Qh,e+t),sd(this,zh,n)}get size(){const e=td(this,Wh),t=td(this,Qh)-td(this,Wh),n=td(this,Kh).length-e;return Math.max(0,Math.min(t,n))}insert(e){const t={moveIn:null,moveOut:null},n=rd(this,Hh,Gh).call(this,e),s=ld(e,Uh(0===n?null:ud(td(this,Kh)[n-1]),n===td(this,Kh).length?null:ud(td(this,Kh)[n])));if(td(this,Kh).splice(n,0,s),n<td(this,Qh)){const e=Math.max(n,td(this,Wh));e<td(this,Kh).length&&(t.moveIn=td(this,Kh)[e],td(this,Qh)<td(this,Kh).length&&(t.moveOut=td(this,Kh)[td(this,Qh)]))}return t}delete(e){const t={moveIn:null,moveOut:null},n=rd(this,Hh,Gh).call(this,e),[s]=td(this,Kh).splice(n,1);if(n<td(this,Qh)){if(t.moveOut=s,n<td(this,Wh)){const e=td(this,Wh)-1;e<td(this,Kh).length?t.moveOut=td(this,Kh)[e]:t.moveOut=null}const e=td(this,Qh)-1;e<td(this,Kh).length&&(t.moveIn=td(this,Kh)[e])}return t}}Kh=new WeakMap,zh=new WeakMap,Wh=new WeakMap,Qh=new WeakMap,Hh=new WeakSet,Gh=function(e){return function(e,t,n){let s=0,r=e.length;for(;s<r;){const i=Math.floor((s+r)/2),o=n(e[i],t);if(o<0)s=i+1;else{if(!(o>0))return i;r=i}}return s}(td(this,Kh),ld(e,""),(e,t)=>td(this,zh).call(this,cd(e),cd(t)))};class od extends pu{constructor(e,t,n,s,r){var i;super(e,t,n),nd(this,Jh,new Map),nd(this,Yh),nd(this,Zh),sd(this,Zh,r.limit??1/0);const o=r.offset??0;sd(this,Yh,this.createTopK(o,td(this,Zh),(e,t)=>{const n=s(fd(e),fd(t));if(0!==n)return n;return pd(e)-pd(t)})),null==(i=r.setSizeCallback)||i.call(r,()=>td(this,Yh).size)}createTopK(e,t,n){return new id(e,t,n)}run(){const e=[];for(const t of this.inputMessages())for(const[n,s]of t.getInner()){const[t,r]=n;this.processElement(t,r,s,e)}e.length>0&&this.output.sendData(new ru(e))}processElement(e,t,n,s){const{oldMultiplicity:r,newMultiplicity:i}=this.addKey(e,n);let o={moveIn:null,moveOut:null};if(r<=0&&i>0){const n=hd(e,t);o=td(this,Yh).insert(n)}else if(r>0&&i<=0){const n=hd(e,t);o=td(this,Yh).delete(n)}if(o.moveIn){const e=ud(o.moveIn),t=cd(o.moveIn),n=dd(t),r=fd(t);s.push([[n,[r,e]],1])}if(o.moveOut){const e=ud(o.moveOut),t=cd(o.moveOut),n=dd(t),r=fd(t);s.push([[n,[r,e]],-1])}}getMultiplicity(e){return td(this,Jh).get(e)??0}addKey(e,t){const n=this.getMultiplicity(e),s=n+t;return 0===s?td(this,Jh).delete(e):td(this,Jh).set(e,s),{oldMultiplicity:n,newMultiplicity:s}}}function ad(e,t){const n=t||{};return t=>{const s=new Eu(t.graph,new du),r=new od(t.graph.getNextOperatorId(),t.connectReader(),s.writer,e,n);return t.graph.addOperator(r),t.graph.addStream(s.connectReader()),s}}function ld(e,t){return[e,t]}function cd(e){return e[0]}function ud(e){return e[1]}function hd(e,t){return[e,t,Qc.getId(e)]}function dd(e){return e[0]}function fd(e){return e[1]}function pd(e){return e[2]}function gd(e,t){return function(e,t,n){const s=(null==n?void 0:n.limit)??1/0,r=(null==n?void 0:n.offset)??0,i=null==n?void 0:n.setSizeCallback,o=(null==n?void 0:n.comparator)??((e,t)=>e===t?0:e<t?-1:1);return n=>n.pipe(e((e,n)=>o(t(e),t(n)),{limit:s,offset:r,setSizeCallback:i}),bh())}(ad,e,t)}function md(e,t){return yd(e,t,new Map)}function yd(e,t,n){if(e===t)return!0;if(null==e||null==t)return!1;if(typeof e!=typeof t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;if(n.has(e))return n.get(e)===t;n.set(e,t);const s=e.every((e,s)=>yd(e,t[s],n));return n.delete(e),s}if("object"==typeof e){if(n.has(e))return n.get(e)===t;n.set(e,t);const s=Object.keys(e),r=Object.keys(t);if(s.length!==r.length)return n.delete(e),!1;const i=s.every(s=>s in t&&yd(e[s],t[s],n));return n.delete(e),i}return!1}Jh=new WeakMap,Yh=new WeakMap,Zh=new WeakMap;const vd=new Set(["eq","gt","lt","gte","lte","and","or","in"]);function bd(e){const t=e.type;return"func"===t?!!vd.has(e.name)&&e.args.every(e=>bd(e)):["val","ref"].includes(t)}function wd(e,t){const n=e.type;if("val"===n)return new Aa(e.value);if("ref"===n){const n=e.path;if(Array.isArray(n)){if(n[0]===t&&n.length>1)return new Ia(n.slice(1));if(1===n.length&&void 0!==n[0])return new Ia([n[0]])}return new Ia(Array.isArray(n)?n:[String(n)])}{if(!vd.has(e.name))return null;const n=[];for(const s of e.args){const e=wd(s,t);if(null==e)return null;n.push(e)}return new Ra(e.name,n)}}function xd(e){const t=function(e){const t=new Map;if(!e.where||0===e.where.length)return t;const n=Md(e.where),s=Pd(n.map(e=>_d(e)));for(const[r,i]of s.singleSource)Sd(e,r)&&bd(i)&&t.set(r,i);return t}(e);let n,s=e,r=0;for(;r<10&&!md(s,n);)n=s,s=Cd(s),r++;return{optimizedQuery:kd(s),collectionWhereClauses:t}}function Sd(e,t){if(e.from.alias===t)return"collectionRef"===e.from.type;if(e.join)for(const n of e.join)if(n.from.alias===t)return"collectionRef"===n.from.type;return!1}function Cd(e){var t;return function(e){if(!e.where||0===e.where.length)return e;if(!e.join||0===e.join.length)return e;const t=Md(e.where),n=Pd(t.map(e=>_d(e)));return function(e,t){const n=new Set,s=Ad(e.from,t.singleSource,n),r=e.join?e.join.map(e=>({...e,from:Ad(e.from,t.singleSource,n)})):void 0,i=[];t.multiSource&&i.push(t.multiSource);for(const[a,l]of t.singleSource)n.has(a)||i.push(l);const o={select:e.select,groupBy:e.groupBy?[...e.groupBy]:void 0,having:e.having?[...e.having]:void 0,orderBy:e.orderBy?[...e.orderBy]:void 0,limit:e.limit,offset:e.offset,fnSelect:e.fnSelect,fnWhere:e.fnWhere?[...e.fnWhere]:void 0,fnHaving:e.fnHaving?[...e.fnHaving]:void 0,from:s,join:r,where:i.length>0?i:[]};return o}(e,n)}({...e,from:"queryRef"===e.from.type?new Pa(Cd(e.from.query),e.from.alias):e.from,join:null==(t=e.join)?void 0:t.map(e=>({...e,from:"queryRef"===e.from.type?new Pa(Cd(e.from.query),e.from.alias):e.from}))})}function kd(e){var t;return{...e,from:Od(e.from),join:null==(t=e.join)?void 0:t.map(e=>({...e,from:Od(e.from)}))}}function Od(e){if("collectionRef"===e.type)return e;const t=kd(e.query);if(!((n=t).where&&0!==n.where.length||n.select||n.groupBy&&0!==n.groupBy.length||n.having&&0!==n.having.length||n.orderBy&&0!==n.orderBy.length||n.join&&0!==n.join.length||void 0!==n.limit||void 0!==n.offset||n.fnSelect||n.fnWhere&&0!==n.fnWhere.length||n.fnHaving&&0!==n.fnHaving.length)){const n=Od(t.from);return"collectionRef"===n.type?new _a(n.collection,e.alias):new Pa(n.query,e.alias)}var n;return new Pa(t,e.alias)}function Md(e){const t=[];for(const n of e)if("func"===n.type&&"and"===n.name){const e=Md(n.args);t.push(...e)}else t.push(n);return t}function _d(e){const t=new Set;return function e(n){switch(n.type){case"ref":if(n.path&&n.path.length>0){const e=n.path[0];e&&t.add(e)}break;case"func":case"agg":n.args&&n.args.forEach(e)}}(e),{expression:e,touchedSources:t}}function Pd(e){const t=new Map,n=[];for(const r of e)if(1===r.touchedSources.size){const e=Array.from(r.touchedSources)[0];t.has(e)||t.set(e,[]),t.get(e).push(r.expression)}else r.touchedSources.size>1&&n.push(r.expression);const s=new Map;for(const[r,i]of t)s.set(r,Rd(i));return{singleSource:s,multiSource:n.length>0?Rd(n):void 0}}function Id(e){return{from:"collectionRef"===e.from.type?new _a(e.from.collection,e.from.alias):new Pa(Id(e.from.query),e.from.alias),select:e.select,join:e.join?e.join.map(e=>({type:e.type,left:e.left,right:e.right,from:"collectionRef"===e.from.type?new _a(e.from.collection,e.from.alias):new Pa(Id(e.from.query),e.from.alias)})):void 0,where:e.where?[...e.where]:void 0,groupBy:e.groupBy?[...e.groupBy]:void 0,having:e.having?[...e.having]:void 0,orderBy:e.orderBy?[...e.orderBy]:void 0,limit:e.limit,offset:e.offset,fnSelect:e.fnSelect,fnWhere:e.fnWhere?[...e.fnWhere]:void 0,fnHaving:e.fnHaving?[...e.fnHaving]:void 0}}function Ad(e,t,n){const s=t.get(e.alias);if(!s)return"collectionRef"===e.type?new _a(e.collection,e.alias):new Pa(Id(e.query),e.alias);if("collectionRef"===e.type){const t={from:new _a(e.collection,e.alias),where:[s]};return n.add(e.alias),new Pa(t,e.alias)}if(!function(e){if(e.select){if(Object.values(e.select).some(e=>"agg"===e.type))return!1}if(e.groupBy&&e.groupBy.length>0)return!1;if(e.having&&e.having.length>0)return!1;if(e.orderBy&&e.orderBy.length>0&&(void 0!==e.limit||void 0!==e.offset))return!1;if(e.fnSelect||e.fnWhere&&e.fnWhere.length>0||e.fnHaving&&e.fnHaving.length>0)return!1;return!0}(e.query))return new Pa(Id(e.query),e.alias);const r=e.query.where||[],i={...Id(e.query),where:[...r,s]};return n.add(e.alias),new Pa(i,e.alias)}function Rd(e){if(0===e.length)throw new oc;return 1===e.length?e[0]:new Ra("and",e)}function Ed(e,t,n,s,r,i,o,a,l,c,u,h,d){const{alias:f,input:p,collectionId:g}=function(e,t,n,s,r,i,o,a){switch(e.type){case"collectionRef":{const n=t[e.collection.id];if(!n)throw new Bl(e.collection.id);return{alias:e.alias,input:n,collectionId:e.collection.id}}case"queryRef":{const l=zd(a.get(e.query)||e.query,t,n,s,r,i,o,a),c=l.pipeline.pipe(Fu(e=>{const[t,[n,s]]=e;return[t,n]}));return{alias:e.alias,input:c,collectionId:l.collectionId}}default:throw new Zl(e.type)}}(t.from,i,l,c,u,h,o,a);n[f]=p;const m=l[s],y=l[g];if(!m)throw new Wl(s);if(!y)throw new Wl(g);const{activeCollection:v,lazyCollection:b}=function(e,t,n){if(t.id===n.id)return{activeCollection:void 0,lazyCollection:void 0};switch(e){case"left":return{activeCollection:"main",lazyCollection:n};case"right":return{activeCollection:"joined",lazyCollection:t};case"inner":return t.size<n.size?{activeCollection:"main",lazyCollection:n}:{activeCollection:"joined",lazyCollection:t};default:return{activeCollection:void 0,lazyCollection:void 0}}}(t.type,m,y),{mainExpr:w,joinedExpr:x}=function(e,t,n,s){const r=Td(e),i=Td(t);if(r===n&&i===s)return{mainExpr:e,joinedExpr:t};if(r===s&&i===n)return{mainExpr:t,joinedExpr:e};if(r===i)throw new Gl(r||"unknown");if(!r||!i)throw new Jl(n,s);throw new Yl(r,i,n,s)}(t.left,t.right,r,f),S=ac(w),C=ac(x);let k=e.pipe(Fu(([e,t])=>[S(t),[e,t]])),O=p.pipe(Fu(([e,t])=>{const n={[f]:t};return[C(n),[e,n]]}));if(!["inner","left","right","full"].includes(t.type))throw new Hl(t.type);if(v){u.add(b.id);const e="main"===v?k:O;let t;const n=Qd(d,"main"===v?x:w,"main"===v?l[s]:b),r=n.collection,i=n.path[0];i&&yc(i,n.path,r);let o=!1;const a=e.pipe((M=([e,s])=>{if(o)return;t??(t=kc(r.indexes,n.path));const i=c[b.id];if(!i)throw new Error("Internal error: callbacks for collection are missing in join pipeline. Make sure the live query collection sets them before running the pipeline.");const{loadKeys:a,loadInitialState:l}=i;t&&t.supports("eq")?a(t.lookup("eq",e)):(o=!0,l())},e=>{const t=new Eu(e.graph,new du),n=new rh(e.graph.getNextOperatorId(),e.connectReader(),t.writer,M);return e.graph.addOperator(n),e.graph.addStream(t.connectReader()),t}));"main"===v?k=a:O=a}var M,_;return k.pipe(Mh(O,t.type),bh(),(_=t.type,function(e){return e.pipe(ch(e=>{const[t,[n,s]]=e,r=null==n?void 0:n[1],i=null==s?void 0:s[1];return"inner"===_?!(!r||!i):"left"===_?!!r:"right"!==_||!!i}),Fu(e=>{const[t,[n,s]]=e,r=null==n?void 0:n[0],i=null==n?void 0:n[1],o=null==s?void 0:s[0],a=null==s?void 0:s[1],l={};return i&&Object.assign(l,i),a&&Object.assign(l,a),[`[${r},${o}]`,l]}))}))}function Td(e){switch(e.type){case"ref":return e.path[0]||null;case"func":{const t=new Set;for(const n of e.args){const e=Td(n);e&&t.add(e)}return 1===t.size?Array.from(t)[0]:null}default:return null}}const{sum:jd,count:Ld,avg:Dd,min:$d,max:Fd}=eh;function qd(e,t,n,s,r){if(0===t.length){const t={};if(s)for(const[e,n]of Object.entries(s))if("agg"===n.type){const s=n;t[e]=Bd(s)}const i=()=>({__singleGroup:!0});if(e=(e=e.pipe(Xu(i,t))).pipe(Fu(([,e])=>{const t={...e.__select_results||{}};if(s)for(const[n,r]of Object.entries(s))"agg"===r.type&&(t[n]=e[n]);return["single_group",{...e,__select_results:t}]})),n&&n.length>0)for(const r of n){const t=ac(Nd(r,s||{}));e=e.pipe(ch(([,e])=>{const n={result:e.__select_results};return t(n)}))}if(r&&r.length>0)for(const n of r)e=e.pipe(ch(([,e])=>{const t={result:e.__select_results};return n(t)}));return e}const i=function(e,t){const n=new Map,s=[...e];if(!t)return{selectToGroupByIndex:n,groupByExpressions:s};for(const[r,i]of Object.entries(t)){if("agg"===i.type)continue;const e=s.findIndex(e=>Vd(i,e));if(-1===e)throw new ec(r);n.set(r,e)}return{selectToGroupByIndex:n,groupByExpressions:s}}(t,s),o=t.map(e=>ac(e)),a={};if(s)for(const[l,c]of Object.entries(s))if("agg"===c.type){const e=c;a[l]=Bd(e)}if(e=(e=e.pipe(Xu(([,e])=>{const n={...e};delete n.__select_results;const s={};for(let r=0;r<t.length;r++){const e=(0,o[r])(n);s[`__key_${r}`]=e}return s},a))).pipe(Fu(([,e])=>{const n=e.__select_results||{},r={};if(s)for(const[t,a]of Object.entries(s))if("agg"!==a.type){const s=i.selectToGroupByIndex.get(t);r[t]=void 0!==s?e[`__key_${s}`]:n[t]}else r[t]=e[t];else for(let s=0;s<t.length;s++)r[`__key_${s}`]=e[`__key_${s}`];let o;if(1===t.length)o=e.__key_0;else{const n=[];for(let s=0;s<t.length;s++)n.push(e[`__key_${s}`]);o=JSON.stringify(n)}return[o,{...e,__select_results:r}]})),n&&n.length>0)for(const l of n){const t=ac(Nd(l,s||{}));e=e.pipe(ch(([,e])=>{const n={result:e.__select_results};return t(n)}))}if(r&&r.length>0)for(const l of r)e=e.pipe(ch(([,e])=>{const t={result:e.__select_results};return l(t)}));return e}function Vd(e,t){var n,s,r,i;if(!e||!t)return!1;if(e.type!==t.type)return!1;switch(e.type){case"ref":return!(!e.path||!t.path)&&(e.path.length===t.path.length&&e.path.every((e,n)=>e===t.path[n]));case"val":return e.value===t.value;case"func":return e.name===t.name&&(null==(n=e.args)?void 0:n.length)===(null==(s=t.args)?void 0:s.length)&&(e.args||[]).every((e,n)=>Vd(e,t.args[n]));case"agg":return e.name===t.name&&(null==(r=e.args)?void 0:r.length)===(null==(i=t.args)?void 0:i.length)&&(e.args||[]).every((e,n)=>Vd(e,t.args[n]));default:return!1}}function Bd(e){const t=ac(e.args[0]),n=([,e])=>{const n=t(e);return"number"==typeof n?n:null!=n?Number(n):0};switch(e.name.toLowerCase()){case"sum":return jd(n);case"count":return Ld();case"avg":return Dd(n);case"min":return $d(n);case"max":return Fd(n);default:throw new tc(e.name)}}function Nd(e,t){switch(e.type){case"agg":{const n=e;for(const[e,s]of Object.entries(t))if("agg"===s.type&&Ud(n,s))return new Ia(["result",e]);throw new nc(n.name)}case"func":{const n=e,s=n.args.map(e=>Nd(e,t));return new Ra(n.name,s)}case"ref":{const n=e;if(1===n.path.length){const e=n.path[0];if(t[e])return new Ia(["result",e])}return e}case"val":return e;default:throw new sc(e.type)}}function Ud(e,t){return e.name===t.name&&e.args.length===t.args.length&&e.args.every((e,n)=>Vd(e,t.args[n]))}function Kd(e){return"agg"===e.type}function zd(e,t,n,s,r,i,o=new WeakMap,a=new WeakMap){const l=o.get(e);if(l)return l;const{optimizedQuery:c,collectionWhereClauses:u}=xd(e);a.set(c,e),Wd(c,e,a);const h={...t},d={},{alias:f,input:p,collectionId:g}=function(e,t,n,s,r,i,o,a){switch(e.type){case"collectionRef":{const n=t[e.collection.id];if(!n)throw new Bl(e.collection.id);return{alias:e.alias,input:n,collectionId:e.collection.id}}case"queryRef":{const l=zd(a.get(e.query)||e.query,t,n,s,r,i,o,a),c=l.pipeline.pipe(Fu(e=>{const[t,[n,s]]=e;return[t,n]}));return{alias:e.alias,input:c,collectionId:l.collectionId}}default:throw new Nl(e.type)}}(c.from,h,n,s,r,i,o,a);d[f]=p;let m=p.pipe(Fu(([e,t])=>[e,{[f]:t}]));if(c.join&&c.join.length>0&&(m=function(e,t,n,s,r,i,o,a,l,c,u,h,d){let f=e;for(const p of t)f=Ed(f,p,n,s,r,i,o,a,l,c,u,h,d);return f}(m,c.join,d,g,f,h,o,a,n,s,r,i,e)),c.where&&c.where.length>0)for(const v of c.where){const e=ac(v);m=m.pipe(ch(([t,n])=>e(n)))}if(c.fnWhere&&c.fnWhere.length>0)for(const v of c.fnWhere)m=m.pipe(ch(([e,t])=>v(t)));if(c.distinct&&!c.fnSelect&&!c.select)throw new Fl;if(m=c.fnSelect?m.pipe(Fu(([e,t])=>{const n=c.fnSelect(t);return[e,{...t,__select_results:n}]})):c.select?function(e,t){const n=[],s=[];for(const[r,i]of Object.entries(t))if(r.startsWith("__SPREAD_SENTINEL__")){const e=r.replace("__SPREAD_SENTINEL__","");s.push(e)}else Kd(i)?n.push({alias:r,compiledExpression:()=>null}):n.push({alias:r,compiledExpression:ac(i)});return e.pipe(Fu(([e,t])=>{const r={};for(const n of s){const e=t[n];if(e&&"object"==typeof e)for(const[t,n]of Object.entries(e))t in r||(r[t]=n)}for(const{alias:s,compiledExpression:i}of n)r[s]=i(t);return[e,{...t,__select_results:r}]}))}(m,c.select):m.pipe(Fu(([e,t])=>{const n=c.join||c.groupBy?t:t[f];return[e,{...t,__select_results:n}]})),c.groupBy&&c.groupBy.length>0)m=qd(m,c.groupBy,c.having,c.select,c.fnHaving);else if(c.select){Object.values(c.select).some(e=>"agg"===e.type)&&(m=qd(m,[],c.having,c.select,c.fnHaving))}if(c.having&&(!c.groupBy||0===c.groupBy.length)){if(!(!!c.select&&Object.values(c.select).some(e=>"agg"===e.type)))throw new ql}if(c.fnHaving&&c.fnHaving.length>0&&(!c.groupBy||0===c.groupBy.length))for(const v of c.fnHaving)m=m.pipe(ch(([e,t])=>v(t)));if(c.distinct&&(m=m.pipe(function(e=e=>e){return t=>{const n=new Eu(t.graph,new du),s=new Dh(t.graph.getNextOperatorId(),t.connectReader(),n.writer,e);return t.graph.addOperator(s),t.graph.addStream(n.connectReader()),n}}(([e,t])=>t.__select_results))),c.orderBy&&c.orderBy.length>0){const t=function(e,t,n,s,r,i,o){const a=n.map(e=>({compiledExpression:ac(e.expression),compareOptions:e.compareOptions})),l=(e,t)=>{if(n.length>1){const s=e,r=t;for(let e=0;e<n.length;e++){const t=Ha(n[e].compareOptions)(s[e],r[e]);if(0!==t)return t}return s.length-r.length}return 1===n.length?Ha(n[0].compareOptions)(e,t):Ga(e,t)};let c;if(i&&1===n.length){const t=n[0].expression;if("ref"===t.type){const n=Qd(e,t,s),a=n.collection,u=n.path[0];u&&yc(u,n.path,a,l);const h=ac(new Ia(n.path),!0),d=(e,t)=>{const n=e?h(e):e,s=t?h(t):t;return l(n,s)},f=kc(a.indexes,n.path);if(f&&f.supports("gt")){const e={offset:o??0,limit:i,comparator:d,valueExtractorForRawRow:h,index:f};r[a.id]=e,c=e=>{r[a.id]={...r[a.id],dataNeeded:()=>{const t=e();return Math.max(0,i-t)}}}}}}return t.pipe(gd(e=>{const t={...e};return e.__select_results&&Object.assign(t,e.__select_results),n.length>1?a.map(e=>e.compiledExpression(t)):1===n.length?a[0].compiledExpression(t):null},{limit:i,offset:o,comparator:l,setSizeCallback:c}))}(e,m,c.orderBy,n[g],i,c.limit,c.offset),s={collectionId:g,pipeline:t.pipe(Fu(([e,[t,n]])=>[e,[t.__select_results,n]])),collectionWhereClauses:u};return o.set(e,s),s}if(void 0!==c.limit||void 0!==c.offset)throw new Vl;const y={collectionId:g,pipeline:m.pipe(Fu(([e,t])=>[e,[t.__select_results,void 0]])),collectionWhereClauses:u};return o.set(e,y),y}function Wd(e,t,n){if("queryRef"===e.from.type&&"queryRef"===t.from.type&&(n.set(e.from.query,t.from.query),Wd(e.from.query,t.from.query,n)),e.join&&t.join)for(let s=0;s<e.join.length&&s<t.join.length;s++){const r=e.join[s],i=t.join[s];"queryRef"===r.from.type&&"queryRef"===i.from.type&&(n.set(r.from.query,i.from.query),Wd(r.from.query,i.from.query,n))}}function Qd(e,t,n){if(0!==t.path.length){if(1===t.path.length){const s=t.path[0];if(e.select){const t=e.select[s];if(t&&"ref"===t.type)return Qd(e,t,n)}return{collection:n,path:[s]}}if(t.path.length>1){const[s,...r]=t.path,i=function(e,t){if(e.from.alias===t)return e.from;for(const n of e.join||[])if(n.from.alias===t)return n.from}(e,s);if(!i)return;return"queryRef"===i.type?Qd(i.query,new Ia(r),n):{collection:i.collection,path:r}}}}let Hd=0;function Gd(e){const t=e.id||"live-query-"+ ++Hd,n="function"==typeof e.query?Ec((0,e.query)(new Rc)):Ec(e.query);const s=new WeakMap,r=new WeakMap,i=n.orderBy&&n.orderBy.length>0?(e,t)=>{const n=r.get(e),s=r.get(t);return n&&s?n<s?-1:n>s?1:0:0}:void 0,o=function(e){const t={};function n(e){"collectionRef"===e.type?t[e.collection.id]=e.collection:"queryRef"===e.type&&s(e.query)}function s(e){if(e.from&&n(e.from),e.join&&Array.isArray(e.join))for(const t of e.join)t.from&&n(t.from)}return s(e),t}(n);let a,l,c,u;const h={},d=new Set,f={},p=()=>{a=new Ru,l=Object.fromEntries(Object.entries(o).map(([e])=>[e,a.newInput()])),({pipeline:c,collectionWhereClauses:u}=zd(n,l,o,h,d,f))};p();const g={rowUpdateMode:"full",sync:({begin:e,write:t,commit:i,markReady:g,collection:m})=>{const{graph:y,inputs:v,pipeline:b}=(a&&l&&c||p(),{graph:a,inputs:l,pipeline:c});let w=0;b.pipe(function(e){return t=>{const n=new Eu(t.graph,new du),s=new yh(t.graph.getNextOperatorId(),t.connectReader(),n.writer,e);return t.graph.addOperator(s),t.graph.addStream(n.connectReader()),n}}(n=>{const o=n.getInner();w+=o.length,e(),o.reduce((e,[[t,n],s])=>{const[r,i]=n,o=e.get(t)||{deletes:0,inserts:0,value:r,orderByIndex:i};return s<0?o.deletes+=Math.abs(s):s>0&&(o.inserts+=s,o.value=r,o.orderByIndex=i),e.set(t,o),e},new Map).forEach((e,n)=>{const{deletes:i,inserts:o,value:a,orderByIndex:l}=e;if(s.set(a,n),void 0!==l&&r.set(a,l),o&&0===i)t({value:a,type:"insert"});else if(o>i||o===i&&m.has(n))t({value:a,type:"update"});else{if(!(i>0))throw new Error(`This should never happen ${JSON.stringify(e)}`);t({value:a,type:"delete"})}}),i()})),y.finalize();let x=!1;const S=t=>{if(Object.values(o).every(e=>"ready"===e.status||"initialCommit"===e.status)&&x){y.run();const n=(null==t?void 0:t())??!0;0===w&&(e(),i()),n&&Object.values(o).every(e=>e.isReady())&&g()}},C=new Set;return Object.entries(o).forEach(([e,t])=>{const s=v[e],r=function(e,t){var n,s,r,i;if("collectionRef"===(null==(n=t.from)?void 0:n.type)&&(null==(s=t.from.collection)?void 0:s.id)===e)return t.from.alias;if(t.join)for(const o of t.join)if("collectionRef"===(null==(r=o.from)?void 0:r.type)&&(null==(i=o.from.collection)?void 0:i.id)===e)return o.from.alias;return}(e,n),i=r&&u?u.get(r):void 0,o=(e,n)=>{!function(e,t,n){const s=[];for(const r of t){const e=n(r.value);"insert"===r.type?s.push([[e,r.value],1]):"update"===r.type?(s.push([[e,r.previousValue],-1]),s.push([[e,r.value],1])):s.push([[e,r.value],-1])}e.sendData(new ru(s))}(s,e,t.config.getKey),S(n)},a=n=>{let s=!1;const r=new Set,i=t.subscribeChanges(e=>{((e,t,n)=>{if(t)return o(e);const s=[];for(const r of e){let e=r;if(!n.has(r.key))if("update"===r.type)e={...r,type:"insert"};else if("delete"===r.type)continue;s.push(e)}o(s)})(e,s,r)},{whereExpression:n}),a=n?Pc(n):()=>!0;return h[e]={loadKeys:e=>((e,n,s)=>{for(const r of e){if(n.has(r))continue;const e=t.get(r);void 0!==e&&s(e)&&(n.add(r),o([{type:"insert",key:r,value:e}]))}})(e,r,a),loadInitialState:()=>{if(s)return;s=!0;const e=t.currentStateAsChanges({whereExpression:n});o(e)}},i},l=n=>{const{offset:s,limit:r,comparator:i,index:a,dataNeeded:l,valueExtractorForRawRow:c}=f[e];if(!l)throw new Error(`Missing dataNeeded callback for collection ${e}`);const u=()=>{const e=l();return e>0&&d(e),0===e},h={sentKeys:new Set,biggest:void 0},d=e=>{const n=h.biggest,s=n?c(n):n;(e=>{const t=function*(e,t,n){for(const s of e)n.sentKeys.add(s.key),n.biggest?t(n.biggest,s.value)<0&&(n.biggest=s.value):n.biggest=s.value,yield s}(e,i,h);o(t,u)})(a.take(e,s).map(e=>({type:"insert",key:e,value:t.get(e)})))};d(s+r);const p=t.subscribeChanges(e=>{const t=function*(e){for(const t of e)"update"===t.type?(yield{type:"delete",key:t.key,value:t.previousValue},yield{type:"insert",key:t.key,value:t.value}):yield t}(e),n=function*(e,t,n){yield*function*(e,t){for(const n of e)t(n)&&(yield n)}(e,e=>!n||t(e.value,n)<=0)}(t,i,h.biggest);o(n,u)},{whereExpression:n});return p},c=n=>{let s;s=d.has(e)?a(n):Object.hasOwn(f,e)?l(n):(e=>t.subscribeChanges(o,{includeInitialState:!0,...e?{whereExpression:e}:void 0}))(n),C.add(s)};if(i){const t=wd(i,r);if(!t)throw new Error(`Failed to convert WHERE clause to collection filter for collection '${e}'. This indicates a bug in the query optimization logic.`);c(t)}else c()}),x=!0,S(),()=>{C.forEach(e=>e()),a=void 0,l=void 0,c=void 0,u=void 0}}};return{id:t,getKey:e.getKey||(e=>s.get(e)),sync:g,compare:i,gcTime:e.gcTime||5e3,schema:e.schema,onInsert:e.onInsert,onUpdate:e.onUpdate,onDelete:e.onDelete,startSync:e.startSync}}function Jd(e){if("function"==typeof e){return Yd(Gd({query:e}))}{const t=e;return Yd({...Gd(t),utils:t.utils})}}function Yd(e){return Ic(e)}function Zd(e){const t=k(()=>{if(1===e.length)return Jd({query:e,startSync:!0});const t=e();return t instanceof Ac?(t.startSyncImmediate(),t):Jd({...t,startSync:!0})},void 0,{name:"TanstackDBCollectionMemo"}),n=new va,[s,r]=Kn([],{name:"TanstackDBData"}),[i,o]=w(t().status,{name:"TanstackDBStatus"}),a=e=>{r(t=>Qn(Array.from(e.values()))(t).filter(Boolean))};let l=null;return x(()=>{const e=t();o(e.status),n.clear();for(const[t,s]of e.entries())n.set(t,s);a(e),l=e.subscribeChanges(t=>{M(()=>{for(const e of t)switch(e.type){case"insert":case"update":n.set(e.key,e.value);break;case"delete":n.delete(e.key)}}),a(e),o(e.status)}),"idle"===e.status&&O(()=>e.preload()),A(()=>{l&&(l(),l=null)})},void 0),{state:n,data:s,collection:t,status:i,isLoading:()=>"loading"===i()||"initialCommit"===i(),isReady:()=>"ready"===i(),isIdle:()=>"idle"===i(),isError:()=>"error"===i(),isCleanedUp:()=>"cleaned-up"===i()}}class Xd extends Ja{constructor(e){super(e),this.name="QueryCollectionError"}}class ef extends Xd{constructor(){super("[QueryCollection] queryKey must be provided."),this.name="QueryKeyRequiredError"}}class tf extends Xd{constructor(){super("[QueryCollection] queryFn must be provided."),this.name="QueryFnRequiredError"}}class nf extends Xd{constructor(){super("[QueryCollection] queryClient must be provided."),this.name="QueryClientRequiredError"}}class sf extends Xd{constructor(){super("[QueryCollection] getKey must be provided."),this.name="GetKeyRequiredError"}}class rf extends Xd{constructor(){super("Collection must be in 'ready' state for manual sync operations. Sync not initialized yet."),this.name="SyncNotInitializedError"}}class of extends Xd{constructor(e){super(`Duplicate key '${e}' found within batch operations`),this.name="DuplicateKeyInBatchError"}}class af extends Xd{constructor(e){super(`Update operation: Item with key '${e}' does not exist`),this.name="UpdateOperationItemNotFoundError"}}class lf extends Xd{constructor(e){super(`Delete operation: Item with key '${e}' does not exist`),this.name="DeleteOperationItemNotFoundError"}}const cf=new WeakMap;function uf(e,t){const n=function(e,t){const n=Array.isArray(e)?e:[e],s=[];for(const r of n)if("delete"===r.type){const e=Array.isArray(r.key)?r.key:[r.key];for(const t of e)s.push({type:"delete",key:t})}else{const e=Array.isArray(r.data)?r.data:[r.data];for(const n of e){let e;if("update"===r.type)e=t.getKey(n);else{const s=t.collection.validateData(n,"upsert"===r.type?"insert":r.type);e=t.getKey(s)}s.push({type:r.type,key:e,data:n})}}return s}(e,t);!function(e,t){const n=new Set;for(const s of e){if(n.has(s.key))throw new of(s.key);if(n.add(s.key),"update"===s.type){if(!t.collection.has(s.key))throw new af(s.key)}else if("delete"===s.type&&!t.collection.has(s.key))throw new lf(s.key)}}(n,t),t.begin();for(const r of n)switch(r.type){case"insert":{const e=t.collection.validateData(r.data,"insert");t.write({type:"insert",value:e});break}case"update":{const e={...t.collection.get(r.key),...r.data},n=t.collection.validateData(e,"update",r.key);t.write({type:"update",value:n});break}case"delete":{const e=t.collection.get(r.key);t.write({type:"delete",value:e});break}case"upsert":{const e=t.collection.validateData(r.data,t.collection.has(r.key)?"update":"insert",r.key);t.collection.has(r.key)?t.write({type:"update",value:e}):t.write({type:"insert",value:e});break}}t.commit();const s=t.collection.toArray;t.queryClient.setQueryData(t.queryKey,s)}function hf(e){const{queryKey:t,queryFn:n,queryClient:s,enabled:r,refetchInterval:i,retry:o,retryDelay:a,staleTime:l,getKey:c,onInsert:u,onUpdate:h,onDelete:d,meta:f,...p}=e;if(!t)throw new ef;if(!n)throw new tf;if(!s)throw new nf;if(!c)throw new sf;const g=async()=>s.refetchQueries({queryKey:t});let m=null;const y=function(e){function t(){const t=e();if(!t)throw new rf;return t}return{writeInsert(e){const n={type:"insert",data:e},s=t(),r=cf.get(s);(null==r?void 0:r.isActive)?r.operations.push(n):uf(n,s)},writeUpdate(e){const n={type:"update",data:e},s=t(),r=cf.get(s);(null==r?void 0:r.isActive)?r.operations.push(n):uf(n,s)},writeDelete(e){const n={type:"delete",key:e},s=t(),r=cf.get(s);(null==r?void 0:r.isActive)?r.operations.push(n):uf(n,s)},writeUpsert(e){const n={type:"upsert",data:e},s=t(),r=cf.get(s);(null==r?void 0:r.isActive)?r.operations.push(n):uf(n,s)},writeBatch(e){const n=t(),s=cf.get(n);if(null==s?void 0:s.isActive)throw new Error("Cannot nest writeBatch calls. Complete the current batch before starting a new one.");const r={operations:[],isActive:!0};cf.set(n,r);try{const t=e();if(t&&"object"==typeof t&&"then"in t&&"function"==typeof t.then)throw new Error("writeBatch does not support async callbacks. The callback must be synchronous.");r.operations.length>0&&uf(r.operations,n)}finally{r.isActive=!1,cf.delete(n)}}}}(()=>m);return{...p,getKey:c,sync:{sync:e=>{const{begin:u,write:h,commit:d,collection:p}=e;return m={collection:p,queryClient:s,queryKey:t,getKey:c,begin:u,write:h,commit:d},(e=>{const{begin:u,write:h,commit:d,markReady:p,collection:g}=e,m=new Jr(s,{queryKey:t,queryFn:n,meta:f,enabled:r,refetchInterval:i,retry:o,retryDelay:a,staleTime:l,structuralSharing:!0,notifyOnChangeProps:"all"}).subscribe(e=>{if(e.isSuccess){const t=e.data;if(!Array.isArray(t)||t.some(e=>"object"!=typeof e))return;const n=new Map(g.syncedData),s=new Map;t.forEach(e=>{const t=c(e);s.set(t,e)}),u();const r=(e,t)=>{const n=Object.keys(e),s=Object.keys(t);return n.length===s.length&&n.every(n=>"function"==typeof e[n]||("object"==typeof e[n]&&e[n],e[n]===t[n]))};n.forEach((e,t)=>{const n=s.get(t);n?r(e,n)||h({type:"update",value:n}):h({type:"delete",value:e})}),s.forEach((e,t)=>{n.has(t)||h({type:"insert",value:e})}),d(),p()}else e.isError&&p()});return async()=>{m(),await s.cancelQueries({queryKey:t}),s.removeQueries({queryKey:t})}})(e)}},onInsert:u?async e=>{const t=await u(e)??{};return!1!==t.refetch&&await g(),t}:void 0,onUpdate:h?async e=>{const t=await h(e)??{};return!1!==t.refetch&&await g(),t}:void 0,onDelete:d?async e=>{const t=await d(e)??{};return!1!==t.refetch&&await g(),t}:void 0,utils:{refetch:g,...y}}}function df(e,t){return Ic(hf({queryKey:[e],queryClient:ua,queryFn:async()=>{try{return await Gi.collection(e).getFullList({expand:t?.expand,sort:t?.sort,filter:t?.filter})}catch(n){throw n}},getKey:e=>e.id,onInsert:async({transaction:t})=>{try{const{modified:n}=t.mutations[0];return await Gi.collection(e).create(n),{refetch:!1}}catch(n){throw n}},onUpdate:async({transaction:t})=>{try{const{key:n,changes:s}=t.mutations[0];return await Gi.collection(e).update(n,s),{refetch:!1}}catch(n){throw n}},onDelete:async({transaction:t})=>{try{const{key:n}=t.mutations[0];return await Gi.collection(e).delete(n),{refetch:!1}}catch(n){throw n}}}))}const ff=df(Zi.Appointments,{sort:"-start_time"}),pf=df(Zi.Clinics,{sort:"clinic_name"}),gf=df(Zi.DentalCharts,{sort:"-created"}),mf=df(Zi.Organizations,{sort:"organization_name"}),yf=df(Zi.PatientTransfers,{sort:"-transfer_date"}),vf=df(Zi.Patients,{sort:"last_name,first_name"}),bf=df(Zi.StaffMembers,{sort:"role"}),wf=df(Zi.TreatmentRecords,{sort:"-created"}),xf=df(Zi.TreatmentsCatalog,{sort:"name"}),Sf=df(Zi.Users,{sort:"name"});const Cf={appointments:ff,clinics:pf,dentalCharts:gf,organizations:mf,patientTransfers:yf,patients:vf,staffMembers:bf,treatmentRecords:wf,treatmentsCatalog:xf,users:Sf},kf=()=>Cf;function Of(e){C(()=>{const t=function(e){const t={[Zi.Appointments]:ff,[Zi.Clinics]:pf,[Zi.DentalCharts]:gf,[Zi.Organizations]:mf,[Zi.PatientTransfers]:yf,[Zi.Patients]:vf,[Zi.StaffMembers]:bf,[Zi.TreatmentRecords]:wf,[Zi.TreatmentsCatalog]:xf,[Zi.Users]:Sf}[e];if(!t)return()=>{};let n=null;return Gi.collection(e).subscribe("*",e=>{switch(e.action){case"create":t.utils.writeInsert(e.record);break;case"update":t.utils.writeUpdate(e.record);break;case"delete":t.utils.writeDelete(e.record.id)}}).then(e=>{n=e}),()=>{n&&n()}}(e);A(t)})}function Mf(){return Zd(e=>e.from({patients:Cf.patients}))}function _f(){return Zd(e=>e.from({appointments:Cf.appointments}))}var Pf=Pe('<svg class="h-5 w-5"fill=none viewBox="0 0 24 24"stroke=currentColor stroke-width=2><path stroke-linecap=round stroke-linejoin=round d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z">'),If=Pe('<svg class="h-5 w-5"fill=none viewBox="0 0 24 24"stroke=currentColor stroke-width=2><path stroke-linecap=round stroke-linejoin=round d="M12 4v16m8-8H4">'),Af=Pe('<div class="flex items-center justify-center h-64"><div class="text-lg text-gray-200">Loading patients…'),Rf=Pe('<div class="flex items-center justify-center h-64"><div class="text-lg text-red-600">Failed to load patients'),Ef=Pe('<div class="rounded-lg shadow-sm border border-gray-200 overflow-hidden"><div class="flex items-center justify-between px-4 py-3 border-b border-gray-200"><div class="text-sm text-gray-200">Showing <!> of <!> patients</div></div><div class=overflow-x-auto><table class="min-w-full text-sm"><thead class=text-gray-200><tr><th class="text-left px-4 py-2 font-medium">Patient</th><th class="text-left px-4 py-2 font-medium">Phone</th><th class="text-left px-4 py-2 font-medium">Email</th><th class="text-left px-4 py-2 font-medium">DOB</th><th class="text-left px-4 py-2 font-medium">Age</th><th class="text-left px-4 py-2 font-medium">Sex</th><th class="text-left px-4 py-2 font-medium">Actions</th></tr></thead><tbody>'),Tf=Pe('<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">'),jf=Pe('<div class="min-h-screen p-6 space-y-6"><div class="flex flex-col gap-5"><div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between"><div><h2 class="text-2xl md:text-3xl font-bold text-gray-100">Patients</h2><p class=text-gray-200>Search, filter, and manage your patient directory</p></div><div class="flex items-center gap-3"><div class=relative><span class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3 text-gray-400"></span><input type=text placeholder="Search by name, phone, email"class="w-72 rounded-lg border border-gray-300 pl-10 pr-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"></div><button class="inline-flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white text-sm hover:bg-blue-700"><span>New patient</span></button></div></div><div class="grid grid-cols-1 sm:grid-cols-3 gap-4"><div class="rounded-lg shadow-sm border border-gray-200 p-4"><div class="text-sm text-gray-200">Total patients</div><div class="mt-1 text-2xl font-bold text-gray-100"></div></div><div class="rounded-lg shadow-sm border border-gray-200 p-4"><div class="text-sm text-gray-200">Male</div><div class="mt-1 text-2xl font-bold text-blue-600"></div></div><div class="rounded-lg shadow-sm border border-gray-200 p-4"><div class="text-sm text-gray-100">Female</div><div class="mt-1 text-2xl font-bold text-pink-600"></div></div></div></div><div class="rounded-lg shadow-sm border border-gray-200 p-4 flex flex-col md:flex-row md:items-center md:justify-between gap-3"><div class="flex items-center gap-2"><button>All</button><button>Male</button><button>Female</button></div><div class="flex items-center gap-3"><select class="rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"><option value=name_asc>Name A → Z</option><option value=name_desc>Name Z → A</option><option value=dob_desc>DOB (newest)</option><option value=dob_asc>DOB (oldest)</option></select><div class="inline-flex items-center rounded-md border border-gray-200 overflow-hidden"><button>Table</button><button>Grid'),Lf=Pe('<tr><td class="px-4 py-3">No patients'),Df=Pe('<tr class="border-t hover:bg-slate-800"><td class="px-4 py-3"><div class="flex items-center gap-3"><div class="h-9 w-9 rounded-full bg-gray-100 flex items-center justify-center text-xs font-semibold text-gray-700"></div><button class="text-blue-600 hover:underline text-left"><div class=font-medium> </div><div class="text-xs text-gray-500">ID: </div></button></div></td><td class="px-4 py-3"></td><td class="px-4 py-3"></td><td class="px-4 py-3"></td><td class="px-4 py-3"></td><td class="px-4 py-3"><span></span></td><td class="px-4 py-3 space-x-2"><button class="rounded border px-2 py-1 hover:bg-gray-50">View</button><button class="rounded border px-2 py-1 hover:bg-gray-50">Schedule</button><button class="rounded border px-2 py-1 text-red-600 hover:bg-red-50">Delete'),$f=Pe("<div class=text-gray-500>No patients"),Ff=Pe('<div class="bg-white rounded-lg shadow-sm border border-gray-200 p-4"><div class="flex items-start gap-3"><div></div><div class="flex-1 min-w-0"><div class="flex items-center justify-between"><div class=truncate><div class="font-semibold text-gray-900 truncate"> </div><div class="text-xs text-gray-500 truncate"></div></div><span class="text-xs text-gray-500"> yrs</span></div><div class="mt-2 text-sm text-gray-700"></div><div class="mt-3 flex items-center gap-2"><button class="px-3 py-1.5 rounded-md border text-sm hover:bg-gray-50">View</button><button class="px-3 py-1.5 rounded-md border text-sm hover:bg-gray-50">Schedule</button><button class="px-3 py-1.5 rounded-md border text-sm text-red-600 hover:bg-red-50">Delete');const qf=hs("/patients/")({component:function(){const e=ls();Of(Zi.Patients);const t=Mf(),n=kf(),[s,r]=w(""),[i,o]=w("all"),[a,l]=w("name_asc"),[c,u]=w("table"),h=(e,t)=>(((e||"").trim()[0]||"")+((t||"").trim()[0]||"")).toUpperCase(),d=e=>{if(!e)return"-";const t=new Date(e),n=new Date;let s=n.getFullYear()-t.getFullYear();const r=n.getMonth()-t.getMonth();return(r<0||0===r&&n.getDate()<t.getDate())&&s--,isNaN(s)?"-":`${s}`},f=k(()=>{let e=t.data??[];const n=s().trim().toLowerCase();n&&(e=e.filter(e=>`${e.first_name} ${e.last_name}`.toLowerCase().includes(n)||(e.email||"").toLowerCase().includes(n)||(e.phone||"").toLowerCase().includes(n)));const r=i();"all"!==r&&(e=e.filter(e=>e.sex===r));const o=a();return e=[...e].sort((e,t)=>{const n=`${e.last_name} ${e.first_name}`.toLocaleLowerCase(),s=`${t.last_name} ${t.first_name}`.toLocaleLowerCase();switch(o){case"name_asc":return n.localeCompare(s);case"name_desc":return s.localeCompare(n);case"dob_desc":return new Date(t.dob).getTime()-new Date(e.dob).getTime();case"dob_asc":return new Date(e.dob).getTime()-new Date(t.dob).getTime()}}),e}),p=k(()=>(t.data||[]).filter(e=>"male"===e.sex).length),g=k(()=>(t.data||[]).filter(e=>"female"===e.sex).length),m=async e=>{try{await n.patients.delete(e)}catch(t){}};return y=jf(),v=y.firstChild,b=v.firstChild,x=b.firstChild.nextSibling.firstChild,C=x.firstChild,O=C.nextSibling,M=x.nextSibling,_=M.firstChild,P=b.nextSibling.firstChild,I=P.firstChild.nextSibling,A=P.nextSibling,R=A.firstChild.nextSibling,E=A.nextSibling.firstChild.nextSibling,T=v.nextSibling.firstChild,j=T.firstChild,L=j.nextSibling,D=L.nextSibling,$=T.nextSibling.firstChild,F=$.nextSibling.firstChild,q=F.nextSibling,De(C,ne(Vf,{})),O.$$input=e=>r(e.currentTarget.value),M.$$click=()=>e({to:"/patients/new"}),De(M,ne(Bf,{}),_),De(I,()=>t.data?.length??0),De(R,p),De(E,g),j.$$click=()=>o("all"),L.$$click=()=>o("male"),D.$$click=()=>o("female"),$.$$input=e=>l(e.currentTarget.value),F.$$click=()=>u("table"),q.$$click=()=>u("grid"),De(y,ne(de,{get when(){return t.isLoading()},get children(){return Af()}}),null),De(y,ne(de,{get when(){return t.isError()},get children(){return Rf()}}),null),De(y,ne(de,{get when(){return t.data},get children(){return[ne(de,{get when(){return"table"===c()},get children(){var n=Ef(),s=n.firstChild,r=s.firstChild,i=r.firstChild.nextSibling,o=i.nextSibling.nextSibling;o.nextSibling;var a=s.nextSibling.firstChild.firstChild.nextSibling;return De(r,()=>f().length,i),De(r,()=>t.data?.length??0,o),De(a,ne(he,{get each(){return f()},get fallback(){return Lf()},children:t=>(()=>{var n=Df(),s=n.firstChild,r=s.firstChild.firstChild,i=r.nextSibling,o=i.firstChild,a=o.firstChild,l=o.nextSibling;l.firstChild;var c=s.nextSibling,u=c.nextSibling,f=u.nextSibling,p=f.nextSibling,g=p.nextSibling,y=g.firstChild,v=g.nextSibling.firstChild,b=v.nextSibling,w=b.nextSibling;return De(r,()=>h(t.first_name,t.last_name)),i.$$click=()=>e({to:`/patients/${t.id}`}),De(o,()=>t.first_name,a),De(o,()=>t.last_name,null),De(l,()=>t.id,null),De(c,()=>t.phone),De(u,()=>t.email||"-"),De(f,()=>new Date(t.dob).toLocaleDateString()),De(p,()=>d(t.dob)),De(y,()=>t.sex),v.$$click=()=>e({to:`/patients/${t.id}`}),b.$$click=()=>e({to:`/appointments/new?patient=${t.id}`}),w.$$click=()=>m(t.id),S(()=>Re(y,"px-2 py-1 rounded-full text-xs font-medium "+("male"===t.sex?"bg-blue-50 text-blue-700":"bg-pink-50 text-pink-700"))),n})()})),n}}),ne(de,{get when(){return"grid"===c()},get children(){var t=Tf();return De(t,ne(he,{get each(){return f()},get fallback(){return $f()},children:t=>{return n=Ff(),s=n.firstChild.firstChild,r=s.nextSibling.firstChild,i=r.firstChild,o=i.firstChild,a=o.firstChild,l=o.nextSibling,c=i.nextSibling,u=c.firstChild,f=r.nextSibling,p=f.nextSibling.firstChild,g=p.nextSibling,y=g.nextSibling,De(s,()=>h(t.first_name,t.last_name)),De(o,()=>t.first_name,a),De(o,()=>t.last_name,null),De(l,()=>t.email||"-"),De(c,()=>d(t.dob),u),De(f,()=>t.phone),p.$$click=()=>e({to:`/patients/${t.id}`}),g.$$click=()=>e({to:`/appointments/new?patient=${t.id}`}),y.$$click=()=>m(t.id),S(()=>Re(s,"h-12 w-12 rounded-full flex items-center justify-center text-sm font-semibold "+("male"===t.sex?"bg-blue-50 text-blue-700":"bg-pink-50 text-pink-700"))),n;var n,s,r,i,o,a,l,c,u,f,p,g,y}})),t}})]}}),null),S(e=>{var t="px-3 py-1.5 rounded-full text-sm "+("all"===i()?"bg-slate-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),n="px-3 py-1.5 rounded-full text-sm "+("male"===i()?"bg-blue-600 text-white":"bg-blue-50 text-blue-700 hover:bg-blue-100"),s="px-3 py-1.5 rounded-full text-sm "+("female"===i()?"bg-pink-600 text-white":"bg-pink-50 text-pink-700 hover:bg-pink-100"),r="px-3 py-1.5 text-sm "+("table"===c()?"bg-gray-900 text-white":"bg-white text-gray-700 hover:bg-gray-50"),o="px-3 py-1.5 text-sm "+("grid"===c()?"bg-gray-900 text-white":"bg-white text-gray-700 hover:bg-gray-50");return t!==e.e&&Re(j,e.e=t),n!==e.t&&Re(L,e.t=n),s!==e.a&&Re(D,e.a=s),r!==e.o&&Re(F,e.o=r),o!==e.i&&Re(q,e.i=o),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),S(()=>O.value=s()),S(()=>$.value=a()),y;var y,v,b,x,C,O,M,_,P,I,A,R,E,T,j,L,D,$,F,q}}),Vf=()=>Pf(),Bf=()=>If();function Nf(e,t){return"function"==typeof e?e(t):e}function Uf(e,t){return Zf(t).reduce((e,t)=>null===e?null:void 0!==e?e[t]:void 0,e)}function Kf(e,t,n){const s=Zf(t);return function e(t){if(!s.length)return Nf(n,t);const r=s.shift();if("string"==typeof r||"number"==typeof r&&!Array.isArray(t))return"object"==typeof t?(null===t&&(t={}),{...t,[r]:e(t[r])}):{[r]:e()};if(Array.isArray(t)&&"number"==typeof r){const n=t.slice(0,r);return[...n.length?n:new Array(r),e(t[r]),...t.slice(r+1)]}return[...new Array(r),e()]}(e)}Ie(["input","click"]);const zf=/^(\d+)$/gm,Wf=/\.(\d+)(?=\.)/gm,Qf=/^(\d+)\./gm,Hf=/\.(\d+$)/gm,Gf=/\.{2,}/gm,Jf="__int__",Yf=`${Jf}$1`;function Zf(e){if(Array.isArray(e))return[...e];if("string"!=typeof e)throw new Error("Path must be a string.");return e.replace(/(^\[)|]/gm,"").replace(/\[/g,".").replace(zf,Yf).replace(Wf,`.${Yf}.`).replace(Qf,`${Yf}.`).replace(Hf,`.${Yf}`).replace(Gf,".").split(".").map(e=>{if(e.startsWith(Jf)){const t=e.substring(Jf.length),n=parseInt(t,10);return String(n)===t?n:t}return e})}function Xf(e){return!(Array.isArray(e)&&0===e.length)}function ep(e,t){return t.validationLogic({form:t.form,validators:t.validators,event:{type:e,async:!1},runValidation:e=>e.validators.filter(Boolean).map(e=>({cause:e.cause,validate:e.fn}))})}function tp(e,t){const{asyncDebounceMs:n}=t,{onBlurAsyncDebounceMs:s,onChangeAsyncDebounceMs:r,onDynamicAsyncDebounceMs:i}=t.validators||{},o=n??0;return t.validationLogic({form:t.form,validators:t.validators,event:{type:e,async:!0},runValidation:t=>t.validators.filter(Boolean).map(t=>{const n=t?.cause||e;let a=o;switch(n){case"change":a=r??o;break;case"blur":a=s??o;break;case"dynamic":a=i??o;break;case"submit":a=0}return"submit"===e&&(a=0),{cause:n,validate:t.fn,debounceMs:a}})})}const np=e=>!!e&&"object"==typeof e&&"fields"in e;function sp(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,s]of e)if(!t.has(n)||!Object.is(s,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(const r of n)if(!s.includes(r)||!sp(e[r],t[r]))return!1;return!0}const rp=({newFormValidatorError:e,isPreviousErrorFromFormValidator:t,previousErrorValue:n})=>e?{newErrorValue:e,newSource:"form"}:t?{newErrorValue:void 0,newSource:void 0}:n?{newErrorValue:n,newSource:"field"}:{newErrorValue:void 0,newSource:void 0},ip=({formLevelError:e,fieldLevelError:t})=>t?{newErrorValue:t,newSource:"field"}:e?{newErrorValue:e,newSource:"form"}:{newErrorValue:void 0,newSource:void 0},op=e=>{if(!e.validators)return e.runValidation({validators:[],form:e.form});const t=e.event.async,n=t?void 0:{fn:e.validators.onMount,cause:"mount"},s={fn:t?e.validators.onChangeAsync:e.validators.onChange,cause:"change"},r={fn:t?e.validators.onBlurAsync:e.validators.onBlur,cause:"blur"},i={fn:t?e.validators.onSubmitAsync:e.validators.onSubmit,cause:"submit"},o=t?void 0:{fn:()=>{},cause:"server"};switch(e.event.type){case"mount":return e.runValidation({validators:[n],form:e.form});case"submit":return e.runValidation({validators:[s,r,i,o],form:e.form});case"server":return e.runValidation({validators:[],form:e.form});case"blur":return e.runValidation({validators:[r,o],form:e.form});case"change":return e.runValidation({validators:[s,o],form:e.form});default:throw new Error(`Unknown validation event type: ${e.event.type}`)}};const ap=e=>{const t=function(e){const t=new Map;for(const n of e){const e=[...n.path??[]].map(e=>{const t="object"==typeof e?e.key:e;return"number"==typeof t?`[${t}]`:t}).join(".").replace(/\.\[/g,"[");t.set(e,(t.get(e)??[]).concat(n))}return Object.fromEntries(t)}(e);return{form:t,fields:t}},lp={validate({value:e,validationSource:t},n){const s=n["~standard"].validate(e);if(s instanceof Promise)throw new Error("async function passed to sync validator");if(s.issues)return"field"===t?s.issues:ap(s.issues)},async validateAsync({value:e,validationSource:t},n){const s=await n["~standard"].validate(e);if(s.issues)return"field"===t?s.issues:ap(s.issues)}},cp=e=>!!e&&"~standard"in e,up={isValidating:!1,isTouched:!1,isBlurred:!1,isDirty:!1,isPristine:!0,isValid:!0,isDefaultValue:!0,errors:[],errorMap:{},errorSourceMap:{}};function hp(e){function t(e,t){return`${e}[${t}]`}function n(t,n){("up"===n?t:[...t].reverse()).forEach(t=>{const r=function(e,t){return e.replace(/\[(\d+)\]/,(e,n)=>{const s=parseInt(n,10);return`[${"up"===t?s+1:Math.max(0,s-1)}]`})}(t.toString(),n),i=e.getFieldMeta(r);i?e.setFieldMeta(t,i):e.setFieldMeta(t,s())})}const s=()=>up,r=(r,i,o)=>{n(r,"down"),r.forEach(n=>{n.toString().startsWith(t(i,o))&&e.setFieldMeta(n,s())})},i=e=>{n(e,"up")},o=(s,r,i,o)=>{const a=new Map(Object.keys(e.fieldInfo).filter(e=>e.startsWith(t(r,i))).map(t=>[t,e.getFieldMeta(t)]));n(s,i<o?"up":"down"),Object.keys(e.fieldInfo).filter(e=>e.startsWith(t(r,o))).forEach(n=>{const s=n.replace(t(r,o),t(r,i)),l=a.get(s);l&&e.setFieldMeta(n,l)})},a=(n,s,r,i)=>{n.forEach(n=>{if(!n.toString().startsWith(t(s,r)))return;const o=n.toString().replace(t(s,r),t(s,i)),[a,l]=[e.getFieldMeta(n),e.getFieldMeta(o)];a&&e.setFieldMeta(o,a),l&&e.setFieldMeta(n,l)})};return{handleArrayFieldMetaShift:function(n,s,l,c){const u=function(n,s,r,i){const o=[t(n,s)];if("swap"===r)o.push(t(n,i));else if("move"===r){const[e,r]=[Math.min(s,i),Math.max(s,i)];for(let s=e;s<=r;s++)o.push(t(n,s))}else{const r=e.getFieldValue(n),i=Array.isArray(r)?r.length:0;for(let e=s+1;e<i;e++)o.push(t(n,e))}return Object.keys(e.fieldInfo).filter(e=>o.some(t=>e.startsWith(t)))}(n,s,l,c);({insert:()=>r(u,n,s),remove:()=>i(u),swap:()=>void 0!==c&&a(u,n,s,c),move:()=>void 0!==c&&o(u,n,s,c)})[l]()}}}function dp(e){return{values:e.values??{},errorMap:e.errorMap??{},fieldMetaBase:e.fieldMetaBase??{},isSubmitted:e.isSubmitted??!1,isSubmitting:e.isSubmitting??!1,isValidating:e.isValidating??!1,submissionAttempts:e.submissionAttempts??0,isSubmitSuccessful:e.isSubmitSuccessful??!1,validationMetaMap:e.validationMetaMap??{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0,onDynamic:void 0}}}class fp{constructor(e){this.options={},this.fieldInfo={},this.prevTransformArray=[],this.mount=()=>{const e=this.fieldMetaDerived.mount(),t=this.store.mount(),n=()=>{e(),t()};this.options.listeners?.onMount?.({formApi:this});const{onMount:s}=this.options.validators||{};return s?(this.validateSync("mount"),n):n},this.update=e=>{if(!e)return;const t=this.options;this.options=e;const n=!!e.transform?.deps?.some((e,t)=>e!==this.prevTransformArray[t]),s=e.defaultValues&&!sp(e.defaultValues,t.defaultValues)&&!this.state.isTouched,r=!sp(e.defaultState,t.defaultState)&&!this.state.isTouched;(s||r||n)&&ot(()=>{this.baseStore.setState(()=>dp(Object.assign({},this.state,r?e.defaultState:{},s?{values:e.defaultValues}:{},n?{_force_re_eval:!this.state._force_re_eval}:{})))})},this.reset=(e,t)=>{const{fieldMeta:n}=this.state,s=this.resetFieldMeta(n);e&&!t?.keepDefaultValues&&(this.options={...this.options,defaultValues:e}),this.baseStore.setState(()=>dp({...this.options.defaultState,values:e??this.options.defaultValues??this.options.defaultState?.values,fieldMetaBase:s}))},this.validateAllFields=async e=>{const t=[];ot(()=>{Object.values(this.fieldInfo).forEach(n=>{if(!n.instance)return;const s=n.instance;t.push(Promise.resolve().then(()=>s.validate(e,{skipFormValidation:!0}))),n.instance.state.meta.isTouched||n.instance.setMeta(e=>({...e,isTouched:!0}))})});return(await Promise.all(t)).flat()},this.validateArrayFieldsStartingFrom=async(e,t,n)=>{const s=this.getFieldValue(e),r=Array.isArray(s)?Math.max(s.length-1,0):null,i=[`${e}[${t}]`];for(let l=t+1;l<=(r??0);l++)i.push(`${e}[${l}]`);const o=Object.keys(this.fieldInfo).filter(e=>i.some(t=>e.startsWith(t))),a=[];ot(()=>{o.forEach(e=>{a.push(Promise.resolve().then(()=>this.validateField(e,n)))})});return(await Promise.all(a)).flat()},this.validateField=(e,t)=>{const n=this.fieldInfo[e]?.instance;return n?(n.state.meta.isTouched||n.setMeta(e=>({...e,isTouched:!0})),n.validate(t)):[]},this.validateSync=e=>{const t=ep(e,{...this.options,form:this,validationLogic:this.options.validationLogic||op});let n=!1;const s={};return ot(()=>{for(const e of t){if(!e.validate)continue;const t=this.runValidator({validate:e.validate,value:{value:this.state.values,formApi:this,validationSource:"form"},type:"validate"}),{formError:r,fieldErrors:i}=pp(t),o=gp(e.cause);for(const e of Object.keys(this.state.fieldMeta)){const t=this.getFieldMeta(e);if(!t)continue;const{errorMap:n,errorSourceMap:r}=t,a=i?.[e],{newErrorValue:l,newSource:c}=rp({newFormValidatorError:a,isPreviousErrorFromFormValidator:"form"===r?.[o],previousErrorValue:n?.[o]});"form"===c&&(s[e]={...s[e],[o]:a}),n?.[o]!==l&&this.setFieldMeta(e,e=>({...e,errorMap:{...e.errorMap,[o]:l},errorSourceMap:{...e.errorSourceMap,[o]:c}}))}this.state.errorMap?.[o]!==r&&this.baseStore.setState(e=>({...e,errorMap:{...e.errorMap,[o]:r}})),(r||i)&&(n=!0)}const r=gp("submit");this.state.errorMap?.[r]&&"submit"!==e&&!n&&this.baseStore.setState(e=>({...e,errorMap:{...e.errorMap,[r]:void 0}}));const i=gp("server");this.state.errorMap?.[i]&&"server"!==e&&!n&&this.baseStore.setState(e=>({...e,errorMap:{...e.errorMap,[i]:void 0}}))}),{hasErrored:n,fieldsErrorMap:s}},this.validateAsync=async e=>{const t=tp(e,{...this.options,form:this,validationLogic:this.options.validationLogic||op});this.state.isFormValidating||this.baseStore.setState(e=>({...e,isFormValidating:!0}));const n=[];let s;for(const o of t){if(!o.validate)continue;const e=gp(o.cause),t=this.state.validationMetaMap[e];t?.lastAbortController.abort();const r=new AbortController;this.state.validationMetaMap[e]={lastAbortController:r},n.push(new Promise(async e=>{let t;try{t=await new Promise((e,t)=>{setTimeout(async()=>{if(r.signal.aborted)return e(void 0);try{e(await this.runValidator({validate:o.validate,value:{value:this.state.values,formApi:this,validationSource:"form",signal:r.signal},type:"validateAsync"}))}catch(n){t(n)}},o.debounceMs)})}catch(l){t=l}const{formError:n,fieldErrors:i}=pp(t);i&&(s=s?{...s,...i}:i);const a=gp(o.cause);for(const r of Object.keys(this.state.fieldMeta)){const e=this.getFieldMeta(r);if(!e)continue;const{errorMap:t,errorSourceMap:n}=e,i=s?.[r],{newErrorValue:o,newSource:l}=rp({newFormValidatorError:i,isPreviousErrorFromFormValidator:"form"===n?.[a],previousErrorValue:t?.[a]});t?.[a]!==o&&this.setFieldMeta(r,e=>({...e,errorMap:{...e.errorMap,[a]:o},errorSourceMap:{...e.errorSourceMap,[a]:l}}))}this.baseStore.setState(e=>({...e,errorMap:{...e.errorMap,[a]:n}})),e(s?{fieldErrors:s,errorMapKey:a}:void 0)}))}let r=[];const i={};if(n.length){r=await Promise.all(n);for(const e of r)if(e?.fieldErrors){const{errorMapKey:t}=e;for(const[n,s]of Object.entries(e.fieldErrors)){const e={...i[n]||{},[t]:s};i[n]=e}}}return this.baseStore.setState(e=>({...e,isFormValidating:!1})),i},this.validate=e=>{const{hasErrored:t,fieldsErrorMap:n}=this.validateSync(e);return t&&!this.options.asyncAlways?n:this.validateAsync(e)},this.getFieldValue=e=>Uf(this.state.values,e),this.getFieldMeta=e=>this.state.fieldMeta[e],this.getFieldInfo=e=>this.fieldInfo[e]||={instance:null,validationMetaMap:{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0,onDynamic:void 0}},this.setFieldMeta=(e,t)=>{this.baseStore.setState(n=>({...n,fieldMetaBase:{...n.fieldMetaBase,[e]:Nf(t,n.fieldMetaBase[e])}}))},this.resetFieldMeta=e=>Object.keys(e).reduce((e,t)=>(e[t]=up,e),{}),this.setFieldValue=(e,t,n)=>{const s=n?.dontUpdateMeta??!1;ot(()=>{s||this.setFieldMeta(e,e=>({...e,isTouched:!0,isDirty:!0,errorMap:{...e?.errorMap,onMount:void 0}})),this.baseStore.setState(n=>({...n,values:Kf(n.values,e,t)}))})},this.deleteField=e=>{const t=[...Object.keys(this.fieldInfo).filter(t=>{const n=e.toString();return t!==n&&t.startsWith(n)}),e];this.baseStore.setState(e=>{const n={...e};return t.forEach(e=>{n.values=function(e,t){const n=Zf(t);return function e(t){if(!t)return;if(1===n.length){const e=n[0];if(Array.isArray(t)&&"number"==typeof e)return t.filter((t,n)=>n!==e);const{[e]:s,...r}=t;return r}const s=n.shift();if("string"==typeof s&&"object"==typeof t)return{...t,[s]:e(t[s])};if("number"==typeof s&&Array.isArray(t)){if(s>=t.length)return t;const n=t.slice(0,s);return[...n.length?n:new Array(s),e(t[s]),...t.slice(s+1)]}throw new Error("It seems we have created an infinite loop in deleteBy. ")}(e)}(n.values,e),delete this.fieldInfo[e],delete n.fieldMetaBase[e]}),n})},this.pushFieldValue=(e,t,n)=>{this.setFieldValue(e,e=>[...Array.isArray(e)?e:[],t],n),this.validateField(e,"change")},this.insertFieldValue=async(e,t,n,s)=>{this.setFieldValue(e,e=>[...e.slice(0,t),n,...e.slice(t)],s),await this.validateField(e,"change"),hp(this).handleArrayFieldMetaShift(e,t,"insert"),await this.validateArrayFieldsStartingFrom(e,t,"change")},this.replaceFieldValue=async(e,t,n,s)=>{this.setFieldValue(e,e=>e.map((e,s)=>s===t?n:e),s),await this.validateField(e,"change"),await this.validateArrayFieldsStartingFrom(e,t,"change")},this.removeFieldValue=async(e,t,n)=>{const s=this.getFieldValue(e),r=Array.isArray(s)?Math.max(s.length-1,0):null;if(this.setFieldValue(e,e=>e.filter((e,n)=>n!==t),n),hp(this).handleArrayFieldMetaShift(e,t,"remove"),null!==r){const t=`${e}[${r}]`;this.deleteField(t)}await this.validateField(e,"change"),await this.validateArrayFieldsStartingFrom(e,t,"change")},this.swapFieldValues=(e,t,n,s)=>{this.setFieldValue(e,e=>{const s=e[t],r=e[n];return Kf(Kf(e,`${t}`,r),`${n}`,s)},s),hp(this).handleArrayFieldMetaShift(e,t,"swap",n),this.validateField(e,"change"),this.validateField(`${e}[${t}]`,"change"),this.validateField(`${e}[${n}]`,"change")},this.moveFieldValues=(e,t,n,s)=>{this.setFieldValue(e,e=>{const s=[...e];return s.splice(n,0,s.splice(t,1)[0]),s},s),hp(this).handleArrayFieldMetaShift(e,t,"move",n),this.validateField(e,"change"),this.validateField(`${e}[${t}]`,"change"),this.validateField(`${e}[${n}]`,"change")},this.clearFieldValues=(e,t)=>{const n=this.getFieldValue(e),s=Array.isArray(n)?Math.max(n.length-1,0):null;if(this.setFieldValue(e,[],t),null!==s)for(let r=0;r<=s;r++){const t=`${e}[${r}]`;this.deleteField(t)}this.validateField(e,"change")},this.resetField=e=>{this.baseStore.setState(t=>({...t,fieldMetaBase:{...t.fieldMetaBase,[e]:up},values:this.options.defaultValues?Kf(t.values,e,Uf(this.options.defaultValues,e)):t.values}))},this.getAllErrors=()=>({form:{errors:this.state.errors,errorMap:this.state.errorMap},fields:Object.entries(this.state.fieldMeta).reduce((e,[t,n])=>(Object.keys(n).length&&n.errors.length&&(e[t]={errors:n.errors,errorMap:n.errorMap}),e),{})}),this.parseValuesWithSchema=e=>lp.validate({value:this.state.values,validationSource:"form"},e),this.parseValuesWithSchemaAsync=e=>lp.validateAsync({value:this.state.values,validationSource:"form"},e),this.baseStore=new at(dp({...e?.defaultState,values:e?.defaultValues??e?.defaultState?.values})),this.fieldMetaDerived=new lt({deps:[this.baseStore],fn:({prevDepVals:e,currDepVals:t,prevVal:n})=>{const s=n,r=e?.[0],i=t[0];let o=0;const a={};for(const l of Object.keys(i.fieldMetaBase)){const e=i.fieldMetaBase[l],t=r?.fieldMetaBase[l],n=s?.[l],c=Uf(i.values,l);let u=n?.errors;if(!t||e.errorMap!==t.errorMap){u=Object.values(e.errorMap??{}).filter(e=>void 0!==e);const t=this.getFieldInfo(l)?.instance;t&&!t.options.disableErrorFlat&&(u=u?.flat(1))}const h=!Xf(u??[]),d=!e.isDirty,f=sp(c,Uf(this.options.defaultValues,l))||sp(c,this.getFieldInfo(l)?.instance?.options.defaultValue);n&&n.isPristine===d&&n.isValid===h&&n.isDefaultValue===f&&n.errors===u&&e===t?(a[l]=n,o++):a[l]={...e,errors:u,isPristine:d,isValid:h,isDefaultValue:f}}return Object.keys(i.fieldMetaBase).length&&s&&o===Object.keys(i.fieldMetaBase).length?s:a}}),this.store=new lt({deps:[this.baseStore,this.fieldMetaDerived],fn:({prevDepVals:e,currDepVals:t,prevVal:n})=>{const s=n,r=e?.[0],i=t[0],o=t[1],a=Object.values(o).filter(Boolean),l=a.some(e=>e.isValidating),c=a.every(e=>e.isValid),u=a.some(e=>e.isTouched),h=a.some(e=>e.isBlurred),d=a.every(e=>e.isDefaultValue),f=u&&i.errorMap?.onMount,p=a.some(e=>e.isDirty),g=!p,m=Boolean(i.errorMap?.onMount||a.some(e=>e?.errorMap?.onMount)),y=!!l;let v=s?.errors??[];r&&i.errorMap===r.errorMap||(v=Object.values(i.errorMap).reduce((e,t)=>void 0===t?e:t&&np(t)?(e.push(t.form),e):(e.push(t),e),[]));const b=0===v.length,w=c&&b,x=this.options.canSubmitWhenInvalid??!1,S=0===i.submissionAttempts&&!u&&!m||!y&&!i.isSubmitting&&w||x;let C=i.errorMap;if(f&&(v=v.filter(e=>e!==i.errorMap.onMount),C=Object.assign(C,{onMount:void 0})),s&&r&&s.errorMap===C&&s.fieldMeta===this.fieldMetaDerived.state&&s.errors===v&&s.isFieldsValidating===l&&s.isFieldsValid===c&&s.isFormValid===b&&s.isValid===w&&s.canSubmit===S&&s.isTouched===u&&s.isBlurred===h&&s.isPristine===g&&s.isDefaultValue===d&&s.isDirty===p&&sp(r,i))return s;let k={...i,errorMap:C,fieldMeta:this.fieldMetaDerived.state,errors:v,isFieldsValidating:l,isFieldsValid:c,isFormValid:b,isValid:w,canSubmit:S,isTouched:u,isBlurred:h,isPristine:g,isDefaultValue:d,isDirty:p};const O=this.options.transform?.deps??[];if(O.length!==this.prevTransformArray.length||O.some((e,t)=>e!==this.prevTransformArray[t])){const e=Object.assign({},this,{state:k});this.options.transform?.fn(e),k=e.state,this.prevTransformArray=O}return k}}),this.handleSubmit=this.handleSubmit.bind(this),this.update(e||{})}get state(){return this.store.state}get formId(){return this.options.formId}runValidator(e){return cp(e.validate)?lp[e.type](e.value,e.validate):e.validate(e.value)}async handleSubmit(e){if(this.baseStore.setState(e=>({...e,isSubmitted:!1,submissionAttempts:e.submissionAttempts+1,isSubmitSuccessful:!1})),ot(()=>{Object.values(this.fieldInfo).forEach(e=>{e.instance&&(e.instance.state.meta.isTouched||e.instance.setMeta(e=>({...e,isTouched:!0})))})}),!this.state.canSubmit)return;const t=e??this.options.onSubmitMeta;this.baseStore.setState(e=>({...e,isSubmitting:!0}));const n=()=>{this.baseStore.setState(e=>({...e,isSubmitting:!1}))};if(await this.validateAllFields("submit"),!this.state.isFieldsValid)return n(),void this.options.onSubmitInvalid?.({value:this.state.values,formApi:this,meta:t});if(await this.validate("submit"),!this.state.isValid)return n(),void this.options.onSubmitInvalid?.({value:this.state.values,formApi:this,meta:t});ot(()=>{Object.values(this.fieldInfo).forEach(e=>{e.instance?.options.listeners?.onSubmit?.({value:e.instance.state.value,fieldApi:e.instance})})}),this.options.listeners?.onSubmit?.({formApi:this,meta:t});try{await(this.options.onSubmit?.({value:this.state.values,formApi:this,meta:t})),ot(()=>{this.baseStore.setState(e=>({...e,isSubmitted:!0,isSubmitSuccessful:!0})),n()})}catch(s){throw this.baseStore.setState(e=>({...e,isSubmitSuccessful:!1})),n(),s}}setErrorMap(e){ot(()=>{Object.entries(e).forEach(([e,t])=>{const n=e;if(np(t)){const{formError:e,fieldErrors:s}=pp(t);for(const t of Object.keys(this.fieldInfo)){this.getFieldMeta(t)&&this.setFieldMeta(t,e=>({...e,errorMap:{...e.errorMap,[n]:s?.[t]},errorSourceMap:{...e.errorSourceMap,[n]:"form"}}))}this.baseStore.setState(t=>({...t,errorMap:{...t.errorMap,[n]:e}}))}else this.baseStore.setState(e=>({...e,errorMap:{...e.errorMap,[n]:t}}))})})}}function pp(e){if(e){if(np(e)){return{formError:pp(e.form).formError,fieldErrors:e.fields}}return{formError:e}}return{formError:void 0}}function gp(e){switch(e){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"dynamic":return"onDynamic";default:return"onChange"}}class mp{constructor(e){this.options={},this.mount=()=>{const e=this.store.mount();void 0!==this.options.defaultValue&&this.form.setFieldValue(this.name,this.options.defaultValue,{dontUpdateMeta:!0});this.getInfo().instance=this,this.update(this.options);const{onMount:t}=this.options.validators||{};if(t){const e=this.runValidator({validate:t,value:{value:this.state.value,fieldApi:this,validationSource:"field"},type:"validate"});e&&this.setMeta(t=>({...t,errorMap:{...t?.errorMap,onMount:e},errorSourceMap:{...t?.errorSourceMap,onMount:"field"}}))}return this.options.listeners?.onMount?.({value:this.state.value,fieldApi:this}),e},this.update=e=>{this.options=e;const t=this.name!==e.name;if(this.name=e.name,void 0===this.state.value){const n=Uf(e.form.options.defaultValues,e.name),s=e.defaultValue??n;t?this.setValue(e=>e||s,{dontUpdateMeta:!0}):void 0!==s&&this.setValue(s,{dontUpdateMeta:!0})}void 0===this.form.getFieldMeta(this.name)&&this.setMeta(this.state.meta)},this.getValue=()=>this.form.getFieldValue(this.name),this.setValue=(e,t)=>{this.form.setFieldValue(this.name,e,t),this.triggerOnChangeListener(),this.validate("change")},this.getMeta=()=>this.store.state.meta,this.setMeta=e=>this.form.setFieldMeta(this.name,e),this.getInfo=()=>this.form.getFieldInfo(this.name),this.pushValue=(e,t)=>{this.form.pushFieldValue(this.name,e,t),this.triggerOnChangeListener()},this.insertValue=(e,t,n)=>{this.form.insertFieldValue(this.name,e,t,n),this.triggerOnChangeListener()},this.replaceValue=(e,t,n)=>{this.form.replaceFieldValue(this.name,e,t,n),this.triggerOnChangeListener()},this.removeValue=(e,t)=>{this.form.removeFieldValue(this.name,e,t),this.triggerOnChangeListener()},this.swapValues=(e,t,n)=>{this.form.swapFieldValues(this.name,e,t,n),this.triggerOnChangeListener()},this.moveValue=(e,t,n)=>{this.form.moveFieldValues(this.name,e,t,n),this.triggerOnChangeListener()},this.clearValues=e=>{this.form.clearFieldValues(this.name,e),this.triggerOnChangeListener()},this.getLinkedFields=e=>{const t=Object.values(this.form.fieldInfo),n=[];for(const s of t){if(!s.instance)continue;const{onChangeListenTo:t,onBlurListenTo:r}=s.instance.options.validators||{};"change"===e&&t?.includes(this.name)&&n.push(s.instance),"blur"===e&&r?.includes(this.name)&&n.push(s.instance)}return n},this.validateSync=(e,t)=>{const n=ep(e,{...this.options,form:this.form,validationLogic:this.form.options.validationLogic||op}),s=this.getLinkedFields(e).reduce((t,n)=>{const s=ep(e,{...n.options,form:n.form,validationLogic:n.form.options.validationLogic||op});return s.forEach(e=>{e.field=n}),t.concat(s)},[]);let r=!1;ot(()=>{const e=(e,n)=>{const s=vp(n.cause),i=n.validate?yp(e.runValidator({validate:n.validate,value:{value:e.store.state.value,validationSource:"field",fieldApi:e},type:"validate"})):void 0,o=t[s],{newErrorValue:a,newSource:l}=ip({formLevelError:o,fieldLevelError:i});e.state.meta.errorMap?.[s]!==a&&e.setMeta(e=>({...e,errorMap:{...e.errorMap,[s]:a},errorSourceMap:{...e.errorSourceMap,[s]:l}})),a&&(r=!0)};for(const t of n)e(this,t);for(const t of s)t.validate&&e(t.field,t)});const i=vp("submit");return this.state.meta.errorMap?.[i]&&"submit"!==e&&!r&&this.setMeta(e=>({...e,errorMap:{...e.errorMap,[i]:void 0},errorSourceMap:{...e.errorSourceMap,[i]:void 0}})),{hasErrored:r}},this.validateAsync=async(e,t)=>{const n=tp(e,{...this.options,form:this.form,validationLogic:this.form.options.validationLogic||op}),s=await t,r=this.getLinkedFields(e),i=r.reduce((t,n)=>{const s=tp(e,{...n.options,form:n.form,validationLogic:n.form.options.validationLogic||op});return s.forEach(e=>{e.field=n}),t.concat(s)},[]);this.state.meta.isValidating||this.setMeta(e=>({...e,isValidating:!0}));for(const u of r)u.setMeta(e=>({...e,isValidating:!0}));const o=[],a=[],l=(e,t,n)=>{const r=vp(t.cause),i=e.getInfo().validationMetaMap[r];i?.lastAbortController.abort();const o=new AbortController;this.getInfo().validationMetaMap[r]={lastAbortController:o},n.push(new Promise(async n=>{let i;try{i=await new Promise((n,s)=>{this.timeoutIds.validations[t.cause]&&clearTimeout(this.timeoutIds.validations[t.cause]),this.timeoutIds.validations[t.cause]=setTimeout(async()=>{if(o.signal.aborted)return n(void 0);try{n(await this.runValidator({validate:t.validate,value:{value:e.store.state.value,fieldApi:e,signal:o.signal,validationSource:"field"},type:"validateAsync"}))}catch(r){s(r)}},t.debounceMs)})}catch(h){i=h}if(o.signal.aborted)return n(void 0);const a=yp(i),l=s[this.name]?.[r],{newErrorValue:c,newSource:u}=ip({formLevelError:l,fieldLevelError:a});e.setMeta(e=>({...e,errorMap:{...e?.errorMap,[r]:c},errorSourceMap:{...e.errorSourceMap,[r]:u}})),n(c)}))};for(const u of n)u.validate&&l(this,u,o);for(const u of i)u.validate&&l(u.field,u,a);let c=[];(o.length||a.length)&&(c=await Promise.all(o),await Promise.all(a)),this.setMeta(e=>({...e,isValidating:!1}));for(const u of r)u.setMeta(e=>({...e,isValidating:!1}));return c.filter(Boolean)},this.validate=(e,t)=>{if(!this.state.meta.isTouched)return[];const{fieldsErrorMap:n}=t?.skipFormValidation?{fieldsErrorMap:{}}:this.form.validateSync(e),{hasErrored:s}=this.validateSync(e,n[this.name]??{});if(s&&!this.options.asyncAlways)return this.getInfo().validationMetaMap[vp(e)]?.lastAbortController.abort(),this.state.meta.errors;const r=t?.skipFormValidation?Promise.resolve({}):this.form.validateAsync(e);return this.validateAsync(e,r)},this.handleChange=e=>{this.setValue(e)},this.handleBlur=()=>{this.state.meta.isTouched||this.setMeta(e=>({...e,isTouched:!0})),this.state.meta.isBlurred||this.setMeta(e=>({...e,isBlurred:!0})),this.validate("blur"),this.triggerOnBlurListener()},this.parseValueWithSchema=e=>lp.validate({value:this.state.value,validationSource:"field"},e),this.parseValueWithSchemaAsync=e=>lp.validateAsync({value:this.state.value,validationSource:"field"},e),this.form=e.form,this.name=e.name,this.timeoutIds={validations:{},listeners:{},formListeners:{}},this.store=new lt({deps:[this.form.store],fn:()=>({value:this.form.getFieldValue(this.name),meta:this.form.getFieldMeta(this.name)??{...up,...e.defaultMeta}})}),this.options=e}get state(){return this.store.state}runValidator(e){return cp(e.validate)?lp[e.type](e.value,e.validate):e.validate(e.value)}setErrorMap(e){this.setMeta(t=>({...t,errorMap:{...t.errorMap,...e}}))}triggerOnBlurListener(){const e=this.form.options.listeners?.onBlurDebounceMs;e&&e>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{this.form.options.listeners?.onBlur?.({formApi:this.form,fieldApi:this})},e)):this.form.options.listeners?.onBlur?.({formApi:this.form,fieldApi:this});const t=this.options.listeners?.onBlurDebounceMs;t&&t>0?(this.timeoutIds.listeners.blur&&clearTimeout(this.timeoutIds.listeners.blur),this.timeoutIds.listeners.blur=setTimeout(()=>{this.options.listeners?.onBlur?.({value:this.state.value,fieldApi:this})},t)):this.options.listeners?.onBlur?.({value:this.state.value,fieldApi:this})}triggerOnChangeListener(){const e=this.form.options.listeners?.onChangeDebounceMs;e&&e>0?(this.timeoutIds.formListeners.change&&clearTimeout(this.timeoutIds.formListeners.change),this.timeoutIds.formListeners.change=setTimeout(()=>{this.form.options.listeners?.onChange?.({formApi:this.form,fieldApi:this})},e)):this.form.options.listeners?.onChange?.({formApi:this.form,fieldApi:this});const t=this.options.listeners?.onChangeDebounceMs;t&&t>0?(this.timeoutIds.listeners.change&&clearTimeout(this.timeoutIds.listeners.change),this.timeoutIds.listeners.change=setTimeout(()=>{this.options.listeners?.onChange?.({value:this.state.value,fieldApi:this})},t)):this.options.listeners?.onChange?.({value:this.state.value,fieldApi:this})}}function yp(e){if(e)return e}function vp(e){switch(e){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"dynamic":return"onDynamic";default:return"onChange"}}function bp(e,t=e=>e){const[n,s]=w(t(e.state)),r=e.subscribe(()=>{const r=t(e.state);(function(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,s]of e)if(!t.has(n)||!Object.is(s,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let s=0;s<n.length;s++)if(!Object.prototype.hasOwnProperty.call(t,n[s])||!Object.is(e[n[s]],t[n[s]]))return!1;return!0})(n(),r)||s(()=>r)});return A(()=>{r()}),n}function wp(e){const t=e(),n=new mp(t),s=n;s.Field=xp;let r=!1;return I(()=>{const e=n.mount();r=!0,A(()=>{e(),r=!1})}),x(()=>{r&&n.update(e())}),function(e){const[t,n]=w(e,{equals:!1});return A(e.store.subscribe(()=>n(e))),t}(s)}function xp(e){const t=wp(()=>{const{children:t,...n}=e;return n});return Me(()=>ne(()=>e.children(t),{}))}function Sp(e){const t=e?.(),n=new fp(t),s=n;return s.Field=e=>ne(xp,ae(e,{form:n})),s.createField=e=>wp(()=>({...e(),form:n})),s.useStore=e=>bp(n.store,e),s.Subscribe=e=>Nf(e.children,bp(n.store,e.selector)),I(n.mount),x(()=>n.update(e?.())),s}var Cp=Pe('<svg class="h-5 w-5"fill=none viewBox="0 0 24 24"stroke=currentColor stroke-width=2><path stroke-linecap=round stroke-linejoin=round d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z">'),kp=Pe('<svg class="h-5 w-5"fill=none viewBox="0 0 24 24"stroke=currentColor stroke-width=2><path stroke-linecap=round stroke-linejoin=round d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z">'),Op=Pe('<svg class="h-5 w-5"fill=none viewBox="0 0 24 24"stroke=currentColor stroke-width=2><path stroke-linecap=round stroke-linejoin=round d="M15 19l-7-7 7-7">'),Mp=Pe('<svg class="h-5 w-5"fill=none viewBox="0 0 24 24"stroke=currentColor stroke-width=2><path stroke-linecap=round stroke-linejoin=round d="M9 5l7 7-7 7">'),_p=Pe('<svg class="h-5 w-5"fill=none viewBox="0 0 24 24"stroke=currentColor stroke-width=2><path stroke-linecap=round stroke-linejoin=round d="M12 4v16m8-8H4">'),Pp=Pe('<svg class="h-5 w-5"fill=none viewBox="0 0 24 24"stroke=currentColor stroke-width=2><path stroke-linecap=round stroke-linejoin=round d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z">'),Ip=Pe('<svg class="h-5 w-5"fill=none viewBox="0 0 24 24"stroke=currentColor stroke-width=2><path stroke-linecap=round stroke-linejoin=round d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z">'),Ap=Pe('<button><div class="flex items-center justify-between"><div class="flex-1 min-w-0"><p class="font-medium text-gray-900 truncate"></p><p class="text-sm text-gray-600 truncate"></p><p class="text-xs text-gray-500"></p></div><div>'),Rp=Pe('<button><div class=space-y-2><div class="flex items-center justify-between"><h4 class="font-medium text-gray-900"></h4><div></div></div><div class=space-y-1><div class="flex items-center gap-2 text-sm text-gray-600"><span></span></div><div class="flex items-center gap-2 text-sm text-gray-600"><span></span></div><div class="flex items-center gap-2 text-sm text-gray-600"><span> - '),Ep=Pe('<p class="text-xs text-gray-500 truncate">'),Tp=Pe('<div class="rounded-lg shadow-sm border border-gray-200 overflow-hidden"><div class="p-4 border-b border-gray-200"><h3 class="text-lg font-semibold text-gray-900"></h3></div><div class="overflow-y-auto max-h-96"><div class="grid grid-cols-1 gap-2 p-4">'),jp=Pe('<div class="border-b border-gray-100 pb-2 last:border-b-0"><div class="flex items-start gap-4"><div class="w-16 flex-shrink-0 pt-2"><span class="text-sm font-medium text-gray-200"></span></div><div class="flex-1 space-y-2">'),Lp=Pe('<div class="h-12 flex items-center justify-center text-gray-300 text-sm">No appointments'),Dp=Pe('<div class="rounded-lg shadow-sm border border-gray-200 overflow-hidden"><div class="p-4 border-b border-gray-200"><h3 class="text-lg font-semibold text-gray-100">Week of <!> - </h3></div><div class="grid grid-cols-7 gap-1 p-4">'),$p=Pe('<div><div class="text-center mb-2"><div></div><div></div></div><div class=space-y-1>'),Fp=Pe('<div class="text-xs text-gray-500 text-center">+<!> more'),qp=Pe('<div class="rounded-lg shadow-sm border border-gray-200 overflow-hidden"><div class="p-4 border-b border-gray-200"><h3 class="text-lg font-semibold text-gray-100"></h3></div><div class=p-4><div class="grid grid-cols-7 gap-1">'),Vp=Pe('<div class="text-center p-2 text-sm font-medium text-gray-200">'),Bp=Pe('<div><div class="text-right mb-1"><span></span></div><div class=space-y-1>'),Np=Pe('<div class="text-xs p-1 bg-blue-300 text-blue-800 rounded cursor-pointer hover:bg-blue-400 transition-colors truncate">'),Up=Pe('<div class="text-xs text-gray-500 text-center">+'),Kp=Pe('<div><div class="flex items-center justify-between"><div><h2 class="text-2xl font-bold text-gray-100">Appointment Calendar</h2><p class=text-gray-200>Manage and view patient appointments</p></div><button class="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"><span>New Appointment</span></button></div><div class="flex items-center justify-between rounded-lg shadow-sm border border-gray-200 p-4"><div class="flex items-center gap-4"><div class="flex items-center gap-1 rounded-lg p-1"></div></div><div class="flex items-center gap-4"><div class="flex items-center gap-2"><button class="p-2 text-gray-300 hover:text-gray-200 hover:bg-slate-800 rounded-lg transition-colors"></button><div class=text-center><div class="text-lg font-semibold text-gray-200"></div></div><button class="p-2 text-gray-300 hover:text-gray-200 hover:bg-slate-800 rounded-lg transition-colors"></button></div><button class="px-4 py-2 text-sm font-medium text-blue-500 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors">Today</button></div></div><div class="grid grid-cols-1 md:grid-cols-4 gap-4"><div class="rounded-lg shadow-sm border border-gray-200 p-4"><div class="flex items-center justify-between"><div><p class="text-sm font-medium text-gray-200">Today\'s Appointments</p><p class="text-2xl font-bold text-gray-100"></p></div></div></div><div class="rounded-lg shadow-sm border border-gray-200 p-4"><div class="flex items-center justify-between"><div><p class="text-sm font-medium text-gray-200">Pending</p><p class="text-2xl font-bold text-yellow-600"></p></div></div></div><div class="rounded-lg shadow-sm border border-gray-200 p-4"><div class="flex items-center justify-between"><div><p class="text-sm font-medium text-gray-200">In Progress</p><p class="text-2xl font-bold text-blue-600"></p></div></div></div><div class="rounded-lg shadow-sm border border-gray-200 p-4"><div class="flex items-center justify-between"><div><p class="text-sm font-medium text-gray-200">Completed</p><p class="text-2xl font-bold text-green-600">'),zp=Pe("<button><span>");const Wp=()=>Cp(),Qp=()=>kp(),Hp=()=>Op(),Gp=()=>Mp(),Jp=()=>_p(),Yp=()=>Pp(),Zp=()=>Ip(),Xp=[{id:"1",patientName:"Sarah Johnson",patientId:"P001",date:"2024-01-15",time:"09:00",endTime:"10:00",type:"Dental Cleaning",status:"scheduled",dentist:"Dr. Smith",notes:"Regular cleaning, patient prefers morning appointments",priority:"medium",duration:60},{id:"2",patientName:"Michael Chen",patientId:"P002",date:"2024-01-15",time:"10:30",endTime:"12:00",type:"Root Canal",status:"scheduled",dentist:"Dr. Johnson",notes:"Follow-up from previous consultation",priority:"high",duration:90},{id:"3",patientName:"Emily Davis",patientId:"P003",date:"2024-01-15",time:"14:00",endTime:"15:30",type:"Crown Placement",status:"scheduled",dentist:"Dr. Williams",notes:"Final crown placement",priority:"medium",duration:90},{id:"4",patientName:"David Wilson",patientId:"P004",date:"2024-01-16",time:"08:00",endTime:"09:00",type:"Emergency",status:"scheduled",dentist:"Dr. Smith",notes:"Severe toothache, urgent care needed",priority:"high",duration:60},{id:"5",patientName:"Lisa Brown",patientId:"P005",date:"2024-01-16",time:"11:00",endTime:"12:00",type:"Consultation",status:"scheduled",dentist:"Dr. Johnson",notes:"New patient consultation",priority:"low",duration:60},{id:"6",patientName:"Robert Taylor",patientId:"P006",date:"2024-01-17",time:"13:00",endTime:"14:30",type:"Wisdom Tooth Extraction",status:"scheduled",dentist:"Dr. Williams",notes:"Surgical extraction required",priority:"high",duration:90}],eg=e=>{const[t,n]=e.split(":"),s=parseInt(t);return`${s%12||12}:${n} ${s>=12?"PM":"AM"}`},tg=e=>{const t=()=>{switch(e.appointment.status){case"scheduled":return"bg-blue-100 text-blue-800";case"in-progress":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},n=()=>{switch(e.appointment.priority){case"high":return"border-l-4 border-l-red-500";case"medium":return"border-l-4 border-l-yellow-500";case"low":return"border-l-4 border-l-green-500";default:return""}};return e.isCompact?(s=Ap(),r=s.firstChild.firstChild,i=r.firstChild,o=i.nextSibling,a=o.nextSibling,l=r.nextSibling,Ee(s,"click",e.onClick,!0),De(i,()=>e.appointment.patientName),De(o,()=>e.appointment.type),De(a,()=>eg(e.appointment.time)),De(l,()=>e.appointment.status),S(e=>{var r=`w-full p-2 text-left bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow ${n()}`,i=`px-2 py-1 rounded-full text-xs font-medium ${t()}`;return r!==e.e&&Re(s,e.e=r),i!==e.t&&Re(l,e.t=i),e},{e:void 0,t:void 0}),s):(u=Rp(),h=u.firstChild,d=h.firstChild,f=d.firstChild,p=f.nextSibling,g=d.nextSibling.firstChild,m=g.firstChild,y=g.nextSibling,v=y.firstChild,b=y.nextSibling,w=b.firstChild,x=w.firstChild,Ee(u,"click",e.onClick,!0),De(f,()=>e.appointment.patientName),De(p,()=>e.appointment.status),De(g,ne(Zp,{}),m),De(m,()=>e.appointment.type),De(y,ne(Yp,{}),v),De(v,()=>e.appointment.dentist),De(b,ne(Qp,{}),w),De(w,()=>eg(e.appointment.time),x),De(w,()=>eg(e.appointment.endTime),null),De(h,(c=Me(()=>!!e.appointment.notes),()=>{return c()&&(De(t=Ep(),()=>e.appointment.notes),t);var t}),null),S(e=>{var s=`w-full p-3 text-left bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow ${n()}`,r=`px-2 py-1 rounded-full text-xs font-medium ${t()}`;return s!==e.e&&Re(u,e.e=s),r!==e.t&&Re(p,e.t=r),e},{e:void 0,t:void 0}),u);var s,r,i,o,a,l,c,u,h,d,f,p,g,m,y,v,b,w,x},ng=e=>{const t=(()=>{const e=[];for(let t=8;t<=18;t++)e.push(`${t.toString().padStart(2,"0")}:00`);return e})(),n=k(()=>e.appointments.filter(t=>t.date===e.date.toISOString().split("T")[0]));return s=Tp(),r=s.firstChild,i=r.firstChild,o=r.nextSibling.firstChild,De(i,()=>e.date.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})),De(o,ne(he,{each:t,children:t=>{const s=(e=>n().filter(t=>t.time===e))(t);return i=jp(),o=i.firstChild.firstChild,a=o.firstChild,l=o.nextSibling,De(a,()=>eg(t)),De(l,ne(he,{each:s,children:t=>ne(tg,{appointment:t,onClick:()=>e.onAppointmentClick(t)})}),null),De(l,(r=Me(()=>0===s.length),()=>r()&&Lp()),null),i;var r,i,o,a,l}})),s;var s,r,i,o},sg=e=>{const t=(e=>{const t=[];for(let n=0;n<7;n++){const s=new Date(e);s.setDate(e.getDate()+n),t.push(s)}return t})(e.startDate);return(()=>{var n=Dp(),s=n.firstChild,r=s.firstChild,i=r.firstChild.nextSibling;i.nextSibling;var o=s.nextSibling;return De(r,()=>t[0].toLocaleDateString("en-US",{month:"short",day:"numeric"}),i),De(r,()=>t[6].toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),null),De(o,ne(he,{each:t,children:(t,n)=>{const s=k(()=>(t=>{const n=t.toISOString().split("T")[0];return e.appointments.filter(e=>e.date===n)})(t)),r=t.toDateString()===(new Date).toDateString();return o=$p(),a=o.firstChild,l=a.firstChild,c=l.nextSibling,u=a.nextSibling,Re(o,`min-h-32 p-2 ${r?"bg-blue-100 border border-blue-200":"bg-slate-200"} rounded-lg`),Re(l,"text-sm font-medium "+(r?"text-blue-600":"text-gray-600")),De(l,()=>t.toLocaleDateString("en-US",{weekday:"short"})),Re(c,"text-lg font-bold "+(r?"text-blue-600":"text-gray-900")),De(c,()=>t.getDate()),De(u,ne(he,{get each(){return s().slice(0,3)},children:t=>ne(tg,{appointment:t,onClick:()=>e.onAppointmentClick(t),isCompact:!0})}),null),De(u,(i=Me(()=>s().length>3),()=>{return i()&&(e=Fp(),(t=e.firstChild.nextSibling).nextSibling,De(e,()=>s().length-3,t),e);var e,t}),null),o;var i,o,a,l,c,u}})),n})()},rg=e=>{const t=((e,t)=>{const n=new Date(e,t,1),s=new Date(e,t+1,0),r=[];for(let o=n.getDay()-1;o>=0;o--){const n=new Date(e,t,-o);r.push({date:n,isCurrentMonth:!1})}for(let o=1;o<=s.getDate();o++){const n=new Date(e,t,o);r.push({date:n,isCurrentMonth:!0})}const i=42-r.length;for(let o=1;o<=i;o++){const n=new Date(e,t+1,o);r.push({date:n,isCurrentMonth:!1})}return r})(e.year,e.month),n=new Date(e.year,e.month).toLocaleDateString("en-US",{month:"long",year:"numeric"});return s=qp(),r=s.firstChild,i=r.firstChild,o=r.nextSibling.firstChild,De(i,n),De(o,ne(he,{each:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],children:e=>{return De(t=Vp(),e),t;var t}}),null),De(o,ne(he,{each:t,children:t=>{const n=k(()=>(t=>{const n=t.toISOString().split("T")[0];return e.appointments.filter(e=>e.date===n)})(t.date)),s=t.date.toDateString()===(new Date).toDateString();return i=Bp(),o=i.firstChild,a=o.firstChild,l=o.nextSibling,De(a,()=>t.date.getDate()),De(l,ne(he,{get each(){return n().slice(0,2)},children:t=>{return(n=Np()).$$click=()=>e.onAppointmentClick(t),De(n,()=>t.patientName),n;var n}}),null),De(l,(r=Me(()=>n().length>2),()=>{return r()&&((e=Up()).firstChild,De(e,()=>n().length-2,null),e);var e}),null),S(e=>{var n=`min-h-24 p-1 ${s?"bg-blue-500 border border-blue-200":""} ${t.isCurrentMonth?"bg-slate-200":"bg-slate-400"} rounded-lg`,r="text-sm "+(s?"text-blue-600 font-bold":t.isCurrentMonth?"text-gray-900":"text-gray-100");return n!==e.e&&Re(i,e.e=n),r!==e.t&&Re(a,e.t=r),e},{e:void 0,t:void 0}),i;var r,i,o,a,l}}),null),s;var s,r,i,o},ig=e=>{const t=ls(),[n,s]=w("weekly"),[r,i]=w(new Date),[o,a]=w(null),l=k(()=>e.appointments?e.appointments():Xp),c=[{type:"daily",label:"Daily",icon:Qp},{type:"weekly",label:"Weekly",icon:Wp},{type:"monthly",label:"Monthly",icon:Wp}],u=e=>{const t=new Date(r());switch(n()){case"daily":t.setDate(t.getDate()+("next"===e?1:-1));break;case"weekly":t.setDate(t.getDate()+("next"===e?7:-7));break;case"monthly":t.setMonth(t.getMonth()+("next"===e?1:-1))}i(t)},h=e=>{a(e),t({to:`/appointments/${e.id}`})},d=()=>{t({to:"/appointments/new"})},f=()=>{switch(n()){case"daily":return r().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});case"weekly":const e=new Date(r());e.setDate(r().getDate()-r().getDay());const t=new Date(e);return t.setDate(e.getDate()+6),`Week of ${e.toLocaleDateString("en-US",{month:"short",day:"numeric"})} - ${t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`;case"monthly":return r().toLocaleDateString("en-US",{month:"long",year:"numeric"})}};return p=Kp(),g=p.firstChild,m=g.firstChild.nextSibling,y=m.firstChild,v=g.nextSibling,b=v.firstChild,x=b.firstChild,C=b.nextSibling.firstChild,O=C.firstChild,M=O.nextSibling,_=M.firstChild,P=M.nextSibling,I=C.nextSibling,A=v.nextSibling,R=A.firstChild,E=R.firstChild,T=E.firstChild.firstChild.nextSibling,j=R.nextSibling,L=j.firstChild,D=L.firstChild.firstChild.nextSibling,$=j.nextSibling,F=$.firstChild,q=F.firstChild.firstChild.nextSibling,V=$.nextSibling.firstChild,B=V.firstChild.firstChild.nextSibling,m.$$click=d,De(m,ne(Jp,{}),y),De(x,ne(he,{each:c,children:e=>{return t=zp(),r=t.firstChild,t.$$click=()=>s(e.type),De(t,ne(e.icon,{}),r),De(r,()=>e.label),S(()=>Re(t,"flex items-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-colors "+(n()===e.type?"bg-slate-800 text-blue-500 shadow-sm":"text-gray-400 hover:text-gray-200"))),t;var t,r}})),O.$$click=()=>u("prev"),De(O,ne(Hp,{})),De(_,f),P.$$click=()=>u("next"),De(P,ne(Gp,{})),I.$$click=()=>i(new Date),De(p,ne(de,{get when(){return"daily"===n()},get children(){return ne(ng,{get date(){return r()},get appointments(){return l()},onAppointmentClick:h})}}),A),De(p,ne(de,{get when(){return"weekly"===n()},get children(){return ne(sg,{get startDate(){const e=new Date(r());return e.setDate(r().getDate()-r().getDay()),e},get appointments(){return l()},onAppointmentClick:h})}}),A),De(p,ne(de,{get when(){return"monthly"===n()},get children(){return ne(rg,{get year(){return r().getFullYear()},get month(){return r().getMonth()},get appointments(){return l()},onAppointmentClick:h})}}),A),De(T,()=>l().filter(e=>e.date===(new Date).toISOString().split("T")[0]).length),De(E,ne(Wp,{}),null),De(D,()=>l().filter(e=>"scheduled"===e.status).length),De(L,ne(Qp,{}),null),De(q,()=>l().filter(e=>"in-progress"===e.status).length),De(F,ne(Qp,{}),null),De(B,()=>l().filter(e=>"completed"===e.status).length),De(V,ne(Wp,{}),null),S(()=>Re(p,`space-y-6 ${e.class||""}`)),p;var p,g,m,y,v,b,x,C,O,M,_,P,I,A,R,E,T,j,L,D,$,F,q,V,B};Ie(["click"]);var og=Pe('<div class="flex items-center justify-center h-64"><div class="text-lg text-gray-200">Loading appointments…'),ag=Pe('<div class="flex items-center justify-center h-64"><div class="text-lg text-red-600">Failed to load appointments'),lg=Pe('<div role=dialog aria-modal=true class="fixed inset-0 z-50 flex items-center justify-center p-4"><div class="absolute inset-0 bg-black/40"aria-hidden=true></div><div class="relative w-full max-w-lg rounded-lg bg-white p-6 shadow"><div class="flex items-center justify-between mb-4"><h3 class="text-lg font-semibold">New appointment</h3><button aria-label=Close class="rounded border px-2 py-1">✕</button></div><form class="grid grid-cols-1 md:grid-cols-2 gap-3"><div><label class="block text-sm mb-1"for=start_time>Start time</label></div><div><label class="block text-sm mb-1"for=end_time>End time</label></div><div class=md:col-span-2><label class="block text-sm mb-1"for=reason>Reason</label></div><div class=md:col-span-2><label class="block text-sm mb-1"for=notes>Notes</label></div><div class="md:col-span-2 flex justify-end gap-2 mt-2"><button type=button class="rounded border px-3 py-2">Cancel</button><button type=submit class="rounded bg-indigo-600 px-3 py-2 text-white">Create'),cg=Pe('<div class="min-h-screen p-6"><div class="mb-4 p-4 bg-gray-100 rounded"><h3 class="font-bold mb-2">Debug Info:</h3><p>Loading: </p><p>Error: </p><p>Data length: </p><button class="px-3 py-1 bg-blue-500 text-white rounded text-sm">Test PocketBase Connection'),ug=Pe('<div class="flex items-center justify-center h-64"><div class="text-lg text-gray-400">No appointments found'),hg=Pe('<input id=start_time name=start_time type=datetime-local required class="w-full rounded border px-3 py-2">'),dg=Pe('<input id=end_time name=end_time type=datetime-local class="w-full rounded border px-3 py-2">'),fg=Pe('<input id=reason name=reason class="w-full rounded border px-3 py-2">'),pg=Pe('<textarea id=notes name=notes class="w-full rounded border px-3 py-2"rows=3>');const gg=hs("/appointments/")({component:function(){Of(Zi.Appointments);const e=_f(),t=kf();const[n,s]=w(!1),r=Sp(()=>({defaultValues:{start_time:"",end_time:"",reason:"",notes:""},onSubmit:async({value:e})=>{try{await t.appointments.insert({start_time:e.start_time?new Date(e.start_time).toISOString():(new Date).toISOString(),end_time:e.end_time?new Date(e.end_time).toISOString():void 0,status:"scheduled",notes:e.notes||"",reason:e.reason||"",patient:[],doctor:[],clinic:[]}),s(!1)}catch(n){}}})),i=k(()=>(e.data??[]).map(e=>({id:e.id,patientName:e.patient?.[0]||"Unknown Patient",patientId:e.patient?.[0]||"",date:new Date(e.start_time).toISOString().split("T")[0],time:new Date(e.start_time).toTimeString().slice(0,5),endTime:e.end_time?new Date(e.end_time).toTimeString().slice(0,5):"",type:e.reason||"Appointment",status:e.status,dentist:e.doctor?.[0]||"Unknown Doctor",notes:e.notes||"",priority:"medium",duration:e.end_time?Math.round((new Date(e.end_time).getTime()-new Date(e.start_time).getTime())/6e4):60})));return(()=>{var t=cg(),o=t.firstChild.firstChild.nextSibling;o.firstChild;var a=o.nextSibling;a.firstChild;var l=a.nextSibling;l.firstChild;var c=l.nextSibling;return De(o,()=>e.isLoading()?"Yes":"No",null),De(a,()=>e.isError()?"Yes":"No",null),De(l,()=>e.data?.length??0,null),c.$$click=()=>{Gi.collection("appointments").getFullList().then(e=>{}).catch(e=>{})},De(t,ne(de,{get when(){return e.isLoading()},get children(){return og()}}),null),De(t,ne(de,{get when(){return e.isError()},get children(){return ag()}}),null),De(t,ne(de,{get when(){return e.data},get fallback(){return ug()},get children(){return ne(ig,{appointments:i})}}),null),De(t,ne(de,{get when(){return n()},get children(){var e=lg(),t=e.firstChild.nextSibling.firstChild,n=t.firstChild.nextSibling,i=t.nextSibling,o=i.firstChild;o.firstChild;var a=o.nextSibling;a.firstChild;var l=a.nextSibling;l.firstChild;var c=l.nextSibling;c.firstChild;var u=c.nextSibling.firstChild;return n.$$click=()=>s(!1),i.addEventListener("submit",e=>{e.preventDefault(),r.handleSubmit()}),De(o,ne(r.Field,{name:"start_time",validators:{onChange:({value:e})=>e?void 0:"Start time is required"},children:e=>{return Ee(t=hg(),"blur",e().handleBlur),t.$$input=t=>e().handleChange(t.currentTarget.value),S(()=>t.value=e().state.value||""),t;var t}}),null),De(a,ne(r.Field,{name:"end_time",children:e=>{return Ee(t=dg(),"blur",e().handleBlur),t.$$input=t=>e().handleChange(t.currentTarget.value),S(()=>t.value=e().state.value||""),t;var t}}),null),De(l,ne(r.Field,{name:"reason",children:e=>{return Ee(t=fg(),"blur",e().handleBlur),t.$$input=t=>e().handleChange(t.currentTarget.value),S(()=>t.value=e().state.value||""),t;var t}}),null),De(c,ne(r.Field,{name:"notes",children:e=>{return Ee(t=pg(),"blur",e().handleBlur),t.$$input=t=>e().handleChange(t.currentTarget.value),S(()=>t.value=e().state.value||""),t;var t}}),null),u.$$click=()=>s(!1),e}}),null),t})()}});Ie(["click","input"]);const mg=hs("/(app)/")({component:gs(()=>qs(()=>import("./index-gw-FTqX7.js"),[]),"component")}),yg=hs("/patients/new")({component:gs(()=>qs(()=>import("./new-Y4Rh6vwq.js"),__vite__mapDeps([0,1])),"component")});var vg=Pe("<button>"),bg=Pe('<div class=space-y-4><div class="flex flex-wrap items-center gap-2"><span class="text-sm text-gray-300">Surface</span></div><div class="flex flex-wrap items-center gap-2"><span class="text-sm text-gray-300">Condition</span></div><div class="grid grid-cols-2 gap-6"><div><div class="grid grid-cols-8 gap-2"></div></div><div><div class="rounded-lg border border-gray-800 p-3"><div class="text-sm text-gray-200 mb-2">Perio (optional)</div><div class="text-xs text-gray-400">Perio charting UI can be expanded here (pockets, bleeding, recession).'),wg=Pe('<div class="mt-2 text-[10px] text-gray-300 space-y-0.5 text-left">'),xg=Pe('<div class="border border-gray-800 rounded p-2 text-center"><div class="flex items-center justify-between mb-1"><button></button><div class="text-xs text-gray-400"></div></div><div class="grid grid-cols-3 gap-1"></div><div class=mt-2><button class="text-xs px-2 py-1 rounded border border-blue-700 text-blue-200 hover:bg-blue-800">Apply'),Sg=Pe('<div>: <span class="text-gray-100 font-medium">');const Cg=["occlusal","mesial","distal","buccal","lingual"],kg=["sound","caries","filled","missing","impacted","root_canal","crown","bridge","implant","fracture","fissure_seal"];function Og(e){return JSON.parse(JSON.stringify(e))}const Mg=e=>{return Ee(t=vg(),"click",e.onClick,!0),De(t,()=>e.children),S(()=>Re(t,"px-2 py-1 rounded-md text-xs border "+(e.active?"bg-blue-600 text-white border-blue-600":"bg-transparent text-gray-200 border-gray-700 hover:bg-gray-800"))),t;var t},_g=e=>{const[t,n]=w(null),[s,r]=w("occlusal"),[i,o]=w("caries"),a=k(()=>"primary"===e.dentition?["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T"]:Array.from({length:32},(e,t)=>String(t+1))),l=()=>e.value,c=()=>!!e.readOnly,u=t=>{if(c())return;(t=>{if(!l().teeth[t]){const n=Og(l());n.teeth[t]={present:!0,conditions:{}},e.onChange?.(n)}})(t);const n=Og(l()),r=s(),o=i();n.teeth[t].conditions[r]=o,e.onChange?.(n)};return(()=>{var h=bg(),d=h.firstChild;d.firstChild;var f=d.nextSibling;f.firstChild;var p=f.nextSibling.firstChild.firstChild;return De(d,ne(he,{each:Cg,children:e=>ne(Mg,{get active(){return s()===e},onClick:()=>r(e),children:e})}),null),De(f,ne(he,{each:kg,children:e=>ne(Mg,{get active(){return i()===e},onClick:()=>o(e),children:e})}),null),De(p,ne(he,{get each(){return a()},children:i=>{return o=xg(),a=o.firstChild,h=a.firstChild,d=h.nextSibling,f=a.nextSibling,p=f.nextSibling.firstChild,h.$$click=()=>(t=>{if(c())return;const n=Og(l());n.teeth[t]||(n.teeth[t]={present:!0,conditions:{}}),n.teeth[t].present=!n.teeth[t].present,e.onChange?.(n)})(i),De(h,()=>!1!==l().teeth[i]?.present?"Present":"Missing"),De(d,i),De(f,ne(he,{each:Cg,children:e=>{return(o=vg()).$$click=()=>{n(i),r(e)},De(o,()=>e[0].toUpperCase()),S(()=>Re(o,"text-[10px] py-1 rounded border "+(t()===i&&s()===e?"bg-blue-600 text-white border-blue-600":"bg-slate-800 text-gray-200 border-slate-700"))),o;var o}})),p.$$click=()=>u(i),De(o,ne(de,{get when(){return Object.keys(l().teeth[i]?.conditions||{}).length>0},get children(){var e=wg();return De(e,ne(he,{get each(){return Object.entries(l().teeth[i]?.conditions||{})},children:([e,t])=>{return n=Sg(),s=n.firstChild,r=s.nextSibling,De(n,e,s),De(r,t),n;var n,s,r}})),e}}),null),S(()=>Re(h,"text-xs "+(!1!==l().teeth[i]?.present?"text-green-400":"text-red-500"))),o;var o,a,h,d,f,p}})),h})()};Ie(["click"]);const Pg=hs("/patients/$patientId")({component:gs(()=>qs(()=>import("./_patientId-UVqw4ljs.js"),__vite__mapDeps([2,1])),"component")}),Ig=hs("/appointments/new")({component:gs(()=>qs(()=>import("./new-C0aDniaU.js"),__vite__mapDeps([3,1])),"component")}),Ag=hs("/appointments/$appointmentId")({component:gs(()=>qs(()=>import("./_appointmentId-CNj7nzSk.js"),__vite__mapDeps([4,1])),"component")});var Rg=Pe('<div class="mb-4 rounded border border-red-200 bg-red-50 text-red-800 px-3 py-2"role=alert>'),Eg=Pe('<div class="min-h-screen flex items-center justify-center bg-slate-900 p-4"><div class="w-full max-w-md rounded-lg shadow p-6"><h1 class="text-2xl font-semibold mb-1">Create account</h1><p class="text-sm text-gray-600 mb-6">Join Zahrawi Clinic to manage patients and appointments.</p><form class=space-y-4 novalidate><div><label for=name class="block text-sm font-medium mb-1">Full name</label><input id=name name=name type=text class="w-full rounded border px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"></div><div><label for=email class="block text-sm font-medium mb-1">Email</label><input id=email name=email type=email autocomplete=email required class="w-full rounded border px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"></div><div><label for=password class="block text-sm font-medium mb-1">Password</label><input id=password name=password type=password autocomplete=new-password required class="w-full rounded border px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"></div><div><label for=passwordConfirm class="block text-sm font-medium mb-1">Confirm password</label><input id=passwordConfirm name=passwordConfirm type=password autocomplete=new-password required class="w-full rounded border px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"></div><button type=submit class="w-full inline-flex justify-center rounded bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-700 disabled:opacity-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"></button></form><div class="mt-4 text-sm">Already have an account? ');const Tg=hs("/(auth)/signup")({component:function(){const{register:e,authState:t,clearError:n}=oo(),s=Jn(),[r,i]=w(""),[o,a]=w(""),[l,c]=w(""),[u,h]=w(""),[d,f]=w(!1),p=async t=>{t.preventDefault(),n(),f(!0);try{await e({email:o(),password:l(),passwordConfirm:u(),name:r()}),s.navigate({to:"/"})}finally{f(!1)}};return g=Eg(),m=g.firstChild,y=m.firstChild.nextSibling.nextSibling,v=y.firstChild,b=v.firstChild.nextSibling,x=v.nextSibling,C=x.firstChild.nextSibling,k=x.nextSibling,O=k.firstChild.nextSibling,M=k.nextSibling,_=M.firstChild.nextSibling,P=M.nextSibling,I=y.nextSibling,I.firstChild,De(m,ne(de,{get when(){return t().error},get children(){var e=Rg();return De(e,()=>t().error),e}}),y),y.addEventListener("submit",p),b.$$input=e=>i(e.currentTarget.value),C.$$input=e=>a(e.currentTarget.value),O.$$input=e=>c(e.currentTarget.value),_.$$input=e=>h(e.currentTarget.value),De(P,()=>d()||t().isLoading?"Creating…":"Create account"),De(I,ne(ss,{to:"/login",class:"text-indigo-600 hover:underline",children:"Sign in"}),null),S(()=>P.disabled=d()||t().isLoading),S(()=>b.value=r()),S(()=>C.value=o()),S(()=>O.value=l()),S(()=>_.value=u()),g;var g,m,y,v,b,x,C,k,O,M,_,P,I}});Ie(["input"]);var jg=Pe('<div class="mb-4 rounded border border-red-200 bg-red-50 text-red-800 px-3 py-2"role=alert>'),Lg=Pe('<div class="min-h-screen flex items-center justify-center bg-slate-900 p-4"><div class="w-full max-w-md rounded-lg shadow p-6"><h1 class="text-2xl font-semibold mb-1">Sign in</h1><p class="text-sm text-gray-600 mb-6">Use your account to access the clinic dashboard.</p><form class=space-y-4 novalidate><div><label for=email class="block text-sm font-medium mb-1">Email</label><input id=email name=email type=email autocomplete=email required class="w-full rounded border px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"></div><div><label for=password class="block text-sm font-medium mb-1">Password</label><input id=password name=password type=password autocomplete=current-password required class="w-full rounded border px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"></div><button type=submit class="w-full inline-flex justify-center rounded bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-700 disabled:opacity-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"></button></form><div class="mt-4 text-sm flex items-center justify-between"><span>New here? ');const Dg=hs("/(auth)/login")({component:function(){const{login:e,authState:t,clearError:n}=oo(),s=Jn(),[r,i]=w(""),[o,a]=w(""),[l,c]=w(!1),u=async t=>{t.preventDefault(),n(),c(!0);try{await e({email:r(),password:o()}),s.navigate({to:"/"})}finally{c(!1)}};return h=Lg(),d=h.firstChild,f=d.firstChild.nextSibling.nextSibling,p=f.firstChild,g=p.firstChild.nextSibling,m=p.nextSibling,y=m.firstChild.nextSibling,v=m.nextSibling,b=f.nextSibling,x=b.firstChild,x.firstChild,De(d,ne(de,{get when(){return t().error},get children(){var e=jg();return De(e,()=>t().error),e}}),f),f.addEventListener("submit",u),g.$$input=e=>i(e.currentTarget.value),y.$$input=e=>a(e.currentTarget.value),De(v,()=>l()||t().isLoading?"Signing in…":"Sign in"),De(x,ne(ss,{to:"/signup",class:"text-indigo-600 hover:underline",children:"Create an account"}),null),De(b,ne(ss,{to:"/admin-login",class:"text-gray-600 hover:underline",children:"Admin sign in"}),null),S(()=>v.disabled=l()||t().isLoading),S(()=>g.value=r()),S(()=>y.value=o()),h;var h,d,f,p,g,m,y,v,b,x}});Ie(["input"]);var $g=Pe('<div class="mb-4 rounded border border-red-200 bg-red-50 text-red-800 px-3 py-2"role=alert>'),Fg=Pe('<div class="min-h-screen flex items-center justify-center bg-slate-900 p-4"><div class="w-full max-w-md rounded-lg shadow p-6"><h1 class="text-2xl font-semibold mb-1">Admin sign in</h1><p class="text-sm text-gray-600 mb-6">Restricted access for administrators.</p><form class=space-y-4 novalidate><div><label for=email class="block text-sm font-medium mb-1">Admin email</label><input id=email name=email type=email autocomplete=email required class="w-full rounded border px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"></div><div><label for=password class="block text-sm font-medium mb-1">Password</label><input id=password name=password type=password autocomplete=current-password required class="w-full rounded border px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"></div><button type=submit class="w-full inline-flex justify-center rounded bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-700 disabled:opacity-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">');const qg=hs("/(auth)/admin-login")({component:function(){const{loginAsAdmin:e,authState:t,clearError:n}=oo(),s=Jn(),[r,i]=w(""),[o,a]=w(""),[l,c]=w(!1),u=async t=>{t.preventDefault(),n(),c(!0);try{await e(r(),o()),s.navigate({to:"/"})}finally{c(!1)}};return h=Fg(),d=h.firstChild,f=d.firstChild.nextSibling.nextSibling,p=f.firstChild,g=p.firstChild.nextSibling,m=p.nextSibling,y=m.firstChild.nextSibling,v=m.nextSibling,De(d,ne(de,{get when(){return t().error},get children(){var e=$g();return De(e,()=>t().error),e}}),f),f.addEventListener("submit",u),g.$$input=e=>i(e.currentTarget.value),y.$$input=e=>a(e.currentTarget.value),De(v,()=>l()||t().isLoading?"Signing in…":"Sign in as Admin"),S(()=>v.disabled=l()||t().isLoading),S(()=>g.value=r()),S(()=>y.value=o()),h;var h,d,f,p,g,m,y,v}});Ie(["input"]);const Vg=hs("/(app)/about")({component:gs(()=>qs(()=>import("./about-dWXq7PYy.js"),[]),"component")}),Bg=qf.update({id:"/patients/",path:"/patients/",getParentRoute:()=>pa}),Ng=gg.update({id:"/appointments/",path:"/appointments/",getParentRoute:()=>pa}),Ug=mg.update({id:"/(app)/",path:"/",getParentRoute:()=>pa}),Kg=yg.update({id:"/patients/new",path:"/patients/new",getParentRoute:()=>pa}),zg=Pg.update({id:"/patients/$patientId",path:"/patients/$patientId",getParentRoute:()=>pa}),Wg=Ig.update({id:"/appointments/new",path:"/appointments/new",getParentRoute:()=>pa}),Qg=Ag.update({id:"/appointments/$appointmentId",path:"/appointments/$appointmentId",getParentRoute:()=>pa}),Hg=Tg.update({id:"/(auth)/signup",path:"/signup",getParentRoute:()=>pa}),Gg=Dg.update({id:"/(auth)/login",path:"/login",getParentRoute:()=>pa}),Jg=qg.update({id:"/(auth)/admin-login",path:"/admin-login",getParentRoute:()=>pa}),Yg={appAboutRoute:Vg.update({id:"/(app)/about",path:"/about",getParentRoute:()=>pa}),authAdminLoginRoute:Jg,authLoginRoute:Gg,authSignupRoute:Hg,AppointmentsAppointmentIdRoute:Qg,AppointmentsNewRoute:Wg,PatientsPatientIdRoute:zg,PatientsNewRoute:Kg,appIndexRoute:Ug,AppointmentsIndexRoute:Ng,PatientsIndexRoute:Bg},Zg=(e=>new Rs(e))({routeTree:pa._addFileChildren(Yg)._addFileTypes()}),Xg=document.getElementById("root");Xg.innerHTML||function(e,t,n,s={}){let r;b(s=>{r=s,t===document?e():De(t,e(),t.firstChild?null:void 0,n)},s.owner)}(()=>ne(ve,{get fallback(){return ne($s,{})},get children(){return ne(Ts,{router:Zg})}}),Xg);export{_f as A,Zi as C,_g as D,he as F,pe as M,Pg as R,fe as S,qs as _,Mf as a,Of as b,ne as c,ve as d,ls as e,w as f,Sp as g,Ee as h,De as i,S as j,de as k,ce as l,Ie as m,k as n,Re as o,Me as p,Ag as q,Kn as r,Yi as s,Pe as t,oo as u,ii as v,C as w,A as x,ci as y,ui as z};
