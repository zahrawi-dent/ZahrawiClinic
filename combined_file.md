---
id: "@tanstack/vue-db"
title: "@tanstack/vue-db"
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# @tanstack/vue-db

## Interfaces

- [UseLiveQueryReturn](../interfaces/uselivequeryreturn.md)
- [UseLiveQueryReturnWithCollection](../interfaces/uselivequeryreturnwithcollection.md)

## Functions

- [useLiveQuery](../functions/uselivequery.md)
---
id: UseLiveQueryReturn
title: UseLiveQueryReturn
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: UseLiveQueryReturn\<T\>

Defined in: [useLiveQuery.ts:35](https://github.com/TanStack/db/blob/main/packages/vue-db/src/useLiveQuery.ts#L35)

Return type for useLiveQuery hook

## Type Parameters

• **T** *extends* `object`

## Properties

### collection

```ts
collection: ComputedRef<Collection<T, string | number, {}, StandardSchemaV1<unknown, unknown>, T>>;
```

Defined in: [useLiveQuery.ts:38](https://github.com/TanStack/db/blob/main/packages/vue-db/src/useLiveQuery.ts#L38)

The underlying query collection instance

***

### data

```ts
data: ComputedRef<T[]>;
```

Defined in: [useLiveQuery.ts:37](https://github.com/TanStack/db/blob/main/packages/vue-db/src/useLiveQuery.ts#L37)

Reactive array of query results in order

***

### isCleanedUp

```ts
isCleanedUp: ComputedRef<boolean>;
```

Defined in: [useLiveQuery.ts:44](https://github.com/TanStack/db/blob/main/packages/vue-db/src/useLiveQuery.ts#L44)

True when query has been cleaned up

***

### isError

```ts
isError: ComputedRef<boolean>;
```

Defined in: [useLiveQuery.ts:43](https://github.com/TanStack/db/blob/main/packages/vue-db/src/useLiveQuery.ts#L43)

True when query encountered an error

***

### isIdle

```ts
isIdle: ComputedRef<boolean>;
```

Defined in: [useLiveQuery.ts:42](https://github.com/TanStack/db/blob/main/packages/vue-db/src/useLiveQuery.ts#L42)

True when query hasn't started yet

***

### isLoading

```ts
isLoading: ComputedRef<boolean>;
```

Defined in: [useLiveQuery.ts:40](https://github.com/TanStack/db/blob/main/packages/vue-db/src/useLiveQuery.ts#L40)

True while initial query data is loading

***

### isReady

```ts
isReady: ComputedRef<boolean>;
```

Defined in: [useLiveQuery.ts:41](https://github.com/TanStack/db/blob/main/packages/vue-db/src/useLiveQuery.ts#L41)

True when query has received first data and is ready

***

### state

```ts
state: ComputedRef<Map<string | number, T>>;
```

Defined in: [useLiveQuery.ts:36](https://github.com/TanStack/db/blob/main/packages/vue-db/src/useLiveQuery.ts#L36)

Reactive Map of query results (key → item)

***

### status

```ts
status: ComputedRef<CollectionStatus>;
```

Defined in: [useLiveQuery.ts:39](https://github.com/TanStack/db/blob/main/packages/vue-db/src/useLiveQuery.ts#L39)

Current query status
---
id: UseLiveQueryReturnWithCollection
title: UseLiveQueryReturnWithCollection
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: UseLiveQueryReturnWithCollection\<T, TKey, TUtils\>

Defined in: [useLiveQuery.ts:47](https://github.com/TanStack/db/blob/main/packages/vue-db/src/useLiveQuery.ts#L47)

## Type Parameters

• **T** *extends* `object`

• **TKey** *extends* `string` \| `number`

• **TUtils** *extends* `Record`\<`string`, `any`\>

## Properties

### collection

```ts
collection: ComputedRef<Collection<T, TKey, TUtils, StandardSchemaV1<unknown, unknown>, T>>;
```

Defined in: [useLiveQuery.ts:54](https://github.com/TanStack/db/blob/main/packages/vue-db/src/useLiveQuery.ts#L54)

***

### data

```ts
data: ComputedRef<T[]>;
```

Defined in: [useLiveQuery.ts:53](https://github.com/TanStack/db/blob/main/packages/vue-db/src/useLiveQuery.ts#L53)

***

### isCleanedUp

```ts
isCleanedUp: ComputedRef<boolean>;
```

Defined in: [useLiveQuery.ts:60](https://github.com/TanStack/db/blob/main/packages/vue-db/src/useLiveQuery.ts#L60)

***

### isError

```ts
isError: ComputedRef<boolean>;
```

Defined in: [useLiveQuery.ts:59](https://github.com/TanStack/db/blob/main/packages/vue-db/src/useLiveQuery.ts#L59)

***

### isIdle

```ts
isIdle: ComputedRef<boolean>;
```

Defined in: [useLiveQuery.ts:58](https://github.com/TanStack/db/blob/main/packages/vue-db/src/useLiveQuery.ts#L58)

***

### isLoading

```ts
isLoading: ComputedRef<boolean>;
```

Defined in: [useLiveQuery.ts:56](https://github.com/TanStack/db/blob/main/packages/vue-db/src/useLiveQuery.ts#L56)

***

### isReady

```ts
isReady: ComputedRef<boolean>;
```

Defined in: [useLiveQuery.ts:57](https://github.com/TanStack/db/blob/main/packages/vue-db/src/useLiveQuery.ts#L57)

***

### state

```ts
state: ComputedRef<Map<TKey, T>>;
```

Defined in: [useLiveQuery.ts:52](https://github.com/TanStack/db/blob/main/packages/vue-db/src/useLiveQuery.ts#L52)

***

### status

```ts
status: ComputedRef<CollectionStatus>;
```

Defined in: [useLiveQuery.ts:55](https://github.com/TanStack/db/blob/main/packages/vue-db/src/useLiveQuery.ts#L55)
---
id: useLiveQuery
title: useLiveQuery
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: useLiveQuery()

## Call Signature

```ts
function useLiveQuery<TContext>(queryFn, deps?): UseLiveQueryReturn<{ [K in string | number | symbol]: (TContext["result"] extends object ? any[any] : TContext["hasJoins"] extends true ? TContext["schema"] : TContext["schema"][TContext["fromSourceName"]])[K] }>
```

Defined in: [useLiveQuery.ts:113](https://github.com/TanStack/db/blob/main/packages/vue-db/src/useLiveQuery.ts#L113)

Create a live query using a query function

### Type Parameters

• **TContext** *extends* `Context`

### Parameters

#### queryFn

(`q`) => `QueryBuilder`\<`TContext`\>

Query function that defines what data to fetch

#### deps?

`unknown`[]

Array of reactive dependencies that trigger query re-execution when changed

### Returns

[`UseLiveQueryReturn`](../../interfaces/uselivequeryreturn.md)\<\{ \[K in string \| number \| symbol\]: (TContext\["result"\] extends object ? any\[any\] : TContext\["hasJoins"\] extends true ? TContext\["schema"\] : TContext\["schema"\]\[TContext\["fromSourceName"\]\])\[K\] \}\>

Reactive object with query data, state, and status information

### Examples

```ts
// Basic query with object syntax
const { data, isLoading } = useLiveQuery((q) =>
  q.from({ todos: todosCollection })
   .where(({ todos }) => eq(todos.completed, false))
   .select(({ todos }) => ({ id: todos.id, text: todos.text }))
)
```

```ts
// With reactive dependencies
const minPriority = ref(5)
const { data, state } = useLiveQuery(
  (q) => q.from({ todos: todosCollection })
         .where(({ todos }) => gt(todos.priority, minPriority.value)),
  [minPriority] // Re-run when minPriority changes
)
```

```ts
// Join pattern
const { data } = useLiveQuery((q) =>
  q.from({ issues: issueCollection })
   .join({ persons: personCollection }, ({ issues, persons }) =>
     eq(issues.userId, persons.id)
   )
   .select(({ issues, persons }) => ({
     id: issues.id,
     title: issues.title,
     userName: persons.name
   }))
)
```

```ts
// Handle loading and error states in template
const { data, isLoading, isError, status } = useLiveQuery((q) =>
  q.from({ todos: todoCollection })
)

// In template:
// <div v-if="isLoading">Loading...</div>
// <div v-else-if="isError">Error: {{ status }}</div>
// <ul v-else>
//   <li v-for="todo in data" :key="todo.id">{{ todo.text }}</li>
// </ul>
```

## Call Signature

```ts
function useLiveQuery<TContext>(config, deps?): UseLiveQueryReturn<{ [K in string | number | symbol]: (TContext["result"] extends object ? any[any] : TContext["hasJoins"] extends true ? TContext["schema"] : TContext["schema"][TContext["fromSourceName"]])[K] }>
```

Defined in: [useLiveQuery.ts:151](https://github.com/TanStack/db/blob/main/packages/vue-db/src/useLiveQuery.ts#L151)

Create a live query using configuration object

### Type Parameters

• **TContext** *extends* `Context`

### Parameters

#### config

`LiveQueryCollectionConfig`\<`TContext`\>

Configuration object with query and options

#### deps?

`unknown`[]

Array of reactive dependencies that trigger query re-execution when changed

### Returns

[`UseLiveQueryReturn`](../../interfaces/uselivequeryreturn.md)\<\{ \[K in string \| number \| symbol\]: (TContext\["result"\] extends object ? any\[any\] : TContext\["hasJoins"\] extends true ? TContext\["schema"\] : TContext\["schema"\]\[TContext\["fromSourceName"\]\])\[K\] \}\>

Reactive object with query data, state, and status information

### Examples

```ts
// Basic config object usage
const { data, status } = useLiveQuery({
  query: (q) => q.from({ todos: todosCollection }),
  gcTime: 60000
})
```

```ts
// With reactive dependencies
const filter = ref('active')
const { data, isReady } = useLiveQuery({
  query: (q) => q.from({ todos: todosCollection })
                 .where(({ todos }) => eq(todos.status, filter.value))
}, [filter])
```

```ts
// Handle all states uniformly
const { data, isLoading, isReady, isError } = useLiveQuery({
  query: (q) => q.from({ items: itemCollection })
})

// In template:
// <div v-if="isLoading">Loading...</div>
// <div v-else-if="isError">Something went wrong</div>
// <div v-else-if="!isReady">Preparing...</div>
// <div v-else>{{ data.length }} items loaded</div>
```

## Call Signature

```ts
function useLiveQuery<TResult, TKey, TUtils>(liveQueryCollection): UseLiveQueryReturnWithCollection<TResult, TKey, TUtils>
```

Defined in: [useLiveQuery.ts:196](https://github.com/TanStack/db/blob/main/packages/vue-db/src/useLiveQuery.ts#L196)

Subscribe to an existing query collection (can be reactive)

### Type Parameters

• **TResult** *extends* `object`

• **TKey** *extends* `string` \| `number`

• **TUtils** *extends* `Record`\<`string`, `any`\>

### Parameters

#### liveQueryCollection

`MaybeRefOrGetter`\<`Collection`\<`TResult`, `TKey`, `TUtils`, `StandardSchemaV1`\<`unknown`, `unknown`\>, `TResult`\>\>

Pre-created query collection to subscribe to (can be a ref)

### Returns

[`UseLiveQueryReturnWithCollection`](../../interfaces/uselivequeryreturnwithcollection.md)\<`TResult`, `TKey`, `TUtils`\>

Reactive object with query data, state, and status information

### Examples

```ts
// Using pre-created query collection
const myLiveQuery = createLiveQueryCollection((q) =>
  q.from({ todos: todosCollection }).where(({ todos }) => eq(todos.active, true))
)
const { data, collection } = useLiveQuery(myLiveQuery)
```

```ts
// Reactive query collection reference
const selectedQuery = ref(todosQuery)
const { data, collection } = useLiveQuery(selectedQuery)

// Switch queries reactively
selectedQuery.value = archiveQuery
```

```ts
// Access query collection methods directly
const { data, collection, isReady } = useLiveQuery(existingQuery)

// Use underlying collection for mutations
const handleToggle = (id) => {
  collection.value.update(id, draft => { draft.completed = !draft.completed })
}
```

```ts
// Handle states consistently
const { data, isLoading, isError } = useLiveQuery(sharedQuery)

// In template:
// <div v-if="isLoading">Loading...</div>
// <div v-else-if="isError">Error loading data</div>
// <div v-else>
//   <Item v-for="item in data" :key="item.id" v-bind="item" />
// </div>
```
---
title: TanStack DB Vue Adapter
ref: docs/framework/react/adapter.md
replace: { "React": "Vue", "react": "vue" }
---
---
title: TanStack DB Svelte Adapter
ref: docs/framework/react/adapter.md
replace: { "React": "Svelte", "react": "svelte" }
---
---
id: "@tanstack/react-db"
title: "@tanstack/react-db"
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# @tanstack/react-db

## Functions

- [useLiveQuery](../functions/uselivequery.md)
---
id: useLiveQuery
title: useLiveQuery
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: useLiveQuery()

## Call Signature

```ts
function useLiveQuery<TContext>(queryFn, deps?): object
```

Defined in: [useLiveQuery.ts:64](https://github.com/TanStack/db/blob/main/packages/react-db/src/useLiveQuery.ts#L64)

Create a live query using a query function

### Type Parameters

• **TContext** *extends* `Context`

### Parameters

#### queryFn

(`q`) => `QueryBuilder`\<`TContext`\>

Query function that defines what data to fetch

#### deps?

`unknown`[]

Array of dependencies that trigger query re-execution when changed

### Returns

`object`

Object with reactive data, state, and status information

#### collection

```ts
collection: Collection<{ [K in string | number | symbol]: (TContext["result"] extends object ? any[any] : TContext["hasJoins"] extends true ? TContext["schema"] : TContext["schema"][TContext["fromSourceName"]])[K] }, string | number, {}>;
```

#### data

```ts
data: { [K in string | number | symbol]: (TContext["result"] extends object ? any[any] : TContext["hasJoins"] extends true ? TContext["schema"] : TContext["schema"][TContext["fromSourceName"]])[K] }[];
```

#### isCleanedUp

```ts
isCleanedUp: boolean;
```

#### isError

```ts
isError: boolean;
```

#### isIdle

```ts
isIdle: boolean;
```

#### isLoading

```ts
isLoading: boolean;
```

#### isReady

```ts
isReady: boolean;
```

#### state

```ts
state: Map<string | number, { [K in string | number | symbol]: (TContext["result"] extends object ? any[any] : TContext["hasJoins"] extends true ? TContext["schema"] : TContext["schema"][TContext["fromSourceName"]])[K] }>;
```

#### status

```ts
status: CollectionStatus;
```

### Examples

```ts
// Basic query with object syntax
const { data, isLoading } = useLiveQuery((q) =>
  q.from({ todos: todosCollection })
   .where(({ todos }) => eq(todos.completed, false))
   .select(({ todos }) => ({ id: todos.id, text: todos.text }))
)
```

```ts
// With dependencies that trigger re-execution
const { data, state } = useLiveQuery(
  (q) => q.from({ todos: todosCollection })
         .where(({ todos }) => gt(todos.priority, minPriority)),
  [minPriority] // Re-run when minPriority changes
)
```

```ts
// Join pattern
const { data } = useLiveQuery((q) =>
  q.from({ issues: issueCollection })
   .join({ persons: personCollection }, ({ issues, persons }) =>
     eq(issues.userId, persons.id)
   )
   .select(({ issues, persons }) => ({
     id: issues.id,
     title: issues.title,
     userName: persons.name
   }))
)
```

```ts
// Handle loading and error states
const { data, isLoading, isError, status } = useLiveQuery((q) =>
  q.from({ todos: todoCollection })
)

if (isLoading) return <div>Loading...</div>
if (isError) return <div>Error: {status}</div>

return (
  <ul>
    {data.map(todo => <li key={todo.id}>{todo.text}</li>)}
  </ul>
)
```

## Call Signature

```ts
function useLiveQuery<TContext>(config, deps?): object
```

Defined in: [useLiveQuery.ts:113](https://github.com/TanStack/db/blob/main/packages/react-db/src/useLiveQuery.ts#L113)

Create a live query using configuration object

### Type Parameters

• **TContext** *extends* `Context`

### Parameters

#### config

`LiveQueryCollectionConfig`\<`TContext`\>

Configuration object with query and options

#### deps?

`unknown`[]

Array of dependencies that trigger query re-execution when changed

### Returns

`object`

Object with reactive data, state, and status information

#### collection

```ts
collection: Collection<{ [K in string | number | symbol]: (TContext["result"] extends object ? any[any] : TContext["hasJoins"] extends true ? TContext["schema"] : TContext["schema"][TContext["fromSourceName"]])[K] }, string | number, {}>;
```

#### data

```ts
data: { [K in string | number | symbol]: (TContext["result"] extends object ? any[any] : TContext["hasJoins"] extends true ? TContext["schema"] : TContext["schema"][TContext["fromSourceName"]])[K] }[];
```

#### isCleanedUp

```ts
isCleanedUp: boolean;
```

#### isError

```ts
isError: boolean;
```

#### isIdle

```ts
isIdle: boolean;
```

#### isLoading

```ts
isLoading: boolean;
```

#### isReady

```ts
isReady: boolean;
```

#### state

```ts
state: Map<string | number, { [K in string | number | symbol]: (TContext["result"] extends object ? any[any] : TContext["hasJoins"] extends true ? TContext["schema"] : TContext["schema"][TContext["fromSourceName"]])[K] }>;
```

#### status

```ts
status: CollectionStatus;
```

### Examples

```ts
// Basic config object usage
const { data, status } = useLiveQuery({
  query: (q) => q.from({ todos: todosCollection }),
  gcTime: 60000
})
```

```ts
// With query builder and options
const queryBuilder = new Query()
  .from({ persons: collection })
  .where(({ persons }) => gt(persons.age, 30))
  .select(({ persons }) => ({ id: persons.id, name: persons.name }))

const { data, isReady } = useLiveQuery({ query: queryBuilder })
```

```ts
// Handle all states uniformly
const { data, isLoading, isReady, isError } = useLiveQuery({
  query: (q) => q.from({ items: itemCollection })
})

if (isLoading) return <div>Loading...</div>
if (isError) return <div>Something went wrong</div>
if (!isReady) return <div>Preparing...</div>

return <div>{data.length} items loaded</div>
```

## Call Signature

```ts
function useLiveQuery<TResult, TKey, TUtils>(liveQueryCollection): object
```

Defined in: [useLiveQuery.ts:158](https://github.com/TanStack/db/blob/main/packages/react-db/src/useLiveQuery.ts#L158)

Subscribe to an existing live query collection

### Type Parameters

• **TResult** *extends* `object`

• **TKey** *extends* `string` \| `number`

• **TUtils** *extends* `Record`\<`string`, `any`\>

### Parameters

#### liveQueryCollection

`Collection`\<`TResult`, `TKey`, `TUtils`\>

Pre-created live query collection to subscribe to

### Returns

`object`

Object with reactive data, state, and status information

#### collection

```ts
collection: Collection<TResult, TKey, TUtils>;
```

#### data

```ts
data: TResult[];
```

#### isCleanedUp

```ts
isCleanedUp: boolean;
```

#### isError

```ts
isError: boolean;
```

#### isIdle

```ts
isIdle: boolean;
```

#### isLoading

```ts
isLoading: boolean;
```

#### isReady

```ts
isReady: boolean;
```

#### state

```ts
state: Map<TKey, TResult>;
```

#### status

```ts
status: CollectionStatus;
```

### Examples

```ts
// Using pre-created live query collection
const myLiveQuery = createLiveQueryCollection((q) =>
  q.from({ todos: todosCollection }).where(({ todos }) => eq(todos.active, true))
)
const { data, collection } = useLiveQuery(myLiveQuery)
```

```ts
// Access collection methods directly
const { data, collection, isReady } = useLiveQuery(existingCollection)

// Use collection for mutations
const handleToggle = (id) => {
  collection.update(id, draft => { draft.completed = !draft.completed })
}
```

```ts
// Handle states consistently
const { data, isLoading, isError } = useLiveQuery(sharedCollection)

if (isLoading) return <div>Loading...</div>
if (isError) return <div>Error loading data</div>

return <div>{data.map(item => <Item key={item.id} {...item} />)}</div>
```
---
title: TanStack DB React Adapter
id: adapter
---

## Installation

```sh
npm install @tanstack/react-db
```

## React Hooks

See the [React Functions Reference](../reference/index.md) to see the full list of hooks available in the React Adapter.

## Basic Usage
---
id: "@tanstack/solid-db"
title: "@tanstack/solid-db"
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# @tanstack/solid-db

## Functions

- [useLiveQuery](../functions/uselivequery.md)
---
id: useLiveQuery
title: useLiveQuery
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: useLiveQuery()

## Call Signature

```ts
function useLiveQuery<TContext>(queryFn): object
```

Defined in: [useLiveQuery.ts:80](https://github.com/TanStack/db/blob/main/packages/solid-db/src/useLiveQuery.ts#L80)

Create a live query using a query function

### Type Parameters

• **TContext** *extends* `Context`

### Parameters

#### queryFn

(`q`) => `QueryBuilder`\<`TContext`\>

Query function that defines what data to fetch

### Returns

`object`

Object with reactive data, state, and status information

#### collection

```ts
collection: Accessor<Collection<{ [K in string | number | symbol]: (TContext["result"] extends object ? any[any] : TContext["hasJoins"] extends true ? TContext["schema"] : TContext["schema"][TContext["fromSourceName"]])[K] }, string | number, {}, StandardSchemaV1<unknown, unknown>, { [K in string | number | symbol]: (TContext["result"] extends object ? any[any] : TContext["hasJoins"] extends true ? TContext["schema"] : TContext["schema"][TContext["fromSourceName"]])[K] }>>;
```

#### data

```ts
data: { [K in string | number | symbol]: (TContext["result"] extends object ? any[any] : TContext["hasJoins"] extends true ? TContext["schema"] : TContext["schema"][TContext["fromSourceName"]])[K] }[];
```

#### isCleanedUp

```ts
isCleanedUp: Accessor<boolean>;
```

#### isError

```ts
isError: Accessor<boolean>;
```

#### isIdle

```ts
isIdle: Accessor<boolean>;
```

#### isLoading

```ts
isLoading: Accessor<boolean>;
```

#### isReady

```ts
isReady: Accessor<boolean>;
```

#### state

```ts
state: ReactiveMap<string | number, { [K in string | number | symbol]: (TContext["result"] extends object ? any[any] : TContext["hasJoins"] extends true ? TContext["schema"] : TContext["schema"][TContext["fromSourceName"]])[K] }>;
```

#### status

```ts
status: Accessor<CollectionStatus>;
```

### Examples

```ts
// Basic query with object syntax
const todosQuery = useLiveQuery((q) =>
  q.from({ todos: todosCollection })
   .where(({ todos }) => eq(todos.completed, false))
   .select(({ todos }) => ({ id: todos.id, text: todos.text }))
)
```

```ts
// With dependencies that trigger re-execution
const todosQuery = useLiveQuery(
  (q) => q.from({ todos: todosCollection })
         .where(({ todos }) => gt(todos.priority, minPriority())),
)
```

```ts
// Join pattern
const personIssues = useLiveQuery((q) =>
  q.from({ issues: issueCollection })
   .join({ persons: personCollection }, ({ issues, persons }) =>
     eq(issues.userId, persons.id)
   )
   .select(({ issues, persons }) => ({
     id: issues.id,
     title: issues.title,
     userName: persons.name
   }))
)
```

```ts
// Handle loading and error states
const todosQuery = useLiveQuery((q) =>
  q.from({ todos: todoCollection })
)

return (
  <Switch>
    <Match when={todosQuery.isLoading()}>
      <div>Loading...</div>
    </Match>
    <Match when={todosQuery.isError()}>
      <div>Error: {todosQuery.status()}</div>
    </Match>
    <Match when={todosQuery.isReady()}>
      <For each={todosQuery.data()}>
        {(todo) => <li key={todo.id}>{todo.text}</li>}
      </For>
    </Match>
  </Switch>
)
```

## Call Signature

```ts
function useLiveQuery<TContext>(config): object
```

Defined in: [useLiveQuery.ts:135](https://github.com/TanStack/db/blob/main/packages/solid-db/src/useLiveQuery.ts#L135)

Create a live query using configuration object

### Type Parameters

• **TContext** *extends* `Context`

### Parameters

#### config

`Accessor`\<`LiveQueryCollectionConfig`\<`TContext`, \{ \[K in string \| number \| symbol\]: (TContext\["result"\] extends object ? any\[any\] : TContext\["hasJoins"\] extends true ? TContext\["schema"\] : TContext\["schema"\]\[TContext\["fromSourceName"\]\])\[K\] \} & `object`\>\>

Configuration object with query and options

### Returns

`object`

Object with reactive data, state, and status information

#### collection

```ts
collection: Accessor<Collection<{ [K in string | number | symbol]: (TContext["result"] extends object ? any[any] : TContext["hasJoins"] extends true ? TContext["schema"] : TContext["schema"][TContext["fromSourceName"]])[K] }, string | number, {}, StandardSchemaV1<unknown, unknown>, { [K in string | number | symbol]: (TContext["result"] extends object ? any[any] : TContext["hasJoins"] extends true ? TContext["schema"] : TContext["schema"][TContext["fromSourceName"]])[K] }>>;
```

#### data

```ts
data: { [K in string | number | symbol]: (TContext["result"] extends object ? any[any] : TContext["hasJoins"] extends true ? TContext["schema"] : TContext["schema"][TContext["fromSourceName"]])[K] }[];
```

#### isCleanedUp

```ts
isCleanedUp: Accessor<boolean>;
```

#### isError

```ts
isError: Accessor<boolean>;
```

#### isIdle

```ts
isIdle: Accessor<boolean>;
```

#### isLoading

```ts
isLoading: Accessor<boolean>;
```

#### isReady

```ts
isReady: Accessor<boolean>;
```

#### state

```ts
state: ReactiveMap<string | number, { [K in string | number | symbol]: (TContext["result"] extends object ? any[any] : TContext["hasJoins"] extends true ? TContext["schema"] : TContext["schema"][TContext["fromSourceName"]])[K] }>;
```

#### status

```ts
status: Accessor<CollectionStatus>;
```

### Examples

```ts
// Basic config object usage
const todosQuery = useLiveQuery(() => ({
  query: (q) => q.from({ todos: todosCollection }),
  gcTime: 60000
}))
```

```ts
// With query builder and options
const queryBuilder = new Query()
  .from({ persons: collection })
  .where(({ persons }) => gt(persons.age, 30))
  .select(({ persons }) => ({ id: persons.id, name: persons.name }))

const personsQuery = useLiveQuery(() => ({ query: queryBuilder }))
```

```ts
// Handle all states uniformly
const itemsQuery = useLiveQuery(() => ({
  query: (q) => q.from({ items: itemCollection })
}))

return (
  <Switch fallback={<div>{itemsQuery.data.length} items loaded</div>}>
    <Match when={itemsQuery.isLoading()}>
      <div>Loading...</div>
    </Match>
    <Match when={itemsQuery.isError()}>
      <div>Something went wrong</div>
    </Match>
    <Match when={!itemsQuery.isReady()}>
      <div>Preparing...</div>
    </Match>
  </Switch>
)
```

## Call Signature

```ts
function useLiveQuery<TResult, TKey, TUtils>(liveQueryCollection): object
```

Defined in: [useLiveQuery.ts:185](https://github.com/TanStack/db/blob/main/packages/solid-db/src/useLiveQuery.ts#L185)

Subscribe to an existing live query collection

### Type Parameters

• **TResult** *extends* `object`

• **TKey** *extends* `string` \| `number`

• **TUtils** *extends* `Record`\<`string`, `any`\>

### Parameters

#### liveQueryCollection

`Accessor`\<`Collection`\<`TResult`, `TKey`, `TUtils`, `StandardSchemaV1`\<`unknown`, `unknown`\>, `TResult`\>\>

Pre-created live query collection to subscribe to

### Returns

`object`

Object with reactive data, state, and status information

#### collection

```ts
collection: Accessor<Collection<TResult, TKey, TUtils, StandardSchemaV1<unknown, unknown>, TResult>>;
```

#### data

```ts
data: TResult[];
```

#### isCleanedUp

```ts
isCleanedUp: Accessor<boolean>;
```

#### isError

```ts
isError: Accessor<boolean>;
```

#### isIdle

```ts
isIdle: Accessor<boolean>;
```

#### isLoading

```ts
isLoading: Accessor<boolean>;
```

#### isReady

```ts
isReady: Accessor<boolean>;
```

#### state

```ts
state: ReactiveMap<TKey, TResult>;
```

#### status

```ts
status: Accessor<CollectionStatus>;
```

### Examples

```ts
// Using pre-created live query collection
const myLiveQuery = createLiveQueryCollection((q) =>
  q.from({ todos: todosCollection }).where(({ todos }) => eq(todos.active, true))
)
const todosQuery = useLiveQuery(() => myLiveQuery)
```

```ts
// Access collection methods directly
const existingQuery = useLiveQuery(() => existingCollection)

// Use collection for mutations
const handleToggle = (id) => {
  existingQuery.collection().update(id, draft => { draft.completed = !draft.completed })
}
```

```ts
// Handle states consistently
const sharedQuery = useLiveQuery(() => sharedCollection)

return (
 <Switch fallback={<div><For each={sharedQuery.data()}>{(item) => <Item key={item.id} {...item} />}</For></div>}>
   <Match when={sharedQuery.isLoading()}>
     <div>Loading...</div>
   </Match>
   <Match when={sharedQuery.isError()}>
     <div>Error loading data</div>
   </Match>
 </Switch>
)
```
---
title: TanStack DB Solid Adapter
ref: docs/framework/react/adapter.md
replace: { "React": "Solid", "react": "solid" }
---
---
id: "@tanstack/query-db-collection"
title: "@tanstack/query-db-collection"
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# @tanstack/query-db-collection

## Classes

- [GetKeyRequiredError](../classes/getkeyrequirederror.md)
- [QueryClientRequiredError](../classes/queryclientrequirederror.md)
- [QueryCollectionError](../classes/querycollectionerror.md)
- [QueryFnRequiredError](../classes/queryfnrequirederror.md)
- [QueryKeyRequiredError](../classes/querykeyrequirederror.md)

## Interfaces

- [QueryCollectionConfig](../interfaces/querycollectionconfig.md)
- [QueryCollectionUtils](../interfaces/querycollectionutils.md)

## Functions

- [queryCollectionOptions](../functions/querycollectionoptions.md)
---
id: QueryCollectionUtils
title: QueryCollectionUtils
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: QueryCollectionUtils\<TItem, TKey, TInsertInput\>

Defined in: [packages/query-db-collection/src/query.ts:256](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L256)

Write operation types for batch operations

## Extends

- `UtilsRecord`

## Type Parameters

• **TItem** *extends* `object` = `Record`\<`string`, `unknown`\>

• **TKey** *extends* `string` \| `number` = `string` \| `number`

• **TInsertInput** *extends* `object` = `TItem`

## Indexable

```ts
[key: string]: Fn
```

## Properties

### refetch

```ts
refetch: RefetchFn;
```

Defined in: [packages/query-db-collection/src/query.ts:261](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L261)

***

### writeBatch()

```ts
writeBatch: (operations) => void;
```

Defined in: [packages/query-db-collection/src/query.ts:266](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L266)

#### Parameters

##### operations

[`SyncOperation`](../../type-aliases/syncoperation.md)\<`TItem`, `TKey`, `TInsertInput`\>[]

#### Returns

`void`

***

### writeDelete()

```ts
writeDelete: (keys) => void;
```

Defined in: [packages/query-db-collection/src/query.ts:264](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L264)

#### Parameters

##### keys

`TKey` | `TKey`[]

#### Returns

`void`

***

### writeInsert()

```ts
writeInsert: (data) => void;
```

Defined in: [packages/query-db-collection/src/query.ts:262](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L262)

#### Parameters

##### data

`TInsertInput` | `TInsertInput`[]

#### Returns

`void`

***

### writeUpdate()

```ts
writeUpdate: (updates) => void;
```

Defined in: [packages/query-db-collection/src/query.ts:263](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L263)

#### Parameters

##### updates

`Partial`\<`TItem`\> | `Partial`\<`TItem`\>[]

#### Returns

`void`

***

### writeUpsert()

```ts
writeUpsert: (data) => void;
```

Defined in: [packages/query-db-collection/src/query.ts:265](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L265)

#### Parameters

##### data

`Partial`\<`TItem`\> | `Partial`\<`TItem`\>[]

#### Returns

`void`
---
id: QueryCollectionConfig
title: QueryCollectionConfig
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: QueryCollectionConfig\<TItem, TError, TQueryKey\>

Defined in: [packages/query-db-collection/src/query.ts:32](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L32)

## Type Parameters

• **TItem** *extends* `object`

• **TError** = `unknown`

• **TQueryKey** *extends* `QueryKey` = `QueryKey`

## Properties

### enabled?

```ts
optional enabled: boolean;
```

Defined in: [packages/query-db-collection/src/query.ts:42](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L42)

***

### getKey()

```ts
getKey: (item) => string | number;
```

Defined in: [packages/query-db-collection/src/query.ts:74](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L74)

#### Parameters

##### item

`TItem`

#### Returns

`string` \| `number`

***

### id?

```ts
optional id: string;
```

Defined in: [packages/query-db-collection/src/query.ts:73](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L73)

***

### meta?

```ts
optional meta: Record<string, unknown>;
```

Defined in: [packages/query-db-collection/src/query.ts:242](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L242)

Metadata to pass to the query.
Available in queryFn via context.meta

#### Example

```ts
// Using meta for error context
queryFn: async (context) => {
  try {
    return await api.getTodos(userId)
  } catch (error) {
    // Use meta for better error messages
    throw new Error(
      context.meta?.errorMessage || 'Failed to load todos'
    )
  }
},
meta: {
  errorMessage: `Failed to load todos for user ${userId}`
}
```

***

### onDelete?

```ts
optional onDelete: DeleteMutationFn<TItem>;
```

Defined in: [packages/query-db-collection/src/query.ts:219](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L219)

Optional asynchronous handler function called before a delete operation

#### Param

Object containing transaction and collection information

#### Returns

Promise resolving to void or { refetch?: boolean } to control refetching

#### Examples

```ts
// Basic query collection delete handler
onDelete: async ({ transaction }) => {
  const mutation = transaction.mutations[0]
  await api.deleteTodo(mutation.original.id)
  // Automatically refetches query after delete
}
```

```ts
// Delete handler with refetch control
onDelete: async ({ transaction }) => {
  const mutation = transaction.mutations[0]
  await api.deleteTodo(mutation.original.id)
  return { refetch: false } // Skip automatic refetch
}
```

```ts
// Delete handler with multiple items
onDelete: async ({ transaction }) => {
  const keysToDelete = transaction.mutations.map(m => m.key)
  await api.deleteTodos(keysToDelete)
  // Will refetch query to get updated data
}
```

```ts
// Delete handler with related collection refetch
onDelete: async ({ transaction, collection }) => {
  const mutation = transaction.mutations[0]
  await api.deleteTodo(mutation.original.id)

  // Refetch related collections when this item is deleted
  await Promise.all([
    collection.utils.refetch(), // Refetch this collection
    usersCollection.utils.refetch(), // Refetch users
    projectsCollection.utils.refetch() // Refetch projects
  ])

  return { refetch: false } // Skip automatic refetch since we handled it manually
}
```

***

### onInsert?

```ts
optional onInsert: InsertMutationFn<TItem>;
```

Defined in: [packages/query-db-collection/src/query.ts:120](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L120)

Optional asynchronous handler function called before an insert operation

#### Param

Object containing transaction and collection information

#### Returns

Promise resolving to void or { refetch?: boolean } to control refetching

#### Examples

```ts
// Basic query collection insert handler
onInsert: async ({ transaction }) => {
  const newItem = transaction.mutations[0].modified
  await api.createTodo(newItem)
  // Automatically refetches query after insert
}
```

```ts
// Insert handler with refetch control
onInsert: async ({ transaction }) => {
  const newItem = transaction.mutations[0].modified
  await api.createTodo(newItem)
  return { refetch: false } // Skip automatic refetch
}
```

```ts
// Insert handler with multiple items
onInsert: async ({ transaction }) => {
  const items = transaction.mutations.map(m => m.modified)
  await api.createTodos(items)
  // Will refetch query to get updated data
}
```

```ts
// Insert handler with error handling
onInsert: async ({ transaction }) => {
  try {
    const newItem = transaction.mutations[0].modified
    await api.createTodo(newItem)
  } catch (error) {
    console.error('Insert failed:', error)
    throw error // Transaction will rollback optimistic changes
  }
}
```

***

### onUpdate?

```ts
optional onUpdate: UpdateMutationFn<TItem>;
```

Defined in: [packages/query-db-collection/src/query.ts:173](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L173)

Optional asynchronous handler function called before an update operation

#### Param

Object containing transaction and collection information

#### Returns

Promise resolving to void or { refetch?: boolean } to control refetching

#### Examples

```ts
// Basic query collection update handler
onUpdate: async ({ transaction }) => {
  const mutation = transaction.mutations[0]
  await api.updateTodo(mutation.original.id, mutation.changes)
  // Automatically refetches query after update
}
```

```ts
// Update handler with multiple items
onUpdate: async ({ transaction }) => {
  const updates = transaction.mutations.map(m => ({
    id: m.key,
    changes: m.changes
  }))
  await api.updateTodos(updates)
  // Will refetch query to get updated data
}
```

```ts
// Update handler with manual refetch
onUpdate: async ({ transaction, collection }) => {
  const mutation = transaction.mutations[0]
  await api.updateTodo(mutation.original.id, mutation.changes)

  // Manually trigger refetch
  await collection.utils.refetch()

  return { refetch: false } // Skip automatic refetch
}
```

```ts
// Update handler with related collection refetch
onUpdate: async ({ transaction, collection }) => {
  const mutation = transaction.mutations[0]
  await api.updateTodo(mutation.original.id, mutation.changes)

  // Refetch related collections when this item changes
  await Promise.all([
    collection.utils.refetch(), // Refetch this collection
    usersCollection.utils.refetch(), // Refetch users
    tagsCollection.utils.refetch() // Refetch tags
  ])

  return { refetch: false } // Skip automatic refetch since we handled it manually
}
```

***

### queryClient

```ts
queryClient: QueryClient;
```

Defined in: [packages/query-db-collection/src/query.ts:39](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L39)

***

### queryFn()

```ts
queryFn: (context) => Promise<TItem[]>;
```

Defined in: [packages/query-db-collection/src/query.ts:38](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L38)

#### Parameters

##### context

###### client

`QueryClient`

###### direction?

`unknown`

**Deprecated**

if you want access to the direction, you can add it to the pageParam

###### meta

`undefined` \| `Record`\<`string`, `unknown`\>

###### pageParam?

`unknown`

###### queryKey

`TQueryKey`

###### signal

`AbortSignal`

#### Returns

`Promise`\<`TItem`[]\>

***

### queryKey

```ts
queryKey: TQueryKey;
```

Defined in: [packages/query-db-collection/src/query.ts:37](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L37)

***

### refetchInterval?

```ts
optional refetchInterval: number | false | (query) => undefined | number | false;
```

Defined in: [packages/query-db-collection/src/query.ts:43](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L43)

***

### retry?

```ts
optional retry: RetryValue<TError>;
```

Defined in: [packages/query-db-collection/src/query.ts:50](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L50)

***

### retryDelay?

```ts
optional retryDelay: RetryDelayValue<TError>;
```

Defined in: [packages/query-db-collection/src/query.ts:57](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L57)

***

### schema?

```ts
optional schema: StandardSchemaV1<unknown, unknown>;
```

Defined in: [packages/query-db-collection/src/query.ts:75](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L75)

***

### staleTime?

```ts
optional staleTime: StaleTimeFunction<TItem[], TError, TItem[], TQueryKey>;
```

Defined in: [packages/query-db-collection/src/query.ts:64](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L64)

***

### startSync?

```ts
optional startSync: boolean;
```

Defined in: [packages/query-db-collection/src/query.ts:77](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L77)

***

### sync?

```ts
optional sync: SyncConfig<TItem, string | number>;
```

Defined in: [packages/query-db-collection/src/query.ts:76](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L76)
---
id: queryCollectionOptions
title: queryCollectionOptions
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: queryCollectionOptions()

```ts
function queryCollectionOptions<TItem, TError, TQueryKey, TKey, TInsertInput>(config): CollectionConfig<TItem, string | number, StandardSchemaV1<unknown, unknown>, TItem> & object
```

Defined in: [packages/query-db-collection/src/query.ts:277](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/query.ts#L277)

Creates query collection options for use with a standard Collection

## Type Parameters

• **TItem** *extends* `object`

• **TError** = `unknown`

• **TQueryKey** *extends* readonly `unknown`[] = readonly `unknown`[]

• **TKey** *extends* `string` \| `number` = `string` \| `number`

• **TInsertInput** *extends* `object` = `TItem`

## Parameters

### config

[`QueryCollectionConfig`](../../interfaces/querycollectionconfig.md)\<`TItem`, `TError`, `TQueryKey`\>

Configuration options for the Query collection

## Returns

`CollectionConfig`\<`TItem`, `string` \| `number`, `StandardSchemaV1`\<`unknown`, `unknown`\>, `TItem`\> & `object`

Collection options with utilities
---
id: QueryClientRequiredError
title: QueryClientRequiredError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: QueryClientRequiredError

Defined in: [packages/query-db-collection/src/errors.ts:25](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/errors.ts#L25)

## Extends

- [`QueryCollectionError`](../querycollectionerror.md)

## Constructors

### new QueryClientRequiredError()

```ts
new QueryClientRequiredError(): QueryClientRequiredError
```

Defined in: [packages/query-db-collection/src/errors.ts:26](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/errors.ts#L26)

#### Returns

[`QueryClientRequiredError`](../queryclientrequirederror.md)

#### Overrides

[`QueryCollectionError`](../querycollectionerror.md).[`constructor`](../QueryCollectionError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`cause`](../QueryCollectionError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`message`](../QueryCollectionError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`name`](../QueryCollectionError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`stack`](../QueryCollectionError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`prepareStackTrace`](../QueryCollectionError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`stackTraceLimit`](../QueryCollectionError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`captureStackTrace`](../QueryCollectionError.md#capturestacktrace)
---
id: GetKeyRequiredError
title: GetKeyRequiredError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: GetKeyRequiredError

Defined in: [packages/query-db-collection/src/errors.ts:32](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/errors.ts#L32)

## Extends

- [`QueryCollectionError`](../querycollectionerror.md)

## Constructors

### new GetKeyRequiredError()

```ts
new GetKeyRequiredError(): GetKeyRequiredError
```

Defined in: [packages/query-db-collection/src/errors.ts:33](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/errors.ts#L33)

#### Returns

[`GetKeyRequiredError`](../getkeyrequirederror.md)

#### Overrides

[`QueryCollectionError`](../querycollectionerror.md).[`constructor`](../QueryCollectionError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`cause`](../QueryCollectionError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`message`](../QueryCollectionError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`name`](../QueryCollectionError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`stack`](../QueryCollectionError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`prepareStackTrace`](../QueryCollectionError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`stackTraceLimit`](../QueryCollectionError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`captureStackTrace`](../QueryCollectionError.md#capturestacktrace)
---
id: QueryKeyRequiredError
title: QueryKeyRequiredError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: QueryKeyRequiredError

Defined in: [packages/query-db-collection/src/errors.ts:11](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/errors.ts#L11)

## Extends

- [`QueryCollectionError`](../querycollectionerror.md)

## Constructors

### new QueryKeyRequiredError()

```ts
new QueryKeyRequiredError(): QueryKeyRequiredError
```

Defined in: [packages/query-db-collection/src/errors.ts:12](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/errors.ts#L12)

#### Returns

[`QueryKeyRequiredError`](../querykeyrequirederror.md)

#### Overrides

[`QueryCollectionError`](../querycollectionerror.md).[`constructor`](../QueryCollectionError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`cause`](../QueryCollectionError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`message`](../QueryCollectionError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`name`](../QueryCollectionError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`stack`](../QueryCollectionError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`prepareStackTrace`](../QueryCollectionError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`stackTraceLimit`](../QueryCollectionError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`captureStackTrace`](../QueryCollectionError.md#capturestacktrace)
---
id: QueryCollectionError
title: QueryCollectionError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: QueryCollectionError

Defined in: [packages/query-db-collection/src/errors.ts:4](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/errors.ts#L4)

## Extends

- `TanStackDBError`

## Extended by

- [`QueryKeyRequiredError`](../querykeyrequirederror.md)
- [`QueryFnRequiredError`](../queryfnrequirederror.md)
- [`QueryClientRequiredError`](../queryclientrequirederror.md)
- [`GetKeyRequiredError`](../getkeyrequirederror.md)

## Constructors

### new QueryCollectionError()

```ts
new QueryCollectionError(message): QueryCollectionError
```

Defined in: [packages/query-db-collection/src/errors.ts:5](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/errors.ts#L5)

#### Parameters

##### message

`string`

#### Returns

[`QueryCollectionError`](../querycollectionerror.md)

#### Overrides

```ts
TanStackDBError.constructor
```

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

```ts
TanStackDBError.cause
```

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

```ts
TanStackDBError.message
```

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

```ts
TanStackDBError.name
```

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

```ts
TanStackDBError.stack
```

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

```ts
TanStackDBError.prepareStackTrace
```

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

```ts
TanStackDBError.stackTraceLimit
```

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

```ts
TanStackDBError.captureStackTrace
```
---
id: QueryFnRequiredError
title: QueryFnRequiredError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: QueryFnRequiredError

Defined in: [packages/query-db-collection/src/errors.ts:18](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/errors.ts#L18)

## Extends

- [`QueryCollectionError`](../querycollectionerror.md)

## Constructors

### new QueryFnRequiredError()

```ts
new QueryFnRequiredError(): QueryFnRequiredError
```

Defined in: [packages/query-db-collection/src/errors.ts:19](https://github.com/TanStack/db/blob/main/packages/query-db-collection/src/errors.ts#L19)

#### Returns

[`QueryFnRequiredError`](../queryfnrequirederror.md)

#### Overrides

[`QueryCollectionError`](../querycollectionerror.md).[`constructor`](../QueryCollectionError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`cause`](../QueryCollectionError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`message`](../QueryCollectionError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`name`](../QueryCollectionError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`stack`](../QueryCollectionError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`prepareStackTrace`](../QueryCollectionError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`stackTraceLimit`](../QueryCollectionError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`QueryCollectionError`](../querycollectionerror.md).[`captureStackTrace`](../QueryCollectionError.md#capturestacktrace)
---
id: "@tanstack/db"
title: "@tanstack/db"
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# @tanstack/db

## Classes

- [AggregateFunctionNotInSelectError](../classes/aggregatefunctionnotinselecterror.md)
- [BaseIndex](../classes/baseindex.md)
- [BaseQueryBuilder](../classes/basequerybuilder.md)
- [BTreeIndex](../classes/btreeindex.md)
- [CannotCombineEmptyExpressionListError](../classes/cannotcombineemptyexpressionlisterror.md)
- [CollectionConfigurationError](../classes/collectionconfigurationerror.md)
- [CollectionImpl](../classes/collectionimpl.md)
- [CollectionInErrorStateError](../classes/collectioninerrorstateerror.md)
- [CollectionInputNotFoundError](../classes/collectioninputnotfounderror.md)
- [CollectionIsInErrorStateError](../classes/collectionisinerrorstateerror.md)
- [CollectionOperationError](../classes/collectionoperationerror.md)
- [CollectionRequiresConfigError](../classes/collectionrequiresconfigerror.md)
- [CollectionRequiresSyncConfigError](../classes/collectionrequiressyncconfigerror.md)
- [CollectionStateError](../classes/collectionstateerror.md)
- [DeleteKeyNotFoundError](../classes/deletekeynotfounderror.md)
- [DistinctRequiresSelectError](../classes/distinctrequiresselecterror.md)
- [DuplicateKeyError](../classes/duplicatekeyerror.md)
- [DuplicateKeySyncError](../classes/duplicatekeysyncerror.md)
- [EmptyReferencePathError](../classes/emptyreferencepatherror.md)
- [GroupByError](../classes/groupbyerror.md)
- [HavingRequiresGroupByError](../classes/havingrequiresgroupbyerror.md)
- [IndexProxy](../classes/indexproxy.md)
- [InvalidCollectionStatusTransitionError](../classes/invalidcollectionstatustransitionerror.md)
- [InvalidJoinConditionSameTableError](../classes/invalidjoinconditionsametableerror.md)
- [InvalidJoinConditionTableMismatchError](../classes/invalidjoinconditiontablemismatcherror.md)
- [InvalidJoinConditionWrongTablesError](../classes/invalidjoinconditionwrongtableserror.md)
- [InvalidSchemaError](../classes/invalidschemaerror.md)
- [InvalidSourceError](../classes/invalidsourceerror.md)
- [InvalidStorageDataFormatError](../classes/invalidstoragedataformaterror.md)
- [InvalidStorageObjectFormatError](../classes/invalidstorageobjectformaterror.md)
- [JoinConditionMustBeEqualityError](../classes/joinconditionmustbeequalityerror.md)
- [JoinError](../classes/joinerror.md)
- [KeyUpdateNotAllowedError](../classes/keyupdatenotallowederror.md)
- [LazyIndexWrapper](../classes/lazyindexwrapper.md)
- [LimitOffsetRequireOrderByError](../classes/limitoffsetrequireorderbyerror.md)
- [LocalStorageCollectionError](../classes/localstoragecollectionerror.md)
- [MissingDeleteHandlerError](../classes/missingdeletehandlererror.md)
- [MissingHandlerError](../classes/missinghandlererror.md)
- [MissingInsertHandlerError](../classes/missinginserthandlererror.md)
- [MissingMutationFunctionError](../classes/missingmutationfunctionerror.md)
- [MissingUpdateArgumentError](../classes/missingupdateargumenterror.md)
- [MissingUpdateHandlerError](../classes/missingupdatehandlererror.md)
- [NegativeActiveSubscribersError](../classes/negativeactivesubscriberserror.md)
- [NoKeysPassedToDeleteError](../classes/nokeyspassedtodeleteerror.md)
- [NoKeysPassedToUpdateError](../classes/nokeyspassedtoupdateerror.md)
- [NonAggregateExpressionNotInGroupByError](../classes/nonaggregateexpressionnotingroupbyerror.md)
- [NonRetriableError](../classes/nonretriableerror.md)
- [NoPendingSyncTransactionCommitError](../classes/nopendingsynctransactioncommiterror.md)
- [NoPendingSyncTransactionWriteError](../classes/nopendingsynctransactionwriteerror.md)
- [NoStorageAvailableError](../classes/nostorageavailableerror.md)
- [NoStorageEventApiError](../classes/nostorageeventapierror.md)
- [OnlyOneSourceAllowedError](../classes/onlyonesourceallowederror.md)
- [QueryBuilderError](../classes/querybuildererror.md)
- [QueryCompilationError](../classes/querycompilationerror.md)
- [QueryMustHaveFromClauseError](../classes/querymusthavefromclauseerror.md)
- [QueryOptimizerError](../classes/queryoptimizererror.md)
- [SchemaMustBeSynchronousError](../classes/schemamustbesynchronouserror.md)
- [SchemaValidationError](../classes/schemavalidationerror.md)
- [SerializationError](../classes/serializationerror.md)
- [SortedMap](../classes/sortedmap.md)
- [StorageError](../classes/storageerror.md)
- [StorageKeyRequiredError](../classes/storagekeyrequirederror.md)
- [SubQueryMustHaveFromClauseError](../classes/subquerymusthavefromclauseerror.md)
- [SyncCleanupError](../classes/synccleanuperror.md)
- [SyncTransactionAlreadyCommittedError](../classes/synctransactionalreadycommittederror.md)
- [SyncTransactionAlreadyCommittedWriteError](../classes/synctransactionalreadycommittedwriteerror.md)
- [TanStackDBError](../classes/tanstackdberror.md)
- [Transaction](../classes/transaction.md)
- [TransactionAlreadyCompletedRollbackError](../classes/transactionalreadycompletedrollbackerror.md)
- [TransactionError](../classes/transactionerror.md)
- [TransactionNotPendingCommitError](../classes/transactionnotpendingcommiterror.md)
- [TransactionNotPendingMutateError](../classes/transactionnotpendingmutateerror.md)
- [UndefinedKeyError](../classes/undefinedkeyerror.md)
- [UnknownExpressionTypeError](../classes/unknownexpressiontypeerror.md)
- [UnknownFunctionError](../classes/unknownfunctionerror.md)
- [UnknownHavingExpressionTypeError](../classes/unknownhavingexpressiontypeerror.md)
- [UnsupportedAggregateFunctionError](../classes/unsupportedaggregatefunctionerror.md)
- [UnsupportedFromTypeError](../classes/unsupportedfromtypeerror.md)
- [UnsupportedJoinSourceTypeError](../classes/unsupportedjoinsourcetypeerror.md)
- [UnsupportedJoinTypeError](../classes/unsupportedjointypeerror.md)
- [UpdateKeyNotFoundError](../classes/updatekeynotfounderror.md)

## Interfaces

- [BTreeIndexOptions](../interfaces/btreeindexoptions.md)
- [ChangeMessage](../interfaces/changemessage.md)
- [Collection](../interfaces/collection.md)
- [CollectionConfig](../interfaces/collectionconfig.md)
- [Context](../interfaces/context.md)
- [CreateOptimisticActionsOptions](../interfaces/createoptimisticactionsoptions.md)
- [CurrentStateAsChangesOptions](../interfaces/currentstateaschangesoptions.md)
- [IndexOptions](../interfaces/indexoptions.md)
- [IndexStats](../interfaces/indexstats.md)
- [InsertConfig](../interfaces/insertconfig.md)
- [LiveQueryCollectionConfig](../interfaces/livequerycollectionconfig.md)
- [LocalOnlyCollectionConfig](../interfaces/localonlycollectionconfig.md)
- [LocalOnlyCollectionUtils](../interfaces/localonlycollectionutils.md)
- [LocalStorageCollectionConfig](../interfaces/localstoragecollectionconfig.md)
- [LocalStorageCollectionUtils](../interfaces/localstoragecollectionutils.md)
- [OperationConfig](../interfaces/operationconfig.md)
- [OptimisticChangeMessage](../interfaces/optimisticchangemessage.md)
- [PendingMutation](../interfaces/pendingmutation.md)
- [RangeQueryOptions](../interfaces/rangequeryoptions.md)
- [SubscribeChangesOptions](../interfaces/subscribechangesoptions.md)
- [SyncConfig](../interfaces/syncconfig.md)
- [TransactionConfig](../interfaces/transactionconfig.md)

## Type Aliases

- [ChangeListener](../type-aliases/changelistener.md)
- [ChangesPayload](../type-aliases/changespayload.md)
- [ClearStorageFn](../type-aliases/clearstoragefn.md)
- [CollectionStatus](../type-aliases/collectionstatus.md)
- [DeleteMutationFn](../type-aliases/deletemutationfn.md)
- [DeleteMutationFnParams](../type-aliases/deletemutationfnparams.md)
- [Fn](../type-aliases/fn.md)
- [GetResult](../type-aliases/getresult.md)
- [GetStorageSizeFn](../type-aliases/getstoragesizefn.md)
- [IndexConstructor](../type-aliases/indexconstructor.md)
- [IndexOperation](../type-aliases/indexoperation.md)
- [IndexResolver](../type-aliases/indexresolver.md)
- [InferSchemaInput](../type-aliases/inferschemainput.md)
- [InferSchemaOutput](../type-aliases/inferschemaoutput.md)
- [InitialQueryBuilder](../type-aliases/initialquerybuilder.md)
- [InputRow](../type-aliases/inputrow.md)
- [InsertMutationFn](../type-aliases/insertmutationfn.md)
- [InsertMutationFnParams](../type-aliases/insertmutationfnparams.md)
- [KeyedNamespacedRow](../type-aliases/keyednamespacedrow.md)
- [KeyedStream](../type-aliases/keyedstream.md)
- [MutationFn](../type-aliases/mutationfn.md)
- [MutationFnParams](../type-aliases/mutationfnparams.md)
- [NamespacedAndKeyedStream](../type-aliases/namespacedandkeyedstream.md)
- [NamespacedRow](../type-aliases/namespacedrow.md)
- [NonEmptyArray](../type-aliases/nonemptyarray.md)
- [OperationType](../type-aliases/operationtype.md)
- [QueryBuilder](../type-aliases/querybuilder.md)
- [Ref](../type-aliases/ref.md)
- [ResolveInsertInput](../type-aliases/resolveinsertinput.md)
- [ResolveTransactionChanges](../type-aliases/resolvetransactionchanges.md)
- [ResolveType](../type-aliases/resolvetype.md)
- [ResultStream](../type-aliases/resultstream.md)
- [Row](../type-aliases/row.md)
- [Source](../type-aliases/source.md)
- [StandardSchema](../type-aliases/standardschema.md)
- [StandardSchemaAlias](../type-aliases/standardschemaalias.md)
- [StorageApi](../type-aliases/storageapi.md)
- [StorageEventApi](../type-aliases/storageeventapi.md)
- [TransactionState](../type-aliases/transactionstate.md)
- [TransactionWithMutations](../type-aliases/transactionwithmutations.md)
- [UpdateMutationFn](../type-aliases/updatemutationfn.md)
- [UpdateMutationFnParams](../type-aliases/updatemutationfnparams.md)
- [UtilsRecord](../type-aliases/utilsrecord.md)

## Variables

- [IndexOperation](../variables/indexoperation.md)
- [Query](../variables/query.md)

## Functions

- [add](../functions/add.md)
- [and](../functions/and.md)
- [avg](../functions/avg.md)
- [coalesce](../functions/coalesce.md)
- [compileQuery](../functions/compilequery.md)
- [concat](../functions/concat.md)
- [count](../functions/count.md)
- [createArrayChangeProxy](../functions/createarraychangeproxy.md)
- [createChangeProxy](../functions/createchangeproxy.md)
- [createCollection](../functions/createcollection.md)
- [createLiveQueryCollection](../functions/createlivequerycollection.md)
- [createOptimisticAction](../functions/createoptimisticaction.md)
- [createTransaction](../functions/createtransaction.md)
- [eq](../functions/eq.md)
- [getActiveTransaction](../functions/getactivetransaction.md)
- [gt](../functions/gt.md)
- [gte](../functions/gte.md)
- [ilike](../functions/ilike.md)
- [inArray](../functions/inarray.md)
- [length](../functions/length.md)
- [like](../functions/like.md)
- [liveQueryCollectionOptions](../functions/livequerycollectionoptions.md)
- [localOnlyCollectionOptions](../functions/localonlycollectionoptions.md)
- [localStorageCollectionOptions](../functions/localstoragecollectionoptions.md)
- [lower](../functions/lower.md)
- [lt](../functions/lt.md)
- [lte](../functions/lte.md)
- [max](../functions/max.md)
- [min](../functions/min.md)
- [not](../functions/not.md)
- [or](../functions/or.md)
- [sum](../functions/sum.md)
- [upper](../functions/upper.md)
- [withArrayChangeTracking](../functions/witharraychangetracking.md)
- [withChangeTracking](../functions/withchangetracking.md)
---
id: InsertConfig
title: InsertConfig
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: InsertConfig

Defined in: [packages/db/src/types.ts:270](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L270)

## Properties

### metadata?

```ts
optional metadata: Record<string, unknown>;
```

Defined in: [packages/db/src/types.ts:271](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L271)

***

### optimistic?

```ts
optional optimistic: boolean;
```

Defined in: [packages/db/src/types.ts:273](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L273)

Whether to apply optimistic updates immediately. Defaults to true.
---
id: TransactionConfig
title: TransactionConfig
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: TransactionConfig\<T\>

Defined in: [packages/db/src/types.ts:161](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L161)

## Type Parameters

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>

## Properties

### autoCommit?

```ts
optional autoCommit: boolean;
```

Defined in: [packages/db/src/types.ts:165](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L165)

***

### id?

```ts
optional id: string;
```

Defined in: [packages/db/src/types.ts:163](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L163)

Unique identifier for the transaction

***

### metadata?

```ts
optional metadata: Record<string, unknown>;
```

Defined in: [packages/db/src/types.ts:168](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L168)

Custom metadata to associate with the transaction

***

### mutationFn

```ts
mutationFn: MutationFn<T>;
```

Defined in: [packages/db/src/types.ts:166](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L166)
---
id: CreateOptimisticActionsOptions
title: CreateOptimisticActionsOptions
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: CreateOptimisticActionsOptions\<TVars, T\>

Defined in: [packages/db/src/types.ts:174](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L174)

Options for the createOptimisticAction helper

## Extends

- `Omit`\<[`TransactionConfig`](../transactionconfig.md)\<`T`\>, `"mutationFn"`\>

## Type Parameters

• **TVars** = `unknown`

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>

## Properties

### autoCommit?

```ts
optional autoCommit: boolean;
```

Defined in: [packages/db/src/types.ts:165](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L165)

#### Inherited from

```ts
Omit.autoCommit
```

***

### id?

```ts
optional id: string;
```

Defined in: [packages/db/src/types.ts:163](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L163)

Unique identifier for the transaction

#### Inherited from

```ts
Omit.id
```

***

### metadata?

```ts
optional metadata: Record<string, unknown>;
```

Defined in: [packages/db/src/types.ts:168](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L168)

Custom metadata to associate with the transaction

#### Inherited from

```ts
Omit.metadata
```

***

### mutationFn()

```ts
mutationFn: (vars, params) => Promise<any>;
```

Defined in: [packages/db/src/types.ts:181](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L181)

Function to execute the mutation on the server

#### Parameters

##### vars

`TVars`

##### params

[`MutationFnParams`](../../type-aliases/mutationfnparams.md)\<`T`\>

#### Returns

`Promise`\<`any`\>

***

### onMutate()

```ts
onMutate: (vars) => void;
```

Defined in: [packages/db/src/types.ts:179](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L179)

Function to apply optimistic updates locally before the mutation completes

#### Parameters

##### vars

`TVars`

#### Returns

`void`
---
id: Collection
title: Collection
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: Collection\<T, TKey, TUtils, TSchema, TInsertInput\>

Defined in: [packages/db/src/collection.ts:77](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L77)

Enhanced Collection interface that includes both data type T and utilities TUtils

## Extends

- [`CollectionImpl`](../../classes/collectionimpl.md)\<`T`, `TKey`, `TUtils`, `TSchema`, `TInsertInput`\>

## Type Parameters

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>

The type of items in the collection

• **TKey** *extends* `string` \| `number` = `string` \| `number`

The type of the key for the collection

• **TUtils** *extends* [`UtilsRecord`](../../type-aliases/utilsrecord.md) = \{\}

The utilities record type

• **TSchema** *extends* `StandardSchemaV1` = `StandardSchemaV1`

• **TInsertInput** *extends* `object` = `T`

The type for insert operations (can be different from T for schemas with defaults)

## Properties

### config

```ts
config: CollectionConfig<T, TKey, TSchema, TInsertInput>;
```

Defined in: [packages/db/src/collection.ts:211](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L211)

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`config`](../../classes/CollectionImpl.md#config-1)

***

### id

```ts
id: string;
```

Defined in: [packages/db/src/collection.ts:331](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L331)

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`id`](../../classes/CollectionImpl.md#id)

***

### optimisticDeletes

```ts
optimisticDeletes: Set<TKey>;
```

Defined in: [packages/db/src/collection.ts:221](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L221)

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`optimisticDeletes`](../../classes/CollectionImpl.md#optimisticdeletes)

***

### optimisticUpserts

```ts
optimisticUpserts: Map<TKey, T>;
```

Defined in: [packages/db/src/collection.ts:220](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L220)

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`optimisticUpserts`](../../classes/CollectionImpl.md#optimisticupserts)

***

### pendingSyncedTransactions

```ts
pendingSyncedTransactions: PendingSyncedTransaction<T>[] = [];
```

Defined in: [packages/db/src/collection.ts:215](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L215)

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`pendingSyncedTransactions`](../../classes/CollectionImpl.md#pendingsyncedtransactions)

***

### syncedData

```ts
syncedData: 
  | Map<TKey, T>
| SortedMap<TKey, T>;
```

Defined in: [packages/db/src/collection.ts:216](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L216)

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`syncedData`](../../classes/CollectionImpl.md#synceddata)

***

### syncedMetadata

```ts
syncedMetadata: Map<TKey, unknown>;
```

Defined in: [packages/db/src/collection.ts:217](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L217)

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`syncedMetadata`](../../classes/CollectionImpl.md#syncedmetadata)

***

### transactions

```ts
transactions: SortedMap<string, Transaction<any>>;
```

Defined in: [packages/db/src/collection.ts:214](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L214)

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`transactions`](../../classes/CollectionImpl.md#transactions)

***

### utils

```ts
readonly utils: TUtils;
```

Defined in: [packages/db/src/collection.ts:84](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L84)

#### Overrides

[`CollectionImpl`](../../classes/collectionimpl.md).[`utils`](../../classes/CollectionImpl.md#utils)

## Accessors

### indexes

#### Get Signature

```ts
get indexes(): Map<number, BaseIndex<TKey>>
```

Defined in: [packages/db/src/collection.ts:1439](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1439)

Get resolved indexes for query optimization

##### Returns

`Map`\<`number`, [`BaseIndex`](../../classes/baseindex.md)\<`TKey`\>\>

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`indexes`](../../classes/CollectionImpl.md#indexes)

***

### size

#### Get Signature

```ts
get size(): number
```

Defined in: [packages/db/src/collection.ts:995](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L995)

Get the current size of the collection (cached)

##### Returns

`number`

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`size`](../../classes/CollectionImpl.md#size)

***

### state

#### Get Signature

```ts
get state(): Map<TKey, T>
```

Defined in: [packages/db/src/collection.ts:2038](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L2038)

Gets the current state of the collection as a Map

##### Example

```ts
const itemsMap = collection.state
console.log(`Collection has ${itemsMap.size} items`)

for (const [key, item] of itemsMap) {
  console.log(`${key}: ${item.title}`)
}

// Check if specific item exists
if (itemsMap.has("todo-1")) {
  console.log("Todo 1 exists:", itemsMap.get("todo-1"))
}
```

##### Returns

`Map`\<`TKey`, `T`\>

Map containing all items in the collection, with keys as identifiers

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`state`](../../classes/CollectionImpl.md#state)

***

### status

#### Get Signature

```ts
get status(): CollectionStatus
```

Defined in: [packages/db/src/collection.ts:336](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L336)

Gets the current status of the collection

##### Returns

[`CollectionStatus`](../../type-aliases/collectionstatus.md)

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`status`](../../classes/CollectionImpl.md#status)

***

### toArray

#### Get Signature

```ts
get toArray(): T[]
```

Defined in: [packages/db/src/collection.ts:2071](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L2071)

Gets the current state of the collection as an Array

##### Returns

`T`[]

An Array containing all items in the collection

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`toArray`](../../classes/CollectionImpl.md#toarray)

## Methods

### \[iterator\]()

```ts
iterator: IterableIterator<[TKey, T]>
```

Defined in: [packages/db/src/collection.ts:1046](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1046)

Get all entries (virtual derived state)

#### Returns

`IterableIterator`\<\[`TKey`, `T`\]\>

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`[iterator]`](../../classes/CollectionImpl.md#iterator)

***

### cleanup()

```ts
cleanup(): Promise<void>
```

Defined in: [packages/db/src/collection.ts:583](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L583)

Clean up the collection by stopping sync and clearing data
This can be called manually or automatically by garbage collection

#### Returns

`Promise`\<`void`\>

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`cleanup`](../../classes/CollectionImpl.md#cleanup)

***

### commitPendingTransactions()

```ts
commitPendingTransactions(): void
```

Defined in: [packages/db/src/collection.ts:1082](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1082)

Attempts to commit pending synced transactions if there are no active transactions
This method processes operations from pending transactions and applies them to the synced data

#### Returns

`void`

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`commitPendingTransactions`](../../classes/CollectionImpl.md#commitpendingtransactions)

***

### createIndex()

```ts
createIndex<TResolver>(indexCallback, config): IndexProxy<TKey>
```

Defined in: [packages/db/src/collection.ts:1344](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1344)

Creates an index on a collection for faster queries.
Indexes significantly improve query performance by allowing binary search
and range queries instead of full scans.

#### Type Parameters

• **TResolver** *extends* [`IndexResolver`](../../type-aliases/indexresolver.md)\<`TKey`\> = *typeof* [`BTreeIndex`](../../classes/btreeindex.md)

The type of the index resolver (constructor or async loader)

#### Parameters

##### indexCallback

(`row`) => `any`

Function that extracts the indexed value from each item

##### config

[`IndexOptions`](../indexoptions.md)\<`TResolver`\> = `{}`

Configuration including index type and type-specific options

#### Returns

[`IndexProxy`](../../classes/indexproxy.md)\<`TKey`\>

An index proxy that provides access to the index when ready

#### Example

```ts
// Create a default B+ tree index
const ageIndex = collection.createIndex((row) => row.age)

// Create a ordered index with custom options
const ageIndex = collection.createIndex((row) => row.age, {
  indexType: BTreeIndex,
  options: { compareFn: customComparator },
  name: 'age_btree'
})

// Create an async-loaded index
const textIndex = collection.createIndex((row) => row.content, {
  indexType: async () => {
    const { FullTextIndex } = await import('./indexes/fulltext.js')
    return FullTextIndex
  },
  options: { language: 'en' }
})
```

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`createIndex`](../../classes/CollectionImpl.md#createindex)

***

### currentStateAsChanges()

```ts
currentStateAsChanges(options): ChangeMessage<T, string | number>[]
```

Defined in: [packages/db/src/collection.ts:2113](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L2113)

Returns the current state of the collection as an array of changes

#### Parameters

##### options

[`CurrentStateAsChangesOptions`](../currentstateaschangesoptions.md)\<`T`\> = `{}`

Options including optional where filter

#### Returns

[`ChangeMessage`](../changemessage.md)\<`T`, `string` \| `number`\>[]

An array of changes

#### Example

```ts
// Get all items as changes
const allChanges = collection.currentStateAsChanges()

// Get only items matching a condition
const activeChanges = collection.currentStateAsChanges({
  where: (row) => row.status === 'active'
})

// Get only items using a pre-compiled expression
const activeChanges = collection.currentStateAsChanges({
  whereExpression: eq(row.status, 'active')
})
```

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`currentStateAsChanges`](../../classes/CollectionImpl.md#currentstateaschanges)

***

### delete()

```ts
delete(keys, config?): Transaction<any>
```

Defined in: [packages/db/src/collection.ts:1939](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1939)

Deletes one or more items from the collection

#### Parameters

##### keys

Single key or array of keys to delete

`TKey` | `TKey`[]

##### config?

[`OperationConfig`](../operationconfig.md)

Optional configuration including metadata

#### Returns

[`Transaction`](../../classes/transaction.md)\<`any`\>

A Transaction object representing the delete operation(s)

#### Examples

```ts
// Delete a single item
const tx = collection.delete("todo-1")
await tx.isPersisted.promise
```

```ts
// Delete multiple items
const tx = collection.delete(["todo-1", "todo-2"])
await tx.isPersisted.promise
```

```ts
// Delete with metadata
const tx = collection.delete("todo-1", { metadata: { reason: "completed" } })
await tx.isPersisted.promise
```

```ts
// Handle errors
try {
  const tx = collection.delete("item-1")
  await tx.isPersisted.promise
  console.log('Delete successful')
} catch (error) {
  console.log('Delete failed:', error)
}
```

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`delete`](../../classes/CollectionImpl.md#delete)

***

### entries()

```ts
entries(): IterableIterator<[TKey, T]>
```

Defined in: [packages/db/src/collection.ts:1034](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1034)

Get all entries (virtual derived state)

#### Returns

`IterableIterator`\<\[`TKey`, `T`\]\>

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`entries`](../../classes/CollectionImpl.md#entries)

***

### forEach()

```ts
forEach(callbackfn): void
```

Defined in: [packages/db/src/collection.ts:1055](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1055)

Execute a callback for each entry in the collection

#### Parameters

##### callbackfn

(`value`, `key`, `index`) => `void`

#### Returns

`void`

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`forEach`](../../classes/CollectionImpl.md#foreach)

***

### generateGlobalKey()

```ts
generateGlobalKey(key, item): string
```

Defined in: [packages/db/src/collection.ts:1306](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1306)

#### Parameters

##### key

`any`

##### item

`any`

#### Returns

`string`

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`generateGlobalKey`](../../classes/CollectionImpl.md#generateglobalkey)

***

### get()

```ts
get(key): undefined | T
```

Defined in: [packages/db/src/collection.ts:959](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L959)

Get the current value for a key (virtual derived state)

#### Parameters

##### key

`TKey`

#### Returns

`undefined` \| `T`

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`get`](../../classes/CollectionImpl.md#get)

***

### getKeyFromItem()

```ts
getKeyFromItem(item): TKey
```

Defined in: [packages/db/src/collection.ts:1302](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1302)

#### Parameters

##### item

`T`

#### Returns

`TKey`

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`getKeyFromItem`](../../classes/CollectionImpl.md#getkeyfromitem)

***

### has()

```ts
has(key): boolean
```

Defined in: [packages/db/src/collection.ts:977](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L977)

Check if a key exists in the collection (virtual derived state)

#### Parameters

##### key

`TKey`

#### Returns

`boolean`

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`has`](../../classes/CollectionImpl.md#has)

***

### insert()

```ts
insert(data, config?): 
  | Transaction<Record<string, unknown>>
| Transaction<T>
```

Defined in: [packages/db/src/collection.ts:1594](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1594)

Inserts one or more items into the collection

#### Parameters

##### data

`TInsertInput` | `TInsertInput`[]

##### config?

[`InsertConfig`](../insertconfig.md)

Optional configuration including metadata

#### Returns

  \| [`Transaction`](../../classes/transaction.md)\<`Record`\<`string`, `unknown`\>\>
  \| [`Transaction`](../../classes/transaction.md)\<`T`\>

A Transaction object representing the insert operation(s)

#### Throws

If the data fails schema validation

#### Examples

```ts
// Insert a single todo (requires onInsert handler)
const tx = collection.insert({ id: "1", text: "Buy milk", completed: false })
await tx.isPersisted.promise
```

```ts
// Insert multiple todos at once
const tx = collection.insert([
  { id: "1", text: "Buy milk", completed: false },
  { id: "2", text: "Walk dog", completed: true }
])
await tx.isPersisted.promise
```

```ts
// Insert with metadata
const tx = collection.insert({ id: "1", text: "Buy groceries" },
  { metadata: { source: "mobile-app" } }
)
await tx.isPersisted.promise
```

```ts
// Handle errors
try {
  const tx = collection.insert({ id: "1", text: "New item" })
  await tx.isPersisted.promise
  console.log('Insert successful')
} catch (error) {
  console.log('Insert failed:', error)
}
```

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`insert`](../../classes/CollectionImpl.md#insert)

***

### isReady()

```ts
isReady(): boolean
```

Defined in: [packages/db/src/collection.ts:294](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L294)

Check if the collection is ready for use
Returns true if the collection has been marked as ready by its sync implementation

#### Returns

`boolean`

true if the collection is ready, false otherwise

#### Example

```ts
if (collection.isReady()) {
  console.log('Collection is ready, data is available')
  // Safe to access collection.state
} else {
  console.log('Collection is still loading')
}
```

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`isReady`](../../classes/CollectionImpl.md#isready)

***

### keys()

```ts
keys(): IterableIterator<TKey>
```

Defined in: [packages/db/src/collection.ts:1002](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1002)

Get all keys (virtual derived state)

#### Returns

`IterableIterator`\<`TKey`\>

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`keys`](../../classes/CollectionImpl.md#keys-1)

***

### map()

```ts
map<U>(callbackfn): U[]
```

Defined in: [packages/db/src/collection.ts:1067](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1067)

Create a new array with the results of calling a function for each entry in the collection

#### Type Parameters

• **U**

#### Parameters

##### callbackfn

(`value`, `key`, `index`) => `U`

#### Returns

`U`[]

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`map`](../../classes/CollectionImpl.md#map)

***

### onFirstReady()

```ts
onFirstReady(callback): void
```

Defined in: [packages/db/src/collection.ts:272](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L272)

Register a callback to be executed when the collection first becomes ready
Useful for preloading collections

#### Parameters

##### callback

() => `void`

Function to call when the collection first becomes ready

#### Returns

`void`

#### Example

```ts
collection.onFirstReady(() => {
  console.log('Collection is ready for the first time')
  // Safe to access collection.state now
})
```

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`onFirstReady`](../../classes/CollectionImpl.md#onfirstready)

***

### onTransactionStateChange()

```ts
onTransactionStateChange(): void
```

Defined in: [packages/db/src/collection.ts:2271](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L2271)

Trigger a recomputation when transactions change
This method should be called by the Transaction class when state changes

#### Returns

`void`

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`onTransactionStateChange`](../../classes/CollectionImpl.md#ontransactionstatechange)

***

### preload()

```ts
preload(): Promise<void>
```

Defined in: [packages/db/src/collection.ts:544](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L544)

Preload the collection data by starting sync if not already started
Multiple concurrent calls will share the same promise

#### Returns

`Promise`\<`void`\>

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`preload`](../../classes/CollectionImpl.md#preload)

***

### startSyncImmediate()

```ts
startSyncImmediate(): void
```

Defined in: [packages/db/src/collection.ts:450](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L450)

Start sync immediately - internal method for compiled queries
This bypasses lazy loading for special cases like live query results

#### Returns

`void`

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`startSyncImmediate`](../../classes/CollectionImpl.md#startsyncimmediate)

***

### stateWhenReady()

```ts
stateWhenReady(): Promise<Map<TKey, T>>
```

Defined in: [packages/db/src/collection.ts:2052](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L2052)

Gets the current state of the collection as a Map, but only resolves when data is available
Waits for the first sync commit to complete before resolving

#### Returns

`Promise`\<`Map`\<`TKey`, `T`\>\>

Promise that resolves to a Map containing all items in the collection

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`stateWhenReady`](../../classes/CollectionImpl.md#statewhenready)

***

### subscribeChanges()

```ts
subscribeChanges(callback, options): () => void
```

Defined in: [packages/db/src/collection.ts:2158](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L2158)

Subscribe to changes in the collection

#### Parameters

##### callback

(`changes`) => `void`

Function called when items change

##### options

[`SubscribeChangesOptions`](../subscribechangesoptions.md)\<`T`\> = `{}`

Subscription options including includeInitialState and where filter

#### Returns

`Function`

Unsubscribe function - Call this to stop listening for changes

##### Returns

`void`

#### Examples

```ts
// Basic subscription
const unsubscribe = collection.subscribeChanges((changes) => {
  changes.forEach(change => {
    console.log(`${change.type}: ${change.key}`, change.value)
  })
})

// Later: unsubscribe()
```

```ts
// Include current state immediately
const unsubscribe = collection.subscribeChanges((changes) => {
  updateUI(changes)
}, { includeInitialState: true })
```

```ts
// Subscribe only to changes matching a condition
const unsubscribe = collection.subscribeChanges((changes) => {
  updateUI(changes)
}, {
  includeInitialState: true,
  where: (row) => row.status === 'active'
})
```

```ts
// Subscribe using a pre-compiled expression
const unsubscribe = collection.subscribeChanges((changes) => {
  updateUI(changes)
}, {
  includeInitialState: true,
  whereExpression: eq(row.status, 'active')
})
```

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`subscribeChanges`](../../classes/CollectionImpl.md#subscribechanges)

***

### subscribeChangesKey()

```ts
subscribeChangesKey(
   key, 
   listener, 
   __namedParameters): () => void
```

Defined in: [packages/db/src/collection.ts:2197](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L2197)

Subscribe to changes for a specific key

#### Parameters

##### key

`TKey`

##### listener

[`ChangeListener`](../../type-aliases/changelistener.md)\<`T`, `TKey`\>

##### \_\_namedParameters

###### includeInitialState?

`boolean` = `false`

#### Returns

`Function`

##### Returns

`void`

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`subscribeChangesKey`](../../classes/CollectionImpl.md#subscribechangeskey)

***

### toArrayWhenReady()

```ts
toArrayWhenReady(): Promise<T[]>
```

Defined in: [packages/db/src/collection.ts:2081](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L2081)

Gets the current state of the collection as an Array, but only resolves when data is available
Waits for the first sync commit to complete before resolving

#### Returns

`Promise`\<`T`[]\>

Promise that resolves to an Array containing all items in the collection

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`toArrayWhenReady`](../../classes/CollectionImpl.md#toarraywhenready)

***

### update()

#### Call Signature

```ts
update<TItem>(key, callback): Transaction
```

Defined in: [packages/db/src/collection.ts:1725](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1725)

Updates one or more items in the collection using a callback function

##### Type Parameters

• **TItem** *extends* `object` = `T`

##### Parameters

###### key

`unknown`[]

###### callback

(`drafts`) => `void`

##### Returns

[`Transaction`](../../classes/transaction.md)

A Transaction object representing the update operation(s)

##### Throws

If the updated data fails schema validation

##### Examples

```ts
// Update single item by key
const tx = collection.update("todo-1", (draft) => {
  draft.completed = true
})
await tx.isPersisted.promise
```

```ts
// Update multiple items
const tx = collection.update(["todo-1", "todo-2"], (drafts) => {
  drafts.forEach(draft => { draft.completed = true })
})
await tx.isPersisted.promise
```

```ts
// Update with metadata
const tx = collection.update("todo-1",
  { metadata: { reason: "user update" } },
  (draft) => { draft.text = "Updated text" }
)
await tx.isPersisted.promise
```

```ts
// Handle errors
try {
  const tx = collection.update("item-1", draft => { draft.value = "new" })
  await tx.isPersisted.promise
  console.log('Update successful')
} catch (error) {
  console.log('Update failed:', error)
}
```

##### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`update`](../../classes/CollectionImpl.md#update)

#### Call Signature

```ts
update<TItem>(
   keys, 
   config, 
   callback): Transaction
```

Defined in: [packages/db/src/collection.ts:1731](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1731)

Updates one or more items in the collection using a callback function

##### Type Parameters

• **TItem** *extends* `object` = `T`

##### Parameters

###### keys

`unknown`[]

Single key or array of keys to update

###### config

[`OperationConfig`](../operationconfig.md)

###### callback

(`drafts`) => `void`

##### Returns

[`Transaction`](../../classes/transaction.md)

A Transaction object representing the update operation(s)

##### Throws

If the updated data fails schema validation

##### Examples

```ts
// Update single item by key
const tx = collection.update("todo-1", (draft) => {
  draft.completed = true
})
await tx.isPersisted.promise
```

```ts
// Update multiple items
const tx = collection.update(["todo-1", "todo-2"], (drafts) => {
  drafts.forEach(draft => { draft.completed = true })
})
await tx.isPersisted.promise
```

```ts
// Update with metadata
const tx = collection.update("todo-1",
  { metadata: { reason: "user update" } },
  (draft) => { draft.text = "Updated text" }
)
await tx.isPersisted.promise
```

```ts
// Handle errors
try {
  const tx = collection.update("item-1", draft => { draft.value = "new" })
  await tx.isPersisted.promise
  console.log('Update successful')
} catch (error) {
  console.log('Update failed:', error)
}
```

##### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`update`](../../classes/CollectionImpl.md#update)

#### Call Signature

```ts
update<TItem>(id, callback): Transaction
```

Defined in: [packages/db/src/collection.ts:1738](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1738)

Updates one or more items in the collection using a callback function

##### Type Parameters

• **TItem** *extends* `object` = `T`

##### Parameters

###### id

`unknown`

###### callback

(`draft`) => `void`

##### Returns

[`Transaction`](../../classes/transaction.md)

A Transaction object representing the update operation(s)

##### Throws

If the updated data fails schema validation

##### Examples

```ts
// Update single item by key
const tx = collection.update("todo-1", (draft) => {
  draft.completed = true
})
await tx.isPersisted.promise
```

```ts
// Update multiple items
const tx = collection.update(["todo-1", "todo-2"], (drafts) => {
  drafts.forEach(draft => { draft.completed = true })
})
await tx.isPersisted.promise
```

```ts
// Update with metadata
const tx = collection.update("todo-1",
  { metadata: { reason: "user update" } },
  (draft) => { draft.text = "Updated text" }
)
await tx.isPersisted.promise
```

```ts
// Handle errors
try {
  const tx = collection.update("item-1", draft => { draft.value = "new" })
  await tx.isPersisted.promise
  console.log('Update successful')
} catch (error) {
  console.log('Update failed:', error)
}
```

##### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`update`](../../classes/CollectionImpl.md#update)

#### Call Signature

```ts
update<TItem>(
   id, 
   config, 
   callback): Transaction
```

Defined in: [packages/db/src/collection.ts:1744](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1744)

Updates one or more items in the collection using a callback function

##### Type Parameters

• **TItem** *extends* `object` = `T`

##### Parameters

###### id

`unknown`

###### config

[`OperationConfig`](../operationconfig.md)

###### callback

(`draft`) => `void`

##### Returns

[`Transaction`](../../classes/transaction.md)

A Transaction object representing the update operation(s)

##### Throws

If the updated data fails schema validation

##### Examples

```ts
// Update single item by key
const tx = collection.update("todo-1", (draft) => {
  draft.completed = true
})
await tx.isPersisted.promise
```

```ts
// Update multiple items
const tx = collection.update(["todo-1", "todo-2"], (drafts) => {
  drafts.forEach(draft => { draft.completed = true })
})
await tx.isPersisted.promise
```

```ts
// Update with metadata
const tx = collection.update("todo-1",
  { metadata: { reason: "user update" } },
  (draft) => { draft.text = "Updated text" }
)
await tx.isPersisted.promise
```

```ts
// Handle errors
try {
  const tx = collection.update("item-1", draft => { draft.value = "new" })
  await tx.isPersisted.promise
  console.log('Update successful')
} catch (error) {
  console.log('Update failed:', error)
}
```

##### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`update`](../../classes/CollectionImpl.md#update)

***

### values()

```ts
values(): IterableIterator<T>
```

Defined in: [packages/db/src/collection.ts:1022](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1022)

Get all values (virtual derived state)

#### Returns

`IterableIterator`\<`T`\>

#### Inherited from

[`CollectionImpl`](../../classes/collectionimpl.md).[`values`](../../classes/CollectionImpl.md#values)
---
id: LocalOnlyCollectionConfig
title: LocalOnlyCollectionConfig
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: LocalOnlyCollectionConfig\<TExplicit, TSchema, TFallback, TKey\>

Defined in: [packages/db/src/local-only.ts:27](https://github.com/TanStack/db/blob/main/packages/db/src/local-only.ts#L27)

Configuration interface for Local-only collection options

## Remarks

Type resolution follows a priority order:
1. If you provide an explicit type via generic parameter, it will be used
2. If no explicit type is provided but a schema is, the schema's output type will be inferred
3. If neither explicit type nor schema is provided, the fallback type will be used

You should provide EITHER an explicit type OR a schema, but not both, as they would conflict.

## Type Parameters

• **TExplicit** = `unknown`

The explicit type of items in the collection (highest priority)

• **TSchema** *extends* `StandardSchemaV1` = `never`

The schema type for validation and type inference (second priority)

• **TFallback** *extends* `Record`\<`string`, `unknown`\> = `Record`\<`string`, `unknown`\>

The fallback type if no explicit or schema type is provided

• **TKey** *extends* `string` \| `number` = `string` \| `number`

The type of the key returned by getKey

## Properties

### getKey()

```ts
getKey: (item) => TKey;
```

Defined in: [packages/db/src/local-only.ts:38](https://github.com/TanStack/db/blob/main/packages/db/src/local-only.ts#L38)

#### Parameters

##### item

[`ResolveType`](../../type-aliases/resolvetype.md)\<`TExplicit`, `TSchema`, `TFallback`\>

#### Returns

`TKey`

***

### id?

```ts
optional id: string;
```

Defined in: [packages/db/src/local-only.ts:36](https://github.com/TanStack/db/blob/main/packages/db/src/local-only.ts#L36)

Standard Collection configuration properties

***

### initialData?

```ts
optional initialData: ResolveType<TExplicit, TSchema, TFallback>[];
```

Defined in: [packages/db/src/local-only.ts:44](https://github.com/TanStack/db/blob/main/packages/db/src/local-only.ts#L44)

Optional initial data to populate the collection with on creation
This data will be applied during the initial sync process

***

### onDelete()?

```ts
optional onDelete: (params) => Promise<any>;
```

Defined in: [packages/db/src/local-only.ts:77](https://github.com/TanStack/db/blob/main/packages/db/src/local-only.ts#L77)

Optional asynchronous handler function called after a delete operation

#### Parameters

##### params

[`DeleteMutationFnParams`](../../type-aliases/deletemutationfnparams.md)\<[`ResolveType`](../../type-aliases/resolvetype.md)\<`TExplicit`, `TSchema`, `TFallback`\>, `TKey`, [`LocalOnlyCollectionUtils`](../localonlycollectionutils.md)\>

Object containing transaction and collection information

#### Returns

`Promise`\<`any`\>

Promise resolving to any value

***

### onInsert()?

```ts
optional onInsert: (params) => Promise<any>;
```

Defined in: [packages/db/src/local-only.ts:51](https://github.com/TanStack/db/blob/main/packages/db/src/local-only.ts#L51)

Optional asynchronous handler function called after an insert operation

#### Parameters

##### params

[`InsertMutationFnParams`](../../type-aliases/insertmutationfnparams.md)\<[`ResolveType`](../../type-aliases/resolvetype.md)\<`TExplicit`, `TSchema`, `TFallback`\>, `TKey`, [`LocalOnlyCollectionUtils`](../localonlycollectionutils.md)\>

Object containing transaction and collection information

#### Returns

`Promise`\<`any`\>

Promise resolving to any value

***

### onUpdate()?

```ts
optional onUpdate: (params) => Promise<any>;
```

Defined in: [packages/db/src/local-only.ts:64](https://github.com/TanStack/db/blob/main/packages/db/src/local-only.ts#L64)

Optional asynchronous handler function called after an update operation

#### Parameters

##### params

[`UpdateMutationFnParams`](../../type-aliases/updatemutationfnparams.md)\<[`ResolveType`](../../type-aliases/resolvetype.md)\<`TExplicit`, `TSchema`, `TFallback`\>, `TKey`, [`LocalOnlyCollectionUtils`](../localonlycollectionutils.md)\>

Object containing transaction and collection information

#### Returns

`Promise`\<`any`\>

Promise resolving to any value

***

### schema?

```ts
optional schema: TSchema;
```

Defined in: [packages/db/src/local-only.ts:37](https://github.com/TanStack/db/blob/main/packages/db/src/local-only.ts#L37)
---
id: SubscribeChangesOptions
title: SubscribeChangesOptions
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: SubscribeChangesOptions\<T\>

Defined in: [packages/db/src/types.ts:573](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L573)

Options for subscribing to collection changes

## Type Parameters

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>

## Properties

### includeInitialState?

```ts
optional includeInitialState: boolean;
```

Defined in: [packages/db/src/types.ts:577](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L577)

Whether to include the current state as initial changes

***

### where()?

```ts
optional where: (row) => any;
```

Defined in: [packages/db/src/types.ts:579](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L579)

Filter changes using a where expression

#### Parameters

##### row

`SingleRowRefProxy`\<`T`\>

#### Returns

`any`

***

### whereExpression?

```ts
optional whereExpression: BasicExpression<boolean>;
```

Defined in: [packages/db/src/types.ts:581](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L581)

Pre-compiled expression for filtering changes
---
id: CurrentStateAsChangesOptions
title: CurrentStateAsChangesOptions
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: CurrentStateAsChangesOptions\<T\>

Defined in: [packages/db/src/types.ts:587](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L587)

Options for getting current state as changes

## Type Parameters

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>

## Properties

### where()?

```ts
optional where: (row) => any;
```

Defined in: [packages/db/src/types.ts:591](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L591)

Filter the current state using a where expression

#### Parameters

##### row

`SingleRowRefProxy`\<`T`\>

#### Returns

`any`

***

### whereExpression?

```ts
optional whereExpression: BasicExpression<boolean>;
```

Defined in: [packages/db/src/types.ts:593](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L593)

Pre-compiled expression for filtering the current state
---
id: LocalStorageCollectionConfig
title: LocalStorageCollectionConfig
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: LocalStorageCollectionConfig\<TExplicit, TSchema, TFallback\>

Defined in: [packages/db/src/local-storage.ts:61](https://github.com/TanStack/db/blob/main/packages/db/src/local-storage.ts#L61)

Configuration interface for localStorage collection options

## Remarks

Type resolution follows a priority order:
1. If you provide an explicit type via generic parameter, it will be used
2. If no explicit type is provided but a schema is, the schema's output type will be inferred
3. If neither explicit type nor schema is provided, the fallback type will be used

You should provide EITHER an explicit type OR a schema, but not both, as they would conflict.

## Type Parameters

• **TExplicit** = `unknown`

The explicit type of items in the collection (highest priority)

• **TSchema** *extends* `StandardSchemaV1` = `never`

The schema type for validation and type inference (second priority)

• **TFallback** *extends* `object` = `Record`\<`string`, `unknown`\>

The fallback type if no explicit or schema type is provided

## Properties

### getKey()

```ts
getKey: (item) => string | number;
```

Defined in: [packages/db/src/local-storage.ts:88](https://github.com/TanStack/db/blob/main/packages/db/src/local-storage.ts#L88)

#### Parameters

##### item

[`ResolveType`](../../type-aliases/resolvetype.md)

#### Returns

`string` \| `number`

***

### id?

```ts
optional id: string;
```

Defined in: [packages/db/src/local-storage.ts:86](https://github.com/TanStack/db/blob/main/packages/db/src/local-storage.ts#L86)

Collection identifier (defaults to "local-collection:{storageKey}" if not provided)

***

### onDelete()?

```ts
optional onDelete: (params) => Promise<any>;
```

Defined in: [packages/db/src/local-storage.ts:114](https://github.com/TanStack/db/blob/main/packages/db/src/local-storage.ts#L114)

Optional asynchronous handler function called before a delete operation

#### Parameters

##### params

[`DeleteMutationFnParams`](../../type-aliases/deletemutationfnparams.md)\<[`ResolveType`](../../type-aliases/resolvetype.md)\<`TExplicit`, `TSchema`, `TFallback`\>\>

Object containing transaction and collection information

#### Returns

`Promise`\<`any`\>

Promise resolving to any value

***

### onInsert()?

```ts
optional onInsert: (params) => Promise<any>;
```

Defined in: [packages/db/src/local-storage.ts:96](https://github.com/TanStack/db/blob/main/packages/db/src/local-storage.ts#L96)

Optional asynchronous handler function called before an insert operation

#### Parameters

##### params

[`InsertMutationFnParams`](../../type-aliases/insertmutationfnparams.md)\<[`ResolveType`](../../type-aliases/resolvetype.md)\<`TExplicit`, `TSchema`, `TFallback`\>\>

Object containing transaction and collection information

#### Returns

`Promise`\<`any`\>

Promise resolving to any value

***

### onUpdate()?

```ts
optional onUpdate: (params) => Promise<any>;
```

Defined in: [packages/db/src/local-storage.ts:105](https://github.com/TanStack/db/blob/main/packages/db/src/local-storage.ts#L105)

Optional asynchronous handler function called before an update operation

#### Parameters

##### params

[`UpdateMutationFnParams`](../../type-aliases/updatemutationfnparams.md)\<[`ResolveType`](../../type-aliases/resolvetype.md)\<`TExplicit`, `TSchema`, `TFallback`\>\>

Object containing transaction and collection information

#### Returns

`Promise`\<`any`\>

Promise resolving to any value

***

### schema?

```ts
optional schema: TSchema;
```

Defined in: [packages/db/src/local-storage.ts:87](https://github.com/TanStack/db/blob/main/packages/db/src/local-storage.ts#L87)

***

### storage?

```ts
optional storage: StorageApi;
```

Defined in: [packages/db/src/local-storage.ts:75](https://github.com/TanStack/db/blob/main/packages/db/src/local-storage.ts#L75)

Storage API to use (defaults to window.localStorage)
Can be any object that implements the Storage interface (e.g., sessionStorage)

***

### storageEventApi?

```ts
optional storageEventApi: StorageEventApi;
```

Defined in: [packages/db/src/local-storage.ts:81](https://github.com/TanStack/db/blob/main/packages/db/src/local-storage.ts#L81)

Storage event API to use for cross-tab synchronization (defaults to window)
Can be any object that implements addEventListener/removeEventListener for storage events

***

### storageKey

```ts
storageKey: string;
```

Defined in: [packages/db/src/local-storage.ts:69](https://github.com/TanStack/db/blob/main/packages/db/src/local-storage.ts#L69)

The key to use for storing the collection data in localStorage/sessionStorage

***

### sync?

```ts
optional sync: SyncConfig<ResolveType<TExplicit, TSchema, TFallback>, string | number>;
```

Defined in: [packages/db/src/local-storage.ts:89](https://github.com/TanStack/db/blob/main/packages/db/src/local-storage.ts#L89)
---
id: ChangeMessage
title: ChangeMessage
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: ChangeMessage\<T, TKey\>

Defined in: [packages/db/src/types.ts:228](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L228)

## Extended by

- [`OptimisticChangeMessage`](../optimisticchangemessage.md)

## Type Parameters

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>

• **TKey** *extends* `string` \| `number` = `string` \| `number`

## Properties

### key

```ts
key: TKey;
```

Defined in: [packages/db/src/types.ts:232](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L232)

***

### metadata?

```ts
optional metadata: Record<string, unknown>;
```

Defined in: [packages/db/src/types.ts:236](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L236)

***

### previousValue?

```ts
optional previousValue: T;
```

Defined in: [packages/db/src/types.ts:234](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L234)

***

### type

```ts
type: OperationType;
```

Defined in: [packages/db/src/types.ts:235](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L235)

***

### value

```ts
value: T;
```

Defined in: [packages/db/src/types.ts:233](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L233)
---
id: CollectionConfig
title: CollectionConfig
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: CollectionConfig\<T, TKey, TSchema, TInsertInput\>

Defined in: [packages/db/src/types.ts:349](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L349)

## Type Parameters

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>

• **TKey** *extends* `string` \| `number` = `string` \| `number`

• **TSchema** *extends* `StandardSchemaV1` = `StandardSchemaV1`

• **TInsertInput** *extends* `object` = `T`

## Properties

### autoIndex?

```ts
optional autoIndex: "off" | "eager";
```

Defined in: [packages/db/src/types.ts:388](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L388)

Auto-indexing mode for the collection.
When enabled, indexes will be automatically created for simple where expressions.

#### Default

```ts
"eager"
```

#### Description

- "off": No automatic indexing
- "eager": Automatically create indexes for simple where expressions in subscribeChanges (default)

***

### compare()?

```ts
optional compare: (x, y) => number;
```

Defined in: [packages/db/src/types.ts:399](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L399)

Optional function to compare two items.
This is used to order the items in the collection.

#### Parameters

##### x

`T`

The first item to compare

##### y

`T`

The second item to compare

#### Returns

`number`

A number indicating the order of the items

#### Example

```ts
// For a collection with a 'createdAt' field
compare: (x, y) => x.createdAt.getTime() - y.createdAt.getTime()
```

***

### gcTime?

```ts
optional gcTime: number;
```

Defined in: [packages/db/src/types.ts:374](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L374)

Time in milliseconds after which the collection will be garbage collected
when it has no active subscribers. Defaults to 5 minutes (300000ms).

***

### getKey()

```ts
getKey: (item) => TKey;
```

Defined in: [packages/db/src/types.ts:369](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L369)

Function to extract the ID from an object
This is required for update/delete operations which now only accept IDs

#### Parameters

##### item

`T`

The item to extract the ID from

#### Returns

`TKey`

The ID string for the item

#### Example

```ts
// For a collection with a 'uuid' field as the primary key
getKey: (item) => item.uuid
```

***

### id?

```ts
optional id: string;
```

Defined in: [packages/db/src/types.ts:357](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L357)

***

### onDelete?

```ts
optional onDelete: DeleteMutationFn<T, TKey, Record<string, Fn>>;
```

Defined in: [packages/db/src/types.ts:528](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L528)

Optional asynchronous handler function called before a delete operation

#### Param

Object containing transaction and collection information

#### Returns

Promise resolving to any value

#### Examples

```ts
// Basic delete handler
onDelete: async ({ transaction, collection }) => {
  const deletedKey = transaction.mutations[0].key
  await api.deleteTodo(deletedKey)
}
```

```ts
// Delete handler with multiple items
onDelete: async ({ transaction, collection }) => {
  const keysToDelete = transaction.mutations.map(m => m.key)
  await api.deleteTodos(keysToDelete)
}
```

```ts
// Delete handler with confirmation
onDelete: async ({ transaction, collection }) => {
  const mutation = transaction.mutations[0]
  const shouldDelete = await confirmDeletion(mutation.original)
  if (!shouldDelete) {
    throw new Error('Delete cancelled by user')
  }
  await api.deleteTodo(mutation.original.id)
}
```

```ts
// Delete handler with optimistic rollback
onDelete: async ({ transaction, collection }) => {
  const mutation = transaction.mutations[0]
  try {
    await api.deleteTodo(mutation.original.id)
  } catch (error) {
    // Transaction will automatically rollback optimistic changes
    console.error('Delete failed, rolling back:', error)
    throw error
  }
}
```

***

### onInsert?

```ts
optional onInsert: InsertMutationFn<TInsertInput, TKey, Record<string, Fn>>;
```

Defined in: [packages/db/src/types.ts:441](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L441)

Optional asynchronous handler function called before an insert operation

#### Param

Object containing transaction and collection information

#### Returns

Promise resolving to any value

#### Examples

```ts
// Basic insert handler
onInsert: async ({ transaction, collection }) => {
  const newItem = transaction.mutations[0].modified
  await api.createTodo(newItem)
}
```

```ts
// Insert handler with multiple items
onInsert: async ({ transaction, collection }) => {
  const items = transaction.mutations.map(m => m.modified)
  await api.createTodos(items)
}
```

```ts
// Insert handler with error handling
onInsert: async ({ transaction, collection }) => {
  try {
    const newItem = transaction.mutations[0].modified
    const result = await api.createTodo(newItem)
    return result
  } catch (error) {
    console.error('Insert failed:', error)
    throw error // This will cause the transaction to fail
  }
}
```

```ts
// Insert handler with metadata
onInsert: async ({ transaction, collection }) => {
  const mutation = transaction.mutations[0]
  await api.createTodo(mutation.modified, {
    source: mutation.metadata?.source,
    timestamp: mutation.createdAt
  })
}
```

***

### onUpdate?

```ts
optional onUpdate: UpdateMutationFn<T, TKey, Record<string, Fn>>;
```

Defined in: [packages/db/src/types.ts:485](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L485)

Optional asynchronous handler function called before an update operation

#### Param

Object containing transaction and collection information

#### Returns

Promise resolving to any value

#### Examples

```ts
// Basic update handler
onUpdate: async ({ transaction, collection }) => {
  const updatedItem = transaction.mutations[0].modified
  await api.updateTodo(updatedItem.id, updatedItem)
}
```

```ts
// Update handler with partial updates
onUpdate: async ({ transaction, collection }) => {
  const mutation = transaction.mutations[0]
  const changes = mutation.changes // Only the changed fields
  await api.updateTodo(mutation.original.id, changes)
}
```

```ts
// Update handler with multiple items
onUpdate: async ({ transaction, collection }) => {
  const updates = transaction.mutations.map(m => ({
    id: m.key,
    changes: m.changes
  }))
  await api.updateTodos(updates)
}
```

```ts
// Update handler with optimistic rollback
onUpdate: async ({ transaction, collection }) => {
  const mutation = transaction.mutations[0]
  try {
    await api.updateTodo(mutation.original.id, mutation.changes)
  } catch (error) {
    // Transaction will automatically rollback optimistic changes
    console.error('Update failed, rolling back:', error)
    throw error
  }
}
```

***

### schema?

```ts
optional schema: TSchema;
```

Defined in: [packages/db/src/types.ts:359](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L359)

***

### startSync?

```ts
optional startSync: boolean;
```

Defined in: [packages/db/src/types.ts:379](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L379)

Whether to start syncing immediately when the collection is created.
Defaults to false for lazy loading. Set to true to immediately sync.

***

### sync

```ts
sync: SyncConfig<T, TKey>;
```

Defined in: [packages/db/src/types.ts:358](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L358)
---
id: LiveQueryCollectionConfig
title: LiveQueryCollectionConfig
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: LiveQueryCollectionConfig\<TContext, TResult\>

Defined in: [packages/db/src/query/live-query-collection.ts:47](https://github.com/TanStack/db/blob/main/packages/db/src/query/live-query-collection.ts#L47)

Configuration interface for live query collection options

## Example

```typescript
const config: LiveQueryCollectionConfig<any, any> = {
  // id is optional - will auto-generate "live-query-1", "live-query-2", etc.
  query: (q) => q
    .from({ comment: commentsCollection })
    .join(
      { user: usersCollection },
      ({ comment, user }) => eq(comment.user_id, user.id)
    )
    .where(({ comment }) => eq(comment.active, true))
    .select(({ comment, user }) => ({
      id: comment.id,
      content: comment.content,
      authorName: user.name,
    })),
  // getKey is optional - defaults to using stream key
  getKey: (item) => item.id,
}
```

## Type Parameters

• **TContext** *extends* [`Context`](../context.md)

• **TResult** *extends* `object` = [`GetResult`](../../type-aliases/getresult.md)\<`TContext`\> & `object`

## Properties

### gcTime?

```ts
optional gcTime: number;
```

Defined in: [packages/db/src/query/live-query-collection.ts:90](https://github.com/TanStack/db/blob/main/packages/db/src/query/live-query-collection.ts#L90)

GC time for the collection

***

### getKey()?

```ts
optional getKey: (item) => string | number;
```

Defined in: [packages/db/src/query/live-query-collection.ts:68](https://github.com/TanStack/db/blob/main/packages/db/src/query/live-query-collection.ts#L68)

Function to extract the key from result items
If not provided, defaults to using the key from the D2 stream

#### Parameters

##### item

`TResult`

#### Returns

`string` \| `number`

***

### id?

```ts
optional id: string;
```

Defined in: [packages/db/src/query/live-query-collection.ts:55](https://github.com/TanStack/db/blob/main/packages/db/src/query/live-query-collection.ts#L55)

Unique identifier for the collection
If not provided, defaults to `live-query-${number}` with auto-incrementing number

***

### onDelete?

```ts
optional onDelete: DeleteMutationFn<TResult, string | number, Record<string, Fn>>;
```

Defined in: [packages/db/src/query/live-query-collection.ts:80](https://github.com/TanStack/db/blob/main/packages/db/src/query/live-query-collection.ts#L80)

***

### onInsert?

```ts
optional onInsert: InsertMutationFn<TResult, string | number, Record<string, Fn>>;
```

Defined in: [packages/db/src/query/live-query-collection.ts:78](https://github.com/TanStack/db/blob/main/packages/db/src/query/live-query-collection.ts#L78)

Optional mutation handlers

***

### onUpdate?

```ts
optional onUpdate: UpdateMutationFn<TResult, string | number, Record<string, Fn>>;
```

Defined in: [packages/db/src/query/live-query-collection.ts:79](https://github.com/TanStack/db/blob/main/packages/db/src/query/live-query-collection.ts#L79)

***

### query

```ts
query: 
  | QueryBuilder<TContext>
| (q) => QueryBuilder<TContext>;
```

Defined in: [packages/db/src/query/live-query-collection.ts:60](https://github.com/TanStack/db/blob/main/packages/db/src/query/live-query-collection.ts#L60)

Query builder function that defines the live query

***

### schema?

```ts
optional schema: StandardSchemaV1<unknown, unknown>;
```

Defined in: [packages/db/src/query/live-query-collection.ts:73](https://github.com/TanStack/db/blob/main/packages/db/src/query/live-query-collection.ts#L73)

Optional schema for validation

***

### startSync?

```ts
optional startSync: boolean;
```

Defined in: [packages/db/src/query/live-query-collection.ts:85](https://github.com/TanStack/db/blob/main/packages/db/src/query/live-query-collection.ts#L85)

Start sync / the query immediately
---
id: LocalOnlyCollectionUtils
title: LocalOnlyCollectionUtils
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: LocalOnlyCollectionUtils

Defined in: [packages/db/src/local-only.ts:89](https://github.com/TanStack/db/blob/main/packages/db/src/local-only.ts#L89)

Local-only collection utilities type (currently empty but matches the pattern)

## Extends

- [`UtilsRecord`](../../type-aliases/utilsrecord.md)

## Indexable

```ts
[key: string]: Fn
```
---
id: LocalStorageCollectionUtils
title: LocalStorageCollectionUtils
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: LocalStorageCollectionUtils

Defined in: [packages/db/src/local-storage.ts:132](https://github.com/TanStack/db/blob/main/packages/db/src/local-storage.ts#L132)

LocalStorage collection utilities type

## Extends

- [`UtilsRecord`](../../type-aliases/utilsrecord.md)

## Indexable

```ts
[key: string]: Fn
```

## Properties

### clearStorage

```ts
clearStorage: ClearStorageFn;
```

Defined in: [packages/db/src/local-storage.ts:133](https://github.com/TanStack/db/blob/main/packages/db/src/local-storage.ts#L133)

***

### getStorageSize

```ts
getStorageSize: GetStorageSizeFn;
```

Defined in: [packages/db/src/local-storage.ts:134](https://github.com/TanStack/db/blob/main/packages/db/src/local-storage.ts#L134)
---
id: IndexOptions
title: IndexOptions
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: IndexOptions\<TResolver\>

Defined in: [packages/db/src/indexes/index-options.ts:6](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/index-options.ts#L6)

Enhanced index options that support both sync and async resolvers

## Type Parameters

• **TResolver** *extends* [`IndexResolver`](../../type-aliases/indexresolver.md) = [`IndexResolver`](../../type-aliases/indexresolver.md)

## Properties

### indexType?

```ts
optional indexType: TResolver;
```

Defined in: [packages/db/src/indexes/index-options.ts:8](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/index-options.ts#L8)

***

### name?

```ts
optional name: string;
```

Defined in: [packages/db/src/indexes/index-options.ts:7](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/index-options.ts#L7)

***

### options?

```ts
optional options: TResolver extends IndexConstructor<any> ? TResolver<TResolver> extends (id, expr, name?, options?) => any ? O : never : TResolver extends () => Promise<TCtor> ? TCtor extends (id, expr, name?, options?) => any ? O : never : never;
```

Defined in: [packages/db/src/indexes/index-options.ts:9](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/index-options.ts#L9)
---
id: Context
title: Context
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: Context

Defined in: [packages/db/src/query/builder/types.ts:5](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/types.ts#L5)

## Properties

### baseSchema

```ts
baseSchema: ContextSchema;
```

Defined in: [packages/db/src/query/builder/types.ts:7](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/types.ts#L7)

***

### fromSourceName

```ts
fromSourceName: string;
```

Defined in: [packages/db/src/query/builder/types.ts:11](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/types.ts#L11)

***

### hasJoins?

```ts
optional hasJoins: boolean;
```

Defined in: [packages/db/src/query/builder/types.ts:13](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/types.ts#L13)

***

### joinTypes?

```ts
optional joinTypes: Record<string, "full" | "left" | "right" | "inner" | "outer" | "cross">;
```

Defined in: [packages/db/src/query/builder/types.ts:15](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/types.ts#L15)

***

### result?

```ts
optional result: any;
```

Defined in: [packages/db/src/query/builder/types.ts:20](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/types.ts#L20)

***

### schema

```ts
schema: ContextSchema;
```

Defined in: [packages/db/src/query/builder/types.ts:9](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/types.ts#L9)
---
id: IndexStats
title: IndexStats
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: IndexStats

Defined in: [packages/db/src/indexes/base-index.ts:18](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L18)

Statistics about index usage and performance

## Properties

### averageLookupTime

```ts
readonly averageLookupTime: number;
```

Defined in: [packages/db/src/indexes/base-index.ts:21](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L21)

***

### entryCount

```ts
readonly entryCount: number;
```

Defined in: [packages/db/src/indexes/base-index.ts:19](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L19)

***

### lastUpdated

```ts
readonly lastUpdated: Date;
```

Defined in: [packages/db/src/indexes/base-index.ts:22](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L22)

***

### lookupCount

```ts
readonly lookupCount: number;
```

Defined in: [packages/db/src/indexes/base-index.ts:20](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L20)
---
id: PendingMutation
title: PendingMutation
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: PendingMutation\<T, TOperation, TCollection\>

Defined in: [packages/db/src/types.ts:103](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L103)

Represents a pending mutation within a transaction
Contains information about the original and modified data, as well as metadata

## Type Parameters

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>

• **TOperation** *extends* [`OperationType`](../../type-aliases/operationtype.md) = [`OperationType`](../../type-aliases/operationtype.md)

• **TCollection** *extends* [`Collection`](../collection.md)\<`T`, `any`, `any`, `any`, `any`\> = [`Collection`](../collection.md)\<`T`, `any`, `any`, `any`, `any`\>

## Properties

### changes

```ts
changes: ResolveTransactionChanges<T, TOperation>;
```

Defined in: [packages/db/src/types.ts:120](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L120)

***

### collection

```ts
collection: TCollection;
```

Defined in: [packages/db/src/types.ts:131](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L131)

***

### createdAt

```ts
createdAt: Date;
```

Defined in: [packages/db/src/types.ts:129](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L129)

***

### globalKey

```ts
globalKey: string;
```

Defined in: [packages/db/src/types.ts:121](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L121)

***

### key

```ts
key: any;
```

Defined in: [packages/db/src/types.ts:123](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L123)

***

### metadata

```ts
metadata: unknown;
```

Defined in: [packages/db/src/types.ts:125](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L125)

***

### modified

```ts
modified: T;
```

Defined in: [packages/db/src/types.ts:118](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L118)

***

### mutationId

```ts
mutationId: string;
```

Defined in: [packages/db/src/types.ts:114](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L114)

***

### optimistic

```ts
optimistic: boolean;
```

Defined in: [packages/db/src/types.ts:128](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L128)

Whether this mutation should be applied optimistically (defaults to true)

***

### original

```ts
original: TOperation extends "insert" ? object : T;
```

Defined in: [packages/db/src/types.ts:116](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L116)

***

### syncMetadata

```ts
syncMetadata: Record<string, unknown>;
```

Defined in: [packages/db/src/types.ts:126](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L126)

***

### type

```ts
type: TOperation;
```

Defined in: [packages/db/src/types.ts:124](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L124)

***

### updatedAt

```ts
updatedAt: Date;
```

Defined in: [packages/db/src/types.ts:130](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L130)
---
id: SyncConfig
title: SyncConfig
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: SyncConfig\<T, TKey\>

Defined in: [packages/db/src/types.ts:200](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L200)

## Type Parameters

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>

• **TKey** *extends* `string` \| `number` = `string` \| `number`

## Properties

### getSyncMetadata()?

```ts
optional getSyncMetadata: () => Record<string, unknown>;
```

Defined in: [packages/db/src/types.ts:216](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L216)

Get the sync metadata for insert operations

#### Returns

`Record`\<`string`, `unknown`\>

Record containing relation information

***

### rowUpdateMode?

```ts
optional rowUpdateMode: "partial" | "full";
```

Defined in: [packages/db/src/types.ts:225](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L225)

The row update mode used to sync to the collection.

#### Default

`partial`

#### Description

- `partial`: Updates contain only the changes to the row.
- `full`: Updates contain the entire row.

***

### sync()

```ts
sync: (params) => void;
```

Defined in: [packages/db/src/types.ts:204](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L204)

#### Parameters

##### params

###### begin

() => `void`

###### collection

[`Collection`](../collection.md)\<`T`, `TKey`, `any`, `any`, `any`\>

###### commit

() => `void`

###### markReady

() => `void`

###### write

(`message`) => `void`

#### Returns

`void`
---
id: OptimisticChangeMessage
title: OptimisticChangeMessage
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: OptimisticChangeMessage\<T\>

Defined in: [packages/db/src/types.ts:239](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L239)

## Extends

- [`ChangeMessage`](../changemessage.md)\<`T`\>

## Type Parameters

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>

## Properties

### isActive?

```ts
optional isActive: boolean;
```

Defined in: [packages/db/src/types.ts:243](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L243)

***

### key

```ts
key: string | number;
```

Defined in: [packages/db/src/types.ts:232](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L232)

#### Inherited from

[`ChangeMessage`](../changemessage.md).[`key`](../ChangeMessage.md#key)

***

### metadata?

```ts
optional metadata: Record<string, unknown>;
```

Defined in: [packages/db/src/types.ts:236](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L236)

#### Inherited from

[`ChangeMessage`](../changemessage.md).[`metadata`](../ChangeMessage.md#metadata)

***

### previousValue?

```ts
optional previousValue: T;
```

Defined in: [packages/db/src/types.ts:234](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L234)

#### Inherited from

[`ChangeMessage`](../changemessage.md).[`previousValue`](../ChangeMessage.md#previousvalue)

***

### type

```ts
type: OperationType;
```

Defined in: [packages/db/src/types.ts:235](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L235)

#### Inherited from

[`ChangeMessage`](../changemessage.md).[`type`](../ChangeMessage.md#type)

***

### value

```ts
value: T;
```

Defined in: [packages/db/src/types.ts:233](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L233)

#### Inherited from

[`ChangeMessage`](../changemessage.md).[`value`](../ChangeMessage.md#value)
---
id: OperationConfig
title: OperationConfig
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: OperationConfig

Defined in: [packages/db/src/types.ts:264](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L264)

## Properties

### metadata?

```ts
optional metadata: Record<string, unknown>;
```

Defined in: [packages/db/src/types.ts:265](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L265)

***

### optimistic?

```ts
optional optimistic: boolean;
```

Defined in: [packages/db/src/types.ts:267](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L267)

Whether to apply optimistic updates immediately. Defaults to true.
---
id: BTreeIndexOptions
title: BTreeIndexOptions
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: BTreeIndexOptions

Defined in: [packages/db/src/indexes/btree-index.ts:10](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/btree-index.ts#L10)

Options for Ordered index

## Properties

### compareFn()?

```ts
optional compareFn: (a, b) => number;
```

Defined in: [packages/db/src/indexes/btree-index.ts:11](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/btree-index.ts#L11)

#### Parameters

##### a

`any`

##### b

`any`

#### Returns

`number`
---
id: RangeQueryOptions
title: RangeQueryOptions
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: RangeQueryOptions

Defined in: [packages/db/src/indexes/btree-index.ts:17](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/btree-index.ts#L17)

Options for range queries

## Properties

### from?

```ts
optional from: any;
```

Defined in: [packages/db/src/indexes/btree-index.ts:18](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/btree-index.ts#L18)

***

### fromInclusive?

```ts
optional fromInclusive: boolean;
```

Defined in: [packages/db/src/indexes/btree-index.ts:20](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/btree-index.ts#L20)

***

### to?

```ts
optional to: any;
```

Defined in: [packages/db/src/indexes/btree-index.ts:19](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/btree-index.ts#L19)

***

### toInclusive?

```ts
optional toInclusive: boolean;
```

Defined in: [packages/db/src/indexes/btree-index.ts:21](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/btree-index.ts#L21)
---
id: createTransaction
title: createTransaction
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: createTransaction()

```ts
function createTransaction<T>(config): Transaction<T>
```

Defined in: [packages/db/src/transactions.ts:74](https://github.com/TanStack/db/blob/main/packages/db/src/transactions.ts#L74)

Creates a new transaction for grouping multiple collection operations

## Type Parameters

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>

## Parameters

### config

[`TransactionConfig`](../../interfaces/transactionconfig.md)\<`T`\>

Transaction configuration with mutation function

## Returns

[`Transaction`](../../classes/transaction.md)\<`T`\>

A new Transaction instance

## Examples

```ts
// Basic transaction usage
const tx = createTransaction({
  mutationFn: async ({ transaction }) => {
    // Send all mutations to API
    await api.saveChanges(transaction.mutations)
  }
})

tx.mutate(() => {
  collection.insert({ id: "1", text: "Buy milk" })
  collection.update("2", draft => { draft.completed = true })
})

await tx.isPersisted.promise
```

```ts
// Handle transaction errors
try {
  const tx = createTransaction({
    mutationFn: async () => { throw new Error("API failed") }
  })

  tx.mutate(() => {
    collection.insert({ id: "1", text: "New item" })
  })

  await tx.isPersisted.promise
} catch (error) {
  console.log('Transaction failed:', error)
}
```

```ts
// Manual commit control
const tx = createTransaction({
  autoCommit: false,
  mutationFn: async () => {
    // API call
  }
})

tx.mutate(() => {
  collection.insert({ id: "1", text: "Item" })
})

// Commit later
await tx.commit()
```
---
id: and
title: and
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: and()

## Call Signature

```ts
function and(left, right): BasicExpression<boolean>
```

Defined in: [packages/db/src/query/builder/functions.ts:77](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L77)

### Parameters

#### left

`any`

#### right

`any`

### Returns

`BasicExpression`\<`boolean`\>

## Call Signature

```ts
function and(
   left, 
   right, ...
rest): BasicExpression<boolean>
```

Defined in: [packages/db/src/query/builder/functions.ts:81](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L81)

### Parameters

#### left

`any`

#### right

`any`

#### rest

...`any`[]

### Returns

`BasicExpression`\<`boolean`\>
---
id: getActiveTransaction
title: getActiveTransaction
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: getActiveTransaction()

```ts
function getActiveTransaction(): 
  | undefined
| Transaction<Record<string, unknown>>
```

Defined in: [packages/db/src/transactions.ts:93](https://github.com/TanStack/db/blob/main/packages/db/src/transactions.ts#L93)

Gets the currently active ambient transaction, if any
Used internally by collection operations to join existing transactions

## Returns

  \| `undefined`
  \| [`Transaction`](../../classes/transaction.md)\<`Record`\<`string`, `unknown`\>\>

The active transaction or undefined if none is active

## Example

```ts
// Check if operations will join an ambient transaction
const ambientTx = getActiveTransaction()
if (ambientTx) {
  console.log('Operations will join transaction:', ambientTx.id)
}
```
---
id: createArrayChangeProxy
title: createArrayChangeProxy
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: createArrayChangeProxy()

```ts
function createArrayChangeProxy<T>(targets): object
```

Defined in: [packages/db/src/proxy.ts:964](https://github.com/TanStack/db/blob/main/packages/db/src/proxy.ts#L964)

Creates proxies for an array of objects and tracks changes to each

## Type Parameters

• **T** *extends* `object`

## Parameters

### targets

`T`[]

Array of objects to proxy

## Returns

`object`

An object containing the array of proxies and a function to get all changes

### getChanges()

```ts
getChanges: () => Record<string | symbol, unknown>[];
```

#### Returns

`Record`\<`string` \| `symbol`, `unknown`\>[]

### proxies

```ts
proxies: T[];
```
---
id: like
title: like
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: like()

```ts
function like(left, right): BasicExpression<boolean>
```

Defined in: [packages/db/src/query/builder/functions.ts:131](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L131)

## Parameters

### left

`string` | `RefProxy`\<`string`\> | `RefProxy`\<`null` \| `string`\> | `RefProxy`\<`undefined` \| `string`\> | `BasicExpression`\<`string`\>

### right

`string` | `RefProxy`\<`string`\> | `BasicExpression`\<`string`\>

## Returns

`BasicExpression`\<`boolean`\>
---
id: max
title: max
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: max()

```ts
function max(arg): Aggregate<number>
```

Defined in: [packages/db/src/query/builder/functions.ts:259](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L259)

## Parameters

### arg

`number` | `BasicExpression`\<`number`\> | `RefProxy`\<`number`\> | `RefProxy`\<`undefined` \| `number`\>

## Returns

`Aggregate`\<`number`\>
---
id: withChangeTracking
title: withChangeTracking
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: withChangeTracking()

```ts
function withChangeTracking<T>(target, callback): Record<string | symbol, unknown>
```

Defined in: [packages/db/src/proxy.ts:986](https://github.com/TanStack/db/blob/main/packages/db/src/proxy.ts#L986)

Creates a proxy for an object, passes it to a callback function,
and returns the changes made by the callback

## Type Parameters

• **T** *extends* `object`

## Parameters

### target

`T`

The object to proxy

### callback

(`proxy`) => `void`

Function that receives the proxy and can make changes to it

## Returns

`Record`\<`string` \| `symbol`, `unknown`\>

The changes made to the object
---
id: inArray
title: inArray
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: inArray()

```ts
function inArray(value, array): BasicExpression<boolean>
```

Defined in: [packages/db/src/query/builder/functions.ts:124](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L124)

## Parameters

### value

`any`

### array

`any`

## Returns

`BasicExpression`\<`boolean`\>
---
id: count
title: count
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: count()

```ts
function count(arg): Aggregate<number>
```

Defined in: [packages/db/src/query/builder/functions.ts:225](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L225)

## Parameters

### arg

`any`

## Returns

`Aggregate`\<`number`\>
---
id: createCollection
title: createCollection
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: createCollection()

```ts
function createCollection<TExplicit, TKey, TUtils, TSchema, TFallback>(options): Collection<ResolveType<TExplicit, TSchema, TFallback>, TKey, TUtils, TSchema, ResolveInsertInput<TExplicit, TSchema, TFallback>>
```

Defined in: [packages/db/src/collection.ts:160](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L160)

Creates a new Collection instance with the given configuration

## Type Parameters

• **TExplicit** = `unknown`

The explicit type of items in the collection (highest priority)

• **TKey** *extends* `string` \| `number` = `string` \| `number`

The type of the key for the collection

• **TUtils** *extends* [`UtilsRecord`](../../type-aliases/utilsrecord.md) = \{\}

The utilities record type

• **TSchema** *extends* `StandardSchemaV1`\<`unknown`, `unknown`\> = `StandardSchemaV1`\<`unknown`, `unknown`\>

The schema type for validation and type inference (second priority)

• **TFallback** *extends* `object` = `Record`\<`string`, `unknown`\>

The fallback type if no explicit or schema type is provided

## Parameters

### options

[`CollectionConfig`](../../interfaces/collectionconfig.md)\<[`ResolveType`](../../type-aliases/resolvetype.md)\<`TExplicit`, `TSchema`, `TFallback`\>, `TKey`, `TSchema`, [`ResolveInsertInput`](../../type-aliases/resolveinsertinput.md)\<`TExplicit`, `TSchema`, `TFallback`\>\> & `object`

Collection options with optional utilities

## Returns

[`Collection`](../../interfaces/collection.md)\<[`ResolveType`](../../type-aliases/resolvetype.md)\<`TExplicit`, `TSchema`, `TFallback`\>, `TKey`, `TUtils`, `TSchema`, [`ResolveInsertInput`](../../type-aliases/resolveinsertinput.md)\<`TExplicit`, `TSchema`, `TFallback`\>\>

A new Collection with utilities exposed both at top level and under .utils

## Examples

```ts
// Pattern 1: With operation handlers (direct collection calls)
const todos = createCollection({
  id: "todos",
  getKey: (todo) => todo.id,
  schema,
  onInsert: async ({ transaction, collection }) => {
    // Send to API
    await api.createTodo(transaction.mutations[0].modified)
  },
  onUpdate: async ({ transaction, collection }) => {
    await api.updateTodo(transaction.mutations[0].modified)
  },
  onDelete: async ({ transaction, collection }) => {
    await api.deleteTodo(transaction.mutations[0].key)
  },
  sync: { sync: () => {} }
})

// Direct usage (handlers manage transactions)
const tx = todos.insert({ id: "1", text: "Buy milk", completed: false })
await tx.isPersisted.promise
```

```ts
// Pattern 2: Manual transaction management
const todos = createCollection({
  getKey: (todo) => todo.id,
  schema: todoSchema,
  sync: { sync: () => {} }
})

// Explicit transaction usage
const tx = createTransaction({
  mutationFn: async ({ transaction }) => {
    // Handle all mutations in transaction
    await api.saveChanges(transaction.mutations)
  }
})

tx.mutate(() => {
  todos.insert({ id: "1", text: "Buy milk" })
  todos.update("2", draft => { draft.completed = true })
})

await tx.isPersisted.promise
```

```ts
// Using schema for type inference (preferred as it also gives you client side validation)
const todoSchema = z.object({
  id: z.string(),
  title: z.string(),
  completed: z.boolean()
})

const todos = createCollection({
  schema: todoSchema,
  getKey: (todo) => todo.id,
  sync: { sync: () => {} }
})

// Note: You must provide either an explicit type or a schema, but not both.
```
---
id: eq
title: eq
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: eq()

## Call Signature

```ts
function eq<T>(left, right): BasicExpression<boolean>
```

Defined in: [packages/db/src/query/builder/functions.ts:11](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L11)

### Type Parameters

• **T**

### Parameters

#### left

`RefProxy`\<`T`\>

#### right

`T` | `RefProxy`\<`T`\> | `BasicExpression`\<`T`\>

### Returns

`BasicExpression`\<`boolean`\>

## Call Signature

```ts
function eq<T>(left, right): BasicExpression<boolean>
```

Defined in: [packages/db/src/query/builder/functions.ts:15](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L15)

### Type Parameters

• **T** *extends* `string` \| `number` \| `boolean`

### Parameters

#### left

`T` | `BasicExpression`\<`T`\>

#### right

`T` | `BasicExpression`\<`T`\>

### Returns

`BasicExpression`\<`boolean`\>

## Call Signature

```ts
function eq<T>(left, right): BasicExpression<boolean>
```

Defined in: [packages/db/src/query/builder/functions.ts:19](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L19)

### Type Parameters

• **T**

### Parameters

#### left

`Aggregate`\<`T`\>

#### right

`any`

### Returns

`BasicExpression`\<`boolean`\>
---
id: gt
title: gt
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: gt()

## Call Signature

```ts
function gt<T>(left, right): BasicExpression<boolean>
```

Defined in: [packages/db/src/query/builder/functions.ts:24](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L24)

### Type Parameters

• **T**

### Parameters

#### left

`RefProxy`\<`T`\>

#### right

`T` | `RefProxy`\<`T`\> | `BasicExpression`\<`T`\>

### Returns

`BasicExpression`\<`boolean`\>

## Call Signature

```ts
function gt<T>(left, right): BasicExpression<boolean>
```

Defined in: [packages/db/src/query/builder/functions.ts:28](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L28)

### Type Parameters

• **T** *extends* `string` \| `number`

### Parameters

#### left

`T` | `BasicExpression`\<`T`\>

#### right

`T` | `BasicExpression`\<`T`\>

### Returns

`BasicExpression`\<`boolean`\>

## Call Signature

```ts
function gt<T>(left, right): BasicExpression<boolean>
```

Defined in: [packages/db/src/query/builder/functions.ts:32](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L32)

### Type Parameters

• **T**

### Parameters

#### left

`Aggregate`\<`T`\>

#### right

`any`

### Returns

`BasicExpression`\<`boolean`\>
---
id: coalesce
title: coalesce
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: coalesce()

```ts
function coalesce(...args): BasicExpression<any>
```

Defined in: [packages/db/src/query/builder/functions.ts:201](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L201)

## Parameters

### args

...`any`[]

## Returns

`BasicExpression`\<`any`\>
---
id: upper
title: upper
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: upper()

```ts
function upper(arg): BasicExpression<string>
```

Defined in: [packages/db/src/query/builder/functions.ts:158](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L158)

## Parameters

### arg

`string` | `RefProxy`\<`string`\> | `RefProxy`\<`undefined` \| `string`\> | `BasicExpression`\<`string`\>

## Returns

`BasicExpression`\<`string`\>
---
id: gte
title: gte
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: gte()

## Call Signature

```ts
function gte<T>(left, right): BasicExpression<boolean>
```

Defined in: [packages/db/src/query/builder/functions.ts:37](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L37)

### Type Parameters

• **T**

### Parameters

#### left

`RefProxy`\<`T`\>

#### right

`T` | `RefProxy`\<`T`\> | `BasicExpression`\<`T`\>

### Returns

`BasicExpression`\<`boolean`\>

## Call Signature

```ts
function gte<T>(left, right): BasicExpression<boolean>
```

Defined in: [packages/db/src/query/builder/functions.ts:41](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L41)

### Type Parameters

• **T** *extends* `string` \| `number`

### Parameters

#### left

`T` | `BasicExpression`\<`T`\>

#### right

`T` | `BasicExpression`\<`T`\>

### Returns

`BasicExpression`\<`boolean`\>

## Call Signature

```ts
function gte<T>(left, right): BasicExpression<boolean>
```

Defined in: [packages/db/src/query/builder/functions.ts:45](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L45)

### Type Parameters

• **T**

### Parameters

#### left

`Aggregate`\<`T`\>

#### right

`any`

### Returns

`BasicExpression`\<`boolean`\>
---
id: liveQueryCollectionOptions
title: liveQueryCollectionOptions
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: liveQueryCollectionOptions()

```ts
function liveQueryCollectionOptions<TContext, TResult>(config): CollectionConfig<TResult>
```

Defined in: [packages/db/src/query/live-query-collection.ts:117](https://github.com/TanStack/db/blob/main/packages/db/src/query/live-query-collection.ts#L117)

Creates live query collection options for use with createCollection

## Type Parameters

• **TContext** *extends* [`Context`](../../interfaces/context.md)

• **TResult** *extends* `object` = \{ \[K in string \| number \| symbol\]: (TContext\["result"\] extends object ? any\[any\] : TContext\["hasJoins"\] extends true ? TContext\["schema"\] : TContext\["schema"\]\[TContext\["fromSourceName"\]\])\[K\] \}

## Parameters

### config

[`LiveQueryCollectionConfig`](../../interfaces/livequerycollectionconfig.md)\<`TContext`, `TResult`\>

Configuration options for the live query collection

## Returns

[`CollectionConfig`](../../interfaces/collectionconfig.md)\<`TResult`\>

Collection options that can be passed to createCollection

## Example

```typescript
const options = liveQueryCollectionOptions({
  // id is optional - will auto-generate if not provided
  query: (q) => q
    .from({ post: postsCollection })
    .where(({ post }) => eq(post.published, true))
    .select(({ post }) => ({
      id: post.id,
      title: post.title,
      content: post.content,
    })),
  // getKey is optional - will use stream key if not provided
})

const collection = createCollection(options)
```
---
id: lte
title: lte
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: lte()

## Call Signature

```ts
function lte<T>(left, right): BasicExpression<boolean>
```

Defined in: [packages/db/src/query/builder/functions.ts:63](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L63)

### Type Parameters

• **T**

### Parameters

#### left

`RefProxy`\<`T`\>

#### right

`T` | `RefProxy`\<`T`\> | `BasicExpression`\<`T`\>

### Returns

`BasicExpression`\<`boolean`\>

## Call Signature

```ts
function lte<T>(left, right): BasicExpression<boolean>
```

Defined in: [packages/db/src/query/builder/functions.ts:67](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L67)

### Type Parameters

• **T** *extends* `string` \| `number`

### Parameters

#### left

`T` | `BasicExpression`\<`T`\>

#### right

`T` | `BasicExpression`\<`T`\>

### Returns

`BasicExpression`\<`boolean`\>

## Call Signature

```ts
function lte<T>(left, right): BasicExpression<boolean>
```

Defined in: [packages/db/src/query/builder/functions.ts:71](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L71)

### Type Parameters

• **T**

### Parameters

#### left

`Aggregate`\<`T`\>

#### right

`any`

### Returns

`BasicExpression`\<`boolean`\>
---
id: concat
title: concat
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: concat()

```ts
function concat(...args): BasicExpression<string>
```

Defined in: [packages/db/src/query/builder/functions.ts:192](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L192)

## Parameters

### args

...`any`[]

## Returns

`BasicExpression`\<`string`\>
---
id: createChangeProxy
title: createChangeProxy
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: createChangeProxy()

```ts
function createChangeProxy<T>(target, parent?): object
```

Defined in: [packages/db/src/proxy.ts:273](https://github.com/TanStack/db/blob/main/packages/db/src/proxy.ts#L273)

Creates a proxy that tracks changes to the target object

## Type Parameters

• **T** *extends* `Record`\<`string` \| `symbol`, `any`\>

## Parameters

### target

`T`

The object to proxy

### parent?

Optional parent information

#### prop

`string` \| `symbol`

#### tracker

`ChangeTracker`\<`Record`\<`string` \| `symbol`, `unknown`\>\>

## Returns

`object`

An object containing the proxy and a function to get the changes

### getChanges()

```ts
getChanges: () => Record<string | symbol, any>;
```

#### Returns

`Record`\<`string` \| `symbol`, `any`\>

### proxy

```ts
proxy: T;
```
---
id: lower
title: lower
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: lower()

```ts
function lower(arg): BasicExpression<string>
```

Defined in: [packages/db/src/query/builder/functions.ts:168](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L168)

## Parameters

### arg

`string` | `RefProxy`\<`string`\> | `RefProxy`\<`undefined` \| `string`\> | `BasicExpression`\<`string`\>

## Returns

`BasicExpression`\<`string`\>
---
id: createLiveQueryCollection
title: createLiveQueryCollection
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: createLiveQueryCollection()

## Call Signature

```ts
function createLiveQueryCollection<TContext, TResult>(query): Collection<TResult, string | number, {}>
```

Defined in: [packages/db/src/query/live-query-collection.ts:424](https://github.com/TanStack/db/blob/main/packages/db/src/query/live-query-collection.ts#L424)

Creates a live query collection directly

### Type Parameters

• **TContext** *extends* [`Context`](../../interfaces/context.md)

• **TResult** *extends* `object` = \{ \[K in string \| number \| symbol\]: (TContext\["result"\] extends object ? any\[any\] : TContext\["hasJoins"\] extends true ? TContext\["schema"\] : TContext\["schema"\]\[TContext\["fromSourceName"\]\])\[K\] \}

### Parameters

#### query

(`q`) => [`QueryBuilder`](../../type-aliases/querybuilder.md)\<`TContext`\>

### Returns

[`Collection`](../../interfaces/collection.md)\<`TResult`, `string` \| `number`, \{\}\>

### Example

```typescript
// Minimal usage - just pass a query function
const activeUsers = createLiveQueryCollection(
  (q) => q
    .from({ user: usersCollection })
    .where(({ user }) => eq(user.active, true))
    .select(({ user }) => ({ id: user.id, name: user.name }))
)

// Full configuration with custom options
const searchResults = createLiveQueryCollection({
  id: "search-results", // Custom ID (auto-generated if omitted)
  query: (q) => q
    .from({ post: postsCollection })
    .where(({ post }) => like(post.title, `%${searchTerm}%`))
    .select(({ post }) => ({
      id: post.id,
      title: post.title,
      excerpt: post.excerpt,
    })),
  getKey: (item) => item.id, // Custom key function (uses stream key if omitted)
  utils: {
    updateSearchTerm: (newTerm: string) => {
      // Custom utility functions
    }
  }
})
```

## Call Signature

```ts
function createLiveQueryCollection<TContext, TResult, TUtils>(config): Collection<TResult, string | number, TUtils>
```

Defined in: [packages/db/src/query/live-query-collection.ts:432](https://github.com/TanStack/db/blob/main/packages/db/src/query/live-query-collection.ts#L432)

Creates a live query collection directly

### Type Parameters

• **TContext** *extends* [`Context`](../../interfaces/context.md)

• **TResult** *extends* `object` = \{ \[K in string \| number \| symbol\]: (TContext\["result"\] extends object ? any\[any\] : TContext\["hasJoins"\] extends true ? TContext\["schema"\] : TContext\["schema"\]\[TContext\["fromSourceName"\]\])\[K\] \}

• **TUtils** *extends* [`UtilsRecord`](../../type-aliases/utilsrecord.md) = \{\}

### Parameters

#### config

[`LiveQueryCollectionConfig`](../../interfaces/livequerycollectionconfig.md)\<`TContext`, `TResult`\> & `object`

### Returns

[`Collection`](../../interfaces/collection.md)\<`TResult`, `string` \| `number`, `TUtils`\>

### Example

```typescript
// Minimal usage - just pass a query function
const activeUsers = createLiveQueryCollection(
  (q) => q
    .from({ user: usersCollection })
    .where(({ user }) => eq(user.active, true))
    .select(({ user }) => ({ id: user.id, name: user.name }))
)

// Full configuration with custom options
const searchResults = createLiveQueryCollection({
  id: "search-results", // Custom ID (auto-generated if omitted)
  query: (q) => q
    .from({ post: postsCollection })
    .where(({ post }) => like(post.title, `%${searchTerm}%`))
    .select(({ post }) => ({
      id: post.id,
      title: post.title,
      excerpt: post.excerpt,
    })),
  getKey: (item) => item.id, // Custom key function (uses stream key if omitted)
  utils: {
    updateSearchTerm: (newTerm: string) => {
      // Custom utility functions
    }
  }
})
```
---
id: createOptimisticAction
title: createOptimisticAction
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: createOptimisticAction()

```ts
function createOptimisticAction<TVariables>(options): (variables) => Transaction
```

Defined in: [packages/db/src/optimistic-action.ts:41](https://github.com/TanStack/db/blob/main/packages/db/src/optimistic-action.ts#L41)

Creates an optimistic action function that applies local optimistic updates immediately
before executing the actual mutation on the server.

This pattern allows for responsive UI updates while the actual mutation is in progress.
The optimistic update is applied via the `onMutate` callback, and the server mutation
is executed via the `mutationFn`.

## Type Parameters

• **TVariables** = `unknown`

The type of variables that will be passed to the action function

## Parameters

### options

[`CreateOptimisticActionsOptions`](../../interfaces/createoptimisticactionsoptions.md)\<`TVariables`\>

Configuration options for the optimistic action

## Returns

`Function`

A function that accepts variables of type TVariables and returns a Transaction

### Parameters

#### variables

`TVariables`

### Returns

[`Transaction`](../../classes/transaction.md)

## Example

```ts
const addTodo = createOptimisticAction<string>({
  onMutate: (text) => {
    // Instantly applies local optimistic state
    todoCollection.insert({
      id: uuid(),
      text,
      completed: false
    })
  },
  mutationFn: async (text, params) => {
    // Persist the todo to your backend
    const response = await fetch('/api/todos', {
      method: 'POST',
      body: JSON.stringify({ text, completed: false }),
    })
    return response.json()
  }
})

// Usage
const transaction = addTodo('New Todo Item')
```
---
id: localOnlyCollectionOptions
title: localOnlyCollectionOptions
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: localOnlyCollectionOptions()

```ts
function localOnlyCollectionOptions<TExplicit, TSchema, TFallback, TKey>(config): object
```

Defined in: [packages/db/src/local-only.ts:137](https://github.com/TanStack/db/blob/main/packages/db/src/local-only.ts#L137)

Creates Local-only collection options for use with a standard Collection

This is an in-memory collection that doesn't sync with external sources but uses a loopback sync config
that immediately "syncs" all optimistic changes to the collection, making them permanent.
Perfect for local-only data that doesn't need persistence or external synchronization.

## Type Parameters

• **TExplicit** = `unknown`

The explicit type of items in the collection (highest priority)

• **TSchema** *extends* `StandardSchemaV1`\<`unknown`, `unknown`\> = `never`

The schema type for validation and type inference (second priority)

• **TFallback** *extends* `Record`\<`string`, `unknown`\> = `Record`\<`string`, `unknown`\>

The fallback type if no explicit or schema type is provided

• **TKey** *extends* `string` \| `number` = `string` \| `number`

The type of the key returned by getKey

## Parameters

### config

[`LocalOnlyCollectionConfig`](../../interfaces/localonlycollectionconfig.md)\<`TExplicit`, `TSchema`, `TFallback`, `TKey`\>

Configuration options for the Local-only collection

## Returns

`object`

Collection options with utilities (currently empty but follows the pattern)

### gcTime

```ts
gcTime: number = 0;
```

### getKey()

```ts
getKey: (item) => TKey;
```

#### Parameters

##### item

[`ResolveType`](../../type-aliases/resolvetype.md)\<`TExplicit`, `TSchema`, `TFallback`\>

#### Returns

`TKey`

### id?

```ts
optional id: string;
```

Standard Collection configuration properties

### onDelete()

```ts
onDelete: (params) => Promise<any> = wrappedOnDelete;
```

Wrapper for onDelete handler that also confirms the transaction immediately

#### Parameters

##### params

[`DeleteMutationFnParams`](../../type-aliases/deletemutationfnparams.md)\<[`ResolveType`](../../type-aliases/resolvetype.md)\<`TExplicit`, `TSchema`, `TFallback`\>, `TKey`, [`LocalOnlyCollectionUtils`](../../interfaces/localonlycollectionutils.md)\>

#### Returns

`Promise`\<`any`\>

### onInsert()

```ts
onInsert: (params) => Promise<any> = wrappedOnInsert;
```

Create wrapper handlers that call user handlers first, then confirm transactions
Wraps the user's onInsert handler to also confirm the transaction immediately

#### Parameters

##### params

[`InsertMutationFnParams`](../../type-aliases/insertmutationfnparams.md)\<[`ResolveType`](../../type-aliases/resolvetype.md)\<`TExplicit`, `TSchema`, `TFallback`\>, `TKey`, [`LocalOnlyCollectionUtils`](../../interfaces/localonlycollectionutils.md)\>

#### Returns

`Promise`\<`any`\>

### onUpdate()

```ts
onUpdate: (params) => Promise<any> = wrappedOnUpdate;
```

Wrapper for onUpdate handler that also confirms the transaction immediately

#### Parameters

##### params

[`UpdateMutationFnParams`](../../type-aliases/updatemutationfnparams.md)\<[`ResolveType`](../../type-aliases/resolvetype.md)\<`TExplicit`, `TSchema`, `TFallback`\>, `TKey`, [`LocalOnlyCollectionUtils`](../../interfaces/localonlycollectionutils.md)\>

#### Returns

`Promise`\<`any`\>

### schema?

```ts
optional schema: TSchema;
```

### startSync

```ts
startSync: boolean = true;
```

### sync

```ts
sync: SyncConfig<ResolveType<TExplicit, TSchema, TFallback>, TKey> = syncResult.sync;
```

### utils

```ts
utils: LocalOnlyCollectionUtils;
```

## Examples

```ts
// Basic local-only collection
const collection = createCollection(
  localOnlyCollectionOptions({
    getKey: (item) => item.id,
  })
)
```

```ts
// Local-only collection with initial data
const collection = createCollection(
  localOnlyCollectionOptions({
    getKey: (item) => item.id,
    initialData: [
      { id: 1, name: 'Item 1' },
      { id: 2, name: 'Item 2' },
    ],
  })
)
```

```ts
// Local-only collection with mutation handlers
const collection = createCollection(
  localOnlyCollectionOptions({
    getKey: (item) => item.id,
    onInsert: async ({ transaction }) => {
      console.log('Item inserted:', transaction.mutations[0].modified)
      // Custom logic after insert
    },
  })
)
```
---
id: sum
title: sum
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: sum()

```ts
function sum(arg): Aggregate<number>
```

Defined in: [packages/db/src/query/builder/functions.ts:239](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L239)

## Parameters

### arg

`number` | `BasicExpression`\<`number`\> | `RefProxy`\<`number`\> | `RefProxy`\<`undefined` \| `number`\>

## Returns

`Aggregate`\<`number`\>
---
id: not
title: not
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: not()

```ts
function not(value): BasicExpression<boolean>
```

Defined in: [packages/db/src/query/builder/functions.ts:120](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L120)

## Parameters

### value

`any`

## Returns

`BasicExpression`\<`boolean`\>
---
id: or
title: or
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: or()

## Call Signature

```ts
function or(left, right): BasicExpression<boolean>
```

Defined in: [packages/db/src/query/builder/functions.ts:99](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L99)

### Parameters

#### left

`any`

#### right

`any`

### Returns

`BasicExpression`\<`boolean`\>

## Call Signature

```ts
function or(
   left, 
   right, ...
rest): BasicExpression<boolean>
```

Defined in: [packages/db/src/query/builder/functions.ts:103](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L103)

### Parameters

#### left

`any`

#### right

`any`

#### rest

...`any`[]

### Returns

`BasicExpression`\<`boolean`\>
---
id: avg
title: avg
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: avg()

```ts
function avg(arg): Aggregate<number>
```

Defined in: [packages/db/src/query/builder/functions.ts:229](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L229)

## Parameters

### arg

`number` | `BasicExpression`\<`number`\> | `RefProxy`\<`number`\> | `RefProxy`\<`undefined` \| `number`\>

## Returns

`Aggregate`\<`number`\>
---
id: localStorageCollectionOptions
title: localStorageCollectionOptions
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: localStorageCollectionOptions()

```ts
function localStorageCollectionOptions<TExplicit, TSchema, TFallback>(config): object
```

Defined in: [packages/db/src/local-storage.ts:205](https://github.com/TanStack/db/blob/main/packages/db/src/local-storage.ts#L205)

Creates localStorage collection options for use with a standard Collection

This function creates a collection that persists data to localStorage/sessionStorage
and synchronizes changes across browser tabs using storage events.

## Type Parameters

• **TExplicit** = `unknown`

The explicit type of items in the collection (highest priority)

• **TSchema** *extends* `StandardSchemaV1`\<`unknown`, `unknown`\> = `never`

The schema type for validation and type inference (second priority)

• **TFallback** *extends* `object` = `Record`\<`string`, `unknown`\>

The fallback type if no explicit or schema type is provided

## Parameters

### config

[`LocalStorageCollectionConfig`](../../interfaces/localstoragecollectionconfig.md)\<`TExplicit`, `TSchema`, `TFallback`\>

Configuration options for the localStorage collection

## Returns

`object`

Collection options with utilities including clearStorage and getStorageSize

### getKey()

```ts
getKey: (item) => string | number;
```

#### Parameters

##### item

[`ResolveType`](../../type-aliases/resolvetype.md)

#### Returns

`string` \| `number`

### id

```ts
id: string = collectionId;
```

### onDelete()

```ts
onDelete: (params) => Promise<any> = wrappedOnDelete;
```

#### Parameters

##### params

[`DeleteMutationFnParams`](../../type-aliases/deletemutationfnparams.md)\<[`ResolveType`](../../type-aliases/resolvetype.md)\<`TExplicit`, `TSchema`, `TFallback`\>\>

#### Returns

`Promise`\<`any`\>

### onInsert()

```ts
onInsert: (params) => Promise<any> = wrappedOnInsert;
```

#### Parameters

##### params

[`InsertMutationFnParams`](../../type-aliases/insertmutationfnparams.md)\<[`ResolveType`](../../type-aliases/resolvetype.md)\<`TExplicit`, `TSchema`, `TFallback`\>\>

#### Returns

`Promise`\<`any`\>

### onUpdate()

```ts
onUpdate: (params) => Promise<any> = wrappedOnUpdate;
```

#### Parameters

##### params

[`UpdateMutationFnParams`](../../type-aliases/updatemutationfnparams.md)\<[`ResolveType`](../../type-aliases/resolvetype.md)\<`TExplicit`, `TSchema`, `TFallback`\>\>

#### Returns

`Promise`\<`any`\>

### schema?

```ts
optional schema: TSchema;
```

### sync

```ts
sync: SyncConfig<ResolveType<TExplicit, TSchema, TFallback>, string | number> & object;
```

#### Type declaration

##### manualTrigger()?

```ts
optional manualTrigger: () => void;
```

###### Returns

`void`

### utils

```ts
utils: object;
```

#### utils.clearStorage

```ts
clearStorage: ClearStorageFn;
```

#### utils.getStorageSize

```ts
getStorageSize: GetStorageSizeFn;
```

## Examples

```ts
// Basic localStorage collection
const collection = createCollection(
  localStorageCollectionOptions({
    storageKey: 'todos',
    getKey: (item) => item.id,
  })
)
```

```ts
// localStorage collection with custom storage
const collection = createCollection(
  localStorageCollectionOptions({
    storageKey: 'todos',
    storage: window.sessionStorage, // Use sessionStorage instead
    getKey: (item) => item.id,
  })
)
```

```ts
// localStorage collection with mutation handlers
const collection = createCollection(
  localStorageCollectionOptions({
    storageKey: 'todos',
    getKey: (item) => item.id,
    onInsert: async ({ transaction }) => {
      console.log('Item inserted:', transaction.mutations[0].modified)
    },
  })
)
```
---
id: ilike
title: ilike
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: ilike()

```ts
function ilike(left, right): BasicExpression<boolean>
```

Defined in: [packages/db/src/query/builder/functions.ts:144](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L144)

## Parameters

### left

`string` | `RefProxy`\<`string`\> | `RefProxy`\<`null` \| `string`\> | `RefProxy`\<`undefined` \| `string`\> | `BasicExpression`\<`string`\>

### right

`string` | `RefProxy`\<`string`\> | `BasicExpression`\<`string`\>

## Returns

`BasicExpression`\<`boolean`\>
---
id: lt
title: lt
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: lt()

## Call Signature

```ts
function lt<T>(left, right): BasicExpression<boolean>
```

Defined in: [packages/db/src/query/builder/functions.ts:50](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L50)

### Type Parameters

• **T**

### Parameters

#### left

`RefProxy`\<`T`\>

#### right

`T` | `RefProxy`\<`T`\> | `BasicExpression`\<`T`\>

### Returns

`BasicExpression`\<`boolean`\>

## Call Signature

```ts
function lt<T>(left, right): BasicExpression<boolean>
```

Defined in: [packages/db/src/query/builder/functions.ts:54](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L54)

### Type Parameters

• **T** *extends* `string` \| `number`

### Parameters

#### left

`T` | `BasicExpression`\<`T`\>

#### right

`T` | `BasicExpression`\<`T`\>

### Returns

`BasicExpression`\<`boolean`\>

## Call Signature

```ts
function lt<T>(left, right): BasicExpression<boolean>
```

Defined in: [packages/db/src/query/builder/functions.ts:58](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L58)

### Type Parameters

• **T**

### Parameters

#### left

`Aggregate`\<`T`\>

#### right

`any`

### Returns

`BasicExpression`\<`boolean`\>
---
id: compileQuery
title: compileQuery
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: compileQuery()

```ts
function compileQuery(
   rawQuery, 
   inputs, 
   cache, 
   queryMapping): CompilationResult
```

Defined in: [packages/db/src/query/compiler/index.ts:46](https://github.com/TanStack/db/blob/main/packages/db/src/query/compiler/index.ts#L46)

Compiles a query2 IR into a D2 pipeline

## Parameters

### rawQuery

`QueryIR`

The query IR to compile

### inputs

`Record`\<`string`, [`KeyedStream`](../../type-aliases/keyedstream.md)\>

Mapping of collection names to input streams

### cache

`QueryCache` = `...`

Optional cache for compiled subqueries (used internally for recursion)

### queryMapping

`QueryMapping` = `...`

Optional mapping from optimized queries to original queries

## Returns

`CompilationResult`

A CompilationResult with the pipeline and collection WHERE clauses
---
id: add
title: add
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: add()

```ts
function add(left, right): BasicExpression<number>
```

Defined in: [packages/db/src/query/builder/functions.ts:208](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L208)

## Parameters

### left

`number` | `BasicExpression`\<`number`\> | `RefProxy`\<`number`\> | `RefProxy`\<`undefined` \| `number`\>

### right

`number` | `BasicExpression`\<`number`\> | `RefProxy`\<`number`\> | `RefProxy`\<`undefined` \| `number`\>

## Returns

`BasicExpression`\<`number`\>
---
id: min
title: min
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: min()

```ts
function min(arg): Aggregate<number>
```

Defined in: [packages/db/src/query/builder/functions.ts:249](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L249)

## Parameters

### arg

`number` | `BasicExpression`\<`number`\> | `RefProxy`\<`number`\> | `RefProxy`\<`undefined` \| `number`\>

## Returns

`Aggregate`\<`number`\>
---
id: length
title: length
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: length()

```ts
function length(arg): BasicExpression<number>
```

Defined in: [packages/db/src/query/builder/functions.ts:178](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/functions.ts#L178)

## Parameters

### arg

`string` | `any`[] | `RefProxy`\<`string`\> | `RefProxy`\<`undefined` \| `string`\> | `BasicExpression`\<`string`\> | `RefProxy`\<`any`[]\> | `RefProxy`\<`undefined` \| `any`[]\> | `BasicExpression`\<`any`[]\>

## Returns

`BasicExpression`\<`number`\>
---
id: withArrayChangeTracking
title: withArrayChangeTracking
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: withArrayChangeTracking()

```ts
function withArrayChangeTracking<T>(targets, callback): Record<string | symbol, unknown>[]
```

Defined in: [packages/db/src/proxy.ts:1005](https://github.com/TanStack/db/blob/main/packages/db/src/proxy.ts#L1005)

Creates proxies for an array of objects, passes them to a callback function,
and returns the changes made by the callback for each object

## Type Parameters

• **T** *extends* `object`

## Parameters

### targets

`T`[]

Array of objects to proxy

### callback

(`proxies`) => `void`

Function that receives the proxies and can make changes to them

## Returns

`Record`\<`string` \| `symbol`, `unknown`\>[]

Array of changes made to each object
---
id: Query
title: Query
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Variable: Query

```ts
const Query: InitialQueryBuilderConstructor = BaseQueryBuilder;
```

Defined in: [packages/db/src/query/builder/index.ts:767](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/index.ts#L767)
---
id: IndexOperation
title: IndexOperation
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Variable: IndexOperation

```ts
const IndexOperation: readonly ["eq", "gt", "gte", "lt", "lte", "in", "like", "ilike"] = comparisonFunctions;
```

Defined in: [packages/db/src/indexes/base-index.ts:8](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L8)

Operations that indexes can support, imported from available comparison functions
---
id: Fn
title: Fn
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: Fn()

```ts
type Fn = (...args) => any;
```

Defined in: [packages/db/src/types.ts:81](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L81)

Represents a utility function that can be attached to a collection

## Parameters

### args

...`any`[]

## Returns

`any`
---
id: TransactionWithMutations
title: TransactionWithMutations
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: TransactionWithMutations\<T, TOperation\>

```ts
type TransactionWithMutations<T, TOperation> = Transaction<T> & object;
```

Defined in: [packages/db/src/types.ts:154](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L154)

Utility type for a Transaction with at least one mutation
This is used internally by the Transaction.commit method

## Type declaration

### mutations

```ts
mutations: NonEmptyArray<PendingMutation<T, TOperation>>;
```

## Type Parameters

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>

• **TOperation** *extends* [`OperationType`](../operationtype.md) = [`OperationType`](../operationtype.md)
---
id: NonEmptyArray
title: NonEmptyArray
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: NonEmptyArray\<T\>

```ts
type NonEmptyArray<T> = [T, ...T[]];
```

Defined in: [packages/db/src/types.ts:148](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L148)

Represents a non-empty array (at least one element)

## Type Parameters

• **T**
---
id: CollectionStatus
title: CollectionStatus
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: CollectionStatus

```ts
type CollectionStatus = "idle" | "loading" | "initialCommit" | "ready" | "error" | "cleaned-up";
```

Defined in: [packages/db/src/types.ts:335](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L335)

Collection status values for lifecycle management

## Examples

```ts
// Check collection status
if (collection.status === "loading") {
  console.log("Collection is loading initial data")
} else if (collection.status === "ready") {
  console.log("Collection is ready for use")
}
```

```ts
// Status transitions
// idle → loading → initialCommit → ready
// Any status can transition to → error or cleaned-up
```
---
id: NamespacedRow
title: NamespacedRow
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: NamespacedRow

```ts
type NamespacedRow = Record<string, Record<string, unknown>>;
```

Defined in: [packages/db/src/types.ts:555](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L555)

A namespaced row is a row withing a pipeline that had each table wrapped in its alias
---
id: InsertMutationFnParams
title: InsertMutationFnParams
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: InsertMutationFnParams\<T, TKey, TUtils\>

```ts
type InsertMutationFnParams<T, TKey, TUtils> = object;
```

Defined in: [packages/db/src/types.ts:285](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L285)

## Type Parameters

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>

• **TKey** *extends* `string` \| `number` = `string` \| `number`

• **TUtils** *extends* [`UtilsRecord`](../utilsrecord.md) = `Record`\<`string`, [`Fn`](../fn.md)\>

## Type declaration

### collection

```ts
collection: Collection<T, TKey, TUtils>;
```

### transaction

```ts
transaction: TransactionWithMutations<T, "insert">;
```
---
id: GetStorageSizeFn
title: GetStorageSizeFn
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: GetStorageSizeFn()

```ts
type GetStorageSizeFn = () => number;
```

Defined in: [packages/db/src/local-storage.ts:127](https://github.com/TanStack/db/blob/main/packages/db/src/local-storage.ts#L127)

Type for the getStorageSize utility function

## Returns

`number`
---
id: KeyedStream
title: KeyedStream
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: KeyedStream

```ts
type KeyedStream = IStreamBuilder<InputRow>;
```

Defined in: [packages/db/src/types.ts:544](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L544)

A keyed stream is a stream of rows
This is used as the inputs from a collection to a query
---
id: Source
title: Source
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: Source

```ts
type Source = object;
```

Defined in: [packages/db/src/query/builder/types.ts:25](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/types.ts#L25)

## Index Signature

```ts
[alias: string]: 
  | CollectionImpl<any, any, {}, StandardSchemaV1<unknown, unknown>, any>
| QueryBuilder<Context>
```
---
id: InferSchemaOutput
title: InferSchemaOutput
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: InferSchemaOutput\<T\>

```ts
type InferSchemaOutput<T> = T extends StandardSchemaV1 ? StandardSchemaV1.InferOutput<T> extends object ? StandardSchemaV1.InferOutput<T> : Record<string, unknown> : Record<string, unknown>;
```

Defined in: [packages/db/src/types.ts:14](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L14)

**`Internal`**

Helper type to extract the output type from a standard schema

 This is used by the type resolution system

## Type Parameters

• **T**
---
id: ClearStorageFn
title: ClearStorageFn
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: ClearStorageFn()

```ts
type ClearStorageFn = () => void;
```

Defined in: [packages/db/src/local-storage.ts:122](https://github.com/TanStack/db/blob/main/packages/db/src/local-storage.ts#L122)

Type for the clear utility function

## Returns

`void`
---
id: MutationFn
title: MutationFn
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: MutationFn()\<T\>

```ts
type MutationFn<T> = (params) => Promise<any>;
```

Defined in: [packages/db/src/types.ts:141](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L141)

## Type Parameters

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>

## Parameters

### params

[`MutationFnParams`](../mutationfnparams.md)\<`T`\>

## Returns

`Promise`\<`any`\>
---
id: IndexConstructor
title: IndexConstructor
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: IndexConstructor()\<TKey\>

```ts
type IndexConstructor<TKey> = (id, expression, name?, options?) => BaseIndex<TKey>;
```

Defined in: [packages/db/src/indexes/base-index.ts:106](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L106)

Type for index constructor

## Type Parameters

• **TKey** *extends* `string` \| `number` = `string` \| `number`

## Parameters

### id

`number`

### expression

`BasicExpression`

### name?

`string`

### options?

`any`

## Returns

[`BaseIndex`](../../classes/baseindex.md)\<`TKey`\>
---
id: StandardSchema
title: StandardSchema
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: StandardSchema\<T\>

```ts
type StandardSchema<T> = StandardSchemaV1 & object;
```

Defined in: [packages/db/src/types.ts:250](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L250)

The Standard Schema interface.
This follows the standard-schema specification: https://github.com/standard-schema/standard-schema

## Type declaration

### ~standard

```ts
~standard: object;
```

#### ~standard.types?

```ts
optional types: object;
```

#### ~standard.types.input

```ts
input: T;
```

#### ~standard.types.output

```ts
output: T;
```

## Type Parameters

• **T**
---
id: ResultStream
title: ResultStream
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: ResultStream

```ts
type ResultStream = IStreamBuilder<[unknown, [any, string | undefined]]>;
```

Defined in: [packages/db/src/types.ts:550](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L550)

Result stream type representing the output of compiled queries
Always returns [key, [result, orderByIndex]] where orderByIndex is undefined for unordered queries
---
id: IndexResolver
title: IndexResolver
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: IndexResolver\<TKey\>

```ts
type IndexResolver<TKey> = 
  | IndexConstructor<TKey>
| () => Promise<IndexConstructor<TKey>>;
```

Defined in: [packages/db/src/indexes/base-index.ts:117](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L117)

Index resolver can be either a class constructor or async loader

## Type Parameters

• **TKey** *extends* `string` \| `number` = `string` \| `number`
---
id: UpdateMutationFnParams
title: UpdateMutationFnParams
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: UpdateMutationFnParams\<T, TKey, TUtils\>

```ts
type UpdateMutationFnParams<T, TKey, TUtils> = object;
```

Defined in: [packages/db/src/types.ts:276](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L276)

## Type Parameters

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>

• **TKey** *extends* `string` \| `number` = `string` \| `number`

• **TUtils** *extends* [`UtilsRecord`](../utilsrecord.md) = `Record`\<`string`, [`Fn`](../fn.md)\>

## Type declaration

### collection

```ts
collection: Collection<T, TKey, TUtils>;
```

### transaction

```ts
transaction: TransactionWithMutations<T, "update">;
```
---
id: ChangeListener
title: ChangeListener
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: ChangeListener()\<T, TKey\>

```ts
type ChangeListener<T, TKey> = (changes) => void;
```

Defined in: [packages/db/src/types.ts:627](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L627)

Function type for listening to collection changes

## Type Parameters

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>

• **TKey** *extends* `string` \| `number` = `string` \| `number`

## Parameters

### changes

[`ChangeMessage`](../../interfaces/changemessage.md)\<`T`, `TKey`\>[]

Array of change messages describing what happened

## Returns

`void`

## Examples

```ts
// Basic change listener
const listener: ChangeListener = (changes) => {
  changes.forEach(change => {
    console.log(`${change.type}: ${change.key}`, change.value)
  })
}

collection.subscribeChanges(listener)
```

```ts
// Handle different change types
const listener: ChangeListener<Todo> = (changes) => {
  for (const change of changes) {
    switch (change.type) {
      case 'insert':
        addToUI(change.value)
        break
      case 'update':
        updateInUI(change.key, change.value, change.previousValue)
        break
      case 'delete':
        removeFromUI(change.key)
        break
    }
  }
}
```
---
id: InitialQueryBuilder
title: InitialQueryBuilder
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: InitialQueryBuilder

```ts
type InitialQueryBuilder = Pick<BaseQueryBuilder<Context>, "from">;
```

Defined in: [packages/db/src/query/builder/index.ts:756](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/index.ts#L756)
---
id: StorageApi
title: StorageApi
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: StorageApi

```ts
type StorageApi = Pick<Storage, "getItem" | "setItem" | "removeItem">;
```

Defined in: [packages/db/src/local-storage.ts:23](https://github.com/TanStack/db/blob/main/packages/db/src/local-storage.ts#L23)

Storage API interface - subset of DOM Storage that we need
---
id: DeleteMutationFn
title: DeleteMutationFn
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: DeleteMutationFn()\<T, TKey, TUtils\>

```ts
type DeleteMutationFn<T, TKey, TUtils> = (params) => Promise<any>;
```

Defined in: [packages/db/src/types.ts:314](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L314)

## Type Parameters

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>

• **TKey** *extends* `string` \| `number` = `string` \| `number`

• **TUtils** *extends* [`UtilsRecord`](../utilsrecord.md) = `Record`\<`string`, [`Fn`](../fn.md)\>

## Parameters

### params

[`DeleteMutationFnParams`](../deletemutationfnparams.md)\<`T`, `TKey`, `TUtils`\>

## Returns

`Promise`\<`any`\>
---
id: GetResult
title: GetResult
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: GetResult\<TContext\>

```ts
type GetResult<TContext> = Prettify<TContext["result"] extends object ? TContext["result"] : TContext["hasJoins"] extends true ? TContext["schema"] : TContext["schema"][TContext["fromSourceName"]]>;
```

Defined in: [packages/db/src/query/builder/types.ts:208](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/types.ts#L208)

## Type Parameters

• **TContext** *extends* [`Context`](../../interfaces/context.md)
---
id: ChangesPayload
title: ChangesPayload
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: ChangesPayload\<T\>

```ts
type ChangesPayload<T> = ChangeMessage<T>[];
```

Defined in: [packages/db/src/types.ts:531](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L531)

## Type Parameters

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>
---
id: StandardSchemaAlias
title: StandardSchemaAlias
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: StandardSchemaAlias\<T\>

```ts
type StandardSchemaAlias<T> = StandardSchema<T>;
```

Defined in: [packages/db/src/types.ts:262](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L262)

Type alias for StandardSchema

## Type Parameters

• **T** = `unknown`
---
id: MutationFnParams
title: MutationFnParams
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: MutationFnParams\<T\>

```ts
type MutationFnParams<T> = object;
```

Defined in: [packages/db/src/types.ts:137](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L137)

Configuration options for creating a new transaction

## Type Parameters

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>

## Type declaration

### transaction

```ts
transaction: TransactionWithMutations<T>;
```
---
id: Row
title: Row
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: Row\<TExtensions\>

```ts
type Row<TExtensions> = Record<string, Value<TExtensions>>;
```

Defined in: [packages/db/src/types.ts:196](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L196)

## Type Parameters

• **TExtensions** = `never`
---
id: IndexOperation
title: IndexOperation
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: IndexOperation

```ts
type IndexOperation = typeof comparisonFunctions[number];
```

Defined in: [packages/db/src/indexes/base-index.ts:8](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L8)

Type for index operation values
---
id: ResolveInsertInput
title: ResolveInsertInput
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: ResolveInsertInput\<TExplicit, TSchema, TFallback\>

```ts
type ResolveInsertInput<TExplicit, TSchema, TFallback> = unknown extends TExplicit ? [TSchema] extends [never] ? TFallback : InferSchemaInput<TSchema> : TExplicit extends object ? TExplicit : Record<string, unknown>;
```

Defined in: [packages/db/src/types.ts:42](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L42)

**`Internal`**

Helper type to determine the insert input type
This takes the raw generics (TExplicit, TSchema, TFallback) instead of the resolved T.

Priority:
1. Explicit generic TExplicit (if not 'unknown')
2. Schema input type (if schema provided)
3. Fallback type TFallback

 This is used for collection insert type inference

## Type Parameters

• **TExplicit** = `unknown`

• **TSchema** *extends* `StandardSchemaV1` = `never`

• **TFallback** *extends* `object` = `Record`\<`string`, `unknown`\>
---
id: TransactionState
title: TransactionState
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: TransactionState

```ts
type TransactionState = "pending" | "persisting" | "completed" | "failed";
```

Defined in: [packages/db/src/types.ts:76](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L76)
---
id: NamespacedAndKeyedStream
title: NamespacedAndKeyedStream
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: NamespacedAndKeyedStream

```ts
type NamespacedAndKeyedStream = IStreamBuilder<KeyedNamespacedRow>;
```

Defined in: [packages/db/src/types.ts:568](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L568)

A namespaced and keyed stream is a stream of rows
This is used throughout a query pipeline and as the output from a query without
a `select` clause.
---
id: DeleteMutationFnParams
title: DeleteMutationFnParams
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: DeleteMutationFnParams\<T, TKey, TUtils\>

```ts
type DeleteMutationFnParams<T, TKey, TUtils> = object;
```

Defined in: [packages/db/src/types.ts:293](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L293)

## Type Parameters

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>

• **TKey** *extends* `string` \| `number` = `string` \| `number`

• **TUtils** *extends* [`UtilsRecord`](../utilsrecord.md) = `Record`\<`string`, [`Fn`](../fn.md)\>

## Type declaration

### collection

```ts
collection: Collection<T, TKey, TUtils>;
```

### transaction

```ts
transaction: TransactionWithMutations<T, "delete">;
```
---
id: InsertMutationFn
title: InsertMutationFn
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: InsertMutationFn()\<T, TKey, TUtils\>

```ts
type InsertMutationFn<T, TKey, TUtils> = (params) => Promise<any>;
```

Defined in: [packages/db/src/types.ts:302](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L302)

## Type Parameters

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>

• **TKey** *extends* `string` \| `number` = `string` \| `number`

• **TUtils** *extends* [`UtilsRecord`](../utilsrecord.md) = `Record`\<`string`, [`Fn`](../fn.md)\>

## Parameters

### params

[`InsertMutationFnParams`](../insertmutationfnparams.md)\<`T`, `TKey`, `TUtils`\>

## Returns

`Promise`\<`any`\>
---
id: ResolveTransactionChanges
title: ResolveTransactionChanges
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: ResolveTransactionChanges\<T, TOperation\>

```ts
type ResolveTransactionChanges<T, TOperation> = TOperation extends "delete" ? T : Partial<T>;
```

Defined in: [packages/db/src/types.ts:94](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L94)

## Type Parameters

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>

• **TOperation** *extends* [`OperationType`](../operationtype.md) = [`OperationType`](../operationtype.md)

## Remarks

`update` and `insert` are both represented as `Partial<T>`, but changes for `insert` could me made more precise by inferring the schema input type. In practice, this has almost 0 real world impact so it's not worth the added type complexity.

## See

https://github.com/TanStack/db/pull/209#issuecomment-3053001206
---
id: UpdateMutationFn
title: UpdateMutationFn
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: UpdateMutationFn()\<T, TKey, TUtils\>

```ts
type UpdateMutationFn<T, TKey, TUtils> = (params) => Promise<any>;
```

Defined in: [packages/db/src/types.ts:308](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L308)

## Type Parameters

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>

• **TKey** *extends* `string` \| `number` = `string` \| `number`

• **TUtils** *extends* [`UtilsRecord`](../utilsrecord.md) = `Record`\<`string`, [`Fn`](../fn.md)\>

## Parameters

### params

[`UpdateMutationFnParams`](../updatemutationfnparams.md)\<`T`, `TKey`, `TUtils`\>

## Returns

`Promise`\<`any`\>
---
id: StorageEventApi
title: StorageEventApi
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: StorageEventApi

```ts
type StorageEventApi = object;
```

Defined in: [packages/db/src/local-storage.ts:28](https://github.com/TanStack/db/blob/main/packages/db/src/local-storage.ts#L28)

Storage event API - subset of Window for 'storage' events only

## Type declaration

### addEventListener()

```ts
addEventListener: (type, listener) => void;
```

#### Parameters

##### type

`"storage"`

##### listener

(`event`) => `void`

#### Returns

`void`

### removeEventListener()

```ts
removeEventListener: (type, listener) => void;
```

#### Parameters

##### type

`"storage"`

##### listener

(`event`) => `void`

#### Returns

`void`
---
id: ResolveType
title: ResolveType
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: ResolveType\<TExplicit, TSchema, TFallback\>

```ts
type ResolveType<TExplicit, TSchema, TFallback> = unknown extends TExplicit ? [TSchema] extends [never] ? TFallback : InferSchemaOutput<TSchema> : TExplicit extends object ? TExplicit : Record<string, unknown>;
```

Defined in: [packages/db/src/types.ts:64](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L64)

Helper type to determine the final type based on priority:
1. Explicit generic TExplicit (if not 'unknown')
2. Schema output type (if schema provided)
3. Fallback type TFallback

## Type Parameters

• **TExplicit**

• **TSchema** *extends* `StandardSchemaV1` = `never`

• **TFallback** *extends* `object` = `Record`\<`string`, `unknown`\>

## Remarks

This type is used internally to resolve the collection item type based on the provided generics and schema.
Users should not need to use this type directly, but understanding the priority order helps when defining collections.
---
id: InputRow
title: InputRow
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: InputRow

```ts
type InputRow = [unknown, Record<string, unknown>];
```

Defined in: [packages/db/src/types.ts:538](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L538)

An input row from a collection
---
id: QueryBuilder
title: QueryBuilder
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: QueryBuilder\<TContext\>

```ts
type QueryBuilder<TContext> = Omit<BaseQueryBuilder<TContext>, "from" | "_getQuery">;
```

Defined in: [packages/db/src/query/builder/index.ts:760](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/index.ts#L760)

## Type Parameters

• **TContext** *extends* [`Context`](../../interfaces/context.md)
---
id: KeyedNamespacedRow
title: KeyedNamespacedRow
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: KeyedNamespacedRow

```ts
type KeyedNamespacedRow = [unknown, NamespacedRow];
```

Defined in: [packages/db/src/types.ts:561](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L561)

A keyed namespaced row is a row with a key and a namespaced row
This is the main representation of a row in a query pipeline
---
id: OperationType
title: OperationType
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: OperationType

```ts
type OperationType = "insert" | "update" | "delete";
```

Defined in: [packages/db/src/types.ts:198](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L198)
---
id: Ref
title: Ref
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: Ref\<T\>

```ts
type Ref<T> = RefProxyFor<T>;
```

Defined in: [packages/db/src/query/builder/types.ts:144](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/types.ts#L144)

## Type Parameters

• **T**
---
id: UtilsRecord
title: UtilsRecord
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: UtilsRecord

```ts
type UtilsRecord = Record<string, Fn>;
```

Defined in: [packages/db/src/types.ts:86](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L86)

A record of utility functions that can be attached to a collection
---
id: InferSchemaInput
title: InferSchemaInput
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: InferSchemaInput\<T\>

```ts
type InferSchemaInput<T> = T extends StandardSchemaV1 ? StandardSchemaV1.InferInput<T> extends object ? StandardSchemaV1.InferInput<T> : Record<string, unknown> : Record<string, unknown>;
```

Defined in: [packages/db/src/types.ts:25](https://github.com/TanStack/db/blob/main/packages/db/src/types.ts#L25)

**`Internal`**

Helper type to extract the input type from a standard schema

 This is used for collection insert type inference

## Type Parameters

• **T**
---
id: StorageKeyRequiredError
title: StorageKeyRequiredError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: StorageKeyRequiredError

Defined in: [packages/db/src/errors.ts:489](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L489)

## Extends

- [`LocalStorageCollectionError`](../localstoragecollectionerror.md)

## Constructors

### new StorageKeyRequiredError()

```ts
new StorageKeyRequiredError(): StorageKeyRequiredError
```

Defined in: [packages/db/src/errors.ts:490](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L490)

#### Returns

[`StorageKeyRequiredError`](../storagekeyrequirederror.md)

#### Overrides

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`constructor`](../LocalStorageCollectionError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`cause`](../LocalStorageCollectionError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`message`](../LocalStorageCollectionError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`name`](../LocalStorageCollectionError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`stack`](../LocalStorageCollectionError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`prepareStackTrace`](../LocalStorageCollectionError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`stackTraceLimit`](../LocalStorageCollectionError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`captureStackTrace`](../LocalStorageCollectionError.md#capturestacktrace)
---
id: InvalidJoinConditionWrongTablesError
title: InvalidJoinConditionWrongTablesError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: InvalidJoinConditionWrongTablesError

Defined in: [packages/db/src/errors.ts:410](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L410)

## Extends

- [`JoinError`](../joinerror.md)

## Constructors

### new InvalidJoinConditionWrongTablesError()

```ts
new InvalidJoinConditionWrongTablesError(
   leftTableAlias, 
   rightTableAlias, 
   mainTableAlias, 
   joinedTableAlias): InvalidJoinConditionWrongTablesError
```

Defined in: [packages/db/src/errors.ts:411](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L411)

#### Parameters

##### leftTableAlias

`string`

##### rightTableAlias

`string`

##### mainTableAlias

`string`

##### joinedTableAlias

`string`

#### Returns

[`InvalidJoinConditionWrongTablesError`](../invalidjoinconditionwrongtableserror.md)

#### Overrides

[`JoinError`](../joinerror.md).[`constructor`](../JoinError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`JoinError`](../joinerror.md).[`cause`](../JoinError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`JoinError`](../joinerror.md).[`message`](../JoinError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`JoinError`](../joinerror.md).[`name`](../JoinError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`JoinError`](../joinerror.md).[`stack`](../JoinError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`JoinError`](../joinerror.md).[`prepareStackTrace`](../JoinError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`JoinError`](../joinerror.md).[`stackTraceLimit`](../JoinError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`JoinError`](../joinerror.md).[`captureStackTrace`](../JoinError.md#capturestacktrace)
---
id: EmptyReferencePathError
title: EmptyReferencePathError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: EmptyReferencePathError

Defined in: [packages/db/src/errors.ts:368](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L368)

## Extends

- [`QueryCompilationError`](../querycompilationerror.md)

## Constructors

### new EmptyReferencePathError()

```ts
new EmptyReferencePathError(): EmptyReferencePathError
```

Defined in: [packages/db/src/errors.ts:369](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L369)

#### Returns

[`EmptyReferencePathError`](../emptyreferencepatherror.md)

#### Overrides

[`QueryCompilationError`](../querycompilationerror.md).[`constructor`](../QueryCompilationError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`cause`](../QueryCompilationError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`message`](../QueryCompilationError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`name`](../QueryCompilationError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`stack`](../QueryCompilationError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`prepareStackTrace`](../QueryCompilationError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`stackTraceLimit`](../QueryCompilationError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`captureStackTrace`](../QueryCompilationError.md#capturestacktrace)
---
id: NoPendingSyncTransactionWriteError
title: NoPendingSyncTransactionWriteError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: NoPendingSyncTransactionWriteError

Defined in: [packages/db/src/errors.ts:256](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L256)

## Extends

- [`TransactionError`](../transactionerror.md)

## Constructors

### new NoPendingSyncTransactionWriteError()

```ts
new NoPendingSyncTransactionWriteError(): NoPendingSyncTransactionWriteError
```

Defined in: [packages/db/src/errors.ts:257](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L257)

#### Returns

[`NoPendingSyncTransactionWriteError`](../nopendingsynctransactionwriteerror.md)

#### Overrides

[`TransactionError`](../transactionerror.md).[`constructor`](../TransactionError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`TransactionError`](../transactionerror.md).[`cause`](../TransactionError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`TransactionError`](../transactionerror.md).[`message`](../TransactionError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`TransactionError`](../transactionerror.md).[`name`](../TransactionError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`TransactionError`](../transactionerror.md).[`stack`](../TransactionError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`TransactionError`](../transactionerror.md).[`prepareStackTrace`](../TransactionError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`TransactionError`](../transactionerror.md).[`stackTraceLimit`](../TransactionError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`TransactionError`](../transactionerror.md).[`captureStackTrace`](../TransactionError.md#capturestacktrace)
---
id: QueryBuilderError
title: QueryBuilderError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: QueryBuilderError

Defined in: [packages/db/src/errors.ts:285](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L285)

## Extends

- [`TanStackDBError`](../tanstackdberror.md)

## Extended by

- [`OnlyOneSourceAllowedError`](../onlyonesourceallowederror.md)
- [`SubQueryMustHaveFromClauseError`](../subquerymusthavefromclauseerror.md)
- [`InvalidSourceError`](../invalidsourceerror.md)
- [`JoinConditionMustBeEqualityError`](../joinconditionmustbeequalityerror.md)
- [`QueryMustHaveFromClauseError`](../querymusthavefromclauseerror.md)

## Constructors

### new QueryBuilderError()

```ts
new QueryBuilderError(message): QueryBuilderError
```

Defined in: [packages/db/src/errors.ts:286](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L286)

#### Parameters

##### message

`string`

#### Returns

[`QueryBuilderError`](../querybuildererror.md)

#### Overrides

[`TanStackDBError`](../tanstackdberror.md).[`constructor`](../TanStackDBError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`cause`](../TanStackDBError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`message`](../TanStackDBError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`name`](../TanStackDBError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stack`](../TanStackDBError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`prepareStackTrace`](../TanStackDBError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stackTraceLimit`](../TanStackDBError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`captureStackTrace`](../TanStackDBError.md#capturestacktrace)
---
id: CollectionRequiresSyncConfigError
title: CollectionRequiresSyncConfigError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: CollectionRequiresSyncConfigError

Defined in: [packages/db/src/errors.ts:58](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L58)

## Extends

- [`CollectionConfigurationError`](../collectionconfigurationerror.md)

## Constructors

### new CollectionRequiresSyncConfigError()

```ts
new CollectionRequiresSyncConfigError(): CollectionRequiresSyncConfigError
```

Defined in: [packages/db/src/errors.ts:59](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L59)

#### Returns

[`CollectionRequiresSyncConfigError`](../collectionrequiressyncconfigerror.md)

#### Overrides

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`constructor`](../CollectionConfigurationError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`cause`](../CollectionConfigurationError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`message`](../CollectionConfigurationError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`name`](../CollectionConfigurationError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`stack`](../CollectionConfigurationError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`prepareStackTrace`](../CollectionConfigurationError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`stackTraceLimit`](../CollectionConfigurationError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`captureStackTrace`](../CollectionConfigurationError.md#capturestacktrace)
---
id: DistinctRequiresSelectError
title: DistinctRequiresSelectError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: DistinctRequiresSelectError

Defined in: [packages/db/src/errors.ts:330](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L330)

## Extends

- [`QueryCompilationError`](../querycompilationerror.md)

## Constructors

### new DistinctRequiresSelectError()

```ts
new DistinctRequiresSelectError(): DistinctRequiresSelectError
```

Defined in: [packages/db/src/errors.ts:331](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L331)

#### Returns

[`DistinctRequiresSelectError`](../distinctrequiresselecterror.md)

#### Overrides

[`QueryCompilationError`](../querycompilationerror.md).[`constructor`](../QueryCompilationError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`cause`](../QueryCompilationError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`message`](../QueryCompilationError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`name`](../QueryCompilationError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`stack`](../QueryCompilationError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`prepareStackTrace`](../QueryCompilationError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`stackTraceLimit`](../QueryCompilationError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`captureStackTrace`](../QueryCompilationError.md#capturestacktrace)
---
id: UpdateKeyNotFoundError
title: UpdateKeyNotFoundError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: UpdateKeyNotFoundError

Defined in: [packages/db/src/errors.ts:156](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L156)

## Extends

- [`CollectionOperationError`](../collectionoperationerror.md)

## Constructors

### new UpdateKeyNotFoundError()

```ts
new UpdateKeyNotFoundError(key): UpdateKeyNotFoundError
```

Defined in: [packages/db/src/errors.ts:157](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L157)

#### Parameters

##### key

`string` | `number`

#### Returns

[`UpdateKeyNotFoundError`](../updatekeynotfounderror.md)

#### Overrides

[`CollectionOperationError`](../collectionoperationerror.md).[`constructor`](../CollectionOperationError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`cause`](../CollectionOperationError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`message`](../CollectionOperationError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`name`](../CollectionOperationError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`stack`](../CollectionOperationError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`prepareStackTrace`](../CollectionOperationError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`stackTraceLimit`](../CollectionOperationError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`captureStackTrace`](../CollectionOperationError.md#capturestacktrace)
---
id: KeyUpdateNotAllowedError
title: KeyUpdateNotAllowedError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: KeyUpdateNotAllowedError

Defined in: [packages/db/src/errors.ts:164](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L164)

## Extends

- [`CollectionOperationError`](../collectionoperationerror.md)

## Constructors

### new KeyUpdateNotAllowedError()

```ts
new KeyUpdateNotAllowedError(originalKey, newKey): KeyUpdateNotAllowedError
```

Defined in: [packages/db/src/errors.ts:165](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L165)

#### Parameters

##### originalKey

`string` | `number`

##### newKey

`string` | `number`

#### Returns

[`KeyUpdateNotAllowedError`](../keyupdatenotallowederror.md)

#### Overrides

[`CollectionOperationError`](../collectionoperationerror.md).[`constructor`](../CollectionOperationError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`cause`](../CollectionOperationError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`message`](../CollectionOperationError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`name`](../CollectionOperationError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`stack`](../CollectionOperationError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`prepareStackTrace`](../CollectionOperationError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`stackTraceLimit`](../CollectionOperationError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`captureStackTrace`](../CollectionOperationError.md#capturestacktrace)
---
id: IndexProxy
title: IndexProxy
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: IndexProxy\<TKey\>

Defined in: [packages/db/src/indexes/lazy-index.ts:131](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L131)

Proxy that provides synchronous interface while index loads asynchronously

## Type Parameters

• **TKey** *extends* `string` \| `number` = `string` \| `number`

## Constructors

### new IndexProxy()

```ts
new IndexProxy<TKey>(indexId, lazyIndex): IndexProxy<TKey>
```

Defined in: [packages/db/src/indexes/lazy-index.ts:132](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L132)

#### Parameters

##### indexId

`number`

##### lazyIndex

[`LazyIndexWrapper`](../lazyindexwrapper.md)\<`TKey`\>

#### Returns

[`IndexProxy`](../indexproxy.md)\<`TKey`\>

## Accessors

### expression

#### Get Signature

```ts
get expression(): BasicExpression
```

Defined in: [packages/db/src/indexes/lazy-index.ts:178](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L178)

Get the index expression (available immediately)

##### Returns

`BasicExpression`

***

### id

#### Get Signature

```ts
get id(): number
```

Defined in: [packages/db/src/indexes/lazy-index.ts:161](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L161)

Get the index ID

##### Returns

`number`

***

### index

#### Get Signature

```ts
get index(): BaseIndex<TKey>
```

Defined in: [packages/db/src/indexes/lazy-index.ts:140](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L140)

Get the resolved index (throws if not ready)

##### Returns

[`BaseIndex`](../baseindex.md)\<`TKey`\>

***

### indexedKeysSet

#### Get Signature

```ts
get indexedKeysSet(): Set<TKey>
```

Defined in: [packages/db/src/indexes/lazy-index.ts:216](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L216)

##### Returns

`Set`\<`TKey`\>

***

### isReady

#### Get Signature

```ts
get isReady(): boolean
```

Defined in: [packages/db/src/indexes/lazy-index.ts:147](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L147)

Check if index is ready

##### Returns

`boolean`

***

### keyCount

#### Get Signature

```ts
get keyCount(): number
```

Defined in: [packages/db/src/indexes/lazy-index.ts:211](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L211)

Get the key count (throws if not ready)

##### Returns

`number`

***

### name

#### Get Signature

```ts
get name(): undefined | string
```

Defined in: [packages/db/src/indexes/lazy-index.ts:168](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L168)

Get the index name (throws if not ready)

##### Returns

`undefined` \| `string`

***

### orderedEntriesArray

#### Get Signature

```ts
get orderedEntriesArray(): [any, Set<TKey>][]
```

Defined in: [packages/db/src/indexes/lazy-index.ts:221](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L221)

##### Returns

\[`any`, `Set`\<`TKey`\>\][]

***

### valueMapData

#### Get Signature

```ts
get valueMapData(): Map<any, Set<TKey>>
```

Defined in: [packages/db/src/indexes/lazy-index.ts:226](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L226)

##### Returns

`Map`\<`any`, `Set`\<`TKey`\>\>

## Methods

### \_getLazyWrapper()

```ts
_getLazyWrapper(): LazyIndexWrapper<TKey>
```

Defined in: [packages/db/src/indexes/lazy-index.ts:248](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L248)

#### Returns

[`LazyIndexWrapper`](../lazyindexwrapper.md)\<`TKey`\>

***

### equalityLookup()

```ts
equalityLookup(value): Set<TKey>
```

Defined in: [packages/db/src/indexes/lazy-index.ts:232](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L232)

#### Parameters

##### value

`any`

#### Returns

`Set`\<`TKey`\>

***

### getStats()

```ts
getStats(): IndexStats
```

Defined in: [packages/db/src/indexes/lazy-index.ts:192](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L192)

Get index statistics (throws if not ready)

#### Returns

[`IndexStats`](../../interfaces/indexstats.md)

***

### inArrayLookup()

```ts
inArrayLookup(values): Set<TKey>
```

Defined in: [packages/db/src/indexes/lazy-index.ts:242](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L242)

#### Parameters

##### values

`any`[]

#### Returns

`Set`\<`TKey`\>

***

### matchesField()

```ts
matchesField(fieldPath): boolean
```

Defined in: [packages/db/src/indexes/lazy-index.ts:199](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L199)

Check if index matches a field path (available immediately)

#### Parameters

##### fieldPath

`string`[]

#### Returns

`boolean`

***

### rangeQuery()

```ts
rangeQuery(options): Set<TKey>
```

Defined in: [packages/db/src/indexes/lazy-index.ts:237](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L237)

#### Parameters

##### options

`any`

#### Returns

`Set`\<`TKey`\>

***

### supports()

```ts
supports(operation): boolean
```

Defined in: [packages/db/src/indexes/lazy-index.ts:185](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L185)

Check if index supports an operation (throws if not ready)

#### Parameters

##### operation

`any`

#### Returns

`boolean`

***

### whenReady()

```ts
whenReady(): Promise<BaseIndex<TKey>>
```

Defined in: [packages/db/src/indexes/lazy-index.ts:154](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L154)

Wait for index to be ready

#### Returns

`Promise`\<[`BaseIndex`](../baseindex.md)\<`TKey`\>\>
---
id: TransactionNotPendingCommitError
title: TransactionNotPendingCommitError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: TransactionNotPendingCommitError

Defined in: [packages/db/src/errors.ts:248](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L248)

## Extends

- [`TransactionError`](../transactionerror.md)

## Constructors

### new TransactionNotPendingCommitError()

```ts
new TransactionNotPendingCommitError(): TransactionNotPendingCommitError
```

Defined in: [packages/db/src/errors.ts:249](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L249)

#### Returns

[`TransactionNotPendingCommitError`](../transactionnotpendingcommiterror.md)

#### Overrides

[`TransactionError`](../transactionerror.md).[`constructor`](../TransactionError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`TransactionError`](../transactionerror.md).[`cause`](../TransactionError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`TransactionError`](../transactionerror.md).[`message`](../TransactionError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`TransactionError`](../transactionerror.md).[`name`](../TransactionError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`TransactionError`](../transactionerror.md).[`stack`](../TransactionError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`TransactionError`](../transactionerror.md).[`prepareStackTrace`](../TransactionError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`TransactionError`](../transactionerror.md).[`stackTraceLimit`](../TransactionError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`TransactionError`](../transactionerror.md).[`captureStackTrace`](../TransactionError.md#capturestacktrace)
---
id: TransactionAlreadyCompletedRollbackError
title: TransactionAlreadyCompletedRollbackError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: TransactionAlreadyCompletedRollbackError

Defined in: [packages/db/src/errors.ts:240](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L240)

## Extends

- [`TransactionError`](../transactionerror.md)

## Constructors

### new TransactionAlreadyCompletedRollbackError()

```ts
new TransactionAlreadyCompletedRollbackError(): TransactionAlreadyCompletedRollbackError
```

Defined in: [packages/db/src/errors.ts:241](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L241)

#### Returns

[`TransactionAlreadyCompletedRollbackError`](../transactionalreadycompletedrollbackerror.md)

#### Overrides

[`TransactionError`](../transactionerror.md).[`constructor`](../TransactionError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`TransactionError`](../transactionerror.md).[`cause`](../TransactionError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`TransactionError`](../transactionerror.md).[`message`](../TransactionError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`TransactionError`](../transactionerror.md).[`name`](../TransactionError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`TransactionError`](../transactionerror.md).[`stack`](../TransactionError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`TransactionError`](../transactionerror.md).[`prepareStackTrace`](../TransactionError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`TransactionError`](../transactionerror.md).[`stackTraceLimit`](../TransactionError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`TransactionError`](../transactionerror.md).[`captureStackTrace`](../TransactionError.md#capturestacktrace)
---
id: SyncTransactionAlreadyCommittedError
title: SyncTransactionAlreadyCommittedError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: SyncTransactionAlreadyCommittedError

Defined in: [packages/db/src/errors.ts:276](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L276)

## Extends

- [`TransactionError`](../transactionerror.md)

## Constructors

### new SyncTransactionAlreadyCommittedError()

```ts
new SyncTransactionAlreadyCommittedError(): SyncTransactionAlreadyCommittedError
```

Defined in: [packages/db/src/errors.ts:277](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L277)

#### Returns

[`SyncTransactionAlreadyCommittedError`](../synctransactionalreadycommittederror.md)

#### Overrides

[`TransactionError`](../transactionerror.md).[`constructor`](../TransactionError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`TransactionError`](../transactionerror.md).[`cause`](../TransactionError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`TransactionError`](../transactionerror.md).[`message`](../TransactionError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`TransactionError`](../transactionerror.md).[`name`](../TransactionError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`TransactionError`](../transactionerror.md).[`stack`](../TransactionError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`TransactionError`](../transactionerror.md).[`prepareStackTrace`](../TransactionError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`TransactionError`](../transactionerror.md).[`stackTraceLimit`](../TransactionError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`TransactionError`](../transactionerror.md).[`captureStackTrace`](../TransactionError.md#capturestacktrace)
---
id: UnknownHavingExpressionTypeError
title: UnknownHavingExpressionTypeError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: UnknownHavingExpressionTypeError

Defined in: [packages/db/src/errors.ts:459](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L459)

## Extends

- [`GroupByError`](../groupbyerror.md)

## Constructors

### new UnknownHavingExpressionTypeError()

```ts
new UnknownHavingExpressionTypeError(type): UnknownHavingExpressionTypeError
```

Defined in: [packages/db/src/errors.ts:460](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L460)

#### Parameters

##### type

`string`

#### Returns

[`UnknownHavingExpressionTypeError`](../unknownhavingexpressiontypeerror.md)

#### Overrides

[`GroupByError`](../groupbyerror.md).[`constructor`](../GroupByError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`cause`](../GroupByError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`message`](../GroupByError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`name`](../GroupByError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`stack`](../GroupByError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`prepareStackTrace`](../GroupByError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`stackTraceLimit`](../GroupByError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`captureStackTrace`](../GroupByError.md#capturestacktrace)
---
id: SerializationError
title: SerializationError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: SerializationError

Defined in: [packages/db/src/errors.ts:473](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L473)

## Extends

- [`StorageError`](../storageerror.md)

## Constructors

### new SerializationError()

```ts
new SerializationError(operation, originalError): SerializationError
```

Defined in: [packages/db/src/errors.ts:474](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L474)

#### Parameters

##### operation

`string`

##### originalError

`string`

#### Returns

[`SerializationError`](../serializationerror.md)

#### Overrides

[`StorageError`](../storageerror.md).[`constructor`](../StorageError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`StorageError`](../storageerror.md).[`cause`](../StorageError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`StorageError`](../storageerror.md).[`message`](../StorageError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`StorageError`](../storageerror.md).[`name`](../StorageError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`StorageError`](../storageerror.md).[`stack`](../StorageError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`StorageError`](../storageerror.md).[`prepareStackTrace`](../StorageError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`StorageError`](../storageerror.md).[`stackTraceLimit`](../StorageError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`StorageError`](../storageerror.md).[`captureStackTrace`](../StorageError.md#capturestacktrace)
---
id: OnlyOneSourceAllowedError
title: OnlyOneSourceAllowedError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: OnlyOneSourceAllowedError

Defined in: [packages/db/src/errors.ts:292](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L292)

## Extends

- [`QueryBuilderError`](../querybuildererror.md)

## Constructors

### new OnlyOneSourceAllowedError()

```ts
new OnlyOneSourceAllowedError(context): OnlyOneSourceAllowedError
```

Defined in: [packages/db/src/errors.ts:293](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L293)

#### Parameters

##### context

`string`

#### Returns

[`OnlyOneSourceAllowedError`](../onlyonesourceallowederror.md)

#### Overrides

[`QueryBuilderError`](../querybuildererror.md).[`constructor`](../QueryBuilderError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`cause`](../QueryBuilderError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`message`](../QueryBuilderError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`name`](../QueryBuilderError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`stack`](../QueryBuilderError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`prepareStackTrace`](../QueryBuilderError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`stackTraceLimit`](../QueryBuilderError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`captureStackTrace`](../QueryBuilderError.md#capturestacktrace)
---
id: CollectionRequiresConfigError
title: CollectionRequiresConfigError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: CollectionRequiresConfigError

Defined in: [packages/db/src/errors.ts:52](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L52)

## Extends

- [`CollectionConfigurationError`](../collectionconfigurationerror.md)

## Constructors

### new CollectionRequiresConfigError()

```ts
new CollectionRequiresConfigError(): CollectionRequiresConfigError
```

Defined in: [packages/db/src/errors.ts:53](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L53)

#### Returns

[`CollectionRequiresConfigError`](../collectionrequiresconfigerror.md)

#### Overrides

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`constructor`](../CollectionConfigurationError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`cause`](../CollectionConfigurationError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`message`](../CollectionConfigurationError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`name`](../CollectionConfigurationError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`stack`](../CollectionConfigurationError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`prepareStackTrace`](../CollectionConfigurationError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`stackTraceLimit`](../CollectionConfigurationError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`captureStackTrace`](../CollectionConfigurationError.md#capturestacktrace)
---
id: BaseQueryBuilder
title: BaseQueryBuilder
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: BaseQueryBuilder\<TContext\>

Defined in: [packages/db/src/query/builder/index.ts:37](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/index.ts#L37)

## Type Parameters

• **TContext** *extends* [`Context`](../../interfaces/context.md) = [`Context`](../../interfaces/context.md)

## Constructors

### new BaseQueryBuilder()

```ts
new BaseQueryBuilder<TContext>(query): BaseQueryBuilder<TContext>
```

Defined in: [packages/db/src/query/builder/index.ts:40](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/index.ts#L40)

#### Parameters

##### query

`Partial`\<`QueryIR`\> = `{}`

#### Returns

[`BaseQueryBuilder`](../basequerybuilder.md)\<`TContext`\>

## Accessors

### fn

#### Get Signature

```ts
get fn(): object
```

Defined in: [packages/db/src/query/builder/index.ts:645](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/index.ts#L645)

Functional variants of the query builder
These are imperative function that are called for ery row.
Warning: that these cannot be optimized by the query compiler, and may prevent
some type of optimizations being possible.

##### Example

```ts
q.fn.select((row) => ({
  name: row.user.name.toUpperCase(),
  age: row.user.age + 1,
}))
```

##### Returns

`object`

###### having()

Filter grouped rows using a function that operates on each aggregated row
Warning: This cannot be optimized by the query compiler

###### Parameters

###### callback

(`row`) => `any`

A function that receives an aggregated row and returns a boolean

###### Returns

[`QueryBuilder`](../../type-aliases/querybuilder.md)\<`TContext`\>

A QueryBuilder with functional having filter applied

###### Example

```ts
// Functional having (not optimized)
query
  .from({ posts: postsCollection })
  .groupBy(({posts}) => posts.userId)
  .fn.having(row => row.count > 5)
```

###### select()

Select fields using a function that operates on each row
Warning: This cannot be optimized by the query compiler

###### Type Parameters

• **TFuncSelectResult**

###### Parameters

###### callback

(`row`) => `TFuncSelectResult`

A function that receives a row and returns the selected value

###### Returns

[`QueryBuilder`](../../type-aliases/querybuilder.md)\<\{ \[K in string \| number \| symbol\]: (Omit\<TContext, "result"\> & \{ result: \{ \[K in string \| number \| symbol\]: TFuncSelectResult\[K\] \} \})\[K\] \}\>

A QueryBuilder with functional selection applied

###### Example

```ts
// Functional select (not optimized)
query
  .from({ users: usersCollection })
  .fn.select(row => ({
    name: row.users.name.toUpperCase(),
    age: row.users.age + 1,
  }))
```

###### where()

Filter rows using a function that operates on each row
Warning: This cannot be optimized by the query compiler

###### Parameters

###### callback

(`row`) => `any`

A function that receives a row and returns a boolean

###### Returns

[`QueryBuilder`](../../type-aliases/querybuilder.md)\<`TContext`\>

A QueryBuilder with functional filtering applied

###### Example

```ts
// Functional where (not optimized)
query
  .from({ users: usersCollection })
  .fn.where(row => row.users.name.startsWith('A'))
```

## Methods

### \_getQuery()

```ts
_getQuery(): QueryIR
```

Defined in: [packages/db/src/query/builder/index.ts:731](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/index.ts#L731)

#### Returns

`QueryIR`

***

### distinct()

```ts
distinct(): QueryBuilder<TContext>
```

Defined in: [packages/db/src/query/builder/index.ts:606](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/index.ts#L606)

Specify that the query should return distinct rows.
Deduplicates rows based on the selected columns.

#### Returns

[`QueryBuilder`](../../type-aliases/querybuilder.md)\<`TContext`\>

A QueryBuilder with distinct enabled

#### Example

```ts
// Get countries our users are from
query
  .from({ users: usersCollection })
  .select(({users}) => users.country)
  .distinct()
```

***

### from()

```ts
from<TSource>(source): QueryBuilder<{
  baseSchema: { [K in string | number | symbol]: { [K in string | number | symbol]: TSource[K] extends CollectionImpl<U, string | number, {}, StandardSchemaV1<unknown, unknown>, U> ? U : TSource[K] extends QueryBuilder<TContext> ? { [K in string | number | symbol]: ((...)[(...)] extends object ? any[any] : (...) extends (...) ? (...) : (...))[K] } : never }[K] };
  fromSourceName: keyof TSource & string;
  hasJoins: false;
  schema: { [K in string | number | symbol]: { [K in string | number | symbol]: TSource[K] extends CollectionImpl<U, string | number, {}, StandardSchemaV1<unknown, unknown>, U> ? U : TSource[K] extends QueryBuilder<TContext> ? { [K in string | number | symbol]: ((...)[(...)] extends object ? any[any] : (...) extends (...) ? (...) : (...))[K] } : never }[K] };
}>
```

Defined in: [packages/db/src/query/builder/index.ts:94](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/index.ts#L94)

Specify the source table or subquery for the query

#### Type Parameters

• **TSource** *extends* [`Source`](../../type-aliases/source.md)

#### Parameters

##### source

`TSource`

An object with a single key-value pair where the key is the table alias and the value is a Collection or subquery

#### Returns

[`QueryBuilder`](../../type-aliases/querybuilder.md)\<\{
  `baseSchema`: \{ \[K in string \| number \| symbol\]: \{ \[K in string \| number \| symbol\]: TSource\[K\] extends CollectionImpl\<U, string \| number, \{\}, StandardSchemaV1\<unknown, unknown\>, U\> ? U : TSource\[K\] extends QueryBuilder\<TContext\> ? \{ \[K in string \| number \| symbol\]: ((...)\[(...)\] extends object ? any\[any\] : (...) extends (...) ? (...) : (...))\[K\] \} : never \}\[K\] \};
  `fromSourceName`: keyof `TSource` & `string`;
  `hasJoins`: `false`;
  `schema`: \{ \[K in string \| number \| symbol\]: \{ \[K in string \| number \| symbol\]: TSource\[K\] extends CollectionImpl\<U, string \| number, \{\}, StandardSchemaV1\<unknown, unknown\>, U\> ? U : TSource\[K\] extends QueryBuilder\<TContext\> ? \{ \[K in string \| number \| symbol\]: ((...)\[(...)\] extends object ? any\[any\] : (...) extends (...) ? (...) : (...))\[K\] \} : never \}\[K\] \};
 \}\>

A QueryBuilder with the specified source

#### Example

```ts
// Query from a collection
query.from({ users: usersCollection })

// Query from a subquery
const activeUsers = query.from({ u: usersCollection }).where(({u}) => u.active)
query.from({ activeUsers })
```

***

### fullJoin()

```ts
fullJoin<TSource>(source, onCallback): QueryBuilder<MergeContextWithJoinType<TContext, { [K in string | number | symbol]: { [K in string | number | symbol]: TSource[K] extends CollectionImpl<U, string | number, {}, StandardSchemaV1<unknown, unknown>, U> ? U : TSource[K] extends QueryBuilder<TContext> ? { [K in string | number | symbol]: ((...)[(...)] extends object ? any[any] : (...) extends (...) ? (...) : (...))[K] } : never }[K] }, "full">>
```

Defined in: [packages/db/src/query/builder/index.ts:285](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/index.ts#L285)

Perform a FULL JOIN with another table or subquery

#### Type Parameters

• **TSource** *extends* [`Source`](../../type-aliases/source.md)

#### Parameters

##### source

`TSource`

An object with a single key-value pair where the key is the table alias and the value is a Collection or subquery

##### onCallback

`JoinOnCallback`\<`MergeContext`\<`TContext`, \{ \[K in string \| number \| symbol\]: \{ \[K in string \| number \| symbol\]: TSource\[K\] extends CollectionImpl\<U, string \| number, \{\}, StandardSchemaV1\<unknown, unknown\>, U\> ? U : TSource\[K\] extends QueryBuilder\<TContext\> ? \{ \[K in string \| number \| symbol\]: ((...)\[(...)\] extends object ? any\[any\] : (...) extends (...) ? (...) : (...))\[K\] \} : never \}\[K\] \}\>\>

A function that receives table references and returns the join condition

#### Returns

[`QueryBuilder`](../../type-aliases/querybuilder.md)\<`MergeContextWithJoinType`\<`TContext`, \{ \[K in string \| number \| symbol\]: \{ \[K in string \| number \| symbol\]: TSource\[K\] extends CollectionImpl\<U, string \| number, \{\}, StandardSchemaV1\<unknown, unknown\>, U\> ? U : TSource\[K\] extends QueryBuilder\<TContext\> ? \{ \[K in string \| number \| symbol\]: ((...)\[(...)\] extends object ? any\[any\] : (...) extends (...) ? (...) : (...))\[K\] \} : never \}\[K\] \}, `"full"`\>\>

A QueryBuilder with the full joined table available

#### Example

```ts
// Full join users with posts
query
  .from({ users: usersCollection })
  .fullJoin({ posts: postsCollection }, ({users, posts}) => eq(users.id, posts.userId))
```

***

### groupBy()

```ts
groupBy(callback): QueryBuilder<TContext>
```

Defined in: [packages/db/src/query/builder/index.ts:529](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/index.ts#L529)

Group rows by one or more columns for aggregation

#### Parameters

##### callback

`GroupByCallback`\<`TContext`\>

A function that receives table references and returns the field(s) to group by

#### Returns

[`QueryBuilder`](../../type-aliases/querybuilder.md)\<`TContext`\>

A QueryBuilder with grouping applied (enables aggregate functions in SELECT and HAVING)

#### Example

```ts
// Group by a single column
query
  .from({ posts: postsCollection })
  .groupBy(({posts}) => posts.userId)
  .select(({posts, count}) => ({
    userId: posts.userId,
    postCount: count()
  }))

// Group by multiple columns
query
  .from({ sales: salesCollection })
  .groupBy(({sales}) => [sales.region, sales.category])
  .select(({sales, sum}) => ({
    region: sales.region,
    category: sales.category,
    totalSales: sum(sales.amount)
  }))
```

***

### having()

```ts
having(callback): QueryBuilder<TContext>
```

Defined in: [packages/db/src/query/builder/index.ts:365](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/index.ts#L365)

Filter grouped rows based on aggregate conditions

#### Parameters

##### callback

`WhereCallback`\<`TContext`\>

A function that receives table references and returns an expression

#### Returns

[`QueryBuilder`](../../type-aliases/querybuilder.md)\<`TContext`\>

A QueryBuilder with the having condition applied

#### Example

```ts
// Filter groups by count
query
  .from({ posts: postsCollection })
  .groupBy(({posts}) => posts.userId)
  .having(({posts}) => gt(count(posts.id), 5))

// Filter by average
query
  .from({ orders: ordersCollection })
  .groupBy(({orders}) => orders.customerId)
  .having(({orders}) => gt(avg(orders.total), 100))

// Multiple having calls are ANDed together
query
  .from({ orders: ordersCollection })
  .groupBy(({orders}) => orders.customerId)
  .having(({orders}) => gt(count(orders.id), 5))
  .having(({orders}) => gt(avg(orders.total), 100))
```

***

### innerJoin()

```ts
innerJoin<TSource>(source, onCallback): QueryBuilder<MergeContextWithJoinType<TContext, { [K in string | number | symbol]: { [K in string | number | symbol]: TSource[K] extends CollectionImpl<U, string | number, {}, StandardSchemaV1<unknown, unknown>, U> ? U : TSource[K] extends QueryBuilder<TContext> ? { [K in string | number | symbol]: ((...)[(...)] extends object ? any[any] : (...) extends (...) ? (...) : (...))[K] } : never }[K] }, "inner">>
```

Defined in: [packages/db/src/query/builder/index.ts:259](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/index.ts#L259)

Perform an INNER JOIN with another table or subquery

#### Type Parameters

• **TSource** *extends* [`Source`](../../type-aliases/source.md)

#### Parameters

##### source

`TSource`

An object with a single key-value pair where the key is the table alias and the value is a Collection or subquery

##### onCallback

`JoinOnCallback`\<`MergeContext`\<`TContext`, \{ \[K in string \| number \| symbol\]: \{ \[K in string \| number \| symbol\]: TSource\[K\] extends CollectionImpl\<U, string \| number, \{\}, StandardSchemaV1\<unknown, unknown\>, U\> ? U : TSource\[K\] extends QueryBuilder\<TContext\> ? \{ \[K in string \| number \| symbol\]: ((...)\[(...)\] extends object ? any\[any\] : (...) extends (...) ? (...) : (...))\[K\] \} : never \}\[K\] \}\>\>

A function that receives table references and returns the join condition

#### Returns

[`QueryBuilder`](../../type-aliases/querybuilder.md)\<`MergeContextWithJoinType`\<`TContext`, \{ \[K in string \| number \| symbol\]: \{ \[K in string \| number \| symbol\]: TSource\[K\] extends CollectionImpl\<U, string \| number, \{\}, StandardSchemaV1\<unknown, unknown\>, U\> ? U : TSource\[K\] extends QueryBuilder\<TContext\> ? \{ \[K in string \| number \| symbol\]: ((...)\[(...)\] extends object ? any\[any\] : (...) extends (...) ? (...) : (...))\[K\] \} : never \}\[K\] \}, `"inner"`\>\>

A QueryBuilder with the inner joined table available

#### Example

```ts
// Inner join users with posts
query
  .from({ users: usersCollection })
  .innerJoin({ posts: postsCollection }, ({users, posts}) => eq(users.id, posts.userId))
```

***

### join()

```ts
join<TSource, TJoinType>(
   source, 
   onCallback, 
type): QueryBuilder<MergeContextWithJoinType<TContext, { [K in string | number | symbol]: { [K in string | number | symbol]: TSource[K] extends CollectionImpl<U, string | number, {}, StandardSchemaV1<unknown, unknown>, U> ? U : TSource[K] extends QueryBuilder<TContext> ? { [K in string | number | symbol]: ((...)[(...)] extends object ? any[any] : (...) extends (...) ? (...) : (...))[K] } : never }[K] }, TJoinType>>
```

Defined in: [packages/db/src/query/builder/index.ts:137](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/index.ts#L137)

Join another table or subquery to the current query

#### Type Parameters

• **TSource** *extends* [`Source`](../../type-aliases/source.md)

• **TJoinType** *extends* `"full"` \| `"left"` \| `"right"` \| `"inner"` = `"left"`

#### Parameters

##### source

`TSource`

An object with a single key-value pair where the key is the table alias and the value is a Collection or subquery

##### onCallback

`JoinOnCallback`\<`MergeContext`\<`TContext`, \{ \[K in string \| number \| symbol\]: \{ \[K in string \| number \| symbol\]: TSource\[K\] extends CollectionImpl\<U, string \| number, \{\}, StandardSchemaV1\<unknown, unknown\>, U\> ? U : TSource\[K\] extends QueryBuilder\<TContext\> ? \{ \[K in string \| number \| symbol\]: ((...)\[(...)\] extends object ? any\[any\] : (...) extends (...) ? (...) : (...))\[K\] \} : never \}\[K\] \}\>\>

A function that receives table references and returns the join condition

##### type

`TJoinType` = `...`

The type of join: 'inner', 'left', 'right', or 'full' (defaults to 'left')

#### Returns

[`QueryBuilder`](../../type-aliases/querybuilder.md)\<`MergeContextWithJoinType`\<`TContext`, \{ \[K in string \| number \| symbol\]: \{ \[K in string \| number \| symbol\]: TSource\[K\] extends CollectionImpl\<U, string \| number, \{\}, StandardSchemaV1\<unknown, unknown\>, U\> ? U : TSource\[K\] extends QueryBuilder\<TContext\> ? \{ \[K in string \| number \| symbol\]: ((...)\[(...)\] extends object ? any\[any\] : (...) extends (...) ? (...) : (...))\[K\] \} : never \}\[K\] \}, `TJoinType`\>\>

A QueryBuilder with the joined table available

#### Example

```ts
// Left join users with posts
query
  .from({ users: usersCollection })
  .join({ posts: postsCollection }, ({users, posts}) => eq(users.id, posts.userId))

// Inner join with explicit type
query
  .from({ u: usersCollection })
  .join({ p: postsCollection }, ({u, p}) => eq(u.id, p.userId), 'inner')
```

// Join with a subquery
const activeUsers = query.from({ u: usersCollection }).where(({u}) => u.active)
query
  .from({ activeUsers })
  .join({ p: postsCollection }, ({u, p}) => eq(u.id, p.userId))

***

### leftJoin()

```ts
leftJoin<TSource>(source, onCallback): QueryBuilder<MergeContextWithJoinType<TContext, { [K in string | number | symbol]: { [K in string | number | symbol]: TSource[K] extends CollectionImpl<U, string | number, {}, StandardSchemaV1<unknown, unknown>, U> ? U : TSource[K] extends QueryBuilder<TContext> ? { [K in string | number | symbol]: ((...)[(...)] extends object ? any[any] : (...) extends (...) ? (...) : (...))[K] } : never }[K] }, "left">>
```

Defined in: [packages/db/src/query/builder/index.ts:207](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/index.ts#L207)

Perform a LEFT JOIN with another table or subquery

#### Type Parameters

• **TSource** *extends* [`Source`](../../type-aliases/source.md)

#### Parameters

##### source

`TSource`

An object with a single key-value pair where the key is the table alias and the value is a Collection or subquery

##### onCallback

`JoinOnCallback`\<`MergeContext`\<`TContext`, \{ \[K in string \| number \| symbol\]: \{ \[K in string \| number \| symbol\]: TSource\[K\] extends CollectionImpl\<U, string \| number, \{\}, StandardSchemaV1\<unknown, unknown\>, U\> ? U : TSource\[K\] extends QueryBuilder\<TContext\> ? \{ \[K in string \| number \| symbol\]: ((...)\[(...)\] extends object ? any\[any\] : (...) extends (...) ? (...) : (...))\[K\] \} : never \}\[K\] \}\>\>

A function that receives table references and returns the join condition

#### Returns

[`QueryBuilder`](../../type-aliases/querybuilder.md)\<`MergeContextWithJoinType`\<`TContext`, \{ \[K in string \| number \| symbol\]: \{ \[K in string \| number \| symbol\]: TSource\[K\] extends CollectionImpl\<U, string \| number, \{\}, StandardSchemaV1\<unknown, unknown\>, U\> ? U : TSource\[K\] extends QueryBuilder\<TContext\> ? \{ \[K in string \| number \| symbol\]: ((...)\[(...)\] extends object ? any\[any\] : (...) extends (...) ? (...) : (...))\[K\] \} : never \}\[K\] \}, `"left"`\>\>

A QueryBuilder with the left joined table available

#### Example

```ts
// Left join users with posts
query
  .from({ users: usersCollection })
  .leftJoin({ posts: postsCollection }, ({users, posts}) => eq(users.id, posts.userId))
```

***

### limit()

```ts
limit(count): QueryBuilder<TContext>
```

Defined in: [packages/db/src/query/builder/index.ts:561](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/index.ts#L561)

Limit the number of rows returned by the query
`orderBy` is required for `limit`

#### Parameters

##### count

`number`

Maximum number of rows to return

#### Returns

[`QueryBuilder`](../../type-aliases/querybuilder.md)\<`TContext`\>

A QueryBuilder with the limit applied

#### Example

```ts
// Get top 5 posts by likes
query
  .from({ posts: postsCollection })
  .orderBy(({posts}) => posts.likes, 'desc')
  .limit(5)
```

***

### offset()

```ts
offset(count): QueryBuilder<TContext>
```

Defined in: [packages/db/src/query/builder/index.ts:585](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/index.ts#L585)

Skip a number of rows before returning results
`orderBy` is required for `offset`

#### Parameters

##### count

`number`

Number of rows to skip

#### Returns

[`QueryBuilder`](../../type-aliases/querybuilder.md)\<`TContext`\>

A QueryBuilder with the offset applied

#### Example

```ts
// Get second page of results
query
  .from({ posts: postsCollection })
  .orderBy(({posts}) => posts.createdAt, 'desc')
  .offset(page * pageSize)
  .limit(pageSize)
```

***

### orderBy()

```ts
orderBy(callback, direction): QueryBuilder<TContext>
```

Defined in: [packages/db/src/query/builder/index.ts:479](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/index.ts#L479)

Sort the query results by one or more columns

#### Parameters

##### callback

`OrderByCallback`\<`TContext`\>

A function that receives table references and returns the field to sort by

##### direction

`OrderByDirection` = `...`

Sort direction: 'asc' for ascending, 'desc' for descending (defaults to 'asc')

#### Returns

[`QueryBuilder`](../../type-aliases/querybuilder.md)\<`TContext`\>

A QueryBuilder with the ordering applied

#### Example

```ts
// Sort by a single column
query
  .from({ users: usersCollection })
  .orderBy(({users}) => users.name)

// Sort descending
query
  .from({ users: usersCollection })
  .orderBy(({users}) => users.createdAt, 'desc')

// Multiple sorts (chain orderBy calls)
query
  .from({ users: usersCollection })
  .orderBy(({users}) => users.lastName)
  .orderBy(({users}) => users.firstName)
```

***

### rightJoin()

```ts
rightJoin<TSource>(source, onCallback): QueryBuilder<MergeContextWithJoinType<TContext, { [K in string | number | symbol]: { [K in string | number | symbol]: TSource[K] extends CollectionImpl<U, string | number, {}, StandardSchemaV1<unknown, unknown>, U> ? U : TSource[K] extends QueryBuilder<TContext> ? { [K in string | number | symbol]: ((...)[(...)] extends object ? any[any] : (...) extends (...) ? (...) : (...))[K] } : never }[K] }, "right">>
```

Defined in: [packages/db/src/query/builder/index.ts:233](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/index.ts#L233)

Perform a RIGHT JOIN with another table or subquery

#### Type Parameters

• **TSource** *extends* [`Source`](../../type-aliases/source.md)

#### Parameters

##### source

`TSource`

An object with a single key-value pair where the key is the table alias and the value is a Collection or subquery

##### onCallback

`JoinOnCallback`\<`MergeContext`\<`TContext`, \{ \[K in string \| number \| symbol\]: \{ \[K in string \| number \| symbol\]: TSource\[K\] extends CollectionImpl\<U, string \| number, \{\}, StandardSchemaV1\<unknown, unknown\>, U\> ? U : TSource\[K\] extends QueryBuilder\<TContext\> ? \{ \[K in string \| number \| symbol\]: ((...)\[(...)\] extends object ? any\[any\] : (...) extends (...) ? (...) : (...))\[K\] \} : never \}\[K\] \}\>\>

A function that receives table references and returns the join condition

#### Returns

[`QueryBuilder`](../../type-aliases/querybuilder.md)\<`MergeContextWithJoinType`\<`TContext`, \{ \[K in string \| number \| symbol\]: \{ \[K in string \| number \| symbol\]: TSource\[K\] extends CollectionImpl\<U, string \| number, \{\}, StandardSchemaV1\<unknown, unknown\>, U\> ? U : TSource\[K\] extends QueryBuilder\<TContext\> ? \{ \[K in string \| number \| symbol\]: ((...)\[(...)\] extends object ? any\[any\] : (...) extends (...) ? (...) : (...))\[K\] \} : never \}\[K\] \}, `"right"`\>\>

A QueryBuilder with the right joined table available

#### Example

```ts
// Right join users with posts
query
  .from({ users: usersCollection })
  .rightJoin({ posts: postsCollection }, ({users, posts}) => eq(users.id, posts.userId))
```

***

### select()

```ts
select<TSelectObject>(callback): QueryBuilder<{ [K in string | number | symbol]: (Omit<TContext, "result"> & { result: { [K in string | number | symbol]: ResultTypeFromSelect<TSelectObject>[K] } })[K] }>
```

Defined in: [packages/db/src/query/builder/index.ts:412](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/index.ts#L412)

Select specific columns or computed values from the query

#### Type Parameters

• **TSelectObject** *extends* `Record`\<`string`, 
  \| `BasicExpression`
  \| `Aggregate`\<`any`\>
  \| `RefProxy`\<`any`\>
  \| `RefProxyFor`\<`any`\>\>

#### Parameters

##### callback

(`refs`) => `TSelectObject`

A function that receives table references and returns an object with selected fields or expressions

#### Returns

[`QueryBuilder`](../../type-aliases/querybuilder.md)\<\{ \[K in string \| number \| symbol\]: (Omit\<TContext, "result"\> & \{ result: \{ \[K in string \| number \| symbol\]: ResultTypeFromSelect\<TSelectObject\>\[K\] \} \})\[K\] \}\>

A QueryBuilder that returns only the selected fields

#### Example

```ts
// Select specific columns
query
  .from({ users: usersCollection })
  .select(({users}) => ({
    name: users.name,
    email: users.email
  }))

// Select with computed values
query
  .from({ users: usersCollection })
  .select(({users}) => ({
    fullName: concat(users.firstName, ' ', users.lastName),
    ageInMonths: mul(users.age, 12)
  }))

// Select with aggregates (requires GROUP BY)
query
  .from({ posts: postsCollection })
  .groupBy(({posts}) => posts.userId)
  .select(({posts, count}) => ({
    userId: posts.userId,
    postCount: count(posts.id)
  }))
```

***

### where()

```ts
where(callback): QueryBuilder<TContext>
```

Defined in: [packages/db/src/query/builder/index.ts:324](https://github.com/TanStack/db/blob/main/packages/db/src/query/builder/index.ts#L324)

Filter rows based on a condition

#### Parameters

##### callback

`WhereCallback`\<`TContext`\>

A function that receives table references and returns an expression

#### Returns

[`QueryBuilder`](../../type-aliases/querybuilder.md)\<`TContext`\>

A QueryBuilder with the where condition applied

#### Example

```ts
// Simple condition
query
  .from({ users: usersCollection })
  .where(({users}) => gt(users.age, 18))

// Multiple conditions
query
  .from({ users: usersCollection })
  .where(({users}) => and(
    gt(users.age, 18),
    eq(users.active, true)
  ))

// Multiple where calls are ANDed together
query
  .from({ users: usersCollection })
  .where(({users}) => gt(users.age, 18))
  .where(({users}) => eq(users.active, true))
```
---
id: CollectionInputNotFoundError
title: CollectionInputNotFoundError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: CollectionInputNotFoundError

Defined in: [packages/db/src/errors.ts:350](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L350)

## Extends

- [`QueryCompilationError`](../querycompilationerror.md)

## Constructors

### new CollectionInputNotFoundError()

```ts
new CollectionInputNotFoundError(collectionId): CollectionInputNotFoundError
```

Defined in: [packages/db/src/errors.ts:351](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L351)

#### Parameters

##### collectionId

`string`

#### Returns

[`CollectionInputNotFoundError`](../collectioninputnotfounderror.md)

#### Overrides

[`QueryCompilationError`](../querycompilationerror.md).[`constructor`](../QueryCompilationError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`cause`](../QueryCompilationError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`message`](../QueryCompilationError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`name`](../QueryCompilationError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`stack`](../QueryCompilationError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`prepareStackTrace`](../QueryCompilationError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`stackTraceLimit`](../QueryCompilationError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`captureStackTrace`](../QueryCompilationError.md#capturestacktrace)
---
id: UnsupportedJoinTypeError
title: UnsupportedJoinTypeError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: UnsupportedJoinTypeError

Defined in: [packages/db/src/errors.ts:388](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L388)

## Extends

- [`JoinError`](../joinerror.md)

## Constructors

### new UnsupportedJoinTypeError()

```ts
new UnsupportedJoinTypeError(joinType): UnsupportedJoinTypeError
```

Defined in: [packages/db/src/errors.ts:389](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L389)

#### Parameters

##### joinType

`string`

#### Returns

[`UnsupportedJoinTypeError`](../unsupportedjointypeerror.md)

#### Overrides

[`JoinError`](../joinerror.md).[`constructor`](../JoinError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`JoinError`](../joinerror.md).[`cause`](../JoinError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`JoinError`](../joinerror.md).[`message`](../JoinError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`JoinError`](../joinerror.md).[`name`](../JoinError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`JoinError`](../joinerror.md).[`stack`](../JoinError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`JoinError`](../joinerror.md).[`prepareStackTrace`](../JoinError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`JoinError`](../joinerror.md).[`stackTraceLimit`](../JoinError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`JoinError`](../joinerror.md).[`captureStackTrace`](../JoinError.md#capturestacktrace)
---
id: NoKeysPassedToDeleteError
title: NoKeysPassedToDeleteError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: NoKeysPassedToDeleteError

Defined in: [packages/db/src/errors.ts:172](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L172)

## Extends

- [`CollectionOperationError`](../collectionoperationerror.md)

## Constructors

### new NoKeysPassedToDeleteError()

```ts
new NoKeysPassedToDeleteError(): NoKeysPassedToDeleteError
```

Defined in: [packages/db/src/errors.ts:173](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L173)

#### Returns

[`NoKeysPassedToDeleteError`](../nokeyspassedtodeleteerror.md)

#### Overrides

[`CollectionOperationError`](../collectionoperationerror.md).[`constructor`](../CollectionOperationError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`cause`](../CollectionOperationError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`message`](../CollectionOperationError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`name`](../CollectionOperationError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`stack`](../CollectionOperationError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`prepareStackTrace`](../CollectionOperationError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`stackTraceLimit`](../CollectionOperationError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`captureStackTrace`](../CollectionOperationError.md#capturestacktrace)
---
id: TransactionError
title: TransactionError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: TransactionError

Defined in: [packages/db/src/errors.ts:219](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L219)

## Extends

- [`TanStackDBError`](../tanstackdberror.md)

## Extended by

- [`MissingMutationFunctionError`](../missingmutationfunctionerror.md)
- [`TransactionNotPendingMutateError`](../transactionnotpendingmutateerror.md)
- [`TransactionAlreadyCompletedRollbackError`](../transactionalreadycompletedrollbackerror.md)
- [`TransactionNotPendingCommitError`](../transactionnotpendingcommiterror.md)
- [`NoPendingSyncTransactionWriteError`](../nopendingsynctransactionwriteerror.md)
- [`SyncTransactionAlreadyCommittedWriteError`](../synctransactionalreadycommittedwriteerror.md)
- [`NoPendingSyncTransactionCommitError`](../nopendingsynctransactioncommiterror.md)
- [`SyncTransactionAlreadyCommittedError`](../synctransactionalreadycommittederror.md)

## Constructors

### new TransactionError()

```ts
new TransactionError(message): TransactionError
```

Defined in: [packages/db/src/errors.ts:220](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L220)

#### Parameters

##### message

`string`

#### Returns

[`TransactionError`](../transactionerror.md)

#### Overrides

[`TanStackDBError`](../tanstackdberror.md).[`constructor`](../TanStackDBError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`cause`](../TanStackDBError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`message`](../TanStackDBError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`name`](../TanStackDBError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stack`](../TanStackDBError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`prepareStackTrace`](../TanStackDBError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stackTraceLimit`](../TanStackDBError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`captureStackTrace`](../TanStackDBError.md#capturestacktrace)
---
id: CollectionStateError
title: CollectionStateError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: CollectionStateError

Defined in: [packages/db/src/errors.ts:77](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L77)

## Extends

- [`TanStackDBError`](../tanstackdberror.md)

## Extended by

- [`CollectionInErrorStateError`](../collectioninerrorstateerror.md)
- [`InvalidCollectionStatusTransitionError`](../invalidcollectionstatustransitionerror.md)
- [`CollectionIsInErrorStateError`](../collectionisinerrorstateerror.md)
- [`NegativeActiveSubscribersError`](../negativeactivesubscriberserror.md)

## Constructors

### new CollectionStateError()

```ts
new CollectionStateError(message): CollectionStateError
```

Defined in: [packages/db/src/errors.ts:78](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L78)

#### Parameters

##### message

`string`

#### Returns

[`CollectionStateError`](../collectionstateerror.md)

#### Overrides

[`TanStackDBError`](../tanstackdberror.md).[`constructor`](../TanStackDBError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`cause`](../TanStackDBError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`message`](../TanStackDBError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`name`](../TanStackDBError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stack`](../TanStackDBError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`prepareStackTrace`](../TanStackDBError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stackTraceLimit`](../TanStackDBError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`captureStackTrace`](../TanStackDBError.md#capturestacktrace)
---
id: InvalidCollectionStatusTransitionError
title: InvalidCollectionStatusTransitionError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: InvalidCollectionStatusTransitionError

Defined in: [packages/db/src/errors.ts:92](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L92)

## Extends

- [`CollectionStateError`](../collectionstateerror.md)

## Constructors

### new InvalidCollectionStatusTransitionError()

```ts
new InvalidCollectionStatusTransitionError(
   from, 
   to, 
   collectionId): InvalidCollectionStatusTransitionError
```

Defined in: [packages/db/src/errors.ts:93](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L93)

#### Parameters

##### from

`string`

##### to

`string`

##### collectionId

`string`

#### Returns

[`InvalidCollectionStatusTransitionError`](../invalidcollectionstatustransitionerror.md)

#### Overrides

[`CollectionStateError`](../collectionstateerror.md).[`constructor`](../CollectionStateError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`cause`](../CollectionStateError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`message`](../CollectionStateError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`name`](../CollectionStateError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`stack`](../CollectionStateError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`prepareStackTrace`](../CollectionStateError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`stackTraceLimit`](../CollectionStateError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`captureStackTrace`](../CollectionStateError.md#capturestacktrace)
---
id: SchemaMustBeSynchronousError
title: SchemaMustBeSynchronousError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: SchemaMustBeSynchronousError

Defined in: [packages/db/src/errors.ts:70](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L70)

## Extends

- [`CollectionConfigurationError`](../collectionconfigurationerror.md)

## Constructors

### new SchemaMustBeSynchronousError()

```ts
new SchemaMustBeSynchronousError(): SchemaMustBeSynchronousError
```

Defined in: [packages/db/src/errors.ts:71](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L71)

#### Returns

[`SchemaMustBeSynchronousError`](../schemamustbesynchronouserror.md)

#### Overrides

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`constructor`](../CollectionConfigurationError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`cause`](../CollectionConfigurationError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`message`](../CollectionConfigurationError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`name`](../CollectionConfigurationError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`stack`](../CollectionConfigurationError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`prepareStackTrace`](../CollectionConfigurationError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`stackTraceLimit`](../CollectionConfigurationError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`captureStackTrace`](../CollectionConfigurationError.md#capturestacktrace)
---
id: GroupByError
title: GroupByError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: GroupByError

Defined in: [packages/db/src/errors.ts:430](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L430)

## Extends

- [`TanStackDBError`](../tanstackdberror.md)

## Extended by

- [`NonAggregateExpressionNotInGroupByError`](../nonaggregateexpressionnotingroupbyerror.md)
- [`UnsupportedAggregateFunctionError`](../unsupportedaggregatefunctionerror.md)
- [`AggregateFunctionNotInSelectError`](../aggregatefunctionnotinselecterror.md)
- [`UnknownHavingExpressionTypeError`](../unknownhavingexpressiontypeerror.md)

## Constructors

### new GroupByError()

```ts
new GroupByError(message): GroupByError
```

Defined in: [packages/db/src/errors.ts:431](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L431)

#### Parameters

##### message

`string`

#### Returns

[`GroupByError`](../groupbyerror.md)

#### Overrides

[`TanStackDBError`](../tanstackdberror.md).[`constructor`](../TanStackDBError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`cause`](../TanStackDBError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`message`](../TanStackDBError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`name`](../TanStackDBError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stack`](../TanStackDBError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`prepareStackTrace`](../TanStackDBError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stackTraceLimit`](../TanStackDBError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`captureStackTrace`](../TanStackDBError.md#capturestacktrace)
---
id: UnsupportedJoinSourceTypeError
title: UnsupportedJoinSourceTypeError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: UnsupportedJoinSourceTypeError

Defined in: [packages/db/src/errors.ts:423](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L423)

## Extends

- [`JoinError`](../joinerror.md)

## Constructors

### new UnsupportedJoinSourceTypeError()

```ts
new UnsupportedJoinSourceTypeError(type): UnsupportedJoinSourceTypeError
```

Defined in: [packages/db/src/errors.ts:424](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L424)

#### Parameters

##### type

`string`

#### Returns

[`UnsupportedJoinSourceTypeError`](../unsupportedjoinsourcetypeerror.md)

#### Overrides

[`JoinError`](../joinerror.md).[`constructor`](../JoinError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`JoinError`](../joinerror.md).[`cause`](../JoinError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`JoinError`](../joinerror.md).[`message`](../JoinError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`JoinError`](../joinerror.md).[`name`](../JoinError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`JoinError`](../joinerror.md).[`stack`](../JoinError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`JoinError`](../joinerror.md).[`prepareStackTrace`](../JoinError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`JoinError`](../joinerror.md).[`stackTraceLimit`](../JoinError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`JoinError`](../joinerror.md).[`captureStackTrace`](../JoinError.md#capturestacktrace)
---
id: TanStackDBError
title: TanStackDBError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: TanStackDBError

Defined in: [packages/db/src/errors.ts:2](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L2)

## Extends

- `Error`

## Extended by

- [`NonRetriableError`](../nonretriableerror.md)
- [`SchemaValidationError`](../schemavalidationerror.md)
- [`CollectionConfigurationError`](../collectionconfigurationerror.md)
- [`CollectionStateError`](../collectionstateerror.md)
- [`CollectionOperationError`](../collectionoperationerror.md)
- [`MissingHandlerError`](../missinghandlererror.md)
- [`TransactionError`](../transactionerror.md)
- [`QueryBuilderError`](../querybuildererror.md)
- [`QueryCompilationError`](../querycompilationerror.md)
- [`JoinError`](../joinerror.md)
- [`GroupByError`](../groupbyerror.md)
- [`StorageError`](../storageerror.md)
- [`SyncCleanupError`](../synccleanuperror.md)
- [`QueryOptimizerError`](../queryoptimizererror.md)

## Constructors

### new TanStackDBError()

```ts
new TanStackDBError(message): TanStackDBError
```

Defined in: [packages/db/src/errors.ts:3](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L3)

#### Parameters

##### message

`string`

#### Returns

[`TanStackDBError`](../tanstackdberror.md)

#### Overrides

```ts
Error.constructor
```

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

```ts
Error.cause
```

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

```ts
Error.message
```

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

```ts
Error.name
```

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

```ts
Error.stack
```

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

```ts
Error.prepareStackTrace
```

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

```ts
Error.stackTraceLimit
```

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

```ts
Error.captureStackTrace
```
---
id: CannotCombineEmptyExpressionListError
title: CannotCombineEmptyExpressionListError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: CannotCombineEmptyExpressionListError

Defined in: [packages/db/src/errors.ts:546](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L546)

## Extends

- [`QueryOptimizerError`](../queryoptimizererror.md)

## Constructors

### new CannotCombineEmptyExpressionListError()

```ts
new CannotCombineEmptyExpressionListError(): CannotCombineEmptyExpressionListError
```

Defined in: [packages/db/src/errors.ts:547](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L547)

#### Returns

[`CannotCombineEmptyExpressionListError`](../cannotcombineemptyexpressionlisterror.md)

#### Overrides

[`QueryOptimizerError`](../queryoptimizererror.md).[`constructor`](../QueryOptimizerError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`QueryOptimizerError`](../queryoptimizererror.md).[`cause`](../QueryOptimizerError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`QueryOptimizerError`](../queryoptimizererror.md).[`message`](../QueryOptimizerError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`QueryOptimizerError`](../queryoptimizererror.md).[`name`](../QueryOptimizerError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`QueryOptimizerError`](../queryoptimizererror.md).[`stack`](../QueryOptimizerError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`QueryOptimizerError`](../queryoptimizererror.md).[`prepareStackTrace`](../QueryOptimizerError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`QueryOptimizerError`](../queryoptimizererror.md).[`stackTraceLimit`](../QueryOptimizerError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`QueryOptimizerError`](../queryoptimizererror.md).[`captureStackTrace`](../QueryOptimizerError.md#capturestacktrace)
---
id: CollectionOperationError
title: CollectionOperationError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: CollectionOperationError

Defined in: [packages/db/src/errors.ts:113](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L113)

## Extends

- [`TanStackDBError`](../tanstackdberror.md)

## Extended by

- [`UndefinedKeyError`](../undefinedkeyerror.md)
- [`DuplicateKeyError`](../duplicatekeyerror.md)
- [`DuplicateKeySyncError`](../duplicatekeysyncerror.md)
- [`MissingUpdateArgumentError`](../missingupdateargumenterror.md)
- [`NoKeysPassedToUpdateError`](../nokeyspassedtoupdateerror.md)
- [`UpdateKeyNotFoundError`](../updatekeynotfounderror.md)
- [`KeyUpdateNotAllowedError`](../keyupdatenotallowederror.md)
- [`NoKeysPassedToDeleteError`](../nokeyspassedtodeleteerror.md)
- [`DeleteKeyNotFoundError`](../deletekeynotfounderror.md)

## Constructors

### new CollectionOperationError()

```ts
new CollectionOperationError(message): CollectionOperationError
```

Defined in: [packages/db/src/errors.ts:114](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L114)

#### Parameters

##### message

`string`

#### Returns

[`CollectionOperationError`](../collectionoperationerror.md)

#### Overrides

[`TanStackDBError`](../tanstackdberror.md).[`constructor`](../TanStackDBError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`cause`](../TanStackDBError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`message`](../TanStackDBError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`name`](../TanStackDBError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stack`](../TanStackDBError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`prepareStackTrace`](../TanStackDBError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stackTraceLimit`](../TanStackDBError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`captureStackTrace`](../TanStackDBError.md#capturestacktrace)
---
id: DuplicateKeySyncError
title: DuplicateKeySyncError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: DuplicateKeySyncError

Defined in: [packages/db/src/errors.ts:136](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L136)

## Extends

- [`CollectionOperationError`](../collectionoperationerror.md)

## Constructors

### new DuplicateKeySyncError()

```ts
new DuplicateKeySyncError(key, collectionId): DuplicateKeySyncError
```

Defined in: [packages/db/src/errors.ts:137](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L137)

#### Parameters

##### key

`string` | `number`

##### collectionId

`string`

#### Returns

[`DuplicateKeySyncError`](../duplicatekeysyncerror.md)

#### Overrides

[`CollectionOperationError`](../collectionoperationerror.md).[`constructor`](../CollectionOperationError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`cause`](../CollectionOperationError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`message`](../CollectionOperationError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`name`](../CollectionOperationError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`stack`](../CollectionOperationError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`prepareStackTrace`](../CollectionOperationError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`stackTraceLimit`](../CollectionOperationError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`captureStackTrace`](../CollectionOperationError.md#capturestacktrace)
---
id: UnknownFunctionError
title: UnknownFunctionError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: UnknownFunctionError

Defined in: [packages/db/src/errors.ts:374](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L374)

## Extends

- [`QueryCompilationError`](../querycompilationerror.md)

## Constructors

### new UnknownFunctionError()

```ts
new UnknownFunctionError(functionName): UnknownFunctionError
```

Defined in: [packages/db/src/errors.ts:375](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L375)

#### Parameters

##### functionName

`string`

#### Returns

[`UnknownFunctionError`](../unknownfunctionerror.md)

#### Overrides

[`QueryCompilationError`](../querycompilationerror.md).[`constructor`](../QueryCompilationError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`cause`](../QueryCompilationError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`message`](../QueryCompilationError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`name`](../QueryCompilationError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`stack`](../QueryCompilationError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`prepareStackTrace`](../QueryCompilationError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`stackTraceLimit`](../QueryCompilationError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`captureStackTrace`](../QueryCompilationError.md#capturestacktrace)
---
id: LimitOffsetRequireOrderByError
title: LimitOffsetRequireOrderByError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: LimitOffsetRequireOrderByError

Defined in: [packages/db/src/errors.ts:342](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L342)

## Extends

- [`QueryCompilationError`](../querycompilationerror.md)

## Constructors

### new LimitOffsetRequireOrderByError()

```ts
new LimitOffsetRequireOrderByError(): LimitOffsetRequireOrderByError
```

Defined in: [packages/db/src/errors.ts:343](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L343)

#### Returns

[`LimitOffsetRequireOrderByError`](../limitoffsetrequireorderbyerror.md)

#### Overrides

[`QueryCompilationError`](../querycompilationerror.md).[`constructor`](../QueryCompilationError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`cause`](../QueryCompilationError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`message`](../QueryCompilationError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`name`](../QueryCompilationError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`stack`](../QueryCompilationError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`prepareStackTrace`](../QueryCompilationError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`stackTraceLimit`](../QueryCompilationError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`captureStackTrace`](../QueryCompilationError.md#capturestacktrace)
---
id: BaseIndex
title: BaseIndex
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: `abstract` BaseIndex\<TKey\>

Defined in: [packages/db/src/indexes/base-index.ts:28](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L28)

Base abstract class that all index types extend

## Extended by

- [`BTreeIndex`](../btreeindex.md)

## Type Parameters

• **TKey** *extends* `string` \| `number` = `string` \| `number`

## Constructors

### new BaseIndex()

```ts
new BaseIndex<TKey>(
   id, 
   expression, 
   name?, 
options?): BaseIndex<TKey>
```

Defined in: [packages/db/src/indexes/base-index.ts:40](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L40)

#### Parameters

##### id

`number`

##### expression

`BasicExpression`

##### name?

`string`

##### options?

`any`

#### Returns

[`BaseIndex`](../baseindex.md)\<`TKey`\>

## Properties

### expression

```ts
readonly expression: BasicExpression;
```

Defined in: [packages/db/src/indexes/base-index.ts:33](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L33)

***

### id

```ts
readonly id: number;
```

Defined in: [packages/db/src/indexes/base-index.ts:31](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L31)

***

### lastUpdated

```ts
protected lastUpdated: Date;
```

Defined in: [packages/db/src/indexes/base-index.ts:38](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L38)

***

### lookupCount

```ts
protected lookupCount: number = 0;
```

Defined in: [packages/db/src/indexes/base-index.ts:36](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L36)

***

### name?

```ts
readonly optional name: string;
```

Defined in: [packages/db/src/indexes/base-index.ts:32](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L32)

***

### supportedOperations

```ts
abstract readonly supportedOperations: Set<"eq" | "gt" | "gte" | "lt" | "lte" | "in" | "like" | "ilike">;
```

Defined in: [packages/db/src/indexes/base-index.ts:34](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L34)

***

### totalLookupTime

```ts
protected totalLookupTime: number = 0;
```

Defined in: [packages/db/src/indexes/base-index.ts:37](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L37)

## Accessors

### keyCount

#### Get Signature

```ts
get abstract keyCount(): number
```

Defined in: [packages/db/src/indexes/base-index.ts:59](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L59)

##### Returns

`number`

## Methods

### add()

```ts
abstract add(key, item): void
```

Defined in: [packages/db/src/indexes/base-index.ts:53](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L53)

#### Parameters

##### key

`TKey`

##### item

`any`

#### Returns

`void`

***

### build()

```ts
abstract build(entries): void
```

Defined in: [packages/db/src/indexes/base-index.ts:56](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L56)

#### Parameters

##### entries

`Iterable`\<\[`TKey`, `any`\]\>

#### Returns

`void`

***

### clear()

```ts
abstract clear(): void
```

Defined in: [packages/db/src/indexes/base-index.ts:57](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L57)

#### Returns

`void`

***

### evaluateIndexExpression()

```ts
protected evaluateIndexExpression(item): any
```

Defined in: [packages/db/src/indexes/base-index.ts:87](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L87)

#### Parameters

##### item

`any`

#### Returns

`any`

***

### getStats()

```ts
getStats(): IndexStats
```

Defined in: [packages/db/src/indexes/base-index.ts:74](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L74)

#### Returns

[`IndexStats`](../../interfaces/indexstats.md)

***

### initialize()

```ts
abstract protected initialize(options?): void
```

Defined in: [packages/db/src/indexes/base-index.ts:85](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L85)

#### Parameters

##### options?

`any`

#### Returns

`void`

***

### lookup()

```ts
abstract lookup(operation, value): Set<TKey>
```

Defined in: [packages/db/src/indexes/base-index.ts:58](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L58)

#### Parameters

##### operation

`"eq"` | `"gt"` | `"gte"` | `"lt"` | `"lte"` | `"in"` | `"like"` | `"ilike"`

##### value

`any`

#### Returns

`Set`\<`TKey`\>

***

### matchesField()

```ts
matchesField(fieldPath): boolean
```

Defined in: [packages/db/src/indexes/base-index.ts:66](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L66)

#### Parameters

##### fieldPath

`string`[]

#### Returns

`boolean`

***

### remove()

```ts
abstract remove(key, item): void
```

Defined in: [packages/db/src/indexes/base-index.ts:54](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L54)

#### Parameters

##### key

`TKey`

##### item

`any`

#### Returns

`void`

***

### supports()

```ts
supports(operation): boolean
```

Defined in: [packages/db/src/indexes/base-index.ts:62](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L62)

#### Parameters

##### operation

`"eq"` | `"gt"` | `"gte"` | `"lt"` | `"lte"` | `"in"` | `"like"` | `"ilike"`

#### Returns

`boolean`

***

### trackLookup()

```ts
protected trackLookup(startTime): void
```

Defined in: [packages/db/src/indexes/base-index.ts:92](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L92)

#### Parameters

##### startTime

`number`

#### Returns

`void`

***

### update()

```ts
abstract update(
   key, 
   oldItem, 
   newItem): void
```

Defined in: [packages/db/src/indexes/base-index.ts:55](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L55)

#### Parameters

##### key

`TKey`

##### oldItem

`any`

##### newItem

`any`

#### Returns

`void`

***

### updateTimestamp()

```ts
protected updateTimestamp(): void
```

Defined in: [packages/db/src/indexes/base-index.ts:98](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L98)

#### Returns

`void`
---
id: JoinConditionMustBeEqualityError
title: JoinConditionMustBeEqualityError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: JoinConditionMustBeEqualityError

Defined in: [packages/db/src/errors.ts:310](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L310)

## Extends

- [`QueryBuilderError`](../querybuildererror.md)

## Constructors

### new JoinConditionMustBeEqualityError()

```ts
new JoinConditionMustBeEqualityError(): JoinConditionMustBeEqualityError
```

Defined in: [packages/db/src/errors.ts:311](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L311)

#### Returns

[`JoinConditionMustBeEqualityError`](../joinconditionmustbeequalityerror.md)

#### Overrides

[`QueryBuilderError`](../querybuildererror.md).[`constructor`](../QueryBuilderError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`cause`](../QueryBuilderError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`message`](../QueryBuilderError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`name`](../QueryBuilderError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`stack`](../QueryBuilderError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`prepareStackTrace`](../QueryBuilderError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`stackTraceLimit`](../QueryBuilderError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`captureStackTrace`](../QueryBuilderError.md#capturestacktrace)
---
id: InvalidSourceError
title: InvalidSourceError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: InvalidSourceError

Defined in: [packages/db/src/errors.ts:304](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L304)

## Extends

- [`QueryBuilderError`](../querybuildererror.md)

## Constructors

### new InvalidSourceError()

```ts
new InvalidSourceError(): InvalidSourceError
```

Defined in: [packages/db/src/errors.ts:305](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L305)

#### Returns

[`InvalidSourceError`](../invalidsourceerror.md)

#### Overrides

[`QueryBuilderError`](../querybuildererror.md).[`constructor`](../QueryBuilderError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`cause`](../QueryBuilderError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`message`](../QueryBuilderError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`name`](../QueryBuilderError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`stack`](../QueryBuilderError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`prepareStackTrace`](../QueryBuilderError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`stackTraceLimit`](../QueryBuilderError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`captureStackTrace`](../QueryBuilderError.md#capturestacktrace)
---
id: CollectionInErrorStateError
title: CollectionInErrorStateError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: CollectionInErrorStateError

Defined in: [packages/db/src/errors.ts:84](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L84)

## Extends

- [`CollectionStateError`](../collectionstateerror.md)

## Constructors

### new CollectionInErrorStateError()

```ts
new CollectionInErrorStateError(operation, collectionId): CollectionInErrorStateError
```

Defined in: [packages/db/src/errors.ts:85](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L85)

#### Parameters

##### operation

`string`

##### collectionId

`string`

#### Returns

[`CollectionInErrorStateError`](../collectioninerrorstateerror.md)

#### Overrides

[`CollectionStateError`](../collectionstateerror.md).[`constructor`](../CollectionStateError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`cause`](../CollectionStateError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`message`](../CollectionStateError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`name`](../CollectionStateError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`stack`](../CollectionStateError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`prepareStackTrace`](../CollectionStateError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`stackTraceLimit`](../CollectionStateError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`captureStackTrace`](../CollectionStateError.md#capturestacktrace)
---
id: InvalidStorageObjectFormatError
title: InvalidStorageObjectFormatError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: InvalidStorageObjectFormatError

Defined in: [packages/db/src/errors.ts:519](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L519)

## Extends

- [`LocalStorageCollectionError`](../localstoragecollectionerror.md)

## Constructors

### new InvalidStorageObjectFormatError()

```ts
new InvalidStorageObjectFormatError(storageKey): InvalidStorageObjectFormatError
```

Defined in: [packages/db/src/errors.ts:520](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L520)

#### Parameters

##### storageKey

`string`

#### Returns

[`InvalidStorageObjectFormatError`](../invalidstorageobjectformaterror.md)

#### Overrides

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`constructor`](../LocalStorageCollectionError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`cause`](../LocalStorageCollectionError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`message`](../LocalStorageCollectionError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`name`](../LocalStorageCollectionError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`stack`](../LocalStorageCollectionError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`prepareStackTrace`](../LocalStorageCollectionError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`stackTraceLimit`](../LocalStorageCollectionError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`captureStackTrace`](../LocalStorageCollectionError.md#capturestacktrace)
---
id: MissingUpdateHandlerError
title: MissingUpdateHandlerError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: MissingUpdateHandlerError

Defined in: [packages/db/src/errors.ts:202](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L202)

## Extends

- [`MissingHandlerError`](../missinghandlererror.md)

## Constructors

### new MissingUpdateHandlerError()

```ts
new MissingUpdateHandlerError(): MissingUpdateHandlerError
```

Defined in: [packages/db/src/errors.ts:203](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L203)

#### Returns

[`MissingUpdateHandlerError`](../missingupdatehandlererror.md)

#### Overrides

[`MissingHandlerError`](../missinghandlererror.md).[`constructor`](../MissingHandlerError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`MissingHandlerError`](../missinghandlererror.md).[`cause`](../MissingHandlerError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`MissingHandlerError`](../missinghandlererror.md).[`message`](../MissingHandlerError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`MissingHandlerError`](../missinghandlererror.md).[`name`](../MissingHandlerError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`MissingHandlerError`](../missinghandlererror.md).[`stack`](../MissingHandlerError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`MissingHandlerError`](../missinghandlererror.md).[`prepareStackTrace`](../MissingHandlerError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`MissingHandlerError`](../missinghandlererror.md).[`stackTraceLimit`](../MissingHandlerError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`MissingHandlerError`](../missinghandlererror.md).[`captureStackTrace`](../MissingHandlerError.md#capturestacktrace)
---
id: UnsupportedFromTypeError
title: UnsupportedFromTypeError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: UnsupportedFromTypeError

Defined in: [packages/db/src/errors.ts:356](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L356)

## Extends

- [`QueryCompilationError`](../querycompilationerror.md)

## Constructors

### new UnsupportedFromTypeError()

```ts
new UnsupportedFromTypeError(type): UnsupportedFromTypeError
```

Defined in: [packages/db/src/errors.ts:357](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L357)

#### Parameters

##### type

`string`

#### Returns

[`UnsupportedFromTypeError`](../unsupportedfromtypeerror.md)

#### Overrides

[`QueryCompilationError`](../querycompilationerror.md).[`constructor`](../QueryCompilationError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`cause`](../QueryCompilationError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`message`](../QueryCompilationError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`name`](../QueryCompilationError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`stack`](../QueryCompilationError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`prepareStackTrace`](../QueryCompilationError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`stackTraceLimit`](../QueryCompilationError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`captureStackTrace`](../QueryCompilationError.md#capturestacktrace)
---
id: QueryCompilationError
title: QueryCompilationError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: QueryCompilationError

Defined in: [packages/db/src/errors.ts:323](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L323)

## Extends

- [`TanStackDBError`](../tanstackdberror.md)

## Extended by

- [`DistinctRequiresSelectError`](../distinctrequiresselecterror.md)
- [`HavingRequiresGroupByError`](../havingrequiresgroupbyerror.md)
- [`LimitOffsetRequireOrderByError`](../limitoffsetrequireorderbyerror.md)
- [`CollectionInputNotFoundError`](../collectioninputnotfounderror.md)
- [`UnsupportedFromTypeError`](../unsupportedfromtypeerror.md)
- [`UnknownExpressionTypeError`](../unknownexpressiontypeerror.md)
- [`EmptyReferencePathError`](../emptyreferencepatherror.md)
- [`UnknownFunctionError`](../unknownfunctionerror.md)

## Constructors

### new QueryCompilationError()

```ts
new QueryCompilationError(message): QueryCompilationError
```

Defined in: [packages/db/src/errors.ts:324](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L324)

#### Parameters

##### message

`string`

#### Returns

[`QueryCompilationError`](../querycompilationerror.md)

#### Overrides

[`TanStackDBError`](../tanstackdberror.md).[`constructor`](../TanStackDBError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`cause`](../TanStackDBError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`message`](../TanStackDBError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`name`](../TanStackDBError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stack`](../TanStackDBError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`prepareStackTrace`](../TanStackDBError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stackTraceLimit`](../TanStackDBError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`captureStackTrace`](../TanStackDBError.md#capturestacktrace)
---
id: InvalidStorageDataFormatError
title: InvalidStorageDataFormatError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: InvalidStorageDataFormatError

Defined in: [packages/db/src/errors.ts:511](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L511)

## Extends

- [`LocalStorageCollectionError`](../localstoragecollectionerror.md)

## Constructors

### new InvalidStorageDataFormatError()

```ts
new InvalidStorageDataFormatError(storageKey, key): InvalidStorageDataFormatError
```

Defined in: [packages/db/src/errors.ts:512](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L512)

#### Parameters

##### storageKey

`string`

##### key

`string`

#### Returns

[`InvalidStorageDataFormatError`](../invalidstoragedataformaterror.md)

#### Overrides

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`constructor`](../LocalStorageCollectionError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`cause`](../LocalStorageCollectionError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`message`](../LocalStorageCollectionError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`name`](../LocalStorageCollectionError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`stack`](../LocalStorageCollectionError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`prepareStackTrace`](../LocalStorageCollectionError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`stackTraceLimit`](../LocalStorageCollectionError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`captureStackTrace`](../LocalStorageCollectionError.md#capturestacktrace)
---
id: MissingMutationFunctionError
title: MissingMutationFunctionError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: MissingMutationFunctionError

Defined in: [packages/db/src/errors.ts:226](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L226)

## Extends

- [`TransactionError`](../transactionerror.md)

## Constructors

### new MissingMutationFunctionError()

```ts
new MissingMutationFunctionError(): MissingMutationFunctionError
```

Defined in: [packages/db/src/errors.ts:227](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L227)

#### Returns

[`MissingMutationFunctionError`](../missingmutationfunctionerror.md)

#### Overrides

[`TransactionError`](../transactionerror.md).[`constructor`](../TransactionError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`TransactionError`](../transactionerror.md).[`cause`](../TransactionError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`TransactionError`](../transactionerror.md).[`message`](../TransactionError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`TransactionError`](../transactionerror.md).[`name`](../TransactionError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`TransactionError`](../transactionerror.md).[`stack`](../TransactionError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`TransactionError`](../transactionerror.md).[`prepareStackTrace`](../TransactionError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`TransactionError`](../transactionerror.md).[`stackTraceLimit`](../TransactionError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`TransactionError`](../transactionerror.md).[`captureStackTrace`](../TransactionError.md#capturestacktrace)
---
id: NoStorageAvailableError
title: NoStorageAvailableError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: NoStorageAvailableError

Defined in: [packages/db/src/errors.ts:495](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L495)

## Extends

- [`LocalStorageCollectionError`](../localstoragecollectionerror.md)

## Constructors

### new NoStorageAvailableError()

```ts
new NoStorageAvailableError(): NoStorageAvailableError
```

Defined in: [packages/db/src/errors.ts:496](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L496)

#### Returns

[`NoStorageAvailableError`](../nostorageavailableerror.md)

#### Overrides

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`constructor`](../LocalStorageCollectionError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`cause`](../LocalStorageCollectionError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`message`](../LocalStorageCollectionError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`name`](../LocalStorageCollectionError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`stack`](../LocalStorageCollectionError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`prepareStackTrace`](../LocalStorageCollectionError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`stackTraceLimit`](../LocalStorageCollectionError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`captureStackTrace`](../LocalStorageCollectionError.md#capturestacktrace)
---
id: SyncCleanupError
title: SyncCleanupError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: SyncCleanupError

Defined in: [packages/db/src/errors.ts:528](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L528)

## Extends

- [`TanStackDBError`](../tanstackdberror.md)

## Constructors

### new SyncCleanupError()

```ts
new SyncCleanupError(collectionId, error): SyncCleanupError
```

Defined in: [packages/db/src/errors.ts:529](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L529)

#### Parameters

##### collectionId

`string`

##### error

`string` | `Error`

#### Returns

[`SyncCleanupError`](../synccleanuperror.md)

#### Overrides

[`TanStackDBError`](../tanstackdberror.md).[`constructor`](../TanStackDBError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`cause`](../TanStackDBError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`message`](../TanStackDBError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`name`](../TanStackDBError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stack`](../TanStackDBError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`prepareStackTrace`](../TanStackDBError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stackTraceLimit`](../TanStackDBError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`captureStackTrace`](../TanStackDBError.md#capturestacktrace)
---
id: QueryOptimizerError
title: QueryOptimizerError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: QueryOptimizerError

Defined in: [packages/db/src/errors.ts:539](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L539)

## Extends

- [`TanStackDBError`](../tanstackdberror.md)

## Extended by

- [`CannotCombineEmptyExpressionListError`](../cannotcombineemptyexpressionlisterror.md)

## Constructors

### new QueryOptimizerError()

```ts
new QueryOptimizerError(message): QueryOptimizerError
```

Defined in: [packages/db/src/errors.ts:540](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L540)

#### Parameters

##### message

`string`

#### Returns

[`QueryOptimizerError`](../queryoptimizererror.md)

#### Overrides

[`TanStackDBError`](../tanstackdberror.md).[`constructor`](../TanStackDBError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`cause`](../TanStackDBError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`message`](../TanStackDBError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`name`](../TanStackDBError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stack`](../TanStackDBError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`prepareStackTrace`](../TanStackDBError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stackTraceLimit`](../TanStackDBError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`captureStackTrace`](../TanStackDBError.md#capturestacktrace)
---
id: InvalidJoinConditionSameTableError
title: InvalidJoinConditionSameTableError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: InvalidJoinConditionSameTableError

Defined in: [packages/db/src/errors.ts:394](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L394)

## Extends

- [`JoinError`](../joinerror.md)

## Constructors

### new InvalidJoinConditionSameTableError()

```ts
new InvalidJoinConditionSameTableError(tableAlias): InvalidJoinConditionSameTableError
```

Defined in: [packages/db/src/errors.ts:395](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L395)

#### Parameters

##### tableAlias

`string`

#### Returns

[`InvalidJoinConditionSameTableError`](../invalidjoinconditionsametableerror.md)

#### Overrides

[`JoinError`](../joinerror.md).[`constructor`](../JoinError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`JoinError`](../joinerror.md).[`cause`](../JoinError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`JoinError`](../joinerror.md).[`message`](../JoinError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`JoinError`](../joinerror.md).[`name`](../JoinError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`JoinError`](../joinerror.md).[`stack`](../JoinError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`JoinError`](../joinerror.md).[`prepareStackTrace`](../JoinError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`JoinError`](../joinerror.md).[`stackTraceLimit`](../JoinError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`JoinError`](../joinerror.md).[`captureStackTrace`](../JoinError.md#capturestacktrace)
---
id: AggregateFunctionNotInSelectError
title: AggregateFunctionNotInSelectError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: AggregateFunctionNotInSelectError

Defined in: [packages/db/src/errors.ts:451](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L451)

## Extends

- [`GroupByError`](../groupbyerror.md)

## Constructors

### new AggregateFunctionNotInSelectError()

```ts
new AggregateFunctionNotInSelectError(functionName): AggregateFunctionNotInSelectError
```

Defined in: [packages/db/src/errors.ts:452](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L452)

#### Parameters

##### functionName

`string`

#### Returns

[`AggregateFunctionNotInSelectError`](../aggregatefunctionnotinselecterror.md)

#### Overrides

[`GroupByError`](../groupbyerror.md).[`constructor`](../GroupByError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`cause`](../GroupByError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`message`](../GroupByError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`name`](../GroupByError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`stack`](../GroupByError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`prepareStackTrace`](../GroupByError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`stackTraceLimit`](../GroupByError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`captureStackTrace`](../GroupByError.md#capturestacktrace)
---
id: Transaction
title: Transaction
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: Transaction\<T\>

Defined in: [packages/db/src/transactions.ts:116](https://github.com/TanStack/db/blob/main/packages/db/src/transactions.ts#L116)

## Type Parameters

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>

## Constructors

### new Transaction()

```ts
new Transaction<T>(config): Transaction<T>
```

Defined in: [packages/db/src/transactions.ts:131](https://github.com/TanStack/db/blob/main/packages/db/src/transactions.ts#L131)

#### Parameters

##### config

[`TransactionConfig`](../../interfaces/transactionconfig.md)\<`T`\>

#### Returns

[`Transaction`](../transaction.md)\<`T`\>

## Properties

### autoCommit

```ts
autoCommit: boolean;
```

Defined in: [packages/db/src/transactions.ts:122](https://github.com/TanStack/db/blob/main/packages/db/src/transactions.ts#L122)

***

### createdAt

```ts
createdAt: Date;
```

Defined in: [packages/db/src/transactions.ts:123](https://github.com/TanStack/db/blob/main/packages/db/src/transactions.ts#L123)

***

### error?

```ts
optional error: object;
```

Defined in: [packages/db/src/transactions.ts:126](https://github.com/TanStack/db/blob/main/packages/db/src/transactions.ts#L126)

#### error

```ts
error: Error;
```

#### message

```ts
message: string;
```

***

### id

```ts
id: string;
```

Defined in: [packages/db/src/transactions.ts:117](https://github.com/TanStack/db/blob/main/packages/db/src/transactions.ts#L117)

***

### isPersisted

```ts
isPersisted: Deferred<Transaction<T>>;
```

Defined in: [packages/db/src/transactions.ts:121](https://github.com/TanStack/db/blob/main/packages/db/src/transactions.ts#L121)

***

### metadata

```ts
metadata: Record<string, unknown>;
```

Defined in: [packages/db/src/transactions.ts:125](https://github.com/TanStack/db/blob/main/packages/db/src/transactions.ts#L125)

***

### mutationFn

```ts
mutationFn: MutationFn<T>;
```

Defined in: [packages/db/src/transactions.ts:119](https://github.com/TanStack/db/blob/main/packages/db/src/transactions.ts#L119)

***

### mutations

```ts
mutations: PendingMutation<T, OperationType, Collection<T, any, any, any, any>>[];
```

Defined in: [packages/db/src/transactions.ts:120](https://github.com/TanStack/db/blob/main/packages/db/src/transactions.ts#L120)

***

### sequenceNumber

```ts
sequenceNumber: number;
```

Defined in: [packages/db/src/transactions.ts:124](https://github.com/TanStack/db/blob/main/packages/db/src/transactions.ts#L124)

***

### state

```ts
state: TransactionState;
```

Defined in: [packages/db/src/transactions.ts:118](https://github.com/TanStack/db/blob/main/packages/db/src/transactions.ts#L118)

## Methods

### applyMutations()

```ts
applyMutations(mutations): void
```

Defined in: [packages/db/src/transactions.ts:212](https://github.com/TanStack/db/blob/main/packages/db/src/transactions.ts#L212)

#### Parameters

##### mutations

[`PendingMutation`](../../interfaces/pendingmutation.md)\<`any`, [`OperationType`](../../type-aliases/operationtype.md), [`Collection`](../../interfaces/collection.md)\<`any`, `any`, `any`, `any`, `any`\>\>[]

#### Returns

`void`

***

### commit()

```ts
commit(): Promise<Transaction<T>>
```

Defined in: [packages/db/src/transactions.ts:349](https://github.com/TanStack/db/blob/main/packages/db/src/transactions.ts#L349)

Commit the transaction and execute the mutation function

#### Returns

`Promise`\<[`Transaction`](../transaction.md)\<`T`\>\>

Promise that resolves to this transaction when complete

#### Examples

```ts
// Manual commit (when autoCommit is false)
const tx = createTransaction({
  autoCommit: false,
  mutationFn: async ({ transaction }) => {
    await api.saveChanges(transaction.mutations)
  }
})

tx.mutate(() => {
  collection.insert({ id: "1", text: "Buy milk" })
})

await tx.commit() // Manually commit
```

```ts
// Handle commit errors
try {
  const tx = createTransaction({
    mutationFn: async () => { throw new Error("API failed") }
  })

  tx.mutate(() => {
    collection.insert({ id: "1", text: "Item" })
  })

  await tx.commit()
} catch (error) {
  console.log('Commit failed, transaction rolled back:', error)
}
```

```ts
// Check transaction state after commit
await tx.commit()
console.log(tx.state) // "completed" or "failed"
```

***

### compareCreatedAt()

```ts
compareCreatedAt(other): number
```

Defined in: [packages/db/src/transactions.ts:395](https://github.com/TanStack/db/blob/main/packages/db/src/transactions.ts#L395)

Compare two transactions by their createdAt time and sequence number in order
to sort them in the order they were created.

#### Parameters

##### other

[`Transaction`](../transaction.md)\<`any`\>

The other transaction to compare to

#### Returns

`number`

-1 if this transaction was created before the other, 1 if it was created after, 0 if they were created at the same time

***

### mutate()

```ts
mutate(callback): Transaction<T>
```

Defined in: [packages/db/src/transactions.ts:193](https://github.com/TanStack/db/blob/main/packages/db/src/transactions.ts#L193)

Execute collection operations within this transaction

#### Parameters

##### callback

() => `void`

Function containing collection operations to group together

#### Returns

[`Transaction`](../transaction.md)\<`T`\>

This transaction for chaining

#### Examples

```ts
// Group multiple operations
const tx = createTransaction({ mutationFn: async () => {
  // Send to API
}})

tx.mutate(() => {
  collection.insert({ id: "1", text: "Buy milk" })
  collection.update("2", draft => { draft.completed = true })
  collection.delete("3")
})

await tx.isPersisted.promise
```

```ts
// Handle mutate errors
try {
  tx.mutate(() => {
    collection.insert({ id: "invalid" }) // This might throw
  })
} catch (error) {
  console.log('Mutation failed:', error)
}
```

```ts
// Manual commit control
const tx = createTransaction({ autoCommit: false, mutationFn: async () => {} })

tx.mutate(() => {
  collection.insert({ id: "1", text: "Item" })
})

// Commit later when ready
await tx.commit()
```

***

### rollback()

```ts
rollback(config?): Transaction<T>
```

Defined in: [packages/db/src/transactions.ts:266](https://github.com/TanStack/db/blob/main/packages/db/src/transactions.ts#L266)

Rollback the transaction and any conflicting transactions

#### Parameters

##### config?

Configuration for rollback behavior

###### isSecondaryRollback?

`boolean`

#### Returns

[`Transaction`](../transaction.md)\<`T`\>

This transaction for chaining

#### Examples

```ts
// Manual rollback
const tx = createTransaction({ mutationFn: async () => {
  // Send to API
}})

tx.mutate(() => {
  collection.insert({ id: "1", text: "Buy milk" })
})

// Rollback if needed
if (shouldCancel) {
  tx.rollback()
}
```

```ts
// Handle rollback cascade (automatic)
const tx1 = createTransaction({ mutationFn: async () => {} })
const tx2 = createTransaction({ mutationFn: async () => {} })

tx1.mutate(() => collection.update("1", draft => { draft.value = "A" }))
tx2.mutate(() => collection.update("1", draft => { draft.value = "B" })) // Same item

tx1.rollback() // This will also rollback tx2 due to conflict
```

```ts
// Handle rollback in error scenarios
try {
  await tx.isPersisted.promise
} catch (error) {
  console.log('Transaction was rolled back:', error)
  // Transaction automatically rolled back on mutation function failure
}
```

***

### setState()

```ts
setState(newState): void
```

Defined in: [packages/db/src/transactions.ts:146](https://github.com/TanStack/db/blob/main/packages/db/src/transactions.ts#L146)

#### Parameters

##### newState

[`TransactionState`](../../type-aliases/transactionstate.md)

#### Returns

`void`

***

### touchCollection()

```ts
touchCollection(): void
```

Defined in: [packages/db/src/transactions.ts:294](https://github.com/TanStack/db/blob/main/packages/db/src/transactions.ts#L294)

#### Returns

`void`
---
id: SchemaValidationError
title: SchemaValidationError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: SchemaValidationError

Defined in: [packages/db/src/errors.ts:18](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L18)

## Extends

- [`TanStackDBError`](../tanstackdberror.md)

## Constructors

### new SchemaValidationError()

```ts
new SchemaValidationError(
   type, 
   issues, 
   message?): SchemaValidationError
```

Defined in: [packages/db/src/errors.ts:25](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L25)

#### Parameters

##### type

`"insert"` | `"update"`

##### issues

readonly `object`[]

##### message?

`string`

#### Returns

[`SchemaValidationError`](../schemavalidationerror.md)

#### Overrides

[`TanStackDBError`](../tanstackdberror.md).[`constructor`](../TanStackDBError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`cause`](../TanStackDBError.md#cause)

***

### issues

```ts
issues: readonly object[];
```

Defined in: [packages/db/src/errors.ts:20](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L20)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`message`](../TanStackDBError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`name`](../TanStackDBError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stack`](../TanStackDBError.md#stack)

***

### type

```ts
type: "insert" | "update";
```

Defined in: [packages/db/src/errors.ts:19](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L19)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`prepareStackTrace`](../TanStackDBError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stackTraceLimit`](../TanStackDBError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`captureStackTrace`](../TanStackDBError.md#capturestacktrace)
---
id: DuplicateKeyError
title: DuplicateKeyError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: DuplicateKeyError

Defined in: [packages/db/src/errors.ts:128](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L128)

## Extends

- [`CollectionOperationError`](../collectionoperationerror.md)

## Constructors

### new DuplicateKeyError()

```ts
new DuplicateKeyError(key): DuplicateKeyError
```

Defined in: [packages/db/src/errors.ts:129](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L129)

#### Parameters

##### key

`string` | `number`

#### Returns

[`DuplicateKeyError`](../duplicatekeyerror.md)

#### Overrides

[`CollectionOperationError`](../collectionoperationerror.md).[`constructor`](../CollectionOperationError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`cause`](../CollectionOperationError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`message`](../CollectionOperationError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`name`](../CollectionOperationError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`stack`](../CollectionOperationError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`prepareStackTrace`](../CollectionOperationError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`stackTraceLimit`](../CollectionOperationError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`captureStackTrace`](../CollectionOperationError.md#capturestacktrace)
---
id: SortedMap
title: SortedMap
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: SortedMap\<TKey, TValue\>

Defined in: [packages/db/src/SortedMap.ts:6](https://github.com/TanStack/db/blob/main/packages/db/src/SortedMap.ts#L6)

A Map implementation that keeps its entries sorted based on a comparator function

## Type Parameters

• **TKey**

The type of keys in the map

• **TValue**

The type of values in the map

## Constructors

### new SortedMap()

```ts
new SortedMap<TKey, TValue>(comparator?): SortedMap<TKey, TValue>
```

Defined in: [packages/db/src/SortedMap.ts:16](https://github.com/TanStack/db/blob/main/packages/db/src/SortedMap.ts#L16)

Creates a new SortedMap instance

#### Parameters

##### comparator?

(`a`, `b`) => `number`

Optional function to compare values for sorting

#### Returns

[`SortedMap`](../sortedmap.md)\<`TKey`, `TValue`\>

## Accessors

### size

#### Get Signature

```ts
get size(): number
```

Defined in: [packages/db/src/SortedMap.ts:138](https://github.com/TanStack/db/blob/main/packages/db/src/SortedMap.ts#L138)

Gets the number of key-value pairs in the map

##### Returns

`number`

## Methods

### \[iterator\]()

```ts
iterator: IterableIterator<[TKey, TValue]>
```

Defined in: [packages/db/src/SortedMap.ts:147](https://github.com/TanStack/db/blob/main/packages/db/src/SortedMap.ts#L147)

Default iterator that returns entries in sorted order

#### Returns

`IterableIterator`\<\[`TKey`, `TValue`\]\>

An iterator for the map's entries

***

### clear()

```ts
clear(): void
```

Defined in: [packages/db/src/SortedMap.ts:130](https://github.com/TanStack/db/blob/main/packages/db/src/SortedMap.ts#L130)

Removes all key-value pairs from the map

#### Returns

`void`

***

### delete()

```ts
delete(key): boolean
```

Defined in: [packages/db/src/SortedMap.ts:106](https://github.com/TanStack/db/blob/main/packages/db/src/SortedMap.ts#L106)

Removes a key-value pair from the map

#### Parameters

##### key

`TKey`

The key to remove

#### Returns

`boolean`

True if the key was found and removed, false otherwise

***

### entries()

```ts
entries(): IterableIterator<[TKey, TValue]>
```

Defined in: [packages/db/src/SortedMap.ts:158](https://github.com/TanStack/db/blob/main/packages/db/src/SortedMap.ts#L158)

Returns an iterator for the map's entries in sorted order

#### Returns

`IterableIterator`\<\[`TKey`, `TValue`\]\>

An iterator for the map's entries

***

### forEach()

```ts
forEach(callbackfn): void
```

Defined in: [packages/db/src/SortedMap.ts:189](https://github.com/TanStack/db/blob/main/packages/db/src/SortedMap.ts#L189)

Executes a callback function for each key-value pair in the map in sorted order

#### Parameters

##### callbackfn

(`value`, `key`, `map`) => `void`

Function to execute for each entry

#### Returns

`void`

***

### get()

```ts
get(key): undefined | TValue
```

Defined in: [packages/db/src/SortedMap.ts:96](https://github.com/TanStack/db/blob/main/packages/db/src/SortedMap.ts#L96)

Gets a value by its key

#### Parameters

##### key

`TKey`

The key to look up

#### Returns

`undefined` \| `TValue`

The value associated with the key, or undefined if not found

***

### has()

```ts
has(key): boolean
```

Defined in: [packages/db/src/SortedMap.ts:123](https://github.com/TanStack/db/blob/main/packages/db/src/SortedMap.ts#L123)

Checks if a key exists in the map

#### Parameters

##### key

`TKey`

The key to check

#### Returns

`boolean`

True if the key exists, false otherwise

***

### keys()

```ts
keys(): IterableIterator<TKey>
```

Defined in: [packages/db/src/SortedMap.ts:167](https://github.com/TanStack/db/blob/main/packages/db/src/SortedMap.ts#L167)

Returns an iterator for the map's keys in sorted order

#### Returns

`IterableIterator`\<`TKey`\>

An iterator for the map's keys

***

### set()

```ts
set(key, value): this
```

Defined in: [packages/db/src/SortedMap.ts:73](https://github.com/TanStack/db/blob/main/packages/db/src/SortedMap.ts#L73)

Sets a key-value pair in the map and maintains sort order

#### Parameters

##### key

`TKey`

The key to set

##### value

`TValue`

The value to associate with the key

#### Returns

`this`

This SortedMap instance for chaining

***

### values()

```ts
values(): IterableIterator<TValue>
```

Defined in: [packages/db/src/SortedMap.ts:176](https://github.com/TanStack/db/blob/main/packages/db/src/SortedMap.ts#L176)

Returns an iterator for the map's values in sorted order

#### Returns

`IterableIterator`\<`TValue`\>

An iterator for the map's values
---
id: DeleteKeyNotFoundError
title: DeleteKeyNotFoundError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: DeleteKeyNotFoundError

Defined in: [packages/db/src/errors.ts:178](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L178)

## Extends

- [`CollectionOperationError`](../collectionoperationerror.md)

## Constructors

### new DeleteKeyNotFoundError()

```ts
new DeleteKeyNotFoundError(key): DeleteKeyNotFoundError
```

Defined in: [packages/db/src/errors.ts:179](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L179)

#### Parameters

##### key

`string` | `number`

#### Returns

[`DeleteKeyNotFoundError`](../deletekeynotfounderror.md)

#### Overrides

[`CollectionOperationError`](../collectionoperationerror.md).[`constructor`](../CollectionOperationError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`cause`](../CollectionOperationError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`message`](../CollectionOperationError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`name`](../CollectionOperationError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`stack`](../CollectionOperationError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`prepareStackTrace`](../CollectionOperationError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`stackTraceLimit`](../CollectionOperationError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`captureStackTrace`](../CollectionOperationError.md#capturestacktrace)
---
id: NonAggregateExpressionNotInGroupByError
title: NonAggregateExpressionNotInGroupByError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: NonAggregateExpressionNotInGroupByError

Defined in: [packages/db/src/errors.ts:437](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L437)

## Extends

- [`GroupByError`](../groupbyerror.md)

## Constructors

### new NonAggregateExpressionNotInGroupByError()

```ts
new NonAggregateExpressionNotInGroupByError(alias): NonAggregateExpressionNotInGroupByError
```

Defined in: [packages/db/src/errors.ts:438](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L438)

#### Parameters

##### alias

`string`

#### Returns

[`NonAggregateExpressionNotInGroupByError`](../nonaggregateexpressionnotingroupbyerror.md)

#### Overrides

[`GroupByError`](../groupbyerror.md).[`constructor`](../GroupByError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`cause`](../GroupByError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`message`](../GroupByError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`name`](../GroupByError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`stack`](../GroupByError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`prepareStackTrace`](../GroupByError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`stackTraceLimit`](../GroupByError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`captureStackTrace`](../GroupByError.md#capturestacktrace)
---
id: NoKeysPassedToUpdateError
title: NoKeysPassedToUpdateError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: NoKeysPassedToUpdateError

Defined in: [packages/db/src/errors.ts:150](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L150)

## Extends

- [`CollectionOperationError`](../collectionoperationerror.md)

## Constructors

### new NoKeysPassedToUpdateError()

```ts
new NoKeysPassedToUpdateError(): NoKeysPassedToUpdateError
```

Defined in: [packages/db/src/errors.ts:151](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L151)

#### Returns

[`NoKeysPassedToUpdateError`](../nokeyspassedtoupdateerror.md)

#### Overrides

[`CollectionOperationError`](../collectionoperationerror.md).[`constructor`](../CollectionOperationError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`cause`](../CollectionOperationError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`message`](../CollectionOperationError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`name`](../CollectionOperationError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`stack`](../CollectionOperationError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`prepareStackTrace`](../CollectionOperationError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`stackTraceLimit`](../CollectionOperationError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`captureStackTrace`](../CollectionOperationError.md#capturestacktrace)
---
id: LazyIndexWrapper
title: LazyIndexWrapper
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: LazyIndexWrapper\<TKey\>

Defined in: [packages/db/src/indexes/lazy-index.ts:39](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L39)

Wrapper that defers index creation until first sync

## Type Parameters

• **TKey** *extends* `string` \| `number` = `string` \| `number`

## Constructors

### new LazyIndexWrapper()

```ts
new LazyIndexWrapper<TKey>(
   id, 
   expression, 
   name, 
   resolver, 
   options, 
collectionEntries?): LazyIndexWrapper<TKey>
```

Defined in: [packages/db/src/indexes/lazy-index.ts:43](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L43)

#### Parameters

##### id

`number`

##### expression

`BasicExpression`

##### name

`undefined` | `string`

##### resolver

[`IndexResolver`](../../type-aliases/indexresolver.md)\<`TKey`\>

##### options

`any`

##### collectionEntries?

`Iterable`\<\[`TKey`, `any`\], `any`, `any`\>

#### Returns

[`LazyIndexWrapper`](../lazyindexwrapper.md)\<`TKey`\>

## Methods

### getExpression()

```ts
getExpression(): BasicExpression
```

Defined in: [packages/db/src/indexes/lazy-index.ts:118](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L118)

Get the index expression

#### Returns

`BasicExpression`

***

### getId()

```ts
getId(): number
```

Defined in: [packages/db/src/indexes/lazy-index.ts:104](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L104)

Get the index ID

#### Returns

`number`

***

### getName()

```ts
getName(): undefined | string
```

Defined in: [packages/db/src/indexes/lazy-index.ts:111](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L111)

Get the index name

#### Returns

`undefined` \| `string`

***

### getResolved()

```ts
getResolved(): BaseIndex<TKey>
```

Defined in: [packages/db/src/indexes/lazy-index.ts:92](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L92)

Get resolved index (throws if not ready)

#### Returns

[`BaseIndex`](../baseindex.md)\<`TKey`\>

***

### isResolved()

```ts
isResolved(): boolean
```

Defined in: [packages/db/src/indexes/lazy-index.ts:85](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L85)

Check if already resolved

#### Returns

`boolean`

***

### resolve()

```ts
resolve(): Promise<BaseIndex<TKey>>
```

Defined in: [packages/db/src/indexes/lazy-index.ts:69](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/lazy-index.ts#L69)

Resolve the actual index

#### Returns

`Promise`\<[`BaseIndex`](../baseindex.md)\<`TKey`\>\>
---
id: StorageError
title: StorageError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: StorageError

Defined in: [packages/db/src/errors.ts:466](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L466)

## Extends

- [`TanStackDBError`](../tanstackdberror.md)

## Extended by

- [`SerializationError`](../serializationerror.md)
- [`LocalStorageCollectionError`](../localstoragecollectionerror.md)

## Constructors

### new StorageError()

```ts
new StorageError(message): StorageError
```

Defined in: [packages/db/src/errors.ts:467](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L467)

#### Parameters

##### message

`string`

#### Returns

[`StorageError`](../storageerror.md)

#### Overrides

[`TanStackDBError`](../tanstackdberror.md).[`constructor`](../TanStackDBError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`cause`](../TanStackDBError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`message`](../TanStackDBError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`name`](../TanStackDBError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stack`](../TanStackDBError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`prepareStackTrace`](../TanStackDBError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stackTraceLimit`](../TanStackDBError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`captureStackTrace`](../TanStackDBError.md#capturestacktrace)
---
id: TransactionNotPendingMutateError
title: TransactionNotPendingMutateError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: TransactionNotPendingMutateError

Defined in: [packages/db/src/errors.ts:232](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L232)

## Extends

- [`TransactionError`](../transactionerror.md)

## Constructors

### new TransactionNotPendingMutateError()

```ts
new TransactionNotPendingMutateError(): TransactionNotPendingMutateError
```

Defined in: [packages/db/src/errors.ts:233](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L233)

#### Returns

[`TransactionNotPendingMutateError`](../transactionnotpendingmutateerror.md)

#### Overrides

[`TransactionError`](../transactionerror.md).[`constructor`](../TransactionError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`TransactionError`](../transactionerror.md).[`cause`](../TransactionError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`TransactionError`](../transactionerror.md).[`message`](../TransactionError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`TransactionError`](../transactionerror.md).[`name`](../TransactionError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`TransactionError`](../transactionerror.md).[`stack`](../TransactionError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`TransactionError`](../transactionerror.md).[`prepareStackTrace`](../TransactionError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`TransactionError`](../transactionerror.md).[`stackTraceLimit`](../TransactionError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`TransactionError`](../transactionerror.md).[`captureStackTrace`](../TransactionError.md#capturestacktrace)
---
id: MissingUpdateArgumentError
title: MissingUpdateArgumentError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: MissingUpdateArgumentError

Defined in: [packages/db/src/errors.ts:144](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L144)

## Extends

- [`CollectionOperationError`](../collectionoperationerror.md)

## Constructors

### new MissingUpdateArgumentError()

```ts
new MissingUpdateArgumentError(): MissingUpdateArgumentError
```

Defined in: [packages/db/src/errors.ts:145](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L145)

#### Returns

[`MissingUpdateArgumentError`](../missingupdateargumenterror.md)

#### Overrides

[`CollectionOperationError`](../collectionoperationerror.md).[`constructor`](../CollectionOperationError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`cause`](../CollectionOperationError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`message`](../CollectionOperationError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`name`](../CollectionOperationError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`stack`](../CollectionOperationError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`prepareStackTrace`](../CollectionOperationError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`stackTraceLimit`](../CollectionOperationError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`captureStackTrace`](../CollectionOperationError.md#capturestacktrace)
---
id: NoStorageEventApiError
title: NoStorageEventApiError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: NoStorageEventApiError

Defined in: [packages/db/src/errors.ts:503](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L503)

## Extends

- [`LocalStorageCollectionError`](../localstoragecollectionerror.md)

## Constructors

### new NoStorageEventApiError()

```ts
new NoStorageEventApiError(): NoStorageEventApiError
```

Defined in: [packages/db/src/errors.ts:504](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L504)

#### Returns

[`NoStorageEventApiError`](../nostorageeventapierror.md)

#### Overrides

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`constructor`](../LocalStorageCollectionError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`cause`](../LocalStorageCollectionError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`message`](../LocalStorageCollectionError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`name`](../LocalStorageCollectionError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`stack`](../LocalStorageCollectionError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`prepareStackTrace`](../LocalStorageCollectionError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`stackTraceLimit`](../LocalStorageCollectionError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`LocalStorageCollectionError`](../localstoragecollectionerror.md).[`captureStackTrace`](../LocalStorageCollectionError.md#capturestacktrace)
---
id: MissingDeleteHandlerError
title: MissingDeleteHandlerError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: MissingDeleteHandlerError

Defined in: [packages/db/src/errors.ts:210](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L210)

## Extends

- [`MissingHandlerError`](../missinghandlererror.md)

## Constructors

### new MissingDeleteHandlerError()

```ts
new MissingDeleteHandlerError(): MissingDeleteHandlerError
```

Defined in: [packages/db/src/errors.ts:211](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L211)

#### Returns

[`MissingDeleteHandlerError`](../missingdeletehandlererror.md)

#### Overrides

[`MissingHandlerError`](../missinghandlererror.md).[`constructor`](../MissingHandlerError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`MissingHandlerError`](../missinghandlererror.md).[`cause`](../MissingHandlerError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`MissingHandlerError`](../missinghandlererror.md).[`message`](../MissingHandlerError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`MissingHandlerError`](../missinghandlererror.md).[`name`](../MissingHandlerError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`MissingHandlerError`](../missinghandlererror.md).[`stack`](../MissingHandlerError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`MissingHandlerError`](../missinghandlererror.md).[`prepareStackTrace`](../MissingHandlerError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`MissingHandlerError`](../missinghandlererror.md).[`stackTraceLimit`](../MissingHandlerError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`MissingHandlerError`](../missinghandlererror.md).[`captureStackTrace`](../MissingHandlerError.md#capturestacktrace)
---
id: HavingRequiresGroupByError
title: HavingRequiresGroupByError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: HavingRequiresGroupByError

Defined in: [packages/db/src/errors.ts:336](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L336)

## Extends

- [`QueryCompilationError`](../querycompilationerror.md)

## Constructors

### new HavingRequiresGroupByError()

```ts
new HavingRequiresGroupByError(): HavingRequiresGroupByError
```

Defined in: [packages/db/src/errors.ts:337](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L337)

#### Returns

[`HavingRequiresGroupByError`](../havingrequiresgroupbyerror.md)

#### Overrides

[`QueryCompilationError`](../querycompilationerror.md).[`constructor`](../QueryCompilationError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`cause`](../QueryCompilationError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`message`](../QueryCompilationError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`name`](../QueryCompilationError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`stack`](../QueryCompilationError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`prepareStackTrace`](../QueryCompilationError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`stackTraceLimit`](../QueryCompilationError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`captureStackTrace`](../QueryCompilationError.md#capturestacktrace)
---
id: MissingHandlerError
title: MissingHandlerError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: MissingHandlerError

Defined in: [packages/db/src/errors.ts:187](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L187)

## Extends

- [`TanStackDBError`](../tanstackdberror.md)

## Extended by

- [`MissingInsertHandlerError`](../missinginserthandlererror.md)
- [`MissingUpdateHandlerError`](../missingupdatehandlererror.md)
- [`MissingDeleteHandlerError`](../missingdeletehandlererror.md)

## Constructors

### new MissingHandlerError()

```ts
new MissingHandlerError(message): MissingHandlerError
```

Defined in: [packages/db/src/errors.ts:188](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L188)

#### Parameters

##### message

`string`

#### Returns

[`MissingHandlerError`](../missinghandlererror.md)

#### Overrides

[`TanStackDBError`](../tanstackdberror.md).[`constructor`](../TanStackDBError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`cause`](../TanStackDBError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`message`](../TanStackDBError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`name`](../TanStackDBError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stack`](../TanStackDBError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`prepareStackTrace`](../TanStackDBError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stackTraceLimit`](../TanStackDBError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`captureStackTrace`](../TanStackDBError.md#capturestacktrace)
---
id: InvalidSchemaError
title: InvalidSchemaError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: InvalidSchemaError

Defined in: [packages/db/src/errors.ts:64](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L64)

## Extends

- [`CollectionConfigurationError`](../collectionconfigurationerror.md)

## Constructors

### new InvalidSchemaError()

```ts
new InvalidSchemaError(): InvalidSchemaError
```

Defined in: [packages/db/src/errors.ts:65](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L65)

#### Returns

[`InvalidSchemaError`](../invalidschemaerror.md)

#### Overrides

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`constructor`](../CollectionConfigurationError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`cause`](../CollectionConfigurationError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`message`](../CollectionConfigurationError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`name`](../CollectionConfigurationError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`stack`](../CollectionConfigurationError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`prepareStackTrace`](../CollectionConfigurationError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`stackTraceLimit`](../CollectionConfigurationError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`CollectionConfigurationError`](../collectionconfigurationerror.md).[`captureStackTrace`](../CollectionConfigurationError.md#capturestacktrace)
---
id: NegativeActiveSubscribersError
title: NegativeActiveSubscribersError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: NegativeActiveSubscribersError

Defined in: [packages/db/src/errors.ts:106](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L106)

## Extends

- [`CollectionStateError`](../collectionstateerror.md)

## Constructors

### new NegativeActiveSubscribersError()

```ts
new NegativeActiveSubscribersError(): NegativeActiveSubscribersError
```

Defined in: [packages/db/src/errors.ts:107](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L107)

#### Returns

[`NegativeActiveSubscribersError`](../negativeactivesubscriberserror.md)

#### Overrides

[`CollectionStateError`](../collectionstateerror.md).[`constructor`](../CollectionStateError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`cause`](../CollectionStateError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`message`](../CollectionStateError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`name`](../CollectionStateError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`stack`](../CollectionStateError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`prepareStackTrace`](../CollectionStateError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`stackTraceLimit`](../CollectionStateError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`captureStackTrace`](../CollectionStateError.md#capturestacktrace)
---
id: QueryMustHaveFromClauseError
title: QueryMustHaveFromClauseError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: QueryMustHaveFromClauseError

Defined in: [packages/db/src/errors.ts:316](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L316)

## Extends

- [`QueryBuilderError`](../querybuildererror.md)

## Constructors

### new QueryMustHaveFromClauseError()

```ts
new QueryMustHaveFromClauseError(): QueryMustHaveFromClauseError
```

Defined in: [packages/db/src/errors.ts:317](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L317)

#### Returns

[`QueryMustHaveFromClauseError`](../querymusthavefromclauseerror.md)

#### Overrides

[`QueryBuilderError`](../querybuildererror.md).[`constructor`](../QueryBuilderError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`cause`](../QueryBuilderError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`message`](../QueryBuilderError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`name`](../QueryBuilderError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`stack`](../QueryBuilderError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`prepareStackTrace`](../QueryBuilderError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`stackTraceLimit`](../QueryBuilderError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`captureStackTrace`](../QueryBuilderError.md#capturestacktrace)
---
id: CollectionIsInErrorStateError
title: CollectionIsInErrorStateError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: CollectionIsInErrorStateError

Defined in: [packages/db/src/errors.ts:100](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L100)

## Extends

- [`CollectionStateError`](../collectionstateerror.md)

## Constructors

### new CollectionIsInErrorStateError()

```ts
new CollectionIsInErrorStateError(): CollectionIsInErrorStateError
```

Defined in: [packages/db/src/errors.ts:101](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L101)

#### Returns

[`CollectionIsInErrorStateError`](../collectionisinerrorstateerror.md)

#### Overrides

[`CollectionStateError`](../collectionstateerror.md).[`constructor`](../CollectionStateError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`cause`](../CollectionStateError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`message`](../CollectionStateError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`name`](../CollectionStateError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`stack`](../CollectionStateError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`prepareStackTrace`](../CollectionStateError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`stackTraceLimit`](../CollectionStateError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`CollectionStateError`](../collectionstateerror.md).[`captureStackTrace`](../CollectionStateError.md#capturestacktrace)
---
id: BTreeIndex
title: BTreeIndex
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: BTreeIndex\<TKey\>

Defined in: [packages/db/src/indexes/btree-index.ts:28](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/btree-index.ts#L28)

B+Tree index for sorted data with range queries
This maintains items in sorted order and provides efficient range operations

## Extends

- [`BaseIndex`](../baseindex.md)\<`TKey`\>

## Type Parameters

• **TKey** *extends* `string` \| `number` = `string` \| `number`

## Constructors

### new BTreeIndex()

```ts
new BTreeIndex<TKey>(
   id, 
   expression, 
   name?, 
options?): BTreeIndex<TKey>
```

Defined in: [packages/db/src/indexes/btree-index.ts:48](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/btree-index.ts#L48)

#### Parameters

##### id

`number`

##### expression

`BasicExpression`

##### name?

`string`

##### options?

`any`

#### Returns

[`BTreeIndex`](../btreeindex.md)\<`TKey`\>

#### Overrides

[`BaseIndex`](../baseindex.md).[`constructor`](../BaseIndex.md#constructors)

## Properties

### expression

```ts
readonly expression: BasicExpression;
```

Defined in: [packages/db/src/indexes/base-index.ts:33](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L33)

#### Inherited from

[`BaseIndex`](../baseindex.md).[`expression`](../BaseIndex.md#expression-1)

***

### id

```ts
readonly id: number;
```

Defined in: [packages/db/src/indexes/base-index.ts:31](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L31)

#### Inherited from

[`BaseIndex`](../baseindex.md).[`id`](../BaseIndex.md#id-1)

***

### lastUpdated

```ts
protected lastUpdated: Date;
```

Defined in: [packages/db/src/indexes/base-index.ts:38](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L38)

#### Inherited from

[`BaseIndex`](../baseindex.md).[`lastUpdated`](../BaseIndex.md#lastupdated)

***

### lookupCount

```ts
protected lookupCount: number = 0;
```

Defined in: [packages/db/src/indexes/base-index.ts:36](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L36)

#### Inherited from

[`BaseIndex`](../baseindex.md).[`lookupCount`](../BaseIndex.md#lookupcount)

***

### name?

```ts
readonly optional name: string;
```

Defined in: [packages/db/src/indexes/base-index.ts:32](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L32)

#### Inherited from

[`BaseIndex`](../baseindex.md).[`name`](../BaseIndex.md#name-1)

***

### supportedOperations

```ts
readonly supportedOperations: Set<"eq" | "gt" | "gte" | "lt" | "lte" | "in" | "like" | "ilike">;
```

Defined in: [packages/db/src/indexes/btree-index.ts:31](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/btree-index.ts#L31)

#### Overrides

[`BaseIndex`](../baseindex.md).[`supportedOperations`](../BaseIndex.md#supportedoperations)

***

### totalLookupTime

```ts
protected totalLookupTime: number = 0;
```

Defined in: [packages/db/src/indexes/base-index.ts:37](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L37)

#### Inherited from

[`BaseIndex`](../baseindex.md).[`totalLookupTime`](../BaseIndex.md#totallookuptime)

## Accessors

### indexedKeysSet

#### Get Signature

```ts
get indexedKeysSet(): Set<TKey>
```

Defined in: [packages/db/src/indexes/btree-index.ts:250](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/btree-index.ts#L250)

##### Returns

`Set`\<`TKey`\>

***

### keyCount

#### Get Signature

```ts
get keyCount(): number
```

Defined in: [packages/db/src/indexes/btree-index.ts:188](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/btree-index.ts#L188)

Gets the number of indexed keys

##### Returns

`number`

#### Overrides

[`BaseIndex`](../baseindex.md).[`keyCount`](../BaseIndex.md#keycount)

***

### orderedEntriesArray

#### Get Signature

```ts
get orderedEntriesArray(): [any, Set<TKey>][]
```

Defined in: [packages/db/src/indexes/btree-index.ts:254](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/btree-index.ts#L254)

##### Returns

\[`any`, `Set`\<`TKey`\>\][]

***

### valueMapData

#### Get Signature

```ts
get valueMapData(): Map<any, Set<TKey>>
```

Defined in: [packages/db/src/indexes/btree-index.ts:260](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/btree-index.ts#L260)

##### Returns

`Map`\<`any`, `Set`\<`TKey`\>\>

## Methods

### add()

```ts
add(key, item): void
```

Defined in: [packages/db/src/indexes/btree-index.ts:64](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/btree-index.ts#L64)

Adds a value to the index

#### Parameters

##### key

`TKey`

##### item

`any`

#### Returns

`void`

#### Overrides

[`BaseIndex`](../baseindex.md).[`add`](../BaseIndex.md#add)

***

### build()

```ts
build(entries): void
```

Defined in: [packages/db/src/indexes/btree-index.ts:132](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/btree-index.ts#L132)

Builds the index from a collection of entries

#### Parameters

##### entries

`Iterable`\<\[`TKey`, `any`\]\>

#### Returns

`void`

#### Overrides

[`BaseIndex`](../baseindex.md).[`build`](../BaseIndex.md#build)

***

### clear()

```ts
clear(): void
```

Defined in: [packages/db/src/indexes/btree-index.ts:143](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/btree-index.ts#L143)

Clears all data from the index

#### Returns

`void`

#### Overrides

[`BaseIndex`](../baseindex.md).[`clear`](../BaseIndex.md#clear)

***

### equalityLookup()

```ts
equalityLookup(value): Set<TKey>
```

Defined in: [packages/db/src/indexes/btree-index.ts:197](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/btree-index.ts#L197)

Performs an equality lookup

#### Parameters

##### value

`any`

#### Returns

`Set`\<`TKey`\>

***

### evaluateIndexExpression()

```ts
protected evaluateIndexExpression(item): any
```

Defined in: [packages/db/src/indexes/base-index.ts:87](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L87)

#### Parameters

##### item

`any`

#### Returns

`any`

#### Inherited from

[`BaseIndex`](../baseindex.md).[`evaluateIndexExpression`](../BaseIndex.md#evaluateindexexpression)

***

### getStats()

```ts
getStats(): IndexStats
```

Defined in: [packages/db/src/indexes/base-index.ts:74](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L74)

#### Returns

[`IndexStats`](../../interfaces/indexstats.md)

#### Inherited from

[`BaseIndex`](../baseindex.md).[`getStats`](../BaseIndex.md#getstats)

***

### inArrayLookup()

```ts
inArrayLookup(values): Set<TKey>
```

Defined in: [packages/db/src/indexes/btree-index.ts:236](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/btree-index.ts#L236)

Performs an IN array lookup

#### Parameters

##### values

`any`[]

#### Returns

`Set`\<`TKey`\>

***

### initialize()

```ts
protected initialize(_options?): void
```

Defined in: [packages/db/src/indexes/btree-index.ts:59](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/btree-index.ts#L59)

#### Parameters

##### \_options?

[`BTreeIndexOptions`](../../interfaces/btreeindexoptions.md)

#### Returns

`void`

#### Overrides

[`BaseIndex`](../baseindex.md).[`initialize`](../BaseIndex.md#initialize)

***

### lookup()

```ts
lookup(operation, value): Set<TKey>
```

Defined in: [packages/db/src/indexes/btree-index.ts:153](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/btree-index.ts#L153)

Performs a lookup operation

#### Parameters

##### operation

`"eq"` | `"gt"` | `"gte"` | `"lt"` | `"lte"` | `"in"` | `"like"` | `"ilike"`

##### value

`any`

#### Returns

`Set`\<`TKey`\>

#### Overrides

[`BaseIndex`](../baseindex.md).[`lookup`](../BaseIndex.md#lookup)

***

### matchesField()

```ts
matchesField(fieldPath): boolean
```

Defined in: [packages/db/src/indexes/base-index.ts:66](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L66)

#### Parameters

##### fieldPath

`string`[]

#### Returns

`boolean`

#### Inherited from

[`BaseIndex`](../baseindex.md).[`matchesField`](../BaseIndex.md#matchesfield)

***

### rangeQuery()

```ts
rangeQuery(options): Set<TKey>
```

Defined in: [packages/db/src/indexes/btree-index.ts:205](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/btree-index.ts#L205)

Performs a range query with options
This is more efficient for compound queries like "WHERE a > 5 AND a < 10"

#### Parameters

##### options

[`RangeQueryOptions`](../../interfaces/rangequeryoptions.md) = `{}`

#### Returns

`Set`\<`TKey`\>

***

### remove()

```ts
remove(key, item): void
```

Defined in: [packages/db/src/indexes/btree-index.ts:92](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/btree-index.ts#L92)

Removes a value from the index

#### Parameters

##### key

`TKey`

##### item

`any`

#### Returns

`void`

#### Overrides

[`BaseIndex`](../baseindex.md).[`remove`](../BaseIndex.md#remove)

***

### supports()

```ts
supports(operation): boolean
```

Defined in: [packages/db/src/indexes/base-index.ts:62](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L62)

#### Parameters

##### operation

`"eq"` | `"gt"` | `"gte"` | `"lt"` | `"lte"` | `"in"` | `"like"` | `"ilike"`

#### Returns

`boolean`

#### Inherited from

[`BaseIndex`](../baseindex.md).[`supports`](../BaseIndex.md#supports)

***

### trackLookup()

```ts
protected trackLookup(startTime): void
```

Defined in: [packages/db/src/indexes/base-index.ts:92](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L92)

#### Parameters

##### startTime

`number`

#### Returns

`void`

#### Inherited from

[`BaseIndex`](../baseindex.md).[`trackLookup`](../BaseIndex.md#tracklookup)

***

### update()

```ts
update(
   key, 
   oldItem, 
   newItem): void
```

Defined in: [packages/db/src/indexes/btree-index.ts:124](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/btree-index.ts#L124)

Updates a value in the index

#### Parameters

##### key

`TKey`

##### oldItem

`any`

##### newItem

`any`

#### Returns

`void`

#### Overrides

[`BaseIndex`](../baseindex.md).[`update`](../BaseIndex.md#update)

***

### updateTimestamp()

```ts
protected updateTimestamp(): void
```

Defined in: [packages/db/src/indexes/base-index.ts:98](https://github.com/TanStack/db/blob/main/packages/db/src/indexes/base-index.ts#L98)

#### Returns

`void`

#### Inherited from

[`BaseIndex`](../baseindex.md).[`updateTimestamp`](../BaseIndex.md#updatetimestamp)
---
id: NonRetriableError
title: NonRetriableError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: NonRetriableError

Defined in: [packages/db/src/errors.ts:10](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L10)

## Extends

- [`TanStackDBError`](../tanstackdberror.md)

## Constructors

### new NonRetriableError()

```ts
new NonRetriableError(message): NonRetriableError
```

Defined in: [packages/db/src/errors.ts:11](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L11)

#### Parameters

##### message

`string`

#### Returns

[`NonRetriableError`](../nonretriableerror.md)

#### Overrides

[`TanStackDBError`](../tanstackdberror.md).[`constructor`](../TanStackDBError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`cause`](../TanStackDBError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`message`](../TanStackDBError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`name`](../TanStackDBError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stack`](../TanStackDBError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`prepareStackTrace`](../TanStackDBError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stackTraceLimit`](../TanStackDBError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`captureStackTrace`](../TanStackDBError.md#capturestacktrace)
---
id: CollectionConfigurationError
title: CollectionConfigurationError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: CollectionConfigurationError

Defined in: [packages/db/src/errors.ts:45](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L45)

## Extends

- [`TanStackDBError`](../tanstackdberror.md)

## Extended by

- [`CollectionRequiresConfigError`](../collectionrequiresconfigerror.md)
- [`CollectionRequiresSyncConfigError`](../collectionrequiressyncconfigerror.md)
- [`InvalidSchemaError`](../invalidschemaerror.md)
- [`SchemaMustBeSynchronousError`](../schemamustbesynchronouserror.md)

## Constructors

### new CollectionConfigurationError()

```ts
new CollectionConfigurationError(message): CollectionConfigurationError
```

Defined in: [packages/db/src/errors.ts:46](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L46)

#### Parameters

##### message

`string`

#### Returns

[`CollectionConfigurationError`](../collectionconfigurationerror.md)

#### Overrides

[`TanStackDBError`](../tanstackdberror.md).[`constructor`](../TanStackDBError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`cause`](../TanStackDBError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`message`](../TanStackDBError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`name`](../TanStackDBError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stack`](../TanStackDBError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`prepareStackTrace`](../TanStackDBError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stackTraceLimit`](../TanStackDBError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`captureStackTrace`](../TanStackDBError.md#capturestacktrace)
---
id: LocalStorageCollectionError
title: LocalStorageCollectionError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: LocalStorageCollectionError

Defined in: [packages/db/src/errors.ts:482](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L482)

## Extends

- [`StorageError`](../storageerror.md)

## Extended by

- [`StorageKeyRequiredError`](../storagekeyrequirederror.md)
- [`NoStorageAvailableError`](../nostorageavailableerror.md)
- [`NoStorageEventApiError`](../nostorageeventapierror.md)
- [`InvalidStorageDataFormatError`](../invalidstoragedataformaterror.md)
- [`InvalidStorageObjectFormatError`](../invalidstorageobjectformaterror.md)

## Constructors

### new LocalStorageCollectionError()

```ts
new LocalStorageCollectionError(message): LocalStorageCollectionError
```

Defined in: [packages/db/src/errors.ts:483](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L483)

#### Parameters

##### message

`string`

#### Returns

[`LocalStorageCollectionError`](../localstoragecollectionerror.md)

#### Overrides

[`StorageError`](../storageerror.md).[`constructor`](../StorageError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`StorageError`](../storageerror.md).[`cause`](../StorageError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`StorageError`](../storageerror.md).[`message`](../StorageError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`StorageError`](../storageerror.md).[`name`](../StorageError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`StorageError`](../storageerror.md).[`stack`](../StorageError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`StorageError`](../storageerror.md).[`prepareStackTrace`](../StorageError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`StorageError`](../storageerror.md).[`stackTraceLimit`](../StorageError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`StorageError`](../storageerror.md).[`captureStackTrace`](../StorageError.md#capturestacktrace)
---
id: SubQueryMustHaveFromClauseError
title: SubQueryMustHaveFromClauseError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: SubQueryMustHaveFromClauseError

Defined in: [packages/db/src/errors.ts:298](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L298)

## Extends

- [`QueryBuilderError`](../querybuildererror.md)

## Constructors

### new SubQueryMustHaveFromClauseError()

```ts
new SubQueryMustHaveFromClauseError(context): SubQueryMustHaveFromClauseError
```

Defined in: [packages/db/src/errors.ts:299](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L299)

#### Parameters

##### context

`string`

#### Returns

[`SubQueryMustHaveFromClauseError`](../subquerymusthavefromclauseerror.md)

#### Overrides

[`QueryBuilderError`](../querybuildererror.md).[`constructor`](../QueryBuilderError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`cause`](../QueryBuilderError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`message`](../QueryBuilderError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`name`](../QueryBuilderError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`stack`](../QueryBuilderError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`prepareStackTrace`](../QueryBuilderError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`stackTraceLimit`](../QueryBuilderError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`QueryBuilderError`](../querybuildererror.md).[`captureStackTrace`](../QueryBuilderError.md#capturestacktrace)
---
id: NoPendingSyncTransactionCommitError
title: NoPendingSyncTransactionCommitError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: NoPendingSyncTransactionCommitError

Defined in: [packages/db/src/errors.ts:270](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L270)

## Extends

- [`TransactionError`](../transactionerror.md)

## Constructors

### new NoPendingSyncTransactionCommitError()

```ts
new NoPendingSyncTransactionCommitError(): NoPendingSyncTransactionCommitError
```

Defined in: [packages/db/src/errors.ts:271](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L271)

#### Returns

[`NoPendingSyncTransactionCommitError`](../nopendingsynctransactioncommiterror.md)

#### Overrides

[`TransactionError`](../transactionerror.md).[`constructor`](../TransactionError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`TransactionError`](../transactionerror.md).[`cause`](../TransactionError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`TransactionError`](../transactionerror.md).[`message`](../TransactionError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`TransactionError`](../transactionerror.md).[`name`](../TransactionError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`TransactionError`](../transactionerror.md).[`stack`](../TransactionError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`TransactionError`](../transactionerror.md).[`prepareStackTrace`](../TransactionError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`TransactionError`](../transactionerror.md).[`stackTraceLimit`](../TransactionError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`TransactionError`](../transactionerror.md).[`captureStackTrace`](../TransactionError.md#capturestacktrace)
---
id: SyncTransactionAlreadyCommittedWriteError
title: SyncTransactionAlreadyCommittedWriteError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: SyncTransactionAlreadyCommittedWriteError

Defined in: [packages/db/src/errors.ts:262](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L262)

## Extends

- [`TransactionError`](../transactionerror.md)

## Constructors

### new SyncTransactionAlreadyCommittedWriteError()

```ts
new SyncTransactionAlreadyCommittedWriteError(): SyncTransactionAlreadyCommittedWriteError
```

Defined in: [packages/db/src/errors.ts:263](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L263)

#### Returns

[`SyncTransactionAlreadyCommittedWriteError`](../synctransactionalreadycommittedwriteerror.md)

#### Overrides

[`TransactionError`](../transactionerror.md).[`constructor`](../TransactionError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`TransactionError`](../transactionerror.md).[`cause`](../TransactionError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`TransactionError`](../transactionerror.md).[`message`](../TransactionError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`TransactionError`](../transactionerror.md).[`name`](../TransactionError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`TransactionError`](../transactionerror.md).[`stack`](../TransactionError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`TransactionError`](../transactionerror.md).[`prepareStackTrace`](../TransactionError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`TransactionError`](../transactionerror.md).[`stackTraceLimit`](../TransactionError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`TransactionError`](../transactionerror.md).[`captureStackTrace`](../TransactionError.md#capturestacktrace)
---
id: InvalidJoinConditionTableMismatchError
title: InvalidJoinConditionTableMismatchError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: InvalidJoinConditionTableMismatchError

Defined in: [packages/db/src/errors.ts:402](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L402)

## Extends

- [`JoinError`](../joinerror.md)

## Constructors

### new InvalidJoinConditionTableMismatchError()

```ts
new InvalidJoinConditionTableMismatchError(mainTableAlias, joinedTableAlias): InvalidJoinConditionTableMismatchError
```

Defined in: [packages/db/src/errors.ts:403](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L403)

#### Parameters

##### mainTableAlias

`string`

##### joinedTableAlias

`string`

#### Returns

[`InvalidJoinConditionTableMismatchError`](../invalidjoinconditiontablemismatcherror.md)

#### Overrides

[`JoinError`](../joinerror.md).[`constructor`](../JoinError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`JoinError`](../joinerror.md).[`cause`](../JoinError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`JoinError`](../joinerror.md).[`message`](../JoinError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`JoinError`](../joinerror.md).[`name`](../JoinError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`JoinError`](../joinerror.md).[`stack`](../JoinError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`JoinError`](../joinerror.md).[`prepareStackTrace`](../JoinError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`JoinError`](../joinerror.md).[`stackTraceLimit`](../JoinError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`JoinError`](../joinerror.md).[`captureStackTrace`](../JoinError.md#capturestacktrace)
---
id: MissingInsertHandlerError
title: MissingInsertHandlerError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: MissingInsertHandlerError

Defined in: [packages/db/src/errors.ts:194](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L194)

## Extends

- [`MissingHandlerError`](../missinghandlererror.md)

## Constructors

### new MissingInsertHandlerError()

```ts
new MissingInsertHandlerError(): MissingInsertHandlerError
```

Defined in: [packages/db/src/errors.ts:195](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L195)

#### Returns

[`MissingInsertHandlerError`](../missinginserthandlererror.md)

#### Overrides

[`MissingHandlerError`](../missinghandlererror.md).[`constructor`](../MissingHandlerError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`MissingHandlerError`](../missinghandlererror.md).[`cause`](../MissingHandlerError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`MissingHandlerError`](../missinghandlererror.md).[`message`](../MissingHandlerError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`MissingHandlerError`](../missinghandlererror.md).[`name`](../MissingHandlerError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`MissingHandlerError`](../missinghandlererror.md).[`stack`](../MissingHandlerError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`MissingHandlerError`](../missinghandlererror.md).[`prepareStackTrace`](../MissingHandlerError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`MissingHandlerError`](../missinghandlererror.md).[`stackTraceLimit`](../MissingHandlerError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`MissingHandlerError`](../missinghandlererror.md).[`captureStackTrace`](../MissingHandlerError.md#capturestacktrace)
---
id: UnknownExpressionTypeError
title: UnknownExpressionTypeError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: UnknownExpressionTypeError

Defined in: [packages/db/src/errors.ts:362](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L362)

## Extends

- [`QueryCompilationError`](../querycompilationerror.md)

## Constructors

### new UnknownExpressionTypeError()

```ts
new UnknownExpressionTypeError(type): UnknownExpressionTypeError
```

Defined in: [packages/db/src/errors.ts:363](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L363)

#### Parameters

##### type

`string`

#### Returns

[`UnknownExpressionTypeError`](../unknownexpressiontypeerror.md)

#### Overrides

[`QueryCompilationError`](../querycompilationerror.md).[`constructor`](../QueryCompilationError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`cause`](../QueryCompilationError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`message`](../QueryCompilationError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`name`](../QueryCompilationError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`stack`](../QueryCompilationError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`prepareStackTrace`](../QueryCompilationError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`stackTraceLimit`](../QueryCompilationError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`QueryCompilationError`](../querycompilationerror.md).[`captureStackTrace`](../QueryCompilationError.md#capturestacktrace)
---
id: JoinError
title: JoinError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: JoinError

Defined in: [packages/db/src/errors.ts:381](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L381)

## Extends

- [`TanStackDBError`](../tanstackdberror.md)

## Extended by

- [`UnsupportedJoinTypeError`](../unsupportedjointypeerror.md)
- [`InvalidJoinConditionSameTableError`](../invalidjoinconditionsametableerror.md)
- [`InvalidJoinConditionTableMismatchError`](../invalidjoinconditiontablemismatcherror.md)
- [`InvalidJoinConditionWrongTablesError`](../invalidjoinconditionwrongtableserror.md)
- [`UnsupportedJoinSourceTypeError`](../unsupportedjoinsourcetypeerror.md)

## Constructors

### new JoinError()

```ts
new JoinError(message): JoinError
```

Defined in: [packages/db/src/errors.ts:382](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L382)

#### Parameters

##### message

`string`

#### Returns

[`JoinError`](../joinerror.md)

#### Overrides

[`TanStackDBError`](../tanstackdberror.md).[`constructor`](../TanStackDBError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`cause`](../TanStackDBError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`message`](../TanStackDBError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`name`](../TanStackDBError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stack`](../TanStackDBError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`prepareStackTrace`](../TanStackDBError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`stackTraceLimit`](../TanStackDBError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`TanStackDBError`](../tanstackdberror.md).[`captureStackTrace`](../TanStackDBError.md#capturestacktrace)
---
id: UnsupportedAggregateFunctionError
title: UnsupportedAggregateFunctionError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: UnsupportedAggregateFunctionError

Defined in: [packages/db/src/errors.ts:445](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L445)

## Extends

- [`GroupByError`](../groupbyerror.md)

## Constructors

### new UnsupportedAggregateFunctionError()

```ts
new UnsupportedAggregateFunctionError(functionName): UnsupportedAggregateFunctionError
```

Defined in: [packages/db/src/errors.ts:446](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L446)

#### Parameters

##### functionName

`string`

#### Returns

[`UnsupportedAggregateFunctionError`](../unsupportedaggregatefunctionerror.md)

#### Overrides

[`GroupByError`](../groupbyerror.md).[`constructor`](../GroupByError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`cause`](../GroupByError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`message`](../GroupByError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`name`](../GroupByError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`stack`](../GroupByError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`prepareStackTrace`](../GroupByError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`stackTraceLimit`](../GroupByError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`GroupByError`](../groupbyerror.md).[`captureStackTrace`](../GroupByError.md#capturestacktrace)
---
id: UndefinedKeyError
title: UndefinedKeyError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: UndefinedKeyError

Defined in: [packages/db/src/errors.ts:120](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L120)

## Extends

- [`CollectionOperationError`](../collectionoperationerror.md)

## Constructors

### new UndefinedKeyError()

```ts
new UndefinedKeyError(item): UndefinedKeyError
```

Defined in: [packages/db/src/errors.ts:121](https://github.com/TanStack/db/blob/main/packages/db/src/errors.ts#L121)

#### Parameters

##### item

`any`

#### Returns

[`UndefinedKeyError`](../undefinedkeyerror.md)

#### Overrides

[`CollectionOperationError`](../collectionoperationerror.md).[`constructor`](../CollectionOperationError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`cause`](../CollectionOperationError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`message`](../CollectionOperationError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`name`](../CollectionOperationError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`stack`](../CollectionOperationError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`prepareStackTrace`](../CollectionOperationError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`stackTraceLimit`](../CollectionOperationError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`CollectionOperationError`](../collectionoperationerror.md).[`captureStackTrace`](../CollectionOperationError.md#capturestacktrace)
---
id: CollectionImpl
title: CollectionImpl
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: CollectionImpl\<T, TKey, TUtils, TSchema, TInsertInput\>

Defined in: [packages/db/src/collection.ts:204](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L204)

## Extended by

- [`Collection`](../../interfaces/collection.md)

## Type Parameters

• **T** *extends* `object` = `Record`\<`string`, `unknown`\>

• **TKey** *extends* `string` \| `number` = `string` \| `number`

• **TUtils** *extends* [`UtilsRecord`](../../type-aliases/utilsrecord.md) = \{\}

• **TSchema** *extends* `StandardSchemaV1` = `StandardSchemaV1`

• **TInsertInput** *extends* `object` = `T`

## Constructors

### new CollectionImpl()

```ts
new CollectionImpl<T, TKey, TUtils, TSchema, TInsertInput>(config): CollectionImpl<T, TKey, TUtils, TSchema, TInsertInput>
```

Defined in: [packages/db/src/collection.ts:407](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L407)

Creates a new Collection instance

#### Parameters

##### config

[`CollectionConfig`](../../interfaces/collectionconfig.md)\<`T`, `TKey`, `TSchema`, `TInsertInput`\>

Configuration object for the collection

#### Returns

[`CollectionImpl`](../collectionimpl.md)\<`T`, `TKey`, `TUtils`, `TSchema`, `TInsertInput`\>

#### Throws

Error if sync config is missing

## Properties

### config

```ts
config: CollectionConfig<T, TKey, TSchema, TInsertInput>;
```

Defined in: [packages/db/src/collection.ts:211](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L211)

***

### id

```ts
id: string;
```

Defined in: [packages/db/src/collection.ts:331](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L331)

***

### optimisticDeletes

```ts
optimisticDeletes: Set<TKey>;
```

Defined in: [packages/db/src/collection.ts:221](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L221)

***

### optimisticUpserts

```ts
optimisticUpserts: Map<TKey, T>;
```

Defined in: [packages/db/src/collection.ts:220](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L220)

***

### pendingSyncedTransactions

```ts
pendingSyncedTransactions: PendingSyncedTransaction<T>[] = [];
```

Defined in: [packages/db/src/collection.ts:215](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L215)

***

### syncedData

```ts
syncedData: Map<TKey, T> | SortedMap<TKey, T>;
```

Defined in: [packages/db/src/collection.ts:216](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L216)

***

### syncedMetadata

```ts
syncedMetadata: Map<TKey, unknown>;
```

Defined in: [packages/db/src/collection.ts:217](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L217)

***

### transactions

```ts
transactions: SortedMap<string, Transaction<any>>;
```

Defined in: [packages/db/src/collection.ts:214](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L214)

***

### utils

```ts
utils: Record<string, Fn> = {};
```

Defined in: [packages/db/src/collection.ts:238](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L238)

## Accessors

### indexes

#### Get Signature

```ts
get indexes(): Map<number, BaseIndex<TKey>>
```

Defined in: [packages/db/src/collection.ts:1439](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1439)

Get resolved indexes for query optimization

##### Returns

`Map`\<`number`, [`BaseIndex`](../baseindex.md)\<`TKey`\>\>

***

### size

#### Get Signature

```ts
get size(): number
```

Defined in: [packages/db/src/collection.ts:995](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L995)

Get the current size of the collection (cached)

##### Returns

`number`

***

### state

#### Get Signature

```ts
get state(): Map<TKey, T>
```

Defined in: [packages/db/src/collection.ts:2038](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L2038)

Gets the current state of the collection as a Map

##### Example

```ts
const itemsMap = collection.state
console.log(`Collection has ${itemsMap.size} items`)

for (const [key, item] of itemsMap) {
  console.log(`${key}: ${item.title}`)
}

// Check if specific item exists
if (itemsMap.has("todo-1")) {
  console.log("Todo 1 exists:", itemsMap.get("todo-1"))
}
```

##### Returns

`Map`\<`TKey`, `T`\>

Map containing all items in the collection, with keys as identifiers

***

### status

#### Get Signature

```ts
get status(): CollectionStatus
```

Defined in: [packages/db/src/collection.ts:336](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L336)

Gets the current status of the collection

##### Returns

[`CollectionStatus`](../../type-aliases/collectionstatus.md)

***

### toArray

#### Get Signature

```ts
get toArray(): T[]
```

Defined in: [packages/db/src/collection.ts:2071](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L2071)

Gets the current state of the collection as an Array

##### Returns

`T`[]

An Array containing all items in the collection

## Methods

### \[iterator\]()

```ts
iterator: IterableIterator<[TKey, T]>
```

Defined in: [packages/db/src/collection.ts:1046](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1046)

Get all entries (virtual derived state)

#### Returns

`IterableIterator`\<\[`TKey`, `T`\]\>

***

### cleanup()

```ts
cleanup(): Promise<void>
```

Defined in: [packages/db/src/collection.ts:583](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L583)

Clean up the collection by stopping sync and clearing data
This can be called manually or automatically by garbage collection

#### Returns

`Promise`\<`void`\>

***

### commitPendingTransactions()

```ts
commitPendingTransactions(): void
```

Defined in: [packages/db/src/collection.ts:1082](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1082)

Attempts to commit pending synced transactions if there are no active transactions
This method processes operations from pending transactions and applies them to the synced data

#### Returns

`void`

***

### createIndex()

```ts
createIndex<TResolver>(indexCallback, config): IndexProxy<TKey>
```

Defined in: [packages/db/src/collection.ts:1344](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1344)

Creates an index on a collection for faster queries.
Indexes significantly improve query performance by allowing binary search
and range queries instead of full scans.

#### Type Parameters

• **TResolver** *extends* [`IndexResolver`](../../type-aliases/indexresolver.md)\<`TKey`\> = *typeof* [`BTreeIndex`](../btreeindex.md)

The type of the index resolver (constructor or async loader)

#### Parameters

##### indexCallback

(`row`) => `any`

Function that extracts the indexed value from each item

##### config

[`IndexOptions`](../../interfaces/indexoptions.md)\<`TResolver`\> = `{}`

Configuration including index type and type-specific options

#### Returns

[`IndexProxy`](../indexproxy.md)\<`TKey`\>

An index proxy that provides access to the index when ready

#### Example

```ts
// Create a default B+ tree index
const ageIndex = collection.createIndex((row) => row.age)

// Create a ordered index with custom options
const ageIndex = collection.createIndex((row) => row.age, {
  indexType: BTreeIndex,
  options: { compareFn: customComparator },
  name: 'age_btree'
})

// Create an async-loaded index
const textIndex = collection.createIndex((row) => row.content, {
  indexType: async () => {
    const { FullTextIndex } = await import('./indexes/fulltext.js')
    return FullTextIndex
  },
  options: { language: 'en' }
})
```

***

### currentStateAsChanges()

```ts
currentStateAsChanges(options): ChangeMessage<T, string | number>[]
```

Defined in: [packages/db/src/collection.ts:2113](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L2113)

Returns the current state of the collection as an array of changes

#### Parameters

##### options

[`CurrentStateAsChangesOptions`](../../interfaces/currentstateaschangesoptions.md)\<`T`\> = `{}`

Options including optional where filter

#### Returns

[`ChangeMessage`](../../interfaces/changemessage.md)\<`T`, `string` \| `number`\>[]

An array of changes

#### Example

```ts
// Get all items as changes
const allChanges = collection.currentStateAsChanges()

// Get only items matching a condition
const activeChanges = collection.currentStateAsChanges({
  where: (row) => row.status === 'active'
})

// Get only items using a pre-compiled expression
const activeChanges = collection.currentStateAsChanges({
  whereExpression: eq(row.status, 'active')
})
```

***

### delete()

```ts
delete(keys, config?): Transaction<any>
```

Defined in: [packages/db/src/collection.ts:1939](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1939)

Deletes one or more items from the collection

#### Parameters

##### keys

Single key or array of keys to delete

`TKey` | `TKey`[]

##### config?

[`OperationConfig`](../../interfaces/operationconfig.md)

Optional configuration including metadata

#### Returns

[`Transaction`](../transaction.md)\<`any`\>

A Transaction object representing the delete operation(s)

#### Examples

```ts
// Delete a single item
const tx = collection.delete("todo-1")
await tx.isPersisted.promise
```

```ts
// Delete multiple items
const tx = collection.delete(["todo-1", "todo-2"])
await tx.isPersisted.promise
```

```ts
// Delete with metadata
const tx = collection.delete("todo-1", { metadata: { reason: "completed" } })
await tx.isPersisted.promise
```

```ts
// Handle errors
try {
  const tx = collection.delete("item-1")
  await tx.isPersisted.promise
  console.log('Delete successful')
} catch (error) {
  console.log('Delete failed:', error)
}
```

***

### entries()

```ts
entries(): IterableIterator<[TKey, T]>
```

Defined in: [packages/db/src/collection.ts:1034](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1034)

Get all entries (virtual derived state)

#### Returns

`IterableIterator`\<\[`TKey`, `T`\]\>

***

### forEach()

```ts
forEach(callbackfn): void
```

Defined in: [packages/db/src/collection.ts:1055](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1055)

Execute a callback for each entry in the collection

#### Parameters

##### callbackfn

(`value`, `key`, `index`) => `void`

#### Returns

`void`

***

### generateGlobalKey()

```ts
generateGlobalKey(key, item): string
```

Defined in: [packages/db/src/collection.ts:1306](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1306)

#### Parameters

##### key

`any`

##### item

`any`

#### Returns

`string`

***

### get()

```ts
get(key): undefined | T
```

Defined in: [packages/db/src/collection.ts:959](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L959)

Get the current value for a key (virtual derived state)

#### Parameters

##### key

`TKey`

#### Returns

`undefined` \| `T`

***

### getKeyFromItem()

```ts
getKeyFromItem(item): TKey
```

Defined in: [packages/db/src/collection.ts:1302](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1302)

#### Parameters

##### item

`T`

#### Returns

`TKey`

***

### has()

```ts
has(key): boolean
```

Defined in: [packages/db/src/collection.ts:977](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L977)

Check if a key exists in the collection (virtual derived state)

#### Parameters

##### key

`TKey`

#### Returns

`boolean`

***

### insert()

```ts
insert(data, config?): 
  | Transaction<Record<string, unknown>>
| Transaction<T>
```

Defined in: [packages/db/src/collection.ts:1594](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1594)

Inserts one or more items into the collection

#### Parameters

##### data

`TInsertInput` | `TInsertInput`[]

##### config?

[`InsertConfig`](../../interfaces/insertconfig.md)

Optional configuration including metadata

#### Returns

  \| [`Transaction`](../transaction.md)\<`Record`\<`string`, `unknown`\>\>
  \| [`Transaction`](../transaction.md)\<`T`\>

A Transaction object representing the insert operation(s)

#### Throws

If the data fails schema validation

#### Examples

```ts
// Insert a single todo (requires onInsert handler)
const tx = collection.insert({ id: "1", text: "Buy milk", completed: false })
await tx.isPersisted.promise
```

```ts
// Insert multiple todos at once
const tx = collection.insert([
  { id: "1", text: "Buy milk", completed: false },
  { id: "2", text: "Walk dog", completed: true }
])
await tx.isPersisted.promise
```

```ts
// Insert with metadata
const tx = collection.insert({ id: "1", text: "Buy groceries" },
  { metadata: { source: "mobile-app" } }
)
await tx.isPersisted.promise
```

```ts
// Handle errors
try {
  const tx = collection.insert({ id: "1", text: "New item" })
  await tx.isPersisted.promise
  console.log('Insert successful')
} catch (error) {
  console.log('Insert failed:', error)
}
```

***

### isReady()

```ts
isReady(): boolean
```

Defined in: [packages/db/src/collection.ts:294](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L294)

Check if the collection is ready for use
Returns true if the collection has been marked as ready by its sync implementation

#### Returns

`boolean`

true if the collection is ready, false otherwise

#### Example

```ts
if (collection.isReady()) {
  console.log('Collection is ready, data is available')
  // Safe to access collection.state
} else {
  console.log('Collection is still loading')
}
```

***

### keys()

```ts
keys(): IterableIterator<TKey>
```

Defined in: [packages/db/src/collection.ts:1002](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1002)

Get all keys (virtual derived state)

#### Returns

`IterableIterator`\<`TKey`\>

***

### map()

```ts
map<U>(callbackfn): U[]
```

Defined in: [packages/db/src/collection.ts:1067](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1067)

Create a new array with the results of calling a function for each entry in the collection

#### Type Parameters

• **U**

#### Parameters

##### callbackfn

(`value`, `key`, `index`) => `U`

#### Returns

`U`[]

***

### onFirstReady()

```ts
onFirstReady(callback): void
```

Defined in: [packages/db/src/collection.ts:272](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L272)

Register a callback to be executed when the collection first becomes ready
Useful for preloading collections

#### Parameters

##### callback

() => `void`

Function to call when the collection first becomes ready

#### Returns

`void`

#### Example

```ts
collection.onFirstReady(() => {
  console.log('Collection is ready for the first time')
  // Safe to access collection.state now
})
```

***

### onTransactionStateChange()

```ts
onTransactionStateChange(): void
```

Defined in: [packages/db/src/collection.ts:2271](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L2271)

Trigger a recomputation when transactions change
This method should be called by the Transaction class when state changes

#### Returns

`void`

***

### preload()

```ts
preload(): Promise<void>
```

Defined in: [packages/db/src/collection.ts:544](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L544)

Preload the collection data by starting sync if not already started
Multiple concurrent calls will share the same promise

#### Returns

`Promise`\<`void`\>

***

### startSyncImmediate()

```ts
startSyncImmediate(): void
```

Defined in: [packages/db/src/collection.ts:450](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L450)

Start sync immediately - internal method for compiled queries
This bypasses lazy loading for special cases like live query results

#### Returns

`void`

***

### stateWhenReady()

```ts
stateWhenReady(): Promise<Map<TKey, T>>
```

Defined in: [packages/db/src/collection.ts:2052](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L2052)

Gets the current state of the collection as a Map, but only resolves when data is available
Waits for the first sync commit to complete before resolving

#### Returns

`Promise`\<`Map`\<`TKey`, `T`\>\>

Promise that resolves to a Map containing all items in the collection

***

### subscribeChanges()

```ts
subscribeChanges(callback, options): () => void
```

Defined in: [packages/db/src/collection.ts:2158](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L2158)

Subscribe to changes in the collection

#### Parameters

##### callback

(`changes`) => `void`

Function called when items change

##### options

[`SubscribeChangesOptions`](../../interfaces/subscribechangesoptions.md)\<`T`\> = `{}`

Subscription options including includeInitialState and where filter

#### Returns

`Function`

Unsubscribe function - Call this to stop listening for changes

##### Returns

`void`

#### Examples

```ts
// Basic subscription
const unsubscribe = collection.subscribeChanges((changes) => {
  changes.forEach(change => {
    console.log(`${change.type}: ${change.key}`, change.value)
  })
})

// Later: unsubscribe()
```

```ts
// Include current state immediately
const unsubscribe = collection.subscribeChanges((changes) => {
  updateUI(changes)
}, { includeInitialState: true })
```

```ts
// Subscribe only to changes matching a condition
const unsubscribe = collection.subscribeChanges((changes) => {
  updateUI(changes)
}, {
  includeInitialState: true,
  where: (row) => row.status === 'active'
})
```

```ts
// Subscribe using a pre-compiled expression
const unsubscribe = collection.subscribeChanges((changes) => {
  updateUI(changes)
}, {
  includeInitialState: true,
  whereExpression: eq(row.status, 'active')
})
```

***

### subscribeChangesKey()

```ts
subscribeChangesKey(
   key, 
   listener, 
   __namedParameters): () => void
```

Defined in: [packages/db/src/collection.ts:2197](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L2197)

Subscribe to changes for a specific key

#### Parameters

##### key

`TKey`

##### listener

[`ChangeListener`](../../type-aliases/changelistener.md)\<`T`, `TKey`\>

##### \_\_namedParameters

###### includeInitialState?

`boolean` = `false`

#### Returns

`Function`

##### Returns

`void`

***

### toArrayWhenReady()

```ts
toArrayWhenReady(): Promise<T[]>
```

Defined in: [packages/db/src/collection.ts:2081](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L2081)

Gets the current state of the collection as an Array, but only resolves when data is available
Waits for the first sync commit to complete before resolving

#### Returns

`Promise`\<`T`[]\>

Promise that resolves to an Array containing all items in the collection

***

### update()

#### Call Signature

```ts
update<TItem>(key, callback): Transaction
```

Defined in: [packages/db/src/collection.ts:1725](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1725)

Updates one or more items in the collection using a callback function

##### Type Parameters

• **TItem** *extends* `object` = `T`

##### Parameters

###### key

`unknown`[]

###### callback

(`drafts`) => `void`

##### Returns

[`Transaction`](../transaction.md)

A Transaction object representing the update operation(s)

##### Throws

If the updated data fails schema validation

##### Examples

```ts
// Update single item by key
const tx = collection.update("todo-1", (draft) => {
  draft.completed = true
})
await tx.isPersisted.promise
```

```ts
// Update multiple items
const tx = collection.update(["todo-1", "todo-2"], (drafts) => {
  drafts.forEach(draft => { draft.completed = true })
})
await tx.isPersisted.promise
```

```ts
// Update with metadata
const tx = collection.update("todo-1",
  { metadata: { reason: "user update" } },
  (draft) => { draft.text = "Updated text" }
)
await tx.isPersisted.promise
```

```ts
// Handle errors
try {
  const tx = collection.update("item-1", draft => { draft.value = "new" })
  await tx.isPersisted.promise
  console.log('Update successful')
} catch (error) {
  console.log('Update failed:', error)
}
```

#### Call Signature

```ts
update<TItem>(
   keys, 
   config, 
   callback): Transaction
```

Defined in: [packages/db/src/collection.ts:1731](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1731)

Updates one or more items in the collection using a callback function

##### Type Parameters

• **TItem** *extends* `object` = `T`

##### Parameters

###### keys

`unknown`[]

Single key or array of keys to update

###### config

[`OperationConfig`](../../interfaces/operationconfig.md)

###### callback

(`drafts`) => `void`

##### Returns

[`Transaction`](../transaction.md)

A Transaction object representing the update operation(s)

##### Throws

If the updated data fails schema validation

##### Examples

```ts
// Update single item by key
const tx = collection.update("todo-1", (draft) => {
  draft.completed = true
})
await tx.isPersisted.promise
```

```ts
// Update multiple items
const tx = collection.update(["todo-1", "todo-2"], (drafts) => {
  drafts.forEach(draft => { draft.completed = true })
})
await tx.isPersisted.promise
```

```ts
// Update with metadata
const tx = collection.update("todo-1",
  { metadata: { reason: "user update" } },
  (draft) => { draft.text = "Updated text" }
)
await tx.isPersisted.promise
```

```ts
// Handle errors
try {
  const tx = collection.update("item-1", draft => { draft.value = "new" })
  await tx.isPersisted.promise
  console.log('Update successful')
} catch (error) {
  console.log('Update failed:', error)
}
```

#### Call Signature

```ts
update<TItem>(id, callback): Transaction
```

Defined in: [packages/db/src/collection.ts:1738](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1738)

Updates one or more items in the collection using a callback function

##### Type Parameters

• **TItem** *extends* `object` = `T`

##### Parameters

###### id

`unknown`

###### callback

(`draft`) => `void`

##### Returns

[`Transaction`](../transaction.md)

A Transaction object representing the update operation(s)

##### Throws

If the updated data fails schema validation

##### Examples

```ts
// Update single item by key
const tx = collection.update("todo-1", (draft) => {
  draft.completed = true
})
await tx.isPersisted.promise
```

```ts
// Update multiple items
const tx = collection.update(["todo-1", "todo-2"], (drafts) => {
  drafts.forEach(draft => { draft.completed = true })
})
await tx.isPersisted.promise
```

```ts
// Update with metadata
const tx = collection.update("todo-1",
  { metadata: { reason: "user update" } },
  (draft) => { draft.text = "Updated text" }
)
await tx.isPersisted.promise
```

```ts
// Handle errors
try {
  const tx = collection.update("item-1", draft => { draft.value = "new" })
  await tx.isPersisted.promise
  console.log('Update successful')
} catch (error) {
  console.log('Update failed:', error)
}
```

#### Call Signature

```ts
update<TItem>(
   id, 
   config, 
   callback): Transaction
```

Defined in: [packages/db/src/collection.ts:1744](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1744)

Updates one or more items in the collection using a callback function

##### Type Parameters

• **TItem** *extends* `object` = `T`

##### Parameters

###### id

`unknown`

###### config

[`OperationConfig`](../../interfaces/operationconfig.md)

###### callback

(`draft`) => `void`

##### Returns

[`Transaction`](../transaction.md)

A Transaction object representing the update operation(s)

##### Throws

If the updated data fails schema validation

##### Examples

```ts
// Update single item by key
const tx = collection.update("todo-1", (draft) => {
  draft.completed = true
})
await tx.isPersisted.promise
```

```ts
// Update multiple items
const tx = collection.update(["todo-1", "todo-2"], (drafts) => {
  drafts.forEach(draft => { draft.completed = true })
})
await tx.isPersisted.promise
```

```ts
// Update with metadata
const tx = collection.update("todo-1",
  { metadata: { reason: "user update" } },
  (draft) => { draft.text = "Updated text" }
)
await tx.isPersisted.promise
```

```ts
// Handle errors
try {
  const tx = collection.update("item-1", draft => { draft.value = "new" })
  await tx.isPersisted.promise
  console.log('Update successful')
} catch (error) {
  console.log('Update failed:', error)
}
```

***

### values()

```ts
values(): IterableIterator<T>
```

Defined in: [packages/db/src/collection.ts:1022](https://github.com/TanStack/db/blob/main/packages/db/src/collection.ts#L1022)

Get all values (virtual derived state)

#### Returns

`IterableIterator`\<`T`\>
---
id: "@tanstack/electric-db-collection"
title: "@tanstack/electric-db-collection"
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# @tanstack/electric-db-collection

## Classes

- [ElectricDBCollectionError](../classes/electricdbcollectionerror.md)
- [ElectricDeleteHandlerMustReturnTxIdError](../classes/electricdeletehandlermustreturntxiderror.md)
- [ElectricInsertHandlerMustReturnTxIdError](../classes/electricinserthandlermustreturntxiderror.md)
- [ElectricUpdateHandlerMustReturnTxIdError](../classes/electricupdatehandlermustreturntxiderror.md)
- [ExpectedNumberInAwaitTxIdError](../classes/expectednumberinawaittxiderror.md)
- [TimeoutWaitingForTxIdError](../classes/timeoutwaitingfortxiderror.md)

## Interfaces

- [ElectricCollectionConfig](../interfaces/electriccollectionconfig.md)
- [ElectricCollectionUtils](../interfaces/electriccollectionutils.md)

## Type Aliases

- [Txid](../type-aliases/txid.md)

## Functions

- [electricCollectionOptions](../functions/electriccollectionoptions.md)
---
id: ElectricCollectionConfig
title: ElectricCollectionConfig
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: ElectricCollectionConfig\<TExplicit, TSchema, TFallback\>

Defined in: [packages/electric-db-collection/src/electric.ts:73](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/electric.ts#L73)

Configuration interface for Electric collection options

## Remarks

Type resolution follows a priority order:
1. If you provide an explicit type via generic parameter, it will be used
2. If no explicit type is provided but a schema is, the schema's output type will be inferred
3. If neither explicit type nor schema is provided, the fallback type will be used

You should provide EITHER an explicit type OR a schema, but not both, as they would conflict.

## Type Parameters

• **TExplicit** *extends* `Row`\<`unknown`\> = `Row`\<`unknown`\>

The explicit type of items in the collection (highest priority)

• **TSchema** *extends* `StandardSchemaV1` = `never`

The schema type for validation and type inference (second priority)

• **TFallback** *extends* `Row`\<`unknown`\> = `Row`\<`unknown`\>

The fallback type if no explicit or schema type is provided

## Properties

### getKey()

```ts
getKey: (item) => string | number;
```

Defined in: [packages/electric-db-collection/src/electric.ts:90](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/electric.ts#L90)

#### Parameters

##### item

`ResolveType`

#### Returns

`string` \| `number`

***

### id?

```ts
optional id: string;
```

Defined in: [packages/electric-db-collection/src/electric.ts:88](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/electric.ts#L88)

All standard Collection configuration properties

***

### onDelete()?

```ts
optional onDelete: (params) => Promise<{
  txid: number | number[];
}>;
```

Defined in: [packages/electric-db-collection/src/electric.ts:246](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/electric.ts#L246)

Optional asynchronous handler function called before a delete operation
Must return an object containing a txid number or array of txids

#### Parameters

##### params

`DeleteMutationFnParams`\<`ResolveType`\<`TExplicit`, `TSchema`, `TFallback`\>\>

Object containing transaction and collection information

#### Returns

`Promise`\<\{
  `txid`: `number` \| `number`[];
 \}\>

Promise resolving to an object with txid or txids

#### Examples

```ts
// Basic Electric delete handler - MUST return { txid: number }
onDelete: async ({ transaction }) => {
  const mutation = transaction.mutations[0]
  const result = await api.todos.delete({
    id: mutation.original.id
  })
  return { txid: result.txid } // Required for Electric sync matching
}
```

```ts
// Delete handler with multiple items - return array of txids
onDelete: async ({ transaction }) => {
  const deletes = await Promise.all(
    transaction.mutations.map(m =>
      api.todos.delete({
        where: { id: m.key }
      })
    )
  )
  return { txid: deletes.map(d => d.txid) } // Array of txids
}
```

```ts
// Delete handler with batch operation - single txid
onDelete: async ({ transaction }) => {
  const idsToDelete = transaction.mutations.map(m => m.original.id)
  const result = await api.todos.deleteMany({
    ids: idsToDelete
  })
  return { txid: result.txid } // Single txid for batch operation
}
```

```ts
// Delete handler with optimistic rollback
onDelete: async ({ transaction }) => {
  const mutation = transaction.mutations[0]
  try {
    const result = await api.deleteTodo(mutation.original.id)
    return { txid: result.txid }
  } catch (error) {
    // Transaction will automatically rollback optimistic changes
    console.error('Delete failed, rolling back:', error)
    throw error
  }
}
```

***

### onInsert()?

```ts
optional onInsert: (params) => Promise<{
  txid: number | number[];
}>;
```

Defined in: [packages/electric-db-collection/src/electric.ts:141](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/electric.ts#L141)

Optional asynchronous handler function called before an insert operation
Must return an object containing a txid number or array of txids

#### Parameters

##### params

`InsertMutationFnParams`\<`ResolveType`\<`TExplicit`, `TSchema`, `TFallback`\>\>

Object containing transaction and collection information

#### Returns

`Promise`\<\{
  `txid`: `number` \| `number`[];
 \}\>

Promise resolving to an object with txid or txids

#### Examples

```ts
// Basic Electric insert handler - MUST return { txid: number }
onInsert: async ({ transaction }) => {
  const newItem = transaction.mutations[0].modified
  const result = await api.todos.create({
    data: newItem
  })
  return { txid: result.txid } // Required for Electric sync matching
}
```

```ts
// Insert handler with multiple items - return array of txids
onInsert: async ({ transaction }) => {
  const items = transaction.mutations.map(m => m.modified)
  const results = await Promise.all(
    items.map(item => api.todos.create({ data: item }))
  )
  return { txid: results.map(r => r.txid) } // Array of txids
}
```

```ts
// Insert handler with error handling
onInsert: async ({ transaction }) => {
  try {
    const newItem = transaction.mutations[0].modified
    const result = await api.createTodo(newItem)
    return { txid: result.txid }
  } catch (error) {
    console.error('Insert failed:', error)
    throw error // This will cause the transaction to fail
  }
}
```

```ts
// Insert handler with batch operation - single txid
onInsert: async ({ transaction }) => {
  const items = transaction.mutations.map(m => m.modified)
  const result = await api.todos.createMany({
    data: items
  })
  return { txid: result.txid } // Single txid for batch operation
}
```

***

### onUpdate()?

```ts
optional onUpdate: (params) => Promise<{
  txid: number | number[];
}>;
```

Defined in: [packages/electric-db-collection/src/electric.ts:189](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/electric.ts#L189)

Optional asynchronous handler function called before an update operation
Must return an object containing a txid number or array of txids

#### Parameters

##### params

`UpdateMutationFnParams`\<`ResolveType`\<`TExplicit`, `TSchema`, `TFallback`\>\>

Object containing transaction and collection information

#### Returns

`Promise`\<\{
  `txid`: `number` \| `number`[];
 \}\>

Promise resolving to an object with txid or txids

#### Examples

```ts
// Basic Electric update handler - MUST return { txid: number }
onUpdate: async ({ transaction }) => {
  const { original, changes } = transaction.mutations[0]
  const result = await api.todos.update({
    where: { id: original.id },
    data: changes // Only the changed fields
  })
  return { txid: result.txid } // Required for Electric sync matching
}
```

```ts
// Update handler with multiple items - return array of txids
onUpdate: async ({ transaction }) => {
  const updates = await Promise.all(
    transaction.mutations.map(m =>
      api.todos.update({
        where: { id: m.original.id },
        data: m.changes
      })
    )
  )
  return { txid: updates.map(u => u.txid) } // Array of txids
}
```

```ts
// Update handler with optimistic rollback
onUpdate: async ({ transaction }) => {
  const mutation = transaction.mutations[0]
  try {
    const result = await api.updateTodo(mutation.original.id, mutation.changes)
    return { txid: result.txid }
  } catch (error) {
    // Transaction will automatically rollback optimistic changes
    console.error('Update failed, rolling back:', error)
    throw error
  }
}
```

***

### schema?

```ts
optional schema: TSchema;
```

Defined in: [packages/electric-db-collection/src/electric.ts:89](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/electric.ts#L89)

***

### shapeOptions

```ts
shapeOptions: ShapeStreamOptions<GetExtensions<ResolveType<TExplicit, TSchema, TFallback>>>;
```

Defined in: [packages/electric-db-collection/src/electric.ts:81](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/electric.ts#L81)

Configuration options for the ElectricSQL ShapeStream

***

### sync?

```ts
optional sync: SyncConfig<ResolveType<TExplicit, TSchema, TFallback>, string | number>;
```

Defined in: [packages/electric-db-collection/src/electric.ts:91](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/electric.ts#L91)
---
id: ElectricCollectionUtils
title: ElectricCollectionUtils
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Interface: ElectricCollectionUtils

Defined in: [packages/electric-db-collection/src/electric.ts:272](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/electric.ts#L272)

Electric collection utilities type

## Extends

- `UtilsRecord`

## Indexable

```ts
[key: string]: Fn
```

## Properties

### awaitTxId

```ts
awaitTxId: AwaitTxIdFn;
```

Defined in: [packages/electric-db-collection/src/electric.ts:273](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/electric.ts#L273)
---
id: electricCollectionOptions
title: electricCollectionOptions
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Function: electricCollectionOptions()

```ts
function electricCollectionOptions<TExplicit, TSchema, TFallback>(config): object
```

Defined in: [packages/electric-db-collection/src/electric.ts:285](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/electric.ts#L285)

Creates Electric collection options for use with a standard Collection

## Type Parameters

• **TExplicit** *extends* `Row`\<`unknown`\> = `Row`\<`unknown`\>

The explicit type of items in the collection (highest priority)

• **TSchema** *extends* `StandardSchemaV1`\<`unknown`, `unknown`\> = `never`

The schema type for validation and type inference (second priority)

• **TFallback** *extends* `Row`\<`unknown`\> = `Row`\<`unknown`\>

The fallback type if no explicit or schema type is provided

## Parameters

### config

[`ElectricCollectionConfig`](../../interfaces/electriccollectionconfig.md)\<`TExplicit`, `TSchema`, `TFallback`\>

Configuration options for the Electric collection

## Returns

`object`

Collection options with utilities

### getKey()

```ts
getKey: (item) => string | number;
```

#### Parameters

##### item

`ResolveType`

#### Returns

`string` \| `number`

### id?

```ts
optional id: string;
```

All standard Collection configuration properties

### onDelete

```ts
onDelete: 
  | undefined
  | (params) => Promise<{
  txid: number | number[];
 }> = wrappedOnDelete;
```

### onInsert

```ts
onInsert: 
  | undefined
  | (params) => Promise<{
  txid: number | number[];
 }> = wrappedOnInsert;
```

### onUpdate

```ts
onUpdate: 
  | undefined
  | (params) => Promise<{
  txid: number | number[];
 }> = wrappedOnUpdate;
```

### schema?

```ts
optional schema: TSchema;
```

### sync

```ts
sync: SyncConfig<ResolveType<TExplicit, TSchema, TFallback>, string | number>;
```

### utils

```ts
utils: object;
```

#### utils.awaitTxId

```ts
awaitTxId: AwaitTxIdFn;
```
---
id: Txid
title: Txid
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Type Alias: Txid

```ts
type Txid = number;
```

Defined in: [packages/electric-db-collection/src/electric.ts:37](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/electric.ts#L37)

Type representing a transaction ID in ElectricSQL
---
id: ExpectedNumberInAwaitTxIdError
title: ExpectedNumberInAwaitTxIdError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: ExpectedNumberInAwaitTxIdError

Defined in: [packages/electric-db-collection/src/errors.ts:11](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/errors.ts#L11)

## Extends

- [`ElectricDBCollectionError`](../electricdbcollectionerror.md)

## Constructors

### new ExpectedNumberInAwaitTxIdError()

```ts
new ExpectedNumberInAwaitTxIdError(txIdType): ExpectedNumberInAwaitTxIdError
```

Defined in: [packages/electric-db-collection/src/errors.ts:12](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/errors.ts#L12)

#### Parameters

##### txIdType

`string`

#### Returns

[`ExpectedNumberInAwaitTxIdError`](../expectednumberinawaittxiderror.md)

#### Overrides

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`constructor`](../ElectricDBCollectionError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`cause`](../ElectricDBCollectionError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`message`](../ElectricDBCollectionError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`name`](../ElectricDBCollectionError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`stack`](../ElectricDBCollectionError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`prepareStackTrace`](../ElectricDBCollectionError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`stackTraceLimit`](../ElectricDBCollectionError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`captureStackTrace`](../ElectricDBCollectionError.md#capturestacktrace)
---
id: ElectricDBCollectionError
title: ElectricDBCollectionError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: ElectricDBCollectionError

Defined in: [packages/electric-db-collection/src/errors.ts:4](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/errors.ts#L4)

## Extends

- `TanStackDBError`

## Extended by

- [`ExpectedNumberInAwaitTxIdError`](../expectednumberinawaittxiderror.md)
- [`TimeoutWaitingForTxIdError`](../timeoutwaitingfortxiderror.md)
- [`ElectricInsertHandlerMustReturnTxIdError`](../electricinserthandlermustreturntxiderror.md)
- [`ElectricUpdateHandlerMustReturnTxIdError`](../electricupdatehandlermustreturntxiderror.md)
- [`ElectricDeleteHandlerMustReturnTxIdError`](../electricdeletehandlermustreturntxiderror.md)

## Constructors

### new ElectricDBCollectionError()

```ts
new ElectricDBCollectionError(message): ElectricDBCollectionError
```

Defined in: [packages/electric-db-collection/src/errors.ts:5](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/errors.ts#L5)

#### Parameters

##### message

`string`

#### Returns

[`ElectricDBCollectionError`](../electricdbcollectionerror.md)

#### Overrides

```ts
TanStackDBError.constructor
```

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

```ts
TanStackDBError.cause
```

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

```ts
TanStackDBError.message
```

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

```ts
TanStackDBError.name
```

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

```ts
TanStackDBError.stack
```

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

```ts
TanStackDBError.prepareStackTrace
```

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

```ts
TanStackDBError.stackTraceLimit
```

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

```ts
TanStackDBError.captureStackTrace
```
---
id: ElectricUpdateHandlerMustReturnTxIdError
title: ElectricUpdateHandlerMustReturnTxIdError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: ElectricUpdateHandlerMustReturnTxIdError

Defined in: [packages/electric-db-collection/src/errors.ts:34](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/errors.ts#L34)

## Extends

- [`ElectricDBCollectionError`](../electricdbcollectionerror.md)

## Constructors

### new ElectricUpdateHandlerMustReturnTxIdError()

```ts
new ElectricUpdateHandlerMustReturnTxIdError(): ElectricUpdateHandlerMustReturnTxIdError
```

Defined in: [packages/electric-db-collection/src/errors.ts:35](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/errors.ts#L35)

#### Returns

[`ElectricUpdateHandlerMustReturnTxIdError`](../electricupdatehandlermustreturntxiderror.md)

#### Overrides

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`constructor`](../ElectricDBCollectionError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`cause`](../ElectricDBCollectionError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`message`](../ElectricDBCollectionError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`name`](../ElectricDBCollectionError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`stack`](../ElectricDBCollectionError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`prepareStackTrace`](../ElectricDBCollectionError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`stackTraceLimit`](../ElectricDBCollectionError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`captureStackTrace`](../ElectricDBCollectionError.md#capturestacktrace)
---
id: TimeoutWaitingForTxIdError
title: TimeoutWaitingForTxIdError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: TimeoutWaitingForTxIdError

Defined in: [packages/electric-db-collection/src/errors.ts:18](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/errors.ts#L18)

## Extends

- [`ElectricDBCollectionError`](../electricdbcollectionerror.md)

## Constructors

### new TimeoutWaitingForTxIdError()

```ts
new TimeoutWaitingForTxIdError(txId): TimeoutWaitingForTxIdError
```

Defined in: [packages/electric-db-collection/src/errors.ts:19](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/errors.ts#L19)

#### Parameters

##### txId

`number`

#### Returns

[`TimeoutWaitingForTxIdError`](../timeoutwaitingfortxiderror.md)

#### Overrides

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`constructor`](../ElectricDBCollectionError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`cause`](../ElectricDBCollectionError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`message`](../ElectricDBCollectionError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`name`](../ElectricDBCollectionError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`stack`](../ElectricDBCollectionError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`prepareStackTrace`](../ElectricDBCollectionError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`stackTraceLimit`](../ElectricDBCollectionError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`captureStackTrace`](../ElectricDBCollectionError.md#capturestacktrace)
---
id: ElectricInsertHandlerMustReturnTxIdError
title: ElectricInsertHandlerMustReturnTxIdError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: ElectricInsertHandlerMustReturnTxIdError

Defined in: [packages/electric-db-collection/src/errors.ts:25](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/errors.ts#L25)

## Extends

- [`ElectricDBCollectionError`](../electricdbcollectionerror.md)

## Constructors

### new ElectricInsertHandlerMustReturnTxIdError()

```ts
new ElectricInsertHandlerMustReturnTxIdError(): ElectricInsertHandlerMustReturnTxIdError
```

Defined in: [packages/electric-db-collection/src/errors.ts:26](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/errors.ts#L26)

#### Returns

[`ElectricInsertHandlerMustReturnTxIdError`](../electricinserthandlermustreturntxiderror.md)

#### Overrides

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`constructor`](../ElectricDBCollectionError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`cause`](../ElectricDBCollectionError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`message`](../ElectricDBCollectionError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`name`](../ElectricDBCollectionError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`stack`](../ElectricDBCollectionError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`prepareStackTrace`](../ElectricDBCollectionError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`stackTraceLimit`](../ElectricDBCollectionError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`captureStackTrace`](../ElectricDBCollectionError.md#capturestacktrace)
---
id: ElectricDeleteHandlerMustReturnTxIdError
title: ElectricDeleteHandlerMustReturnTxIdError
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: ElectricDeleteHandlerMustReturnTxIdError

Defined in: [packages/electric-db-collection/src/errors.ts:43](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/errors.ts#L43)

## Extends

- [`ElectricDBCollectionError`](../electricdbcollectionerror.md)

## Constructors

### new ElectricDeleteHandlerMustReturnTxIdError()

```ts
new ElectricDeleteHandlerMustReturnTxIdError(): ElectricDeleteHandlerMustReturnTxIdError
```

Defined in: [packages/electric-db-collection/src/errors.ts:44](https://github.com/TanStack/db/blob/main/packages/electric-db-collection/src/errors.ts#L44)

#### Returns

[`ElectricDeleteHandlerMustReturnTxIdError`](../electricdeletehandlermustreturntxiderror.md)

#### Overrides

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`constructor`](../ElectricDBCollectionError.md#constructors)

## Properties

### cause?

```ts
optional cause: unknown;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es2022.error.d.ts:26

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`cause`](../ElectricDBCollectionError.md#cause)

***

### message

```ts
message: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1077

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`message`](../ElectricDBCollectionError.md#message-1)

***

### name

```ts
name: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1076

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`name`](../ElectricDBCollectionError.md#name)

***

### stack?

```ts
optional stack: string;
```

Defined in: node\_modules/.pnpm/typescript@5.8.2/node\_modules/typescript/lib/lib.es5.d.ts:1078

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`stack`](../ElectricDBCollectionError.md#stack)

***

### prepareStackTrace()?

```ts
static optional prepareStackTrace: (err, stackTraces) => any;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:143

Optional override for formatting stack traces

#### Parameters

##### err

`Error`

##### stackTraces

`CallSite`[]

#### Returns

`any`

#### See

https://v8.dev/docs/stack-trace-api#customizing-stack-traces

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`prepareStackTrace`](../ElectricDBCollectionError.md#preparestacktrace)

***

### stackTraceLimit

```ts
static stackTraceLimit: number;
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:145

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`stackTraceLimit`](../ElectricDBCollectionError.md#stacktracelimit)

## Methods

### captureStackTrace()

```ts
static captureStackTrace(targetObject, constructorOpt?): void
```

Defined in: node\_modules/.pnpm/@types+node@22.13.10/node\_modules/@types/node/globals.d.ts:136

Create .stack property on a target object

#### Parameters

##### targetObject

`object`

##### constructorOpt?

`Function`

#### Returns

`void`

#### Inherited from

[`ElectricDBCollectionError`](../electricdbcollectionerror.md).[`captureStackTrace`](../ElectricDBCollectionError.md#capturestacktrace)
---
title: Overview
id: overview
---

# TanStack DB - Documentation

Welcome to the TanStack DB documentation.

TanStack DB is a reactive client store for building super fast apps on sync. It extends TanStack Query with collections, live queries and optimistic mutations.

## Contents

- [How it works](#how-it-works) &mdash; understand the TanStack DB development model and how the pieces fit together
- [API reference](#api-reference) &mdash; for the primitives and function interfaces
- [Usage examples](#usage-examples) &mdash; examples of common usage patterns
- [More info](#more-info) &mdash; where to find support and more information

## How it works

TanStack DB works by:

- [defining collections](#defining-collections) typed sets of objects that can be populated with data
- [using live queries](#using-live-queries) to query data from/across collections
- [making optimistic mutations](#making-optimistic-mutations) using transactional mutators

```tsx
// Define collections to load data into
const todoCollection = createCollection({
  // ...your config
  onUpdate: updateMutationFn,
})

const Todos = () => {
  // Bind data using live queries
  const { data: todos } = useLiveQuery((q) =>
    q.from({ todo: todoCollection }).where(({ todo }) => todo.completed)
  )

  const complete = (todo) => {
    // Instantly applies optimistic state
    todoCollection.update(todo.id, (draft) => {
      draft.completed = true
    })
  }

  return (
    <ul>
      {todos.map((todo) => (
        <li key={todo.id} onClick={() => complete(todo)}>
          {todo.text}
        </li>
      ))}
    </ul>
  )
}
```

### Defining collections

Collections are typed sets of objects that can be populated with data. They're designed to de-couple loading data into your app from binding data to your components.

Collections can be populated in many ways, including:

- fetching data, for example [from API endpoints using TanStack Query](https://tanstack.com/query/latest)
- syncing data, for example [using a sync engine like ElectricSQL](https://electric-sql.com/)
- storing local data, for example [using localStorage for user preferences and settings](#localstoragecollection) or [in-memory client data or UI state](#localonlycollection)
- from live collection queries, creating [derived collections as materialised views](#using-live-queries)

Once you have your data in collections, you can query across them using live queries in your components.

### Using live queries

Live queries are used to query data out of collections. Live queries are reactive: when the underlying data changes in a way that would affect the query result, the result is incrementally updated and returned from the query, triggering a re-render.

TanStack DB live queries are implemented using [d2ts](https://github.com/electric-sql/d2ts), a Typescript implementation of differential dataflow. This allows the query results to update _incrementally_ (rather than by re-running the whole query). This makes them blazing fast, usually sub-millisecond, even for highly complex queries.

Live queries support joins across collections. This allows you to:

1. load normalised data into collections and then de-normalise it through queries; simplifying your backend by avoiding the need for bespoke API endpoints that match your client
2. join data from multiple sources; for example, syncing some data out of a database, fetching some other data from an external API and then joining these into a unified data model for your front-end code

Every query returns another collection which can _also_ be queried.

For more details on live queries, see the [Live Queries](live-queries.md) documentation.

### Making optimistic mutations

Collections support `insert`, `update` and `delete` operations. When called, by default they trigger the corresponding `onInsert`, `onUpdate`, `onDelete` handlers which are responsible for writing the mutation to the backend.

```ts
// Define collection with persistence handlers
const todoCollection = createCollection({
  id: "todos",
  // ... other config
  onUpdate: async ({ transaction }) => {
    const { original, changes } = transaction.mutations[0]
    await api.todos.update(original.id, changes)
  },
})

// Immediately applies optimistic state
todoCollection.update(todo.id, (draft) => {
  draft.completed = true
})
```

Rather than mutating the collection data directly, the collection internally treats its synced/loaded data as immutable and maintains a separate set of local mutations as optimistic state. When live queries read from the collection, they see a local view that overlays the local optimistic mutations on-top-of the immutable synced data.

The optimistic state is held until the `onUpdate` (in this case) handler resolves - at which point the data is persisted to the server and synced back to the local collection.

If the handler throws an error, the optimistic state is rolled back.

### Explicit transactions

Mutations are based on a `Transaction` primitive.

For simple state changes, directly mutating the collection and persisting with the operator handlers is enough.

But for more complex use cases, you can directly create custom actions with `createOptimisticAction` or custom transactions with `createTransaction`. This lets you do things such as do transactions with multiple mutations across multiple collections, do chained transactions w/ intermediate rollbacks, etc.

For example, in the following code, the mutationFn first sends the write to the server using `await api.todos.update(updatedTodo)` and then calls `await collection.refetch()` to trigger a re-fetch of the collection contents using TanStack Query. When this second await resolves, the collection is up-to-date with the latest changes and the optimistic state is safely discarded.

```ts
const updateTodo = createOptimisticAction<{ id: string }>({
  onMutate,
  mutationFn: async ({ transaction }) => {
    const { collection, modified: updatedTodo } = transaction.mutations[0]

    await api.todos.update(updatedTodo)
    await collection.refetch()
  },
})
```

### Uni-directional data flow

This combines to support a model of uni-directional data flow, extending the redux/flux style state management pattern beyond the client, to take in the server as well:

<figure>
  <a href="./unidirectional-data-flow.lg.png" target="_blank">
    <img src="./unidirectional-data-flow.png" />
  </a>
</figure>

With an instant inner loop of optimistic state, superseded in time by the slower outer loop of persisting to the server and syncing the updated server state back into the collection.

## API reference

### Collections

There are a number of built-in collection types:

1. [`QueryCollection`](#querycollection) to load data into collections using [TanStack Query](https://tanstack.com/query)
2. [`ElectricCollection`](#electriccollection) to sync data into collections using [ElectricSQL](https://electric-sql.com)
3. [`TrailBaseCollection`](#trailbasecollection) to sync data into collections using [TrailBase](https://trailbase.io)
4. [`LocalStorageCollection`](#localstoragecollection) for small amounts of local-only state that syncs across browser tabs
5. [`LocalOnlyCollection`](#localonlycollection) for in-memory client data or UI state

You can also use:

- use live collection queries to [derive collections from other collections](#derived-collections)
- the [base Collection](#base-collection) to define your own collection types

#### Collection schemas

All collections optionally (though strongly recommended) support adding a `schema`.

If provided, this must be a [Standard Schema](https://standardschema.dev) compatible schema instance, such as a [Zod](https://zod.dev) or [Effect](https://effect.website/docs/schema/introduction/) schema.

The collection will use the schema to do client-side validation of optimistic mutations.

The collection will use the schema for its type so if you provide a schema, you can't also pass in an explicit
type (e.g. `createCollection<Todo>()`).

#### `QueryCollection`

[TanStack Query](https://tanstack.com/query) fetches data using managed queries. Use `queryCollectionOptions` to fetch data into a collection using TanStack Query:

```ts
import { createCollection } from "@tanstack/react-db"
import { queryCollectionOptions } from "@tanstack/query-db-collection"

const todoCollection = createCollection(
  queryCollectionOptions({
    queryKey: ["todoItems"],
    queryFn: async () => fetch("/api/todos"),
    getKey: (item) => item.id,
    schema: todoSchema, // any standard schema
  })
)
```

The collection will be populated with the query results.

#### `ElectricCollection`

[Electric](https://electric-sql.com) is a read-path sync engine for Postgres. It allows you to sync subsets of data out of a Postgres database, [through your API](https://electric-sql.com/blog/2024/11/21/local-first-with-your-existing-api), into a TanStack DB collection.

Electric's main primitive for sync is a [Shape](https://electric-sql.com/docs/guides/shapes). Use `electricCollectionOptions` to sync a shape into a collection:

```ts
import { createCollection } from "@tanstack/react-db"
import { electricCollectionOptions } from "@tanstack/electric-db-collection"

export const todoCollection = createCollection(
  electricCollectionOptions({
    id: "todos",
    shapeOptions: {
      url: "https://example.com/v1/shape",
      params: {
        table: "todos",
      },
    },
    getKey: (item) => item.id,
    schema: todoSchema,
  })
)
```

The Electric collection requires two Electric-specific options:

- `shapeOptions` &mdash; the Electric [ShapeStreamOptions](https://electric-sql.com/docs/api/clients/typescript#options) that define the [Shape](https://electric-sql.com/docs/guides/shapes) to sync into the collection; this includes the
  - `url` to your sync engine; and
  - `params` to specify the `table` to sync and any optional `where` clauses, etc.
- `getKey` &mdash; identifies the id for the rows being synced into the collection

A new collections doesn't start syncing until you call `collection.preload()` or you query it.

Electric shapes allow you to filter data using where clauses:

```ts
export const myPendingTodos = createCollection(
  electricCollectionOptions({
    id: "todos",
    shapeOptions: {
      url: "https://example.com/v1/shape",
      params: {
        table: "todos",
        where: `
        status = 'pending'
        AND
        user_id = '${user.id}'
      `,
      },
    },
    getKey: (item) => item.id,
    schema: todoSchema,
  })
)
```

> [!TIP]
> Shape where clauses, used to filter the data you sync into `ElectricCollection`s, are different from the [live queries](#live-queries) you use to query data in components.
>
> Live queries are much more expressive than shapes, allowing you to query across collections, join, aggregate, etc. Shapes just contain filtered database tables and are used to populate the data in a collection.

If you need more control over what data syncs into the collection, Electric allows you to [use your API](https://electric-sql.com/blog/2024/11/21/local-first-with-your-existing-api#filtering) as a proxy to both authorize and filter data.

See the [Electric docs](https://electric-sql.com/docs/intro) for more information.

#### `TrailBaseCollection`

[TrailBase](https://trailbase.io) is an easy-to-self-host, single-executable application backend with built-in SQLite, a V8 JS runtime, auth, admin UIs and sync functionality.

TrailBase lets you expose tables via [Record APIs](https://trailbase.io/documentation/apis_record/) and subscribe to changes when `enable_subscriptions` is set. Use `trailBaseCollectionOptions` to sync records into a collection:

```ts
import { createCollection } from "@tanstack/react-db"
import { trailBaseCollectionOptions } from "@tanstack/trailbase-db-collection"
import { initClient } from "trailbase"

const trailBaseClient = initClient(`https://trailbase.io`)

export const todoCollection = createCollection<SelectTodo, Todo>(
  electricCollectionOptions({
    id: "todos",
    recordApi: trailBaseClient.records(`todos`),
    getKey: (item) => item.id,
    schema: todoSchema,
    parse: {
      created_at: (ts) => new Date(ts * 1000),
    },
    serialize: {
      created_at: (date) => Math.floor(date.valueOf() / 1000),
    },
  })
)
```

This collection requires the following TrailBase-specific options:

- `recordApi` — identifies the API to sync.
- `getKey` — identifies the id for the records being synced into the collection.
- `parse` — maps `(v: Todo[k]) => SelectTodo[k]`.
- `serialize` — maps `(v: SelectTodo[k]) => Todo[k]`.

A new collections doesn't start syncing until you call `collection.preload()` or you query it.


#### `LocalStorageCollection`

localStorage collections store small amounts of local-only state that persists across browser sessions and syncs across browser tabs in real-time. All data is stored under a single localStorage key and automatically synchronized using storage events.

Use `localStorageCollectionOptions` to create a collection that stores data in localStorage:

```ts
import { createCollection } from "@tanstack/react-db"
import { localStorageCollectionOptions } from "@tanstack/react-db"

export const userPreferencesCollection = createCollection(
  localStorageCollectionOptions({
    id: "user-preferences",
    storageKey: "app-user-prefs", // localStorage key
    getKey: (item) => item.id,
    schema: userPrefsSchema,
  })
)
```

The localStorage collection requires:

- `storageKey` — the localStorage key where all collection data is stored
- `getKey` — identifies the id for items in the collection

Mutation handlers (`onInsert`, `onUpdate`, `onDelete`) are completely optional. Data will persist to localStorage whether or not you provide handlers. You can provide alternative storage backends like `sessionStorage` or custom implementations that match the localStorage API.

```ts
export const sessionCollection = createCollection(
  localStorageCollectionOptions({
    id: "session-data",
    storageKey: "session-key",
    storage: sessionStorage, // Use sessionStorage instead
    getKey: (item) => item.id,
  })
)
```

> [!TIP]
> localStorage collections are perfect for user preferences, UI state, and other data that should persist locally but doesn't need server synchronization. For server-synchronized data, use [`QueryCollection`](#querycollection) or [`ElectricCollection`](#electriccollection) instead.

#### `LocalOnlyCollection`

LocalOnly collections are designed for in-memory client data or UI state that doesn't need to persist across browser sessions or sync across tabs. They provide a simple way to manage temporary, session-only data with full optimistic mutation support.

Use `localOnlyCollectionOptions` to create a collection that stores data only in memory:

```ts
import { createCollection } from "@tanstack/react-db"
import { localOnlyCollectionOptions } from "@tanstack/react-db"

export const uiStateCollection = createCollection(
  localOnlyCollectionOptions({
    id: "ui-state",
    getKey: (item) => item.id,
    schema: uiStateSchema,
    // Optional initial data to populate the collection
    initialData: [
      { id: "sidebar", isOpen: false },
      { id: "theme", mode: "light" },
    ],
  })
)
```

The LocalOnly collection requires:

- `getKey` — identifies the id for items in the collection

Optional configuration:

- `initialData` — array of items to populate the collection with on creation
- `onInsert`, `onUpdate`, `onDelete` — optional mutation handlers for custom logic

Mutation handlers are completely optional. When provided, they are called before the optimistic state is confirmed. The collection automatically manages the transition from optimistic to confirmed state internally.

```ts
export const tempDataCollection = createCollection(
  localOnlyCollectionOptions({
    id: "temp-data",
    getKey: (item) => item.id,
    onInsert: async ({ transaction }) => {
      // Custom logic before confirming the insert
      console.log("Inserting:", transaction.mutations[0].modified)
    },
    onUpdate: async ({ transaction }) => {
      // Custom logic before confirming the update
      const { original, modified } = transaction.mutations[0]
      console.log("Updating from", original, "to", modified)
    },
  })
)
```

> [!TIP]
> LocalOnly collections are perfect for temporary UI state, form data, or any client-side data that doesn't need persistence. For data that should persist across sessions, use [`LocalStorageCollection`](#localstoragecollection) instead.

#### Derived collections

Live queries return collections. This allows you to derive collections from other collections.

For example:

```ts
import { createLiveQueryCollection, eq } from "@tanstack/db"

// Imagine you have a collection of todos.
const todoCollection = createCollection({
  // config
})

// You can derive a new collection that's a subset of it.
const completedTodoCollection = createLiveQueryCollection({
  startSync: true,
  query: (q) =>
    q.from({ todo: todoCollection }).where(({ todo }) => todo.completed),
})
```

This also works with joins to derive collections from multiple source collections. And it works recursively -- you can derive collections from other derived collections. Changes propagate efficiently using differential dataflow and it's collections all the way down.

#### Collection

There is a `Collection` interface in [`../packages/db/src/collection.ts`](../packages/db/src/collection.ts). You can use this to implement your own collection types.

See the existing implementations in [`../packages/db`](../packages/db), [`../packages/query-db-collection`](../packages/query-db-collection), [`../packages/electric-db-collection`](../packages/electric-db-collection) and [`../packages/trailbase-db-collection`](../packages/trailbase-db-collection) for reference.

### Live queries

#### `useLiveQuery` hook

Use the `useLiveQuery` hook to assign live query results to a state variable in your React components:

```ts
import { useLiveQuery } from '@tanstack/react-db'
import { eq } from '@tanstack/db'

const Todos = () => {
  const { data: todos } = useLiveQuery((q) =>
    q
      .from({ todo: todoCollection })
      .where(({ todo }) => eq(todo.completed, false))
      .orderBy(({ todo }) => todo.created_at, 'asc')
      .select(({ todo }) => ({
        id: todo.id,
        text: todo.text
      }))
  )

  return <List items={ todos } />
}
```

You can also query across collections with joins:

```ts
import { useLiveQuery } from '@tanstack/react-db'
import { eq } from '@tanstack/db'

const Todos = () => {
  const { data: todos } = useLiveQuery((q) =>
    q
      .from({ todos: todoCollection })
      .join(
        { lists: listCollection },
        ({ todos, lists }) => eq(lists.id, todos.listId),
        'inner'
      )
      .where(({ lists }) => eq(lists.active, true))
      .select(({ todos, lists }) => ({
        id: todos.id,
        title: todos.title,
        listName: lists.name
      }))
  )

  return <List items={ todos } />
}
```

#### `queryBuilder`

You can also build queries directly (outside of the component lifecycle) using the underlying `queryBuilder` API:

```ts
import { createLiveQueryCollection, eq } from "@tanstack/db"

const completedTodos = createLiveQueryCollection({
  startSync: true,
  query: (q) =>
    q
      .from({ todo: todoCollection })
      .where(({ todo }) => eq(todo.completed, true)),
})

const results = completedTodos.toArray
```

Note also that:

1. the query results [are themselves a collection](#derived-collections)
2. the `useLiveQuery` automatically starts and stops live query subscriptions when you mount and unmount your components; if you're creating queries manually, you need to manually manage the subscription lifecycle yourself

See the [Live Queries](live-queries.md) documentation for more details.

### Transactional mutators

Transactional mutators allow you to batch and stage local changes across collections with:

- immediate application of local optimistic updates
- flexible mutationFns to handle writes, with automatic rollbacks and management of optimistic state

#### `mutationFn`

Mutators are created with a `mutationFn`. You can define a single, generic `mutationFn` for your whole app. Or you can define collection or mutation specific functions.

The `mutationFn` is responsible for handling the local changes and processing them, usually to send them to a server or database to be stored, e.g.:

```tsx
import type { MutationFn } from "@tanstack/react-db"

const mutationFn: MutationFn = async ({ transaction }) => {
  const response = await api.todos.create(transaction.mutations)

  if (!response.ok) {
    // Throwing an error will rollback the optimistic state.
    throw new Error(`HTTP Error: ${response.status}`)
  }

  const result = await response.json()

  // Wait for the transaction to be synced back from the server
  // before discarding the optimistic state.
  const collection: Collection = transaction.mutations[0].collection
  await collection.refetch()
}
```

#### `createOptimisticAction`

Use `createOptimisticAction` with your `mutationFn` and `onMutate` functions to create an action that you can use to mutate data in your components in fully custom ways:

```tsx
import { createOptimisticAction } from "@tanstack/react-db"

// Create the `addTodo` action, passing in your `mutationFn` and `onMutate`.
const addTodo = createOptimisticAction<string>({
  onMutate: (text) => {
    // Instantly applies the local optimistic state.
    todoCollection.insert({
      id: uuid(),
      text,
      completed: false,
    })
  },
  mutationFn: async (text) => {
    // Persist the todo to your backend
    const response = await fetch("/api/todos", {
      method: "POST",
      body: JSON.stringify({ text, completed: false }),
    })
    return response.json()
  },
})

const Todo = () => {
  const handleClick = () => {
    // Triggers the onMutate and then the mutationFn
    addTodo("🔥 Make app faster")
  }

  return <Button onClick={handleClick} />
}
```

## Manual Transactions

By manually creating transactions, you can fully control their lifecycles and behaviors. `createOptimisticAction` is a ~25 line
function which implements a common transaction pattern. Feel free to invent your own patterns!

Here's one way you could use transactions.

```ts
import { createTransaction } from "@tanstack/react-db"

const addTodoTx = createTransaction({
  autoCommit: false,
  mutationFn: async ({ transaction }) => {
    // Persist data to backend
    await Promise.all(transaction.mutations.map(mutation => {
      return await api.saveTodo(mutation.modified)
    })
  },
})

// Apply first change
addTodoTx.mutate(() => todoCollection.insert({ id: '1', text: 'First todo', completed: false }))

// user reviews change

// Apply another change
addTodoTx.mutate(() => todoCollection.insert({ id: '2', text: 'Second todo', completed: false }))

// User decides to save and we call .commit() and the mutations are persisted to the backend.
addTodoTx.commit()
```

## Transaction lifecycle

Transactions progress through the following states:

1. `pending`: Initial state when a transaction is created and optimistic mutations can be applied
2. `persisting`: Transaction is being persisted to the backend
3. `completed`: Transaction has been successfully persisted and any backend changes have been synced back.
4. `failed`: An error was thrown while persisting or syncing back the Transaction

#### Write operations

Collections support `insert`, `update` and `delete` operations.

##### `insert`

```typescript
// Insert a single item
myCollection.insert({ text: "Buy groceries", completed: false })

// Insert multiple items
insert([
  { text: "Buy groceries", completed: false },
  { text: "Walk dog", completed: false },
])

// Insert with optimistic updates disabled
myCollection.insert(
  { text: "Server-validated item", completed: false },
  { optimistic: false }
)

// Insert with metadata and optimistic control
myCollection.insert(
  { text: "Custom item", completed: false },
  {
    metadata: { source: "import" },
    optimistic: true, // default behavior
  }
)
```

##### `update`

We use a proxy to capture updates as immutable draft optimistic updates.

```typescript
// Update a single item
update(todo.id, (draft) => {
  draft.completed = true
})

// Update multiple items
update([todo1.id, todo2.id], (drafts) => {
  drafts.forEach((draft) => {
    draft.completed = true
  })
})

// Update with metadata
update(todo.id, { metadata: { reason: "user update" } }, (draft) => {
  draft.text = "Updated text"
})

// Update without optimistic updates
update(todo.id, { optimistic: false }, (draft) => {
  draft.status = "server-validated"
})

// Update with both metadata and optimistic control
update(
  todo.id,
  {
    metadata: { reason: "admin update" },
    optimistic: false,
  },
  (draft) => {
    draft.priority = "high"
  }
)
```

##### `delete`

```typescript
// Delete a single item
delete todo.id

// Delete multiple items
delete [todo1.id, todo2.id]

// Delete with metadata
delete (todo.id, { metadata: { reason: "completed" } })

// Delete without optimistic updates (waits for server confirmation)
delete (todo.id, { optimistic: false })

// Delete with metadata and optimistic control
delete (todo.id,
{
  metadata: { reason: "admin deletion" },
  optimistic: false,
})
```

#### Controlling optimistic behavior

By default, all mutations (`insert`, `update`, `delete`) apply optimistic updates immediately to provide instant feedback in your UI. However, there are cases where you may want to disable this behavior and wait for server confirmation before applying changes locally.

##### When to use `optimistic: false`

Consider disabling optimistic updates when:

- **Complex server-side processing**: Inserts that depend on server-side generation (e.g., cascading foreign keys, computed fields)
- **Validation requirements**: Operations where backend validation might reject the change
- **Confirmation workflows**: Deletes where UX should wait for confirmation before removing data
- **Batch operations**: Large operations where optimistic rollback would be disruptive

##### Behavior differences

**`optimistic: true` (default)**:

- Immediately applies mutation to the local store
- Provides instant UI feedback
- Requires rollback if server rejects the mutation
- Best for simple, predictable operations

**`optimistic: false`**:

- Does not modify local store until server confirms
- No immediate UI feedback, but no rollback needed
- UI updates only after successful server response
- Best for complex or validation-heavy operations

```typescript
// Example: Critical deletion that needs confirmation
const handleDeleteAccount = () => {
  // Don't remove from UI until server confirms
  userCollection.delete(userId, { optimistic: false })
}

// Example: Server-generated data
const handleCreateInvoice = () => {
  // Server generates invoice number, tax calculations, etc.
  invoiceCollection.insert(invoiceData, { optimistic: false })
}

// Example: Mixed approach in same transaction
tx.mutate(() => {
  // Instant UI feedback for simple change
  todoCollection.update(todoId, (draft) => {
    draft.completed = true
  })

  // Wait for server confirmation for complex change
  auditCollection.insert(auditRecord, { optimistic: false })
})
```

## Usage examples

Here we illustrate two common ways of using TanStack DB:

1. [using TanStack Query](#1-tanstack-query) with an existing REST API
2. [using the ElectricSQL sync engine](#2-electricsql-sync) with a generic ingestion endpoint

> [!TIP]
> You can combine these patterns. One of the benefits of TanStack DB is that you can integrate different ways of loading data and handling mutations into the same app. Your components don't need to know where the data came from or goes.

### 1. TanStack Query

You can use TanStack DB with your existing REST API via TanStack Query.

The steps are to:

1. create [`QueryCollection`](#querycollection)s that load data using TanStack Query
2. implement [`mutationFn`](#mutationfn)s that handle mutations by posting them to your API endpoints

```tsx
import { useLiveQuery, createCollection } from "@tanstack/react-db"
import { queryCollectionOptions } from "@tanstack/query-db-collection"

// Load data into collections using TanStack Query.
// It's common to define these in a `collections` module.
const todoCollection = createCollection(queryCollectionOptions({
  queryKey: ["todos"],
  queryFn: async () => fetch("/api/todos"),
  getKey: (item) => item.id,
  schema: todoSchema, // any standard schema
  onInsert: async ({ transaction }) => {
    const { changes: newTodo } = transaction.mutations[0]

    // Handle the local write by sending it to your API.
    await api.todos.create(newTodo)
  }
  // also add onUpdate, onDelete as needed.
}))
const listCollection = createCollection(queryCollectionOptions({
  queryKey: ["todo-lists"],
  queryFn: async () => fetch("/api/todo-lists"),
  getKey: (item) => item.id,
  schema: todoListSchema,
  onInsert: async ({ transaction }) => {
    const { changes: newTodo } = transaction.mutations[0]

    // Handle the local write by sending it to your API.
    await api.todoLists.create(newTodo)
  }
  // also add onUpdate, onDelete as needed.
}))

const Todos = () => {
  // Read the data using live queries. Here we show a live
  // query that joins across two collections.
  const { data: todos } = useLiveQuery((q) =>
    q
      .from({ todo: todoCollection })
      .join(
        { list: listCollection },
        ({ todo, list }) => eq(list.id, todo.list_id),
        'inner'
      )
      .where(({ list }) => eq(list.active, true))
      .select(({ todo, list }) => ({
        id: todo.id,
        text: todo.text,
        status: todo.status,
        listName: list.name
      }))
  )

  // ...

}
```

This pattern allows you to extend an existing TanStack Query application, or any application built on a REST API, with blazing fast, cross-collection live queries and local optimistic mutations with automatically managed optimistic state.

### 2. ElectricSQL sync

One of the most powerful ways of using TanStack DB is with a sync engine, for a fully local-first experience with real-time sync. This allows you to incrementally adopt sync into an existing app, whilst still handling writes with your existing API.

Here, we illustrate this pattern using [ElectricSQL](https://electric-sql.com) as the sync engine.

```tsx
import type { Collection } from '@tanstack/db'
import type { MutationFn, PendingMutation, createCollection } from '@tanstack/react-db'
import { electricCollectionOptions } from '@tanstack/electric-db-collection'

export const todoCollection = createCollection(electricCollectionOptions({
  id: 'todos',
  schema: todoSchema,
  // Electric syncs data using "shapes". These are filtered views
  // on database tables that Electric keeps in sync for you.
  shapeOptions: {
    url: 'https://api.electric-sql.cloud/v1/shape',
    params: {
      table: 'todos'
    }
  },
  getKey: (item) => item.id,
  schema: todoSchema,
  onInsert: async ({ transaction }) => {
    const response = await api.todos.create(transaction.mutations[0].modified)

    return { txid: response.txid}
  }
  // You can also implement onUpdate, onDelete as needed.
}))

const AddTodo = () => {
  return (
    <Button
      onClick={() =>
        todoCollection.insert({ text: "🔥 Make app faster" })
      }
    />
  )
}
```

## React Native

When using TanStack DB with React Native, you need to install and configure a UUID generation library since React Native doesn't include crypto.randomUUID() by default.

Install the `react-native-random-uuid` package:

```bash
npm install react-native-random-uuid
```

Then import it at the entry point of your React Native app (e.g., in your `App.js` or `index.js`):

```javascript
import 'react-native-random-uuid'
```

This polyfill provides the `crypto.randomUUID()` function that TanStack DB uses internally for generating unique identifiers.

## More info

If you have questions / need help using TanStack DB, let us know on the Discord or start a GitHub discussion:

- [`#db` channel in the TanStack discord](https://discord.gg/yjUNbvbraC)
- [GitHub discussions](https://github.com/tanstack/db/discussions)
---
title: Query Collection
---

# Query Collection

Query collections provide seamless integration between TanStack DB and TanStack Query, enabling automatic synchronization between your local database and remote data sources.

## Overview

The `@tanstack/query-db-collection` package allows you to create collections that:
- Automatically sync with remote data via TanStack Query
- Support optimistic updates with automatic rollback on errors
- Handle persistence through customizable mutation handlers
- Provide direct write capabilities as an escape hatch for advanced scenarios

## Installation

```bash
npm install @tanstack/query-db-collection @tanstack/query-core @tanstack/db
```

## Basic Usage

```typescript
import { QueryClient } from '@tanstack/query-core'
import { createCollection } from '@tanstack/db'
import { queryCollectionOptions } from '@tanstack/query-db-collection'

const queryClient = new QueryClient()

const todosCollection = createCollection(
  queryCollectionOptions({
    queryKey: ['todos'],
    queryFn: async () => {
      const response = await fetch('/api/todos')
      return response.json()
    },
    queryClient,
    getKey: (item) => item.id,
  })
)
```

## Configuration Options

The `queryCollectionOptions` function accepts the following options:

### Required Options

- `queryKey`: The query key for TanStack Query
- `queryFn`: Function that fetches data from the server
- `queryClient`: TanStack Query client instance
- `getKey`: Function to extract the unique key from an item

### Query Options

- `enabled`: Whether the query should automatically run (default: `true`)
- `refetchInterval`: Refetch interval in milliseconds
- `retry`: Retry configuration for failed queries
- `retryDelay`: Delay between retries
- `staleTime`: How long data is considered fresh
- `meta`: Optional metadata that will be passed to the query function context

### Collection Options

- `id`: Unique identifier for the collection
- `schema`: Schema for validating items
- `sync`: Custom sync configuration
- `startSync`: Whether to start syncing immediately (default: `true`)

### Persistence Handlers

- `onInsert`: Handler called before insert operations
- `onUpdate`: Handler called before update operations
- `onDelete`: Handler called before delete operations

## Persistence Handlers

You can define handlers that are called when mutations occur. These handlers can persist changes to your backend and control whether the query should refetch after the operation:

```typescript
const todosCollection = createCollection(
  queryCollectionOptions({
    queryKey: ['todos'],
    queryFn: fetchTodos,
    queryClient,
    getKey: (item) => item.id,
    
    onInsert: async ({ transaction }) => {
      const newItems = transaction.mutations.map(m => m.modified)
      await api.createTodos(newItems)
      // Returning nothing or { refetch: true } will trigger a refetch
      // Return { refetch: false } to skip automatic refetch
    },
    
    onUpdate: async ({ transaction }) => {
      const updates = transaction.mutations.map(m => ({
        id: m.key,
        changes: m.changes
      }))
      await api.updateTodos(updates)
    },
    
    onDelete: async ({ transaction }) => {
      const ids = transaction.mutations.map(m => m.key)
      await api.deleteTodos(ids)
    }
  })
)
```

### Controlling Refetch Behavior

By default, after any persistence handler (`onInsert`, `onUpdate`, or `onDelete`) completes successfully, the query will automatically refetch to ensure the local state matches the server state.

You can control this behavior by returning an object with a `refetch` property:

```typescript
onInsert: async ({ transaction }) => {
  await api.createTodos(transaction.mutations.map(m => m.modified))
  
  // Skip the automatic refetch
  return { refetch: false }
}
```

This is useful when:
- You're confident the server state matches what you sent
- You want to avoid unnecessary network requests
- You're handling state updates through other mechanisms (like WebSockets)

## Utility Methods

The collection provides these utility methods via `collection.utils`:

- `refetch()`: Manually trigger a refetch of the query

## Direct Writes (Advanced)

Direct writes are an escape hatch for scenarios where the normal query/mutation flow doesn't fit your needs. They allow you to write directly to the synced data store, bypassing the optimistic update system and query refetch mechanism.

### Understanding the Data Stores

Query Collections maintain two data stores:
1. **Synced Data Store** - The authoritative state synchronized with the server via `queryFn`
2. **Optimistic Mutations Store** - Temporary changes that are applied optimistically before server confirmation

Normal collection operations (insert, update, delete) create optimistic mutations that are:
- Applied immediately to the UI
- Sent to the server via persistence handlers
- Rolled back automatically if the server request fails
- Replaced with server data when the query refetches

Direct writes bypass this system entirely and write directly to the synced data store, making them ideal for handling real-time updates from alternative sources.

### When to Use Direct Writes

Direct writes should be used when:
- You need to sync real-time updates from WebSockets or server-sent events
- You're dealing with large datasets where refetching everything is too expensive
- You receive incremental updates or server-computed field updates
- You need to implement complex pagination or partial data loading scenarios

### Individual Write Operations

```typescript
// Insert a new item directly to the synced data store
todosCollection.utils.writeInsert({ id: '1', text: 'Buy milk', completed: false })

// Update an existing item in the synced data store
todosCollection.utils.writeUpdate({ id: '1', completed: true })

// Delete an item from the synced data store
todosCollection.utils.writeDelete('1')

// Upsert (insert or update) in the synced data store
todosCollection.utils.writeUpsert({ id: '1', text: 'Buy milk', completed: false })
```

These operations:
- Write directly to the synced data store
- Do NOT create optimistic mutations
- Do NOT trigger automatic query refetches
- Update the TanStack Query cache immediately
- Are immediately visible in the UI

### Batch Operations

The `writeBatch` method allows you to perform multiple operations atomically. Any write operations called within the callback will be collected and executed as a single transaction:

```typescript
todosCollection.utils.writeBatch(() => {
  todosCollection.utils.writeInsert({ id: '1', text: 'Buy milk' })
  todosCollection.utils.writeInsert({ id: '2', text: 'Walk dog' })
  todosCollection.utils.writeUpdate({ id: '3', completed: true })
  todosCollection.utils.writeDelete('4')
})
```

### Real-World Example: WebSocket Integration

```typescript
// Handle real-time updates from WebSocket without triggering full refetches
ws.on('todos:update', (changes) => {
  todosCollection.utils.writeBatch(() => {
    changes.forEach(change => {
      switch (change.type) {
        case 'insert':
          todosCollection.utils.writeInsert(change.data)
          break
        case 'update':
          todosCollection.utils.writeUpdate(change.data)
          break
        case 'delete':
          todosCollection.utils.writeDelete(change.id)
          break
      }
    })
  })
})
```

### Example: Incremental Updates

```typescript
// Handle server responses after mutations without full refetch
const createTodo = async (todo) => {
  // Optimistically add the todo
  const tempId = crypto.randomUUID()
  todosCollection.insert({ ...todo, id: tempId })
  
  try {
    // Send to server
    const serverTodo = await api.createTodo(todo)
    
    // Sync the server response (with server-generated ID and timestamps)
    // without triggering a full collection refetch
    todosCollection.utils.writeBatch(() => {
      todosCollection.utils.writeDelete(tempId)
      todosCollection.utils.writeInsert(serverTodo)
    })
  } catch (error) {
    // Rollback happens automatically
    throw error
  }
}
```

### Example: Large Dataset Pagination

```typescript
// Load additional pages without refetching existing data
const loadMoreTodos = async (page) => {
  const newTodos = await api.getTodos({ page, limit: 50 })
  
  // Add new items without affecting existing ones
  todosCollection.utils.writeBatch(() => {
    newTodos.forEach(todo => {
      todosCollection.utils.writeInsert(todo)
    })
  })
}
```

## Important Behaviors

### Full State Sync

The query collection treats the `queryFn` result as the **complete state** of the collection. This means:

- Items present in the collection but not in the query result will be deleted
- Items in the query result but not in the collection will be inserted
- Items present in both will be updated if they differ

### Empty Array Behavior

When `queryFn` returns an empty array, **all items in the collection will be deleted**. This is because the collection interprets an empty array as "the server has no items".

```typescript
// This will delete all items in the collection
queryFn: async () => []
```

### Handling Partial/Incremental Fetches

Since the query collection expects `queryFn` to return the complete state, you can handle partial fetches by merging new data with existing data:

```typescript
const todosCollection = createCollection(
  queryCollectionOptions({
    queryKey: ['todos'],
    queryFn: async ({ queryKey }) => {
      // Get existing data from cache
      const existingData = queryClient.getQueryData(queryKey) || []
      
      // Fetch only new/updated items (e.g., changes since last sync)
      const lastSyncTime = localStorage.getItem('todos-last-sync')
      const newData = await fetch(`/api/todos?since=${lastSyncTime}`).then(r => r.json())
      
      // Merge new data with existing data
      const existingMap = new Map(existingData.map(item => [item.id, item]))
      
      // Apply updates and additions
      newData.forEach(item => {
        existingMap.set(item.id, item)
      })
      
      // Handle deletions if your API provides them
      if (newData.deletions) {
        newData.deletions.forEach(id => existingMap.delete(id))
      }
      
      // Update sync time
      localStorage.setItem('todos-last-sync', new Date().toISOString())
      
      // Return the complete merged state
      return Array.from(existingMap.values())
    },
    queryClient,
    getKey: (item) => item.id,
  })
)
```

This pattern allows you to:
- Fetch only incremental changes from your API
- Merge those changes with existing data
- Return the complete state that the collection expects
- Avoid the performance overhead of fetching all data every time

### Direct Writes and Query Sync

Direct writes update the collection immediately and also update the TanStack Query cache. However, they do not prevent the normal query sync behavior. If your `queryFn` returns data that conflicts with your direct writes, the query data will take precedence.

To handle this properly:
1. Use `{ refetch: false }` in your persistence handlers when using direct writes
2. Set appropriate `staleTime` to prevent unnecessary refetches
3. Design your `queryFn` to be aware of incremental updates (e.g., only fetch new data)

## Complete Direct Write API Reference

All direct write methods are available on `collection.utils`:

- `writeInsert(data)`: Insert one or more items directly
- `writeUpdate(data)`: Update one or more items directly
- `writeDelete(keys)`: Delete one or more items directly
- `writeUpsert(data)`: Insert or update one or more items directly
- `writeBatch(callback)`: Perform multiple operations atomically
- `refetch()`: Manually trigger a refetch of the query
---
title: Quick Start
id: quick-start
---

TanStack DB is a reactive client store for building super fast apps. This example will show you how to:

- **Load data** into collections using TanStack Query
- **Query data** with blazing fast live queries
- **Mutate data** with instant optimistic updates

```tsx
import { createCollection, eq, useLiveQuery } from '@tanstack/react-db'
import { queryCollectionOptions } from '@tanstack/query-db-collection'

// Define a collection that loads data using TanStack Query
const todoCollection = createCollection(
  queryCollectionOptions({
    queryKey: ['todos'],
    queryFn: async () => {
      const response = await fetch('/api/todos')
      return response.json()
    },
    getKey: (item) => item.id,
    onUpdate: async ({ transaction }) => {
      const { original, modified } = transaction.mutations[0]
      await fetch(`/api/todos/${original.id}`, {
        method: 'PUT',
        body: JSON.stringify(modified),
      })
    },
  })
)

function Todos() {
  // Live query that updates automatically when data changes
  const { data: todos } = useLiveQuery((q) =>
    q.from({ todo: todoCollection })
     .where(({ todo }) => eq(todo.completed, false))
     .orderBy(({ todo }) => todo.createdAt, 'desc')
  )

  const toggleTodo = (todo) => {
    // Instantly applies optimistic state, then syncs to server
    todoCollection.update(todo.id, (draft) => {
      draft.completed = !draft.completed
    })
  }

  return (
    <ul>
      {todos.map((todo) => (
        <li key={todo.id} onClick={() => toggleTodo(todo)}>
          {todo.text}
        </li>
      ))}
    </ul>
  )
}
```

You now have collections, live queries, and optimistic mutations! Let's break this down further.

## Installation

```bash
npm install @tanstack/react-db @tanstack/query-db-collection
```

## 1. Create a Collection

Collections store your data and handle persistence. The `queryCollectionOptions` loads data using TanStack Query and defines mutation handlers for server sync:

```tsx
const todoCollection = createCollection(
  queryCollectionOptions({
    queryKey: ['todos'],
    queryFn: async () => {
      const response = await fetch('/api/todos')
      return response.json()
    },
    getKey: (item) => item.id,
    // Handle all CRUD operations
    onInsert: async ({ transaction }) => {
      const { modified: newTodo } = transaction.mutations[0]
      await fetch('/api/todos', {
        method: 'POST',
        body: JSON.stringify(newTodo),
      })
    },
    onUpdate: async ({ transaction }) => {
      const { original, modified } = transaction.mutations[0]
      await fetch(`/api/todos/${original.id}`, {
        method: 'PUT', 
        body: JSON.stringify(modified),
      })
    },
    onDelete: async ({ transaction }) => {
      const { original } = transaction.mutations[0]
      await fetch(`/api/todos/${original.id}`, { method: 'DELETE' })
    },
  })
)
```

## 2. Query with Live Queries

Live queries reactively update when data changes. They support filtering, sorting, joins, and transformations:

```tsx
function TodoList() {
  // Basic filtering and sorting
  const { data: incompleteTodos } = useLiveQuery((q) =>
    q.from({ todo: todoCollection })
     .where(({ todo }) => eq(todo.completed, false))
     .orderBy(({ todo }) => todo.createdAt, 'desc')
  )

  // Transform the data
  const { data: todoSummary } = useLiveQuery((q) =>
    q.from({ todo: todoCollection })
     .select(({ todo }) => ({
       id: todo.id,
       summary: `${todo.text} (${todo.completed ? 'done' : 'pending'})`,
       priority: todo.priority || 'normal'
     }))
  )

  return <div>{/* Render todos */}</div>
}
```

## 3. Optimistic Mutations

Mutations apply instantly and sync to your server. If the server request fails, changes automatically roll back:

```tsx
function TodoActions({ todo }) {
  const addTodo = () => {
    todoCollection.insert({
      id: crypto.randomUUID(),
      text: 'New todo',
      completed: false,
      createdAt: new Date(),
    })
  }

  const toggleComplete = () => {
    todoCollection.update(todo.id, (draft) => {
      draft.completed = !draft.completed
    })
  }

  const updateText = (newText) => {
    todoCollection.update(todo.id, (draft) => {
      draft.text = newText
    })
  }

  const deleteTodo = () => {
    todoCollection.delete(todo.id)
  }

  return (
    <div>
      <button onClick={addTodo}>Add Todo</button>
      <button onClick={toggleComplete}>Toggle</button>
      <button onClick={() => updateText('Updated!')}>Edit</button>
      <button onClick={deleteTodo}>Delete</button>
    </div>
  )
}
```

## Next Steps

You now understand the basics of TanStack DB! The collection loads and persists data, live queries provide reactive views, and mutations give instant feedback with automatic server sync.

Explore the docs to learn more about:

- **[Installation](./installation.md)** - All framework and collection packages
- **[Overview](./overview.md)** - Complete feature overview and examples  
- **[Live Queries](./live-queries.md)** - Advanced querying, joins, and aggregations
---
title: Error Handling
id: error-handling
---

# Error Handling

TanStack DB provides comprehensive error handling capabilities to ensure robust data synchronization and state management. This guide covers the built-in error handling mechanisms and how to work with them effectively.

## Error Types

TanStack DB provides named error classes for better error handling and type safety. All error classes can be imported from `@tanstack/db` (or more commonly, the framework-specific package e.g. `@tanstack/react-db`):

```ts
import {
  SchemaValidationError,
  CollectionInErrorStateError,
  DuplicateKeyError,
  MissingHandlerError,
  TransactionError,
  // ... and many more
} from "@tanstack/db"
```

### SchemaValidationError

Thrown when data doesn't match the collection's schema during insert or update operations:

```ts
import { SchemaValidationError } from "@tanstack/db"

try {
  todoCollection.insert({ text: 123 }) // Invalid type
} catch (error) {
  if (error instanceof SchemaValidationError) {
    console.log(error.type) // 'insert' or 'update'
    console.log(error.issues) // Array of validation issues
    // Example issue: { message: "Expected string, received number", path: ["text"] }
  }
}
```

The error includes:
- `type`: Whether it was an 'insert' or 'update' operation
- `issues`: Array of validation issues with messages and paths
- `message`: A formatted error message listing all issues

## Collection Status and Error States

Collections track their status and transition between states:

```tsx
import { useLiveQuery } from "@tanstack/react-db"

const TodoList = () => {
  const { data, status, isError, isLoading, isReady } = useLiveQuery(
    (query) => query.from({ todos: todoCollection })
  )

  if (isError) {
    return <div>Collection is in error state</div>
  }

  if (isLoading) {
    return <div>Loading...</div>
  }

  return <div>{data?.map(todo => <div key={todo.id}>{todo.text}</div>)}</div>
}
```

Collection status values:
- `idle` - Not yet started
- `loading` - Loading initial data
- `initialCommit` - Processing initial data
- `ready` - Ready for use
- `error` - In error state
- `cleaned-up` - Cleaned up and no longer usable

## Transaction Error Handling

When mutations fail, TanStack DB automatically rolls back optimistic updates:

```ts
const todoCollection = createCollection({
  id: "todos",
  onInsert: async ({ transaction }) => {
    const response = await fetch("/api/todos", {
      method: "POST",
      body: JSON.stringify(transaction.mutations[0].modified),
    })
    
    if (!response.ok) {
      // Throwing an error will rollback the optimistic state
      throw new Error(`HTTP Error: ${response.status}`)
    }
    
    return response.json()
  },
})

// Usage - optimistic update will be rolled back if the mutation fails
try {
  const tx = await todoCollection.insert({
    id: "1",
    text: "New todo",
    completed: false,
  })
  
  await tx.isPersisted.promise
} catch (error) {
  // The optimistic update has been automatically rolled back
  console.error("Failed to create todo:", error)
}
```

### Transaction States and Error Information

Transactions have the following states:
- `pending` - Transaction is being processed
- `persisting` - Currently executing the mutation function
- `completed` - Transaction completed successfully
- `failed` - Transaction failed and was rolled back

Access transaction error information from collection operations:

```ts
const todoCollection = createCollection({
  id: "todos",
  onUpdate: async ({ transaction }) => {
    const response = await fetch(`/api/todos/${transaction.mutations[0].key}`, {
      method: "PUT",
      body: JSON.stringify(transaction.mutations[0].modified),
    })
    
    if (!response.ok) {
      throw new Error(`Update failed: ${response.status}`)
    }
  },
})

try {
  const tx = await todoCollection.update("todo-1", (draft) => {
    draft.completed = true
  })
  
  await tx.isPersisted.promise
} catch (error) {
  // Transaction has been rolled back
  console.log(tx.state) // "failed"
  console.log(tx.error) // { message: "Update failed: 500", error: Error }
}
```

Or with manual transaction creation:

```ts
const tx = createTransaction({
  mutationFn: async ({ transaction }) => {
    throw new Error("API failed")
  }
})

tx.mutate(() => {
  collection.insert({ id: "1", text: "Item" })
})

try {
  await tx.commit()
} catch (error) {
  // Transaction has been rolled back
  console.log(tx.state) // "failed"
  console.log(tx.error) // { message: "API failed", error: Error }
}
```

## Collection Operation Errors

### Invalid Collection State

Collections in an `error` state cannot perform operations and must be manually recovered:

```ts
import { CollectionInErrorStateError } from "@tanstack/db"

try {
  todoCollection.insert(newTodo)
} catch (error) {
  if (error instanceof CollectionInErrorStateError) {
    // Collection needs to be cleaned up and restarted
    await todoCollection.cleanup()
    
    // Now retry the operation
    todoCollection.insert(newTodo)
  }
}
```

### Missing Mutation Handlers

Direct mutations require handlers to be configured:

```ts
const todoCollection = createCollection({
  id: "todos",
  getKey: (todo) => todo.id,
  // Missing onInsert handler
})

// This will throw an error
todoCollection.insert(newTodo)
// Error: Collection.insert called directly (not within an explicit transaction) but no 'onInsert' handler is configured
```

### Duplicate Key Errors

Inserting items with existing keys will throw:

```ts
import { DuplicateKeyError } from "@tanstack/db"

try {
  todoCollection.insert({ id: "existing-id", text: "Todo" })
} catch (error) {
  if (error instanceof DuplicateKeyError) {
    console.log(`Duplicate key: ${error.message}`)
  }
}
```

### Schema Validation Errors

Schema validation must be synchronous:

```ts
const todoCollection = createCollection({
  id: "todos",
  getKey: (todo) => todo.id,
  schema: {
    "~standard": {
      validate: async (data) => { // Async validation not allowed
        // ...
      }
    }
  }
})

// Will throw: Schema validation must be synchronous
```

## Sync Error Handling

### Query Collection Sync Errors

Query collections handle sync errors gracefully and mark the collection as ready even on error to avoid blocking applications:

```ts
import { queryCollectionOptions } from "@tanstack/query-db-collection"

const todoCollection = createCollection(
  queryCollectionOptions({
    queryKey: ["todos"],
    queryFn: async () => {
      const response = await fetch("/api/todos")
      if (!response.ok) {
        throw new Error(`Failed to fetch: ${response.status}`)
      }
      return response.json()
    },
    queryClient,
    getKey: (item) => item.id,
    schema: todoSchema,
    // Standard TanStack Query error handling options
    retry: 3,
    retryDelay: (attemptIndex) => Math.min(1000 * 2 ** attemptIndex, 30000),
  })
)
```

When sync errors occur:
- Error is logged to console: `[QueryCollection] Error observing query...`
- Collection is marked as ready to prevent blocking the application
- Cached data remains available

### Sync Write Errors

Sync functions must handle their own errors during write operations:

```ts
const collection = createCollection({
  id: "todos",
  sync: {
    sync: ({ begin, write, commit }) => {
      begin()
      
      try {
        // Will throw if key already exists
        write({ type: "insert", value: { id: "existing-id", text: "Todo" } })
      } catch (error) {
        // Error: Cannot insert document with key "existing-id" from sync because it already exists
      }
      
      commit()
    }
  }
})
```

### Cleanup Error Handling

Cleanup errors are isolated to prevent blocking the cleanup process:

```ts
const collection = createCollection({
  id: "todos",
  sync: {
    sync: ({ begin, commit }) => {
      begin()
      commit()
      
      // Return a cleanup function
      return () => {
        // If this throws, the error is re-thrown in a microtask
        // but cleanup continues successfully
        throw new Error("Sync cleanup failed")
      }
    },
  },
})

// Cleanup completes even if the sync cleanup function throws
await collection.cleanup() // Resolves successfully
// Error is re-thrown asynchronously via queueMicrotask
```

## Error Recovery Patterns

### Collection Cleanup and Restart

Clean up collections in error states:

```ts
if (todoCollection.status === "error") {
  // Cleanup will stop sync and reset the collection
  await todoCollection.cleanup()
  
  // Collection will automatically restart on next access
  todoCollection.preload() // Or any other operation
}
```

### Graceful Degradation

Collections continue to work with cached data even when sync fails:

```tsx
const TodoApp = () => {
  const { data, isError } = useLiveQuery((query) => 
    query.from({ todos: todoCollection })
  )

  return (
    <div>
      {isError && (
        <div>Sync failed, but you can still view cached data</div>
      )}
      {data?.map(todo => <TodoItem key={todo.id} todo={todo} />)}
    </div>
  )
}
```

### Transaction Rollback Cascading

When a transaction fails, conflicting transactions are automatically rolled back:

```ts
const tx1 = createTransaction({ mutationFn: async () => {} })
const tx2 = createTransaction({ mutationFn: async () => {} })

tx1.mutate(() => collection.update("1", draft => { draft.value = "A" }))
tx2.mutate(() => collection.update("1", draft => { draft.value = "B" })) // Same item

// Rolling back tx1 will also rollback tx2 due to conflict
tx1.rollback() // tx2 is automatically rolled back
```

### Handling Invalid State Errors

Transactions validate their state before operations:

```ts
const tx = createTransaction({ mutationFn: async () => {} })

// Complete the transaction
await tx.commit()

// These will throw:
tx.mutate(() => {}) // Error: You can no longer call .mutate() as the transaction is no longer pending
tx.commit() // Error: You can no longer call .commit() as the transaction is no longer pending
tx.rollback() // Error: You can no longer call .rollback() as the transaction is already completed
```

## Best Practices

1. **Use instanceof checks** - Use `instanceof` instead of string matching for error handling:
   ```ts
   // ✅ Good - type-safe error handling
   if (error instanceof SchemaValidationError) {
     // Handle validation error
   }
   
   // ❌ Avoid - brittle string matching  
   if (error.message.includes("validation failed")) {
     // Handle validation error
   }
   ```

2. **Import specific error types** - Import only the error classes you need for better tree-shaking
3. **Always handle SchemaValidationError** - Provide clear feedback for validation failures
4. **Check collection status** - Use `isError`, `isLoading`, `isReady` flags in React components
5. **Handle transaction promises** - Always handle `isPersisted.promise` rejections

## Example: Complete Error Handling

```tsx
import { 
  createCollection, 
  SchemaValidationError,
  DuplicateKeyError,
  createTransaction
} from "@tanstack/db"
import { useLiveQuery } from "@tanstack/react-db"

const todoCollection = createCollection({
  id: "todos",
  schema: todoSchema,
  getKey: (todo) => todo.id,
  onInsert: async ({ transaction }) => {
    const response = await fetch("/api/todos", {
      method: "POST",
      body: JSON.stringify(transaction.mutations[0].modified),
    })

    if (!response.ok) {
      throw new Error(`HTTP ${response.status}: ${response.statusText}`)
    }

    return response.json()
  },
  sync: {
    sync: ({ begin, write, commit }) => {
      // Your sync implementation
      begin()
      // ... sync logic
      commit()
    }
  }
})

const TodoApp = () => {
  const { data, status, isError, isLoading } = useLiveQuery(
    (query) => query.from({ todos: todoCollection })
  )

  const handleAddTodo = async (text: string) => {
    try {
      const tx = await todoCollection.insert({
        id: crypto.randomUUID(),
        text,
        completed: false,
      })
      
      // Wait for persistence
      await tx.isPersisted.promise
    } catch (error) {
      if (error instanceof SchemaValidationError) {
        alert(`Validation error: ${error.issues[0]?.message}`)
      } else if (error instanceof DuplicateKeyError) {
        alert("A todo with this ID already exists")
      } else {
        alert(`Failed to add todo: ${error.message}`)
      }
    }
  }

  const handleCleanup = async () => {
    try {
      await todoCollection.cleanup()
      // Collection will restart on next access
    } catch (error) {
      console.error("Cleanup failed:", error)
    }
  }

  if (isError) {
    return (
      <div>
        <div>Collection error - data may be stale</div>
        <button onClick={handleCleanup}>
          Restart Collection
        </button>
      </div>
    )
  }

  if (isLoading) {
    return <div>Loading todos...</div>
  }

  return (
    <div>
      <button onClick={() => handleAddTodo("New todo")}>
        Add Todo
      </button>
      {data?.map(todo => (
        <div key={todo.id}>{todo.text}</div>
      ))}
    </div>
  )
}
```

## See Also

- [Mutations Guide](./overview.md#mutations) - Learn about optimistic updates and rollbacks
- [API Reference](./overview.md#api-reference) - Detailed API documentation
- [TanStack Query Error Handling](https://tanstack.com/query/latest/docs/react/guides/error-handling) - Query-specific error handling
---
title: Live Queries
id: live-queries
---

# TanStack DB Live Queries

TanStack DB provides a powerful, type-safe query system that allows you to fetch, filter, transform, and aggregate data from collections using a SQL-like fluent API. All queries are **live** by default, meaning they automatically update when the underlying data changes.

The query system is built around an API similar to SQL query builders like Kysely or Drizzle where you chain methods together to compose your query. The query builder doesn't perform operations in the order of method calls - instead, it composes your query into an optimal incremental pipeline that gets compiled and executed efficiently. Each method returns a new query builder, allowing you to chain operations together.

Live queries resolve to collections that automatically update when their underlying data changes. You can subscribe to changes, iterate over results, and use all the standard collection methods.

```ts
import { createCollection, liveQueryCollectionOptions, eq } from '@tanstack/db'

const activeUsers = createCollection(liveQueryCollectionOptions({
  query: (q) =>
    q
      .from({ user: usersCollection })
      .where(({ user }) => eq(user.active, true))
      .select(({ user }) => ({
        id: user.id,
        name: user.name,
        email: user.email,
      }))
}))
```

The result types are automatically inferred from your query structure, providing full TypeScript support. When you use a `select` clause, the result type matches your projection. Without `select`, you get the full schema with proper join optionality.

## Table of Contents

- [Creating Live Query Collections](#creating-live-query-collections)
- [From Clause](#from-clause)
- [Where Clauses](#where-clauses)
- [Select Projections](#select)
- [Joins](#joins)
- [Subqueries](#subqueries)
- [groupBy and Aggregations](#groupby-and-aggregations)
- [Order By, Limit, and Offset](#order-by-limit-and-offset)
- [Composable Queries](#composable-queries)
- [Expression Functions Reference](#expression-functions-reference)
- [Functional Variants](#functional-variants)

## Creating Live Query Collections

To create a live query collection, you can use `liveQueryCollectionOptions` with `createCollection`, or use the convenience function `createLiveQueryCollection`.

### Using liveQueryCollectionOptions

The fundamental way to create a live query is using `liveQueryCollectionOptions` with `createCollection`:

```ts
import { createCollection, liveQueryCollectionOptions, eq } from '@tanstack/db'

const activeUsers = createCollection(liveQueryCollectionOptions({
  query: (q) =>
    q
      .from({ user: usersCollection })
      .where(({ user }) => eq(user.active, true))
      .select(({ user }) => ({
        id: user.id,
        name: user.name,
      }))
}))
```

### Configuration Options

For more control, you can specify additional options:

```ts
const activeUsers = createCollection(liveQueryCollectionOptions({
  id: 'active-users', // Optional: auto-generated if not provided
  query: (q) =>
    q
      .from({ user: usersCollection })
      .where(({ user }) => eq(user.active, true))
      .select(({ user }) => ({
        id: user.id,
        name: user.name,
      })),
  getKey: (user) => user.id, // Optional: uses stream key if not provided
  startSync: true, // Optional: starts sync immediately
}))
```
| Option | Type | Description |
|--------|------|-------------|
| `id` | `string` (optional) | An optional unique identifier for the live query. If not provided, it will be auto-generated. This is useful for debugging and logging. |
| `query` | `QueryBuilder` or function | The query definition, this is either a `Query` instance or a function that returns a `Query` instance. |
| `getKey` | `(item) => string \| number` (optional) | A function that extracts a unique key from each row. If not provided, the stream's internal key will be used. For simple cases this is the key from the parent collection, but in the case of joins, the auto-generated key will be a composite of the parent keys. Using `getKey` is useful when you want to use a specific key from a parent collection for the resulting collection. |
| `schema` | `Schema` (optional) | Optional schema for validation |
| `startSync` | `boolean` (optional) | Whether to start syncing immediately. Defaults to `true`. |
| `gcTime` | `number` (optional) | Garbage collection time in milliseconds. Defaults to `5000` (5 seconds). |

### Convenience Function

For simpler cases, you can use `createLiveQueryCollection` as a shortcut:

```ts
import { createLiveQueryCollection, eq } from '@tanstack/db'

const activeUsers = createLiveQueryCollection((q) =>
  q
    .from({ user: usersCollection })
    .where(({ user }) => eq(user.active, true))
    .select(({ user }) => ({
      id: user.id,
      name: user.name,
    }))
)
```

### Using with Frameworks

In React, you can use the `useLiveQuery` hook:

```tsx
import { useLiveQuery } from '@tanstack/react-db'

function UserList() {
  const activeUsers = useLiveQuery((q) =>
    q
      .from({ user: usersCollection })
      .where(({ user }) => eq(user.active, true))
  )

  return (
    <ul>
      {activeUsers.map(user => (
        <li key={user.id}>{user.name}</li>
      ))}
    </ul>
  )
}
```

For more details on framework integration, see the [React](/docs/framework/react/adapter) and [Vue](/docs/framework/vue/adapter) adapter documentation.

## From Clause

The foundation of every query is the `from` method, which specifies the source collection or subquery. You can alias the source using object syntax.

### Method Signature

```ts
from({
  [alias]: Collection | Query,
}): Query
```

**Parameters:**
- `[alias]` - A Collection or Query instance. Note that only a single aliased collection or subquery is allowed in the `from` clause.

### Basic Usage

Start with a basic query that selects all records from a collection:

```ts
const allUsers = createCollection(liveQueryCollectionOptions({
  query: (q) => q.from({ user: usersCollection })
}))
```

The result contains all users with their full schema. You can iterate over the results or access them by key:

```ts
// Get all users as an array
const users = allUsers.toArray

// Get a specific user by ID
const user = allUsers.get(1)

// Check if a user exists
const hasUser = allUsers.has(1)
```

Use aliases to make your queries more readable, especially when working with multiple collections:

```ts
const users = createCollection(liveQueryCollectionOptions({
  query: (q) => q.from({ u: usersCollection })
}))

// Access fields using the alias
const userNames = createCollection(liveQueryCollectionOptions({
  query: (q) =>
    q
      .from({ u: usersCollection })
      .select(({ u }) => ({
        name: u.name,
        email: u.email,
      }))
}))
```

## Where Clauses

Use `where` clauses to filter your data based on conditions. You can chain multiple `where` calls - they are combined with `and` logic.

The `where` method takes a callback function that receives an object containing your table aliases and returns a boolean expression. You build these expressions using comparison functions like `eq()`, `gt()`, and logical operators like `and()` and `or()`. This declarative approach allows the query system to optimize your filters efficiently. These are described in more detail in the [Expression Functions Reference](#expression-functions-reference) section. This is very similar to how you construct queries using Kysely or Drizzle.

It's important to note that the `where` method is not a function that is executed on each row or the results, its a way to describe the query that will be executed. This declarative approach works well for almost all use cases, but if you need to use a more complex condition, there is the functional variant as `fn.where` which is described in the [Functional Variants](#functional-variants) section.

### Method Signature

```ts
where(
  condition: (row: TRow) => Expression<boolean>
): Query
```

**Parameters:**
- `condition` - A callback function that receives the row object with table aliases and returns a boolean expression

### Basic Filtering

Filter users by a simple condition:

```ts
import { eq } from '@tanstack/db'

const activeUsers = createCollection(liveQueryCollectionOptions({
  query: (q) =>
    q
      .from({ user: usersCollection })
      .where(({ user }) => eq(user.active, true))
}))
```

### Multiple Conditions

Chain multiple `where` calls for AND logic:

```ts
import { eq, gt } from '@tanstack/db'

const adultActiveUsers = createCollection(liveQueryCollectionOptions({
  query: (q) =>
    q
      .from({ user: usersCollection })
      .where(({ user }) => eq(user.active, true))
      .where(({ user }) => gt(user.age, 18))
}))
```

### Complex Conditions

Use logical operators to build complex conditions:

```ts
import { eq, gt, or, and } from '@tanstack/db'

const specialUsers = createLiveQueryCollection((q) =>
  q
    .from({ user: usersCollection })
    .where(({ user }) => 
      and(
        eq(user.active, true),
        or(
          gt(user.age, 25),
          eq(user.role, 'admin')
        )
      )
    )
)
```

### Available Operators

The query system provides several comparison operators:

```ts
import { eq, gt, gte, lt, lte, like, ilike, inArray, and, or, not } from '@tanstack/db'

// Equality
eq(user.id, 1)

// Comparisons
gt(user.age, 18)    // greater than
gte(user.age, 18)   // greater than or equal
lt(user.age, 65)    // less than
lte(user.age, 65)   // less than or equal

// String matching
like(user.name, 'John%')    // case-sensitive pattern matching
ilike(user.name, 'john%')   // case-insensitive pattern matching

// Array membership
inArray(user.id, [1, 2, 3])

// Logical operators
and(condition1, condition2)
or(condition1, condition2)
not(condition)
```

For a complete reference of all available functions, see the [Expression Functions Reference](#expression-functions-reference) section.

## Select

Use `select` to specify which fields to include in your results and transform your data. Without `select`, you get the full schema.

Similar to the `where` clause, the `select` method takes a callback function that receives an object containing your table aliases and returns an object with the fields you want to include in your results. These can be combined with functions from the [Expression Functions Reference](#expression-functions-reference) section to create computed fields. You can also use the spread operator to include all fields from a table.

### Method Signature

```ts
select(
  projection: (row: TRow) => Record<string, Expression>
): Query
```

**Parameters:**
- `projection` - A callback function that receives the row object with table aliases and returns the selected fields object

### Basic Selects

Select specific fields from your data:

````ts
const userNames = createLiveQueryCollection((q) =>
  q
    .from({ user: usersCollection })
    .select(({ user }) => ({
      id: user.id,
      name: user.name,
      email: user.email,
    }))
)

/*
Result type: { id: number, name: string, email: string }

```ts
for (const row of userNames) {
  console.log(row.name)
}
```
*/
````

### Field Renaming

Rename fields in your results:

```ts
const userProfiles = createLiveQueryCollection((q) =>
  q
    .from({ user: usersCollection })
    .select(({ user }) => ({
      userId: user.id,
      fullName: user.name,
      contactEmail: user.email,
    }))
)
```

### Computed Fields

Create computed fields using expressions:

```ts
import { gt, length } from '@tanstack/db'

const userStats = createLiveQueryCollection((q) =>
  q
    .from({ user: usersCollection })
    .select(({ user }) => ({
      id: user.id,
      name: user.name,
      isAdult: gt(user.age, 18),
      nameLength: length(user.name),
    }))
)
```

### Using Functions and Including All Fields

Transform your data using built-in functions:

````ts
import { concat, upper, gt } from '@tanstack/db'

const formattedUsers = createCollection(liveQueryCollectionOptions({
  query: (q) =>
    q
      .from({ user: usersCollection })
      .select(({ user }) => ({
        ...user, // Include all user fields
        displayName: upper(concat(user.firstName, ' ', user.lastName)),
        isAdult: gt(user.age, 18),
      }))
}))

/*
Result type:
{
  id: number,
  name: string,
  email: string,
  displayName: string,
  isAdult: boolean,
}
*/
````

For a complete list of available functions, see the [Expression Functions Reference](#expression-functions-reference) section.

## Joins

Use `join` to combine data from multiple collections. Joins default to `left` join type and only support equality conditions.

Joins in TanStack DB are a way to combine data from multiple collections, and are conceptually very similar to SQL joins. When two collections are joined, the result is a new collection that contains the combined data as single rows. The new collection is a live query collection, and will automatically update when the underlying data changes.

A `join` without a `select` will return row objects that are namespaced with the aliases of the joined collections.

The result type of a join will take into account the join type, with the optionality of the joined fields being determined by the join type.

> [!NOTE]
> We are working on an `include` system that will enable joins that project to a hierarchical object. For example an `issue` row could have a `comments` property that is an array of `comment` rows.
> See [this issue](https://github.com/TanStack/db/issues/288) for more details.

### Method Signature

```ts
join(
  { [alias]: Collection | Query },
  condition: (row: TRow) => Expression<boolean>, // Must be an `eq` condition
  joinType?: 'left' | 'right' | 'inner' | 'full'
): Query
```

**Parameters:**
- `aliases` - An object where keys are alias names and values are collections or subqueries to join
- `condition` - A callback function that receives the combined row object and returns an equality condition
- `joinType` - Optional join type: `'left'` (default), `'right'`, `'inner'`, or `'full'`

### Basic Joins

Join users with their posts:

````ts
const userPosts = createLiveQueryCollection((q) =>
  q
    .from({ user: usersCollection })
    .join({ post: postsCollection }, ({ user, post }) => 
      eq(user.id, post.userId)
    )
)

/*
Result type: 
{ 
  user: User,
  post?: Post, // post is optional because it is a left join
}

```ts
for (const row of userPosts) {
  console.log(row.user.name, row.post?.title)
}
```
*/
````

### Join Types

Specify the join type as the third parameter:

```ts
const activeUserPosts = createLiveQueryCollection((q) =>
  q
    .from({ user: usersCollection })
    .join(
      { post: postsCollection }, 
      ({ user, post }) => eq(user.id, post.userId),
      'inner', // `inner`, `left`, `right` or `full`
    )
)
```

Or using the aliases `leftJoin`, `rightJoin`, `innerJoin` and `fullJoin` methods:

### Left Join
```ts
// Left join - all users, even without posts
const allUsers = createLiveQueryCollection((q) =>
  q
    .from({ user: usersCollection })
    .leftJoin(
      { post: postsCollection }, 
      ({ user, post }) => eq(user.id, post.userId),
    )
)

/*
Result type:
{
  user: User,
  post?: Post, // post is optional because it is a left join
}
*/
```

### Right Join

```ts
// Right join - all posts, even without users
const allPosts = createLiveQueryCollection((q) =>
  q
    .from({ user: usersCollection })
    .rightJoin(
      { post: postsCollection }, 
      ({ user, post }) => eq(user.id, post.userId),
    )
)

/*
Result type:
{
  user?: User, // user is optional because it is a right join
  post: Post,
}
*/
```

### Inner Join

```ts
// Inner join - only matching records
const activeUserPosts = createLiveQueryCollection((q) =>
  q
    .from({ user: usersCollection })
    .innerJoin(
      { post: postsCollection }, 
      ({ user, post }) => eq(user.id, post.userId),
    )
)

/*
Result type:
{
  user: User,
  post: Post,
}
*/
```

### Full Join

```ts
// Full join - all users and all posts
const allUsersAndPosts = createLiveQueryCollection((q) =>
  q
    .from({ user: usersCollection })
    .fullJoin(
      { post: postsCollection }, 
      ({ user, post }) => eq(user.id, post.userId),
    )
)

/*
Result type:
{
  user?: User, // user is optional because it is a full join
  post?: Post, // post is optional because it is a full join
}
*/
```

### Multiple Joins

Chain multiple joins in a single query:

```ts
const userPostComments = createLiveQueryCollection((q) =>
  q
    .from({ user: usersCollection })
    .join({ post: postsCollection }, ({ user, post }) => 
      eq(user.id, post.userId)
    )
    .join({ comment: commentsCollection }, ({ post, comment }) => 
      eq(post.id, comment.postId)
    )
    .select(({ user, post, comment }) => ({
      userName: user.name,
      postTitle: post.title,
      commentText: comment.text,
    }))
)
```

## Subqueries

Subqueries allow you to use the result of one query as input to another, they are embedded within the query itself and are compile to a single query pipeline. They are very similar to SQL subqueries that are executed as part of a single operation.

Note that subqueries are not the same as using a live query result in a `from` or `join` clause in a new query. When you do that the intermediate result is fully computed and accessible to you, subqueries are internal to their parent query and not materialised to a collection themselves and so are more efficient.

See the [Caching Intermediate Results](#caching-intermediate-results) section for more details on using live query results in a `from` or `join` clause in a new query.

### Subqueries in `from` Clauses

Use a subquery as the main source:

```ts
const activeUserPosts = createCollection(liveQueryCollectionOptions({
  query: (q) => {
    // Build the subquery first
    const activeUsers = q
      .from({ user: usersCollection })
      .where(({ user }) => eq(user.active, true))
    
    // Use the subquery in the main query
    return q
      .from({ activeUser: activeUsers })
      .join({ post: postsCollection }, ({ activeUser, post }) => 
        eq(activeUser.id, post.userId)
      )
  }
}))
```

### Subqueries in `join` Clauses

Join with a subquery result:

```ts
const userRecentPosts = createCollection(liveQueryCollectionOptions({
  query: (q) => {
    // Build the subquery first
    const recentPosts = q
      .from({ post: postsCollection })
      .where(({ post }) => gt(post.createdAt, '2024-01-01'))
      .orderBy(({ post }) => post.createdAt, 'desc')
      .limit(1)
    
    // Use the subquery in the main query
    return q
      .from({ user: usersCollection })
      .join({ recentPost: recentPosts }, ({ user, recentPost }) => 
        eq(user.id, recentPost.userId)
      )
  }
}))
```

### Subquery deduplication  

When the same subquery is used multiple times within a query, it's automatically deduplicated and executed only once:

```ts
const complexQuery = createCollection(liveQueryCollectionOptions({
  query: (q) => {
    // Build the subquery once
    const activeUsers = q
      .from({ user: usersCollection })
      .where(({ user }) => eq(user.active, true))
    
    // Use the same subquery multiple times
    return q
      .from({ activeUser: activeUsers })
      .join({ post: postsCollection }, ({ activeUser, post }) => 
        eq(activeUser.id, post.userId)
      )
      .join({ comment: commentsCollection }, ({ activeUser, comment }) => 
        eq(activeUser.id, comment.userId)
      )
  }
}))
```

In this example, the `activeUsers` subquery is used twice but executed only once, improving performance.

### Complex Nested Subqueries

Build complex queries with multiple levels of nesting:

```ts
import { count } from '@tanstack/db'

const topUsers = createCollection(liveQueryCollectionOptions({
  query: (q) => {
    // Build the post count subquery
    const postCounts = q
      .from({ post: postsCollection })
      .groupBy(({ post }) => post.userId)
      .select(({ post }) => ({
        userId: post.userId,
        count: count(post.id),
      }))
    
    // Build the user stats subquery
    const userStats = q
      .from({ user: usersCollection })
      .join({ postCount: postCounts }, ({ user, postCount }) => 
        eq(user.id, postCount.userId)
      )
      .select(({ user, postCount }) => ({
        id: user.id,
        name: user.name,
        postCount: postCount.count,
      }))
      .orderBy(({ userStats }) => userStats.postCount, 'desc')
      .limit(10)
    
    // Use the user stats subquery in the main query
    return q.from({ userStats })
  }
}))
```

## groupBy and Aggregations

Use `groupBy` to group your data and apply aggregate functions. When you use aggregates in `select` without `groupBy`, the entire result set is treated as a single group.

### Method Signature

```ts
groupBy(
  grouper: (row: TRow) => Expression | Expression[]
): Query
```

**Parameters:**
- `grouper` - A callback function that receives the row object and returns the grouping key(s). Can return a single value or an array for multi-column grouping

### Basic Grouping

Group users by their department and count them:

```ts
import { count, avg } from '@tanstack/db'

const departmentStats = createCollection(liveQueryCollectionOptions({
  query: (q) =>
    q
      .from({ user: usersCollection })
      .groupBy(({ user }) => user.departmentId)
      .select(({ user }) => ({
        departmentId: user.departmentId,
        userCount: count(user.id),
        avgAge: avg(user.age),
      }))
}))
```

> [!NOTE]
> In `groupBy` queries, the properties in your `select` clause must either be:
> - An aggregate function (like `count`, `sum`, `avg`)
> - A property that was used in the `groupBy` clause
> 
> You cannot select properties that are neither aggregated nor grouped.

### Multiple Column Grouping

Group by multiple columns by returning an array from the callback:

```ts
const userStats = createCollection(liveQueryCollectionOptions({
  query: (q) =>
    q
      .from({ user: usersCollection })
      .groupBy(({ user }) => [user.departmentId, user.role])
      .select(({ user }) => ({
        departmentId: user.departmentId,
        role: user.role,
        count: count(user.id),
        avgSalary: avg(user.salary),
      }))
}))
```

### Aggregate Functions

Use various aggregate functions to summarize your data:

```ts
import { count, sum, avg, min, max } from '@tanstack/db'

const orderStats = createCollection(liveQueryCollectionOptions({
  query: (q) =>
    q
      .from({ order: ordersCollection })
      .groupBy(({ order }) => order.customerId)
      .select(({ order }) => ({
        customerId: order.customerId,
        totalOrders: count(order.id),
        totalAmount: sum(order.amount),
        avgOrderValue: avg(order.amount),
        minOrder: min(order.amount),
        maxOrder: max(order.amount),
      }))
}))
```

See the [Aggregate Functions](#aggregate-functions) section for a complete list of available aggregate functions.

### Having Clauses

Filter aggregated results using `having` - this is similar to the `where` clause, but is applied after the aggregation has been performed.

#### Method Signature

```ts
having(
  condition: (row: TRow) => Expression<boolean>
): Query
```

**Parameters:**
- `condition` - A callback function that receives the aggregated row object and returns a boolean expression

```ts
const highValueCustomers = createLiveQueryCollection((q) =>
  q
    .from({ order: ordersCollection })
    .groupBy(({ order }) => order.customerId)
    .select(({ order }) => ({
      customerId: order.customerId,
      totalSpent: sum(order.amount),
      orderCount: count(order.id),
    }))
    .having(({ order }) => gt(sum(order.amount), 1000))
)
```

### Implicit Single-Group Aggregation

When you use aggregates without `groupBy`, the entire result set is grouped:

```ts
const overallStats = createLiveQueryCollection((q) =>
  q
    .from({ user: usersCollection })
    .select(({ user }) => ({
      totalUsers: count(user.id),
      avgAge: avg(user.age),
      maxSalary: max(user.salary),
    }))
)
```

This is equivalent to grouping the entire collection into a single group.

### Accessing Grouped Data

Grouped results can be accessed by the group key:

```ts
const deptStats = createCollection(liveQueryCollectionOptions({
  query: (q) =>
    q
      .from({ user: usersCollection })
      .groupBy(({ user }) => user.departmentId)
      .select(({ user }) => ({
        departmentId: user.departmentId,
        count: count(user.id),
      }))
}))

// Access by department ID
const engineeringStats = deptStats.get(1)
```

> **Note**: Grouped results are keyed differently based on the grouping:
> - **Single column grouping**: Keyed by the actual value (e.g., `deptStats.get(1)`)
> - **Multiple column grouping**: Keyed by a JSON string of the grouped values (e.g., `userStats.get('[1,"admin"]')`)

## Order By, Limit, and Offset

Use `orderBy`, `limit`, and `offset` to control the order and pagination of your results. Ordering is performed incrementally for optimal performance.

### Method Signatures

```ts
orderBy(
  selector: (row: TRow) => Expression,
  direction?: 'asc' | 'desc'
): Query

limit(count: number): Query

offset(count: number): Query
```

**Parameters:**
- `selector` - A callback function that receives the row object and returns the value to sort by
- `direction` - Sort direction: `'asc'` (default) or `'desc'`
- `count` - Number of rows to limit or skip

### Basic Ordering

Sort results by a single column:

```ts
const sortedUsers = createLiveQueryCollection((q) =>
  q
    .from({ user: usersCollection })
    .orderBy(({ user }) => user.name)
    .select(({ user }) => ({
      id: user.id,
      name: user.name,
    }))
)
```

### Multiple Column Ordering

Order by multiple columns:

```ts
const sortedUsers = createLiveQueryCollection((q) =>
  q
    .from({ user: usersCollection })
    .orderBy(({ user }) => user.departmentId, 'asc')
    .orderBy(({ user }) => user.name, 'asc')
    .select(({ user }) => ({
      id: user.id,
      name: user.name,
      departmentId: user.departmentId,
    }))
)
```

### Descending Order

Use `desc` for descending order:

```ts
const recentPosts = createLiveQueryCollection((q) =>
  q
    .from({ post: postsCollection })
    .orderBy(({ post }) => post.createdAt, 'desc')
    .select(({ post }) => ({
      id: post.id,
      title: post.title,
      createdAt: post.createdAt,
    }))
)
```

### Pagination with `limit` and `offset`

Skip results using `offset`:

```ts
const page2Users = createLiveQueryCollection((q) =>
  q
    .from({ user: usersCollection })
    .orderBy(({ user }) => user.name, 'asc')
    .limit(20)
    .offset(20) // Skip first 20 results
    .select(({ user }) => ({
      id: user.id,
      name: user.name,
    }))
)
```

## Composable Queries

Build complex queries by composing smaller, reusable parts. This approach makes your queries more maintainable and allows for better performance through caching.

### Conditional Query Building

Build queries based on runtime conditions:

```ts
import { Query, eq } from '@tanstack/db'

function buildUserQuery(options: { activeOnly?: boolean; limit?: number }) {
  let query = new Query().from({ user: usersCollection })
  
  if (options.activeOnly) {
    query = query.where(({ user }) => eq(user.active, true))
  }
  
  if (options.limit) {
    query = query.limit(options.limit)
  }
  
  return query.select(({ user }) => ({
    id: user.id,
    name: user.name,
  }))
}

const activeUsers = createLiveQueryCollection(buildUserQuery({ activeOnly: true, limit: 10 }))
```

### Caching Intermediate Results

The result of a live query collection is a collection itself, and will automatically update when the underlying data changes. This means that you can use the result of a live query collection as a source in another live query collection. This pattern is useful for building complex queries where you want to cache intermediate results to make further queries faster.

```ts
// Base query for active users
const activeUsers = createLiveQueryCollection((q) =>
  q
    .from({ user: usersCollection })
    .where(({ user }) => eq(user.active, true))
)

// Query that depends on active users
const activeUserPosts = createLiveQueryCollection((q) =>
  q
    .from({ user: activeUsers })
    .join({ post: postsCollection }, ({ user, post }) => 
      eq(user.id, post.userId)
    )
    .select(({ user, post }) => ({
      userName: user.name,
      postTitle: post.title,
    }))
)
```

### Reusable Query Definitions

You can use the `Query` class to create reusable query definitions. This is useful for building complex queries where you want to reuse the same query builder instance multiple times throughout your application.

```ts
import { Query, eq } from '@tanstack/db'

// Create a reusable query builder
const userQuery = new Query()
  .from({ user: usersCollection })
  .where(({ user }) => eq(user.active, true))

// Use it in different contexts
const activeUsers = createLiveQueryCollection({
  query: userQuery.select(({ user }) => ({
    id: user.id,
    name: user.name,
  }))
})

// Or as a subquery
const userPosts = createLiveQueryCollection((q) =>
  q
    .from({ activeUser: userQuery })
    .join({ post: postsCollection }, ({ activeUser, post }) => 
      eq(activeUser.id, post.userId)
    )
)
```

### Reusable Callback Functions

Use `Ref<MyType>` to create reusable callback functions:

```ts
import { Ref, eq, gt, and } from '@tanstack/db'

// Create reusable callbacks
const isActiveUser = (user: Ref<User>) => eq(user.active, true)
const isAdultUser = (user: Ref<User>) => gt(user.age, 18)

// Use them in queries
const activeAdults = createCollection(liveQueryCollectionOptions({
  query: (q) =>
    q
      .from({ user: usersCollection })
      .where(({ user }) => and(isActiveUser(user), isAdultUser(user)))
      .select(({ user }) => ({
        id: user.id,
        name: user.name,
        age: user.age,
      }))
}))
```

You can also create callbacks that take the whole row and pass them directly to `where`:

```ts
// Callback that takes the whole row
const isHighValueCustomer = (row: { user: User; order: Order }) => 
  row.user.active && row.order.amount > 1000

// Use directly in where clause
const highValueCustomers = createCollection(liveQueryCollectionOptions({
  query: (q) =>
    q
      .from({ user: usersCollection })
      .join({ order: ordersCollection }, ({ user, order }) => 
        eq(user.id, order.userId)
      )
      .where(isHighValueCustomer)
      .select(({ user, order }) => ({
        userName: user.name,
        orderAmount: order.amount,
      }))
}))
```

This approach makes your query logic more modular and testable.

## Expression Functions Reference

The query system provides a comprehensive set of functions for filtering, transforming, and aggregating data.

### Comparison Operators

#### `eq(left, right)`
Equality comparison:
```ts
eq(user.id, 1)
eq(user.name, 'John')
```

#### `gt(left, right)`, `gte(left, right)`, `lt(left, right)`, `lte(left, right)`
Numeric, string and date comparisons:
```ts
gt(user.age, 18)
gte(user.salary, 50000)
lt(user.createdAt, new Date('2024-01-01'))
lte(user.rating, 5)
```

#### `inArray(value, array)`
Check if a value is in an array:
```ts
inArray(user.id, [1, 2, 3])
inArray(user.role, ['admin', 'moderator'])
```

#### `like(value, pattern)`, `ilike(value, pattern)`
String pattern matching:
```ts
like(user.name, 'John%')    // Case-sensitive
ilike(user.email, '%@gmail.com')  // Case-insensitive
```

### Logical Operators

#### `and(...conditions)`
Combine conditions with AND logic:
```ts
and(
  eq(user.active, true),
  gt(user.age, 18),
  eq(user.role, 'user')
)
```

#### `or(...conditions)`
Combine conditions with OR logic:
```ts
or(
  eq(user.role, 'admin'),
  eq(user.role, 'moderator')
)
```

#### `not(condition)`
Negate a condition:
```ts
not(eq(user.active, false))
```

### String Functions

#### `upper(value)`, `lower(value)`
Convert case:
```ts
upper(user.name)  // 'JOHN'
lower(user.email) // 'john@example.com'
```

#### `length(value)`
Get string or array length:
```ts
length(user.name)     // String length
length(user.tags)     // Array length
```

#### `concat(...values)`
Concatenate strings:
```ts
concat(user.firstName, ' ', user.lastName)
concat('User: ', user.name, ' (', user.id, ')')
```

### Mathematical Functions

#### `add(left, right)`
Add two numbers:
```ts
add(user.salary, user.bonus)
```

#### `coalesce(...values)`
Return the first non-null value:
```ts
coalesce(user.displayName, user.name, 'Unknown')
```

### Aggregate Functions

#### `count(value)`
Count non-null values:
```ts
count(user.id)        // Count all users
count(user.postId)    // Count users with posts
```

#### `sum(value)`
Sum numeric values:
```ts
sum(order.amount)
sum(user.salary)
```

#### `avg(value)`
Calculate average:
```ts
avg(user.salary)
avg(order.amount)
```

#### `min(value)`, `max(value)`
Find minimum and maximum values:
```ts
min(user.salary)
max(order.amount)
```

### Function Composition

Functions can be composed and chained:

```ts
// Complex condition
and(
  eq(user.active, true),
  or(
    gt(user.age, 25),
    eq(user.role, 'admin')
  ),
  not(inArray(user.id, bannedUserIds))
)

// Complex transformation
concat(
  upper(user.firstName),
  ' ',
  upper(user.lastName),
  ' (',
  user.id,
  ')'
)

// Complex aggregation
avg(add(user.salary, coalesce(user.bonus, 0)))
```

## Functional Variants

The functional variant API provides an alternative to the standard API, offering more flexibility for complex transformations. With functional variants, the callback functions contain actual code that gets executed to perform the operation, giving you the full power of JavaScript at your disposal.

> [!WARNING]
> The functional variant API cannot be optimized by the query optimizer or use collection indexes. It is intended for use in rare cases where the standard API is not sufficient.

### Functional Select

Use `fn.select()` for complex transformations with JavaScript logic:

```ts
const userProfiles = createLiveQueryCollection((q) =>
  q
    .from({ user: usersCollection })
    .fn.select((row) => ({
      id: row.user.id,
      displayName: `${row.user.firstName} ${row.user.lastName}`,
      salaryTier: row.user.salary > 100000 ? 'senior' : 'junior',
      emailDomain: row.user.email.split('@')[1],
      isHighEarner: row.user.salary > 75000,
    }))
)
```

### Functional Where

Use `fn.where()` for complex filtering logic:

```ts
const specialUsers = createLiveQueryCollection((q) =>
  q
    .from({ user: usersCollection })
    .fn.where((row) => {
      const user = row.user
      return user.active && 
             (user.age > 25 || user.role === 'admin') &&
             user.email.includes('@company.com')
    })
)
```

### Functional Having

Use `fn.having()` for complex aggregation filtering:

```ts
const highValueCustomers = createLiveQueryCollection((q) =>
  q
    .from({ order: ordersCollection })
    .groupBy(({ order }) => order.customerId)
    .select(({ order }) => ({
      customerId: order.customerId,
      totalSpent: sum(order.amount),
      orderCount: count(order.id),
    }))
    .fn.having((row) => {
      return row.totalSpent > 1000 && row.orderCount >= 3
    })
)
```

### Complex Transformations

Functional variants excel at complex data transformations:

```ts
const userProfiles = createLiveQueryCollection((q) =>
  q
    .from({ user: usersCollection })
    .fn.select((row) => {
      const user = row.user
      const fullName = `${user.firstName} ${user.lastName}`.trim()
      const emailDomain = user.email.split('@')[1]
      const ageGroup = user.age < 25 ? 'young' : user.age < 50 ? 'adult' : 'senior'
      
      return {
        userId: user.id,
        displayName: fullName || user.name,
        contactInfo: {
          email: user.email,
          domain: emailDomain,
          isCompanyEmail: emailDomain === 'company.com'
        },
        demographics: {
          age: user.age,
          ageGroup: ageGroup,
          isAdult: user.age >= 18
        },
        status: user.active ? 'active' : 'inactive',
        profileStrength: fullName && user.email && user.age ? 'complete' : 'incomplete'
      }
    })
)
```

### Type Inference

Functional variants maintain full TypeScript support:

```ts
const processedUsers = createLiveQueryCollection((q) =>
  q
    .from({ user: usersCollection })
    .fn.select((row): ProcessedUser => ({
      id: row.user.id,
      name: row.user.name.toUpperCase(),
      age: row.user.age,
      ageGroup: row.user.age < 25 ? 'young' : row.user.age < 50 ? 'adult' : 'senior',
    }))
)
```

### When to Use Functional Variants

Use functional variants when you need:
- Complex JavaScript logic that can't be expressed with built-in functions
- Integration with external libraries or utilities
- Full JavaScript power for custom operations

The callbacks in functional variants are actual JavaScript functions that get executed, unlike the standard API which uses declarative expressions. This gives you complete control over the logic but comes with the trade-off of reduced optimization opportunities.

However, prefer the standard API when possible, as it provides better performance and optimization opportunities.
---
title: Creating a Collection Options Creator
id: guide/collection-options-creator
---
# Creating a Collection Options Creator

A collection options creator is a factory function that generates configuration options for TanStack DB collections. It provides a standardized way to integrate different sync engines and data sources with TanStack DB's reactive sync-first architecture.

## Overview

Collection options creators follow a consistent pattern:
1. Accept configuration specific to the sync engine
2. Return an object that satisfies the `CollectionConfig` interface
3. Handle sync initialization, data parsing, and transaction management
4. Optionally provide utility functions specific to the sync engine

## When to Create a Custom Collection

You should create a custom collection when:
- You have a dedicated sync engine (like ElectricSQL, Trailbase, Firebase, or a custom WebSocket solution)
- You need specific sync behaviors that aren't covered by the query collection
- You want to integrate with a backend that has its own sync protocol

**Note**: If you're just hitting an API and returning data, use the query collection instead.

## Core Requirements

Every collection options creator must implement these key responsibilities:

### 1. Configuration Interface

Define a configuration interface that extends or includes standard collection properties:

```typescript
// Pattern A: User provides handlers (Query / ElectricSQL style)
interface MyCollectionConfig<TItem extends object> {
  // Your sync engine specific options
  connectionUrl: string
  apiKey?: string
  
  // Standard collection properties
  id?: string
  schema?: StandardSchemaV1
  getKey: (item: TItem) => string | number
  sync?: SyncConfig<TItem>
  
  rowUpdateMode?: 'partial' | 'full'
  
  // User provides mutation handlers
  onInsert?: InsertMutationFn<TItem>
  onUpdate?: UpdateMutationFn<TItem>
  onDelete?: DeleteMutationFn<TItem>
}

// Pattern B: Built-in handlers (Trailbase style)
interface MyCollectionConfig<TItem extends object> 
  extends Omit<CollectionConfig<TItem>, 'onInsert' | 'onUpdate' | 'onDelete'> {
  // Your sync engine specific options
  recordApi: MyRecordApi<TItem>
  connectionUrl: string
  
  rowUpdateMode?: 'partial' | 'full'
  
  // Note: onInsert/onUpdate/onDelete are implemented by your collection creator
}
```

### 2. Sync Implementation

The sync function is the heart of your collection. It must:

The sync function must return a cleanup function for proper garbage collection:

```typescript
const sync: SyncConfig<T>['sync'] = (params) => {
  const { begin, write, commit, markReady, collection } = params
  
  // 1. Initialize connection to your sync engine
  const connection = initializeConnection(config)
  
  // 2. Set up real-time subscription FIRST (prevents race conditions)
  const eventBuffer: Array<any> = []
  let isInitialSyncComplete = false
  
  connection.subscribe((event) => {
    if (!isInitialSyncComplete) {
      // Buffer events during initial sync to prevent race conditions
      eventBuffer.push(event)
      return
    }
    
    // Process real-time events
    begin()
    
    switch (event.type) {
      case 'insert':
        write({ type: 'insert', value: event.data })
        break
      case 'update':
        write({ type: 'update', value: event.data })
        break
      case 'delete':
        write({ type: 'delete', value: event.data })
        break
    }
    
    commit()
  })
  
  // 3. Perform initial data fetch
  async function initialSync() {
    try {
      const data = await fetchInitialData()
      
      begin() // Start a transaction
      
      for (const item of data) {
        write({
          type: 'insert',
          value: item
        })
      }
      
      commit() // Commit the transaction
      
      // 4. Process buffered events
      isInitialSyncComplete = true
      if (eventBuffer.length > 0) {
        begin()
        for (const event of eventBuffer) {
          // Deduplicate if necessary based on your sync engine
          write({ type: event.type, value: event.data })
        }
        commit()
        eventBuffer.splice(0)
      }
      
    } catch (error) {
      console.error('Initial sync failed:', error)
      throw error
    } finally {
      // ALWAYS call markReady, even on error
      markReady()
    }
  }

  initialSync()
  
  // 4. Return cleanup function
  return () => {
    connection.close()
    // Clean up any timers, intervals, or other resources
  }
}
```

### 3. Transaction Lifecycle

Understanding the transaction lifecycle is important for correct implementation.

The sync process follows this lifecycle:

1. **begin()** - Start collecting changes
2. **write()** - Add changes to the pending transaction (buffered until commit)
3. **commit()** - Apply all changes atomically to the collection state
4. **markReady()** - Signal that initial sync is complete

**Race Condition Prevention:**
Many sync engines start real-time subscriptions before the initial sync completes. Your implementation MUST deduplicate events that arrive via subscription that represent the same data as the initial sync. Consider:
- Starting the listener BEFORE initial fetch and buffering events
- Tracking timestamps, sequence numbers, or document versions
- Using read timestamps or other ordering mechanisms

### 4. Data Parsing and Type Conversion

If your sync engine returns data with different types, provide conversion functions for specific fields:

```typescript
interface MyCollectionConfig<TItem, TRecord> {
  // ... other config
  
  // Only specify conversions for fields that need type conversion
  parse: {
    created_at: (ts: number) => new Date(ts * 1000),  // timestamp -> Date
    updated_at: (ts: number) => new Date(ts * 1000),  // timestamp -> Date
    metadata?: (str: string) => JSON.parse(str)       // JSON string -> object
  }
  
  serialize: {
    created_at: (date: Date) => Math.floor(date.valueOf() / 1000),  // Date -> timestamp
    updated_at: (date: Date) => Math.floor(date.valueOf() / 1000),  // Date -> timestamp  
    metadata?: (obj: object) => JSON.stringify(obj)                 // object -> JSON string
  }
}
```

**Type Conversion Examples:**
```typescript
// Firebase Timestamp to Date
parse: {
  createdAt: (timestamp) => timestamp?.toDate?.() || new Date(timestamp),
  updatedAt: (timestamp) => timestamp?.toDate?.() || new Date(timestamp),
}

// PostGIS geometry to GeoJSON
parse: {
  location: (wkb: string) => parseWKBToGeoJSON(wkb)
}

// JSON string to object with error handling
parse: {
  metadata: (str: string) => {
    try {
      return JSON.parse(str)
    } catch {
      return {}
    }
  }
}
```

### 5. Mutation Handler Patterns

There are two distinct patterns for handling mutations in collection options creators:

#### Pattern A: User-Provided Handlers (ElectricSQL, Query)

The user provides mutation handlers in the config. Your collection creator passes them through:

```typescript
interface MyCollectionConfig<TItem extends object> {
  // ... other config
  
  // User provides these handlers
  onInsert?: InsertMutationFn<TItem>
  onUpdate?: UpdateMutationFn<TItem>
  onDelete?: DeleteMutationFn<TItem>
}

export function myCollectionOptions<TItem extends object>(
  config: MyCollectionConfig<TItem>
) {
  return {
    // ... other options
    rowUpdateMode: config.rowUpdateMode || 'partial',
    
    // Pass through user-provided handlers (possibly with additional logic)
    onInsert: config.onInsert ? async (params) => {
      const result = await config.onInsert!(params)
      // Additional sync coordination logic
      return result
    } : undefined
  }
}
```

#### Pattern B: Built-in Handlers (Trailbase, WebSocket, Firebase)

Your collection creator implements the handlers directly using the sync engine's APIs:

```typescript
interface MyCollectionConfig<TItem extends object> 
  extends Omit<CollectionConfig<TItem>, 'onInsert' | 'onUpdate' | 'onDelete'> {
  // ... sync engine specific config
  // Note: onInsert/onUpdate/onDelete are NOT in the config
}

export function myCollectionOptions<TItem extends object>(
  config: MyCollectionConfig<TItem>
) {
  return {
    // ... other options
    rowUpdateMode: config.rowUpdateMode || 'partial',
    
    // Implement handlers using sync engine APIs
    onInsert: async ({ transaction }) => {
      // Handle provider-specific batch limits (e.g., Firestore's 500 limit)
      const chunks = chunkArray(transaction.mutations, PROVIDER_BATCH_LIMIT)
      
      for (const chunk of chunks) {
        const ids = await config.recordApi.createBulk(
          chunk.map(m => serialize(m.modified))
        )
        await awaitIds(ids)
      }
      
      return transaction.mutations.map(m => m.key)
    },
    
    onUpdate: async ({ transaction }) => {
      const chunks = chunkArray(transaction.mutations, PROVIDER_BATCH_LIMIT)
      
      for (const chunk of chunks) {
        await Promise.all(
          chunk.map(m => 
            config.recordApi.update(m.key, serialize(m.changes))
          )
        )
      }
      
      await awaitIds(transaction.mutations.map(m => String(m.key)))
    }
  }
}
```

Many providers have batch size limits (Firestore: 500, DynamoDB: 25, etc.) so chunk large transactions accordingly.

Choose Pattern A when users need to provide their own APIs, and Pattern B when your sync engine handles writes directly.

## Row Update Modes

Collections support two update modes:

- **`partial`** (default) - Updates are merged with existing data
- **`full`** - Updates replace the entire row

Configure this in your sync config:

```typescript
sync: {
  sync: syncFn,
  rowUpdateMode: 'full' // or 'partial'
}
```

## Production Examples

For complete, production-ready examples, see the collection packages in the TanStack DB repository:

- **[@tanstack/query-collection](https://github.com/TanStack/db/tree/main/packages/query-collection)** - Pattern A: User-provided handlers with full refetch strategy
- **[@tanstack/trailbase-collection](https://github.com/TanStack/db/tree/main/packages/trailbase-collection)** - Pattern B: Built-in handlers with ID-based tracking  
- **[@tanstack/electric-collection](https://github.com/TanStack/db/tree/main/packages/electric-collection)** - Pattern A: Transaction ID tracking with complex sync protocols

### Key Lessons from Production Collections

**From Query Collection:**
- Simplest approach: Full refetch after mutations
- Best for: APIs without real-time sync
- Pattern: User provides `onInsert/onUpdate/onDelete` handlers

**From Trailbase Collection:**  
- Shows ID-based optimistic state management
- Handles provider batch limits (chunking large operations)
- Pattern: Collection provides mutation handlers using record API

**From Electric Collection:**
- Complex transaction ID tracking for distributed sync
- Demonstrates advanced deduplication techniques
- Shows how to wrap user handlers with sync coordination

## Complete Example: WebSocket Collection

Here's a complete example of a WebSocket-based collection options creator that demonstrates the full round-trip flow:

1. Client sends transaction with all mutations batched together
2. Server processes the transaction and may modify the data (validation, timestamps, etc.)
3. Server sends back acknowledgment and the actual processed data
4. Client waits for this round-trip before dropping optimistic state

```typescript
import type {
  CollectionConfig,
  SyncConfig,
  InsertMutationFnParams,
  UpdateMutationFnParams,
  DeleteMutationFnParams,
  UtilsRecord
} from '@tanstack/db'

interface WebSocketMessage<T> {
  type: 'insert' | 'update' | 'delete' | 'sync' | 'transaction' | 'ack'
  data?: T | T[]
  mutations?: Array<{
    type: 'insert' | 'update' | 'delete'
    data: T
    id?: string
  }>
  transactionId?: string
  id?: string
}

interface WebSocketCollectionConfig<TItem extends object>
  extends Omit<CollectionConfig<TItem>, 'onInsert' | 'onUpdate' | 'onDelete' | 'sync'> {
  url: string
  reconnectInterval?: number
  
  // Note: onInsert/onUpdate/onDelete are handled by the WebSocket connection
  // Users don't provide these handlers
}

interface WebSocketUtils extends UtilsRecord {
  reconnect: () => void
  getConnectionState: () => 'connected' | 'disconnected' | 'connecting'
}

export function webSocketCollectionOptions<TItem extends object>(
  config: WebSocketCollectionConfig<TItem>
): CollectionConfig<TItem> & { utils: WebSocketUtils } {
  let ws: WebSocket | null = null
  let reconnectTimer: NodeJS.Timeout | null = null
  let connectionState: 'connected' | 'disconnected' | 'connecting' = 'disconnected'
  
  // Track pending transactions awaiting acknowledgment
  const pendingTransactions = new Map<string, {
    resolve: () => void
    reject: (error: Error) => void
    timeout: NodeJS.Timeout
  }>()
  
  const sync: SyncConfig<TItem>['sync'] = (params) => {
    const { begin, write, commit, markReady } = params
    
    function connect() {
      connectionState = 'connecting'
      ws = new WebSocket(config.url)
      
      ws.onopen = () => {
        connectionState = 'connected'
        // Request initial sync
        ws.send(JSON.stringify({ type: 'sync' }))
      }
      
      ws.onmessage = (event) => {
        const message: WebSocketMessage<TItem> = JSON.parse(event.data)
        
        switch (message.type) {
          case 'sync':
            // Initial sync with array of items
            begin()
            if (Array.isArray(message.data)) {
              for (const item of message.data) {
                write({ type: 'insert', value: item })
              }
            }
            commit()
            markReady()
            break
            
          case 'insert':
          case 'update':
          case 'delete':
            // Real-time updates from other clients
            begin()
            write({ 
              type: message.type, 
              value: message.data as TItem 
            })
            commit()
            break
            
          case 'ack':
            // Server acknowledged our transaction
            if (message.transactionId) {
              const pending = pendingTransactions.get(message.transactionId)
              if (pending) {
                clearTimeout(pending.timeout)
                pendingTransactions.delete(message.transactionId)
                pending.resolve()
              }
            }
            break
            
          case 'transaction':
            // Server sending back the actual data after processing our transaction
            if (message.mutations) {
              begin()
              for (const mutation of message.mutations) {
                write({
                  type: mutation.type,
                  value: mutation.data
                })
              }
              commit()
            }
            break
        }
      }
      
      ws.onerror = (error) => {
        console.error('WebSocket error:', error)
        connectionState = 'disconnected'
      }
      
      ws.onclose = () => {
        connectionState = 'disconnected'
        // Auto-reconnect
        if (!reconnectTimer) {
          reconnectTimer = setTimeout(() => {
            reconnectTimer = null
            connect()
          }, config.reconnectInterval || 5000)
        }
      }
    }
    
    // Start connection
    connect()
    
    // Return cleanup function
    return () => {
      if (reconnectTimer) {
        clearTimeout(reconnectTimer)
        reconnectTimer = null
      }
      if (ws) {
        ws.close()
        ws = null
      }
    }
  }
  
  // Helper function to send transaction and wait for server acknowledgment
  const sendTransaction = async (
    params: InsertMutationFnParams<TItem> | UpdateMutationFnParams<TItem> | DeleteMutationFnParams<TItem>
  ): Promise<void> => {
    if (ws?.readyState !== WebSocket.OPEN) {
      throw new Error('WebSocket not connected')
    }
    
    const transactionId = crypto.randomUUID()
    
    // Convert all mutations in the transaction to the wire format
    const mutations = params.transaction.mutations.map(mutation => ({
      type: mutation.type,
      id: mutation.key,
      data: mutation.type === 'delete' ? undefined : 
           mutation.type === 'update' ? mutation.changes : 
           mutation.modified
    }))
    
    // Send the entire transaction at once
    ws.send(JSON.stringify({
      type: 'transaction',
      transactionId,
      mutations
    }))
    
    // Wait for server acknowledgment
    return new Promise<void>((resolve, reject) => {
      const timeout = setTimeout(() => {
        pendingTransactions.delete(transactionId)
        reject(new Error(`Transaction ${transactionId} timed out`))
      }, 10000) // 10 second timeout
      
      pendingTransactions.set(transactionId, {
        resolve,
        reject,
        timeout
      })
    })
  }
  
  // All mutation handlers use the same transaction sender
  const onInsert = async (params: InsertMutationFnParams<TItem>) => {
    await sendTransaction(params)
  }
  
  const onUpdate = async (params: UpdateMutationFnParams<TItem>) => {
    await sendTransaction(params)
  }
  
  const onDelete = async (params: DeleteMutationFnParams<TItem>) => {
    await sendTransaction(params)
  }
  
  return {
    id: config.id,
    schema: config.schema,
    getKey: config.getKey,
    sync: { sync },
    onInsert,
    onUpdate,
    onDelete,
    utils: {
      reconnect: () => {
        if (ws) ws.close()
        connect()
      },
      getConnectionState: () => connectionState
    }
  }
}
```

## Usage Example

```typescript
import { createCollection } from '@tanstack/react-db'
import { webSocketCollectionOptions } from './websocket-collection'

const todos = createCollection(
  webSocketCollectionOptions({
    url: 'ws://localhost:8080/todos',
    getKey: (todo) => todo.id,
    schema: todoSchema
    // Note: No onInsert/onUpdate/onDelete - handled by WebSocket automatically
  })
)

// Use the collection
todos.insert({ id: '1', text: 'Buy milk', completed: false })

// Access utilities
todos.utils.getConnectionState() // 'connected'
todos.utils.reconnect() // Force reconnect
```

## Advanced: Managing Optimistic State

A critical challenge in sync-first apps is knowing when to drop optimistic state. When a user makes a change:

1. The UI updates immediately (optimistic update)
2. A mutation is sent to the backend
3. The backend processes and persists the change
4. The change syncs back to the client
5. The optimistic state should be dropped in favor of the synced data

The key question is: **How do you know when step 4 is complete?**

### Strategy 1: Built-in Provider Methods (Recommended)

Many providers offer built-in methods to wait for sync completion:

```typescript
// Firebase
await waitForPendingWrites(firestore)

// Custom WebSocket
await websocket.waitForAck(transactionId)
```

### Strategy 2: Transaction ID Tracking (ElectricSQL)

ElectricSQL returns transaction IDs that you can track:

```typescript
// Track seen transaction IDs
const seenTxids = new Store<Set<number>>(new Set())

// In sync, track txids from incoming messages
if (message.headers.txids) {
  message.headers.txids.forEach(txid => {
    seenTxids.setState(prev => new Set([...prev, txid]))
  })
}

// Mutation handlers return txids and wait for them
const wrappedOnInsert = async (params) => {
  const result = await config.onInsert!(params)
  
  // Wait for the txid to appear in synced data
  if (result.txid) {
    await awaitTxId(result.txid)
  }
  
  return result
}

// Utility function to wait for a txid
const awaitTxId = (txId: number): Promise<boolean> => {
  if (seenTxids.state.has(txId)) return Promise.resolve(true)
  
  return new Promise((resolve) => {
    const unsubscribe = seenTxids.subscribe(() => {
      if (seenTxids.state.has(txId)) {
        unsubscribe()
        resolve(true)
      }
    })
  })
}
```

### Strategy 3: ID-Based Tracking (Trailbase)

Trailbase tracks when specific record IDs have been synced:

```typescript
// Track synced IDs with timestamps
const seenIds = new Store(new Map<string, number>())

// In sync, mark IDs as seen
write({ type: 'insert', value: item })
seenIds.setState(prev => new Map(prev).set(item.id, Date.now()))

// Wait for specific IDs after mutations
const wrappedOnInsert = async (params) => {
  const ids = await config.recordApi.createBulk(items)
  
  // Wait for all IDs to be synced back
  await awaitIds(ids)
}

const awaitIds = (ids: string[]): Promise<void> => {
  const allSynced = ids.every(id => seenIds.state.has(id))
  if (allSynced) return Promise.resolve()
  
  return new Promise((resolve) => {
    const unsubscribe = seenIds.subscribe((state) => {
      if (ids.every(id => state.has(id))) {
        unsubscribe()
        resolve()
      }
    })
  })
}
```

### Strategy 4: Version/Timestamp Tracking

Track version numbers or timestamps to detect when data is fresh:

```typescript
// Track latest sync timestamp
let lastSyncTime = 0

// In mutations, record when the operation was sent
const wrappedOnUpdate = async (params) => {
  const mutationTime = Date.now()
  await config.onUpdate(params)
  
  // Wait for sync to catch up
  await waitForSync(mutationTime)
}

const waitForSync = (afterTime: number): Promise<void> => {
  if (lastSyncTime > afterTime) return Promise.resolve()
  
  return new Promise((resolve) => {
    const check = setInterval(() => {
      if (lastSyncTime > afterTime) {
        clearInterval(check)
        resolve()
      }
    }, 100)
  })
}
```

### Strategy 5: Full Refetch (Query Collection)

The query collection simply refetches all data after mutations:

```typescript
const wrappedOnInsert = async (params) => {
  // Perform the mutation
  await config.onInsert(params)
  
  // Refetch the entire collection
  await refetch()
  
  // The refetch will trigger sync with fresh data,
  // automatically dropping optimistic state
}
```

### Choosing a Strategy

- **Built-in Methods**: Best when your provider offers sync completion APIs
- **Transaction IDs**: Best when your backend provides reliable transaction tracking
- **ID-Based**: Good for systems where each mutation returns the affected IDs
- **Full Refetch**: Simplest but least efficient; good for small datasets
- **Version/Timestamp**: Works when your sync includes reliable ordering information

### Implementation Tips

1. **Always wait for sync** in your mutation handlers to ensure optimistic state is properly managed
2. **Handle timeouts** - Don't wait forever for sync confirmation
3. **Clean up tracking data** - Remove old txids/IDs to prevent memory leaks
4. **Provide utilities** - Export functions like `awaitTxId` or `awaitSync` for advanced use cases

## Best Practices

1. **Always call markReady()** - This signals that the collection has initial data and is ready for use
2. **Handle errors gracefully** - Call markReady() even on error to avoid blocking the app
3. **Clean up resources** - Return a cleanup function from sync to prevent memory leaks
4. **Batch operations** - Use begin/commit to batch multiple changes for better performance
5. **Race Conditions** - Start listeners before initial fetch and buffer events
6. **Type safety** - Use TypeScript generics to maintain type safety throughout
7. **Provide utilities** - Export sync-engine-specific utilities for advanced use cases

## Testing Your Collection

Test your collection options creator with:

1. **Unit tests** - Test sync logic, data transformations
2. **Integration tests** - Test with real sync engine
3. **Error scenarios** - Connection failures, invalid data
4. **Performance** - Large datasets, frequent updates

## Conclusion

Creating a collection options creator allows you to integrate any sync engine with TanStack DB's powerful sync-first architecture. Follow the patterns shown here, and you'll have a robust, type-safe integration that provides excellent developer experience.
---
title: Installation
id: installation
---

Each supported framework comes with its own package. Each framework package re-exports everything from the core `@tanstack/db` package.

## React

```sh
npm install @tanstack/react-db
```

TanStack DB is compatible with React v16.8+

## Solid

```sh
npm install @tanstack/solid-db
```

## Svelte

```sh
npm install @tanstack/svelte-db
```

## Vue

```sh
npm install @tanstack/vue-db
```

TanStack DB is compatible with Vue v3.3.0+

## Vanilla JS

```sh
npm install @tanstack/db
```

Install the the core `@tanstack/db` package to use DB without a framework.

## Collection Packages

TanStack DB also provides specialized collection packages for different data sources and storage needs:

### Query Collection

For loading data using TanStack Query:

```sh
npm install @tanstack/query-db-collection
```

Use `queryCollectionOptions` to fetch data into collections using TanStack Query. This is perfect for REST APIs and existing TanStack Query setups.

### Local Collections

Local storage and in-memory collections are included with the framework packages:

- **LocalStorageCollection** - For persistent local data that syncs across browser tabs
- **LocalOnlyCollection** - For temporary in-memory data and UI state

Both use `localStorageCollectionOptions` and `localOnlyCollectionOptions` respectively, available from your framework package (e.g., `@tanstack/react-db`).

### Sync Engines

#### Electric Collection

For real-time sync with [ElectricSQL](https://electric-sql.com):

```sh
npm install @tanstack/electric-db-collection
```

Use `electricCollectionOptions` to sync data from Postgres databases through ElectricSQL shapes. Ideal for real-time, local-first applications.

#### TrailBase Collection

For syncing with [TrailBase](https://trailbase.io) backends:

```sh
npm install @tanstack/trailbase-db-collection
```

Use `trailBaseCollectionOptions` to sync records from TrailBase's Record APIs with built-in subscription support.
